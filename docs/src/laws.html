<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>src.laws API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../src.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;src</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Curves">Curves</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Curves.linear">linear</a>
                        </li>
                        <li>
                                <a class="function" href="#Curves.expon">expon</a>
                        </li>
                        <li>
                                <a class="function" href="#Curves.expon_neg">expon_neg</a>
                        </li>
                        <li>
                                <a class="function" href="#Curves.euler">euler</a>
                        </li>
                        <li>
                                <a class="function" href="#Curves.power">power</a>
                        </li>
                        <li>
                                <a class="function" href="#Curves.power_neg">power_neg</a>
                        </li>
                        <li>
                                <a class="function" href="#Curves.logar">logar</a>
                        </li>
                        <li>
                                <a class="function" href="#Curves.cubic">cubic</a>
                        </li>
                        <li>
                                <a class="function" href="#Curves.sigmoid">sigmoid</a>
                        </li>
                        <li>
                                <a class="function" href="#Curves.quad">quad</a>
                        </li>
                        <li>
                                <a class="function" href="#Curves.four">four</a>
                        </li>
                        <li>
                                <a class="function" href="#Curves.zipf">zipf</a>
                        </li>
                        <li>
                                <a class="function" href="#Curves.power_law">power_law</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DistributionFitingTools">DistributionFitingTools</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#DistributionFitingTools.curves">curves</a>
                        </li>
                        <li>
                                <a class="function" href="#DistributionFitingTools.model_choose">model_choose</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Stats">Stats</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Stats.get_animals_no">get_animals_no</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_period">get_period</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_min_labels_no_after_filtration">get_min_labels_no_after_filtration</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_mean_labels_no_after_filtration">get_mean_labels_no_after_filtration</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_std_labels_no_after_filtration">get_std_labels_no_after_filtration</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_min_records_no_before_filtration">get_min_records_no_before_filtration</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_mean_records_no_before_filtration">get_mean_records_no_before_filtration</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_std_records_no_before_filtration">get_std_records_no_before_filtration</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_mean_periods">get_mean_periods</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_min_periods">get_min_periods</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_max_periods">get_max_periods</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_std_periods">get_std_periods</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_overall_area">get_overall_area</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_mean_area">get_mean_area</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_min_area">get_min_area</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_max_area">get_max_area</a>
                        </li>
                        <li>
                                <a class="function" href="#Stats.get_std_area">get_std_area</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DataSetStats">DataSetStats</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DataSetStats.__init__">DataSetStats</a>
                        </li>
                        <li>
                                <a class="variable" href="#DataSetStats.output_dir">output_dir</a>
                        </li>
                        <li>
                                <a class="variable" href="#DataSetStats.record">record</a>
                        </li>
                        <li>
                                <a class="variable" href="#DataSetStats.stats_set">stats_set</a>
                        </li>
                        <li>
                                <a class="function" href="#DataSetStats.add_data">add_data</a>
                        </li>
                        <li>
                                <a class="function" href="#DataSetStats.add_record">add_record</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Prepocessing">Prepocessing</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Prepocessing.__init__">Prepocessing</a>
                        </li>
                        <li>
                                <a class="function" href="#Prepocessing.get_mean_points">get_mean_points</a>
                        </li>
                        <li>
                                <a class="function" href="#Prepocessing.set_start_stop_time">set_start_stop_time</a>
                        </li>
                        <li>
                                <a class="function" href="#Prepocessing.set_crs">set_crs</a>
                        </li>
                        <li>
                                <a class="function" href="#Prepocessing.filter_by_min_number">filter_by_min_number</a>
                        </li>
                        <li>
                                <a class="function" href="#Prepocessing.filter_by_quartiles">filter_by_quartiles</a>
                        </li>
                        <li>
                                <a class="function" href="#Prepocessing.filing_data">filing_data</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Flexation">Flexation</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Flexation.find_distributions">find_distributions</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Laws">Laws</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Laws.__init__">Laws</a>
                        </li>
                        <li>
                                <a class="variable" href="#Laws.pdf_object">pdf_object</a>
                        </li>
                        <li>
                                <a class="variable" href="#Laws.output_path">output_path</a>
                        </li>
                        <li>
                                <a class="variable" href="#Laws.stats_frame">stats_frame</a>
                        </li>
                        <li>
                                <a class="variable" href="#Laws.curve_fitting">curve_fitting</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.log_curve_fitting_resluts">log_curve_fitting_resluts</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.log_distribution_fitting_resluts">log_distribution_fitting_resluts</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.log_pnew_estimation">log_pnew_estimation</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.log_msd_split">log_msd_split</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.check_curve_fit">check_curve_fit</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.check_distribution_fit">check_distribution_fit</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.visitation_frequency">visitation_frequency</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.jump_lengths_distribution">jump_lengths_distribution</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.waiting_times">waiting_times</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.travel_times">travel_times</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.rog">rog</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.rog_over_time">rog_over_time</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.msd_distribution">msd_distribution</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.msd_curve">msd_curve</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.return_time_distribution">return_time_distribution</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.exploration_time">exploration_time</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.msd_curve_split">msd_curve_split</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.distinct_locations_over_time">distinct_locations_over_time</a>
                        </li>
                        <li>
                                <a class="function" href="#Laws.estimate_pnew">estimate_pnew</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ScalingLawsCalc">ScalingLawsCalc</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ScalingLawsCalc.__init__">ScalingLawsCalc</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScalingLawsCalc.data">data</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScalingLawsCalc.animal_name">animal_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScalingLawsCalc.output_dir">output_dir</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScalingLawsCalc.output_dir_animal">output_dir_animal</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScalingLawsCalc.pdf">pdf</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScalingLawsCalc.stats_frame">stats_frame</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalingLawsCalc.process_file">process_file</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../src.html">src</a><wbr>.laws    </h1>

                        <div class="docstring"><p>Module for data processing, statistical analysis,
and model fitting using Flexation and related methods.</p>

<p>This module includes functionality for handling data related
to animal movement, applying various filtering and preprocessing
techniques, and fitting statistical models to segmented data based
on flexation points.</p>
</div>

                        <input id="mod-laws-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-laws-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">Module for data processing, statistical analysis,</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">and model fitting using Flexation and related methods.</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="sd">This module includes functionality for handling data related</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="sd">to animal movement, applying various filtering and preprocessing</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="sd">techniques, and fitting statistical models to segmented data based</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="sd">on flexation points.</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">import</span> <span class="nn">logging</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">import</span> <span class="nn">scipy</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="kn">import</span> <span class="nn">scipy.stats</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">from</span> <span class="nn">fpdf</span> <span class="kn">import</span> <span class="n">FPDF</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="kn">import</span> <span class="nn">matplotlib</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;Agg&quot;</span><span class="p">)</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">std</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="kn">from</span> <span class="nn">humobi.structures.trajectory</span> <span class="kn">import</span> <span class="n">TrajectoriesFrame</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="kn">from</span> <span class="nn">humobi.measures.individual</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a>    <span class="n">visitation_frequency</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>    <span class="n">jump_lengths</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>    <span class="n">distinct_locations_over_time</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a>    <span class="n">radius_of_gyration</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>    <span class="n">mean_square_displacement</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>    <span class="n">num_of_distinct_locations</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="p">)</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="kn">from</span> <span class="nn">humobi.tools.processing</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a>    <span class="n">rowwise_average</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>    <span class="n">convert_to_distribution</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a>    <span class="n">start_end</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>    <span class="n">groupwise_expansion</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="p">)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="kn">from</span> <span class="nn">constans</span> <span class="kn">import</span> <span class="n">const</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">scp_stats</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="kn">from</span> <span class="nn">distfit</span> <span class="kn">import</span> <span class="n">distfit</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">wasserstein_distance</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="kn">import</span> <span class="nn">ruptures</span> <span class="k">as</span> <span class="nn">rpt</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="kn">import</span> <span class="nn">powerlaw</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> - </span><span class="si">%(levelname)s</span><span class="s2"> - </span><span class="si">%(message)s</span><span class="s2">&quot;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="p">)</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="k">class</span> <span class="nc">Curves</span><span class="p">:</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="sd">    A class containing various static methods to model different</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="sd">    mathematical curves. These methods take input values and parameters</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">    to compute specific mathematical transformations.</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>    <span class="k">def</span> <span class="nf">linear</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">        Computes a linear transformation: y = a*x.</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">        Parameters:</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">        a (float): Slope coefficient.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="sd">        b (float): Scaling coefficient.</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">        Returns:</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>    <span class="k">def</span> <span class="nf">expon</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">        Computes an exponential curve: y = a * x^b.</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="sd">        Parameters:</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="sd">        a (float): Base scaling coefficient.</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="sd">        b (float): Exponent.</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="sd">        Returns:</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>    <span class="k">def</span> <span class="nf">expon_neg</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="sd">        Computes a negative exponential curve: y = a * x^(-b).</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="sd">        Parameters:</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a><span class="sd">        a (float): Scaling coefficient.</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="sd">        b (float): Negative exponent.</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="sd">        Returns:</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="p">)</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>    <span class="k">def</span> <span class="nf">euler</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a><span class="sd">        Computes an Euler&#39;s exponential curve: y = a * e^(b * x).</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a><span class="sd">        Parameters:</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a><span class="sd">        a (float): Scaling coefficient.</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="sd">        b (float): Exponent coefficient.</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="sd">        Returns:</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>    <span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a><span class="sd">        Computes a power curve: y = a * b^x.</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a><span class="sd">        Parameters:</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a><span class="sd">        a (float): Scaling coefficient.</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="sd">        b (float): Base.</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">        Returns:</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>    <span class="k">def</span> <span class="nf">power_neg</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a><span class="sd">        Computes a negative power curve: y = a * b^(-x).</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a><span class="sd">        Parameters:</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a><span class="sd">        a (float): Scaling coefficient.</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a><span class="sd">        b (float): Base.</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a><span class="sd">        Returns:</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>    <span class="k">def</span> <span class="nf">logar</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="sd">        Computes a logarithmic curve: y = a + b * log(x).</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a><span class="sd">        Parameters:</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a><span class="sd">        a (float): Constant offset.</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a><span class="sd">        b (float): Logarithmic scaling factor.</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a><span class="sd">        Returns:</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>    <span class="k">def</span> <span class="nf">cubic</span><span class="p">(</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>        <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a><span class="sd">        Computes a cubic curve: y = a*x^3 + b*x^2 + c*x + d.</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a><span class="sd">        Parameters:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a><span class="sd">        a, b, c, d (float): Coefficients for cubic, quadratic,</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="sd">            linear, and constant terms.</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a><span class="sd">        Returns:</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">d</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>    <span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a><span class="sd">        Computes a sigmoid curve: y = 1 / (1 + exp(a*x)).</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a><span class="sd">        Parameters:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a><span class="sd">        a (float): Scaling factor.</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a><span class="sd">        b (float): Offset factor.</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a><span class="sd">        Returns:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>    <span class="k">def</span> <span class="nf">quad</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a><span class="sd">        Computes a quadratic curve: y = a*x^2 + b*x + c.</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a><span class="sd">        Parameters:</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a><span class="sd">        a (float): Coefficient for the quadratic term.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a><span class="sd">        b (float): Coefficient for the linear term.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="sd">        c (float): Constant term.</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a><span class="sd">        Returns:</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>    <span class="k">def</span> <span class="nf">four</span><span class="p">(</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>        <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a><span class="sd">        Computes a quartic curve: y = a*x^4 + b*x^3 + c*x^2 + d*x + e.</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a><span class="sd">        Parameters:</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a><span class="sd">        a, b, c, d, e (float): Coefficients for quartic, cubic,</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a><span class="sd">        quadratic, linear, and constant terms.</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a><span class="sd">        Returns:</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">e</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>    <span class="k">def</span> <span class="nf">zipf</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a><span class="sd">        Computes a Zipf curve: y = 1 / (x + a)^b.</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a><span class="sd">        Parameters:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a><span class="sd">        a (float): Offset to prevent division by zero.</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a><span class="sd">        b (float): Exponent for scaling.</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a><span class="sd">        Returns:</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="n">b</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>    <span class="k">def</span> <span class="nf">power_law</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a><span class="sd">        Power-law function used to model the number of unique places</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a><span class="sd">        visited over time.</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>        <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">n</span><span class="o">**</span><span class="n">B</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="k">class</span> <span class="nc">DistributionFitingTools</span><span class="p">:</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a><span class="sd">    A class containing tools for fitting distributions and models to data.</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">curves</span> <span class="o">=</span> <span class="n">Curves</span><span class="p">()</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>    <span class="k">def</span> <span class="nf">_fit_distribution</span><span class="p">(</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">distribution</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="sd">        Fits a given distribution to the data</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a><span class="sd">        Parameters:</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a><span class="sd">        ----------</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a><span class="sd">        data : numpy.ndarray</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a><span class="sd">            The data to which the distribution is fitted.</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a><span class="sd">        distribution : scipy.stats.rv_continuous</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a><span class="sd">            The distribution to fit to the data.</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a><span class="sd">        Returns:</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a><span class="sd">        -------</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a><span class="sd">        float</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>        <span class="n">arg</span> <span class="o">=</span> <span class="n">params</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>        <span class="n">loc</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>        <span class="n">scale</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>        <span class="n">pdf_values</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>        <span class="n">log_likelihood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pdf_values</span><span class="p">))</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>        <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>        <span class="n">aic</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">log_likelihood</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>        <span class="n">aicc</span> <span class="o">=</span> <span class="n">aic</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">num_params</span> <span class="o">*</span> <span class="p">(</span><span class="n">num_params</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">num_params</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>        <span class="p">)</span>  <span class="c1"># AICc correction</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>        <span class="k">return</span> <span class="n">aicc</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>    <span class="k">def</span> <span class="nf">_calculate_akaike_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aic_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="sd">        Calculates Akaike weights from AIC values.</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">        Parameters:</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a><span class="sd">        ----------</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a><span class="sd">        aic_values : list of float</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="sd">            The list of AIC values for different models.</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a><span class="sd">        Returns:</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a><span class="sd">        -------</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a><span class="sd">        numpy.ndarray</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="sd">            The Akaike weights corresponding to each AIC value.</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>        <span class="n">delta_aic</span> <span class="o">=</span> <span class="n">aic_values</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">aic_values</span><span class="p">)</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>        <span class="n">exp_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">delta_aic</span><span class="p">)</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>        <span class="n">weights</span> <span class="o">=</span> <span class="n">exp_term</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">exp_term</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>        <span class="k">return</span> <span class="n">weights</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>    <span class="k">def</span> <span class="nf">_multiple_distributions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a><span class="sd">        Fits multiple distributions to the data and selects</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a><span class="sd">        the best one based on AICc.</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a><span class="sd">        Parameters:</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="sd">        ----------</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a><span class="sd">        data : numpy.ndarray</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="sd">            The data to which the distributions are fitted.</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a><span class="sd">        Returns:</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a><span class="sd">        -------</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a><span class="sd">        tuple</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a><span class="sd">            The best fitting distribution and weights of results</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>        <span class="n">distributions</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>            <span class="n">scp_stats</span><span class="o">.</span><span class="n">lognorm</span><span class="p">,</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>            <span class="n">scp_stats</span><span class="o">.</span><span class="n">expon</span><span class="p">,</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>            <span class="n">scp_stats</span><span class="o">.</span><span class="n">powerlaw</span><span class="p">,</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>            <span class="n">scp_stats</span><span class="o">.</span><span class="n">norm</span><span class="p">,</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>            <span class="n">scp_stats</span><span class="o">.</span><span class="n">pareto</span><span class="p">,</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>        <span class="p">]</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>        <span class="n">aic_values</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>        <span class="k">for</span> <span class="n">distribution</span> <span class="ow">in</span> <span class="n">distributions</span><span class="p">:</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>            <span class="n">current_aic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_distribution</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">distribution</span><span class="p">)</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>            <span class="n">aic_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_aic</span><span class="p">)</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>        <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_akaike_weights</span><span class="p">(</span><span class="n">aic_values</span><span class="p">)</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>        <span class="n">best_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanargmin</span><span class="p">(</span><span class="n">aic_values</span><span class="p">)</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>        <span class="n">best_distribution</span> <span class="o">=</span> <span class="n">distributions</span><span class="p">[</span><span class="n">best_index</span><span class="p">]</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        <span class="k">return</span> <span class="n">best_distribution</span><span class="p">,</span> <span class="n">weights</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>    <span class="k">def</span> <span class="nf">model_choose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vals</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a><span class="sd">        Chooses the best fitting model from a set of predefined curves</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a><span class="sd">        based on AICc.</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a><span class="sd">        Parameters:</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a><span class="sd">        ----------</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a><span class="sd">        vals : pandas.Series</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a><span class="sd">            The data to which the models are fitted.</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a><span class="sd">        Returns:</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a><span class="sd">        -------</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a><span class="sd">        tuple</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a><span class="sd">            The best fit model, its name, parameters, and a DataFrame</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a><span class="sd">            containing model information.</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>        <span class="n">expon_pred</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">linear</span><span class="p">,</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">expon</span><span class="p">,</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">expon_neg</span><span class="p">,</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">,</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>        <span class="p">]:</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>                <span class="n">params</span><span class="p">,</span> <span class="n">covar</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>                <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;expon&quot;</span><span class="p">:</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>                    <span class="n">expon_pred</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>                <span class="n">residuals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">y_pred</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>                <span class="n">aic</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>                <span class="n">aicc</span> <span class="o">=</span> <span class="n">aic</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">num_params</span> <span class="o">*</span> <span class="p">(</span><span class="n">num_params</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="o">-</span> <span class="n">num_params</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>                <span class="p">)</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>                <span class="n">scores</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">aicc</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>                <span class="n">parameters</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>                <span class="k">continue</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>        <span class="n">min_aicc</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">scores</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>        <span class="n">min_aicc</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">min_aicc</span><span class="p">]</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>        <span class="n">waicc</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="o">-</span> <span class="n">min_aicc</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>        <span class="n">waicc</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">waicc</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>        <span class="n">waicc</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">waicc</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">waicc</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>        <span class="n">global_params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>                <span class="s2">&quot;curve&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="s2">&quot;param1&quot;</span><span class="p">,</span> <span class="s2">&quot;param2&quot;</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>                <span class="p">]</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>            <span class="p">)</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">key1</span><span class="p">,</span> <span class="n">value1</span><span class="p">),</span> <span class="p">(</span><span class="n">key2</span><span class="p">,</span> <span class="n">value2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">waicc</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>            <span class="k">if</span> <span class="n">key1</span> <span class="o">==</span> <span class="n">key2</span><span class="p">:</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>                <span class="n">global_params</span> <span class="o">=</span> <span class="n">global_params</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>                    <span class="p">{</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>                        <span class="s2">&quot;curve&quot;</span><span class="p">:</span> <span class="n">key2</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>                        <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">value1</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>                        <span class="s2">&quot;param1&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">value2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">25</span><span class="p">),</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>                        <span class="s2">&quot;param2&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">value2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">25</span><span class="p">),</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>                    <span class="p">},</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>                    <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>                <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>        <span class="n">best_fit</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">waicc</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">waicc</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>        <span class="n">params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">best_fit</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>            <span class="n">best_fit</span><span class="p">(</span><span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">),</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>            <span class="n">best_fit</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>            <span class="n">params</span><span class="p">,</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>            <span class="n">global_params</span><span class="p">,</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>            <span class="n">expon_pred</span><span class="p">,</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>        <span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a><span class="k">class</span> <span class="nc">Stats</span><span class="p">:</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a><span class="sd">    A utility class for calculating various statistics and metrics</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a><span class="sd">    from a TrajectoriesFrame.</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>    <span class="k">def</span> <span class="nf">get_animals_no</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a><span class="sd">        Get the total number of unique animals in the dataset.</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a><span class="sd">        Args:</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a><span class="sd">            data (TrajectoriesFrame): Input data with animal trajectories.</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a><span class="sd">        Returns:</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a><span class="sd">            int: The number of unique animals.</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get_users</span><span class="p">())</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>    <span class="k">def</span> <span class="nf">get_period</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a><span class="sd">        Get the total observation period of the dataset.</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a><span class="sd">        Args:</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a><span class="sd">            data (TrajectoriesFrame): Input data containing</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a><span class="sd">                &#39;start&#39; and &#39;end&#39; columns.</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a><span class="sd">        Returns:</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a><span class="sd">            pd.Timedelta: The duration between the earliest start</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a><span class="sd">                and the latest end.</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a><span class="sd">        Raises:</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a><span class="sd">            KeyError: If columns &#39;start&#39; or &#39;end&#39; are missing</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a><span class="sd">                in the dataset.</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a><span class="sd">            ValueError: If columns &#39;start&#39; or &#39;end&#39; contain</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a><span class="sd">                invalid datetime values.</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>            <span class="n">min_start</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>            <span class="n">max_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid datetime format: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>        <span class="k">return</span> <span class="n">max_end</span> <span class="o">-</span> <span class="n">min_start</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>    <span class="k">def</span> <span class="nf">get_min_labels_no_after_filtration</span><span class="p">(</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a><span class="sd">        Get the users with the minimum number of unique labels</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a><span class="sd">        after filtration.</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a><span class="sd">        Args:</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;user_id&#39;</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a><span class="sd">                and &#39;labels&#39; columns.</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a><span class="sd">        Returns:</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a><span class="sd">            pd.Series: Users with the minimum unique label count.</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>        <span class="n">unique_label_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>        <span class="n">min_unique_label_count</span> <span class="o">=</span> <span class="n">unique_label_counts</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>        <span class="k">return</span> <span class="n">unique_label_counts</span><span class="p">[</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>            <span class="n">unique_label_counts</span> <span class="o">==</span> <span class="n">min_unique_label_count</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>        <span class="p">]</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>    <span class="k">def</span> <span class="nf">get_mean_labels_no_after_filtration</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a><span class="sd">        Get the users mean number of unique labels</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="sd">        after filtration.</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">        Args:</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;user_id&#39;</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">                and &#39;labels&#39; columns.</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">        Returns:</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="sd">            int: Users mean no. unique label count.</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>        <span class="n">unique_label_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>        <span class="n">mean_unique_label_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">unique_label_counts</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>        <span class="k">return</span> <span class="n">mean_unique_label_count</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>    <span class="k">def</span> <span class="nf">get_std_labels_no_after_filtration</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a><span class="sd">        Get the users std of unique labels</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a><span class="sd">        after filtration.</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a><span class="sd">        Args:</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;user_id&#39;</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a><span class="sd">                and &#39;labels&#39; columns.</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a><span class="sd">        Returns:</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a><span class="sd">            int: Users mean no. unique label count.</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>        <span class="n">unique_label_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">unique_label_counts</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>  <span class="c1"># type: ignore</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>            <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># type: ignore</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>    <span class="k">def</span> <span class="nf">get_min_records_no_before_filtration</span><span class="p">(</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a><span class="sd">        Get the animals with the minimum number of records</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a><span class="sd">        before filtration.</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a><span class="sd">        Args:</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;animal_id&#39;</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a><span class="sd">                and &#39;time&#39; columns.</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a><span class="sd">        Returns:</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a><span class="sd">            pd.Series: Animals with the minimum number of records.</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>        <span class="n">records_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>        <span class="n">min_label_count</span> <span class="o">=</span> <span class="n">records_counts</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>        <span class="k">return</span> <span class="n">records_counts</span><span class="p">[</span><span class="n">records_counts</span> <span class="o">==</span> <span class="n">min_label_count</span><span class="p">]</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>    <span class="k">def</span> <span class="nf">get_mean_records_no_before_filtration</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a><span class="sd">        Get the mean number of records</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a><span class="sd">        before filtration.</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a><span class="sd">        Args:</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;animal_id&#39;</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a><span class="sd">                and &#39;time&#39; columns.</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a><span class="sd">        Returns:</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a><span class="sd">            int: mean number of records.</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>        <span class="n">records_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>        <span class="n">mean_label_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">records_counts</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>        <span class="k">return</span> <span class="n">mean_label_count</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>    <span class="k">def</span> <span class="nf">get_std_records_no_before_filtration</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a><span class="sd">        Get the mean number of records</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a><span class="sd">        before filtration.</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a><span class="sd">        Args:</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;animal_id&#39;</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a><span class="sd">                and &#39;time&#39; columns.</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a><span class="sd">        Returns:</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a><span class="sd">            int: mean number of records.</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>        <span class="n">records_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">records_counts</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>  <span class="c1"># type: ignore</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>            <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># type: ignore</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>    <span class="k">def</span> <span class="nf">get_mean_periods</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="sd">        Get the mean period between start and end times.</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a><span class="sd">        Args:</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;start&#39;</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a><span class="sd">                and &#39;end&#39; columns.</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a><span class="sd">        Returns:</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a><span class="sd">            float: The mean period in days.</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>    <span class="k">def</span> <span class="nf">get_min_periods</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a><span class="sd">        Get the minimum period between start and end times.</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a><span class="sd">        Args:</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;start&#39;</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a><span class="sd">                and &#39;end&#39; columns.</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a><span class="sd">        Returns:</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a><span class="sd">            float: The minimum period in days.</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>    <span class="k">def</span> <span class="nf">get_max_periods</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a><span class="sd">        Get the maximum period between start and end times.</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="sd">        Args:</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;start&#39;</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a><span class="sd">                and &#39;end&#39; columns.</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a><span class="sd">        Returns:</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a><span class="sd">            float: The maximum period in days.</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>    <span class="k">def</span> <span class="nf">get_std_periods</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a><span class="sd">        Get the std of period between start and end times.</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a><span class="sd">        Args:</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;start&#39;</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a><span class="sd">                and &#39;end&#39; columns.</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a><span class="sd">        Returns:</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a><span class="sd">            float: The std period in days.</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>            <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># type: ignore</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>    <span class="k">def</span> <span class="nf">get_overall_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a><span class="sd">        Get the overall area covered by the trajectories.</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a><span class="sd">        Args:</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a><span class="sd">            data (TrajectoriesFrame): Input spatial data.</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a><span class="sd">        Returns:</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a><span class="sd">            float: The overall area in hectares.</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>        <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>    <span class="k">def</span> <span class="nf">get_mean_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a><span class="sd">        Get the mean area covered by trajectories per user.</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a><span class="sd">        Args:</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a><span class="sd">            data (TrajectoriesFrame): Input data.</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="sd">        Returns:</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="sd">            float: The mean area in hectares.</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>        <span class="k">for</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>            <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">)</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>    <span class="k">def</span> <span class="nf">get_min_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a><span class="sd">        Get the min area covered by trajectories per user.</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a><span class="sd">        Args:</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a><span class="sd">            data (TrajectoriesFrame): Input data.</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a><span class="sd">        Returns:</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a><span class="sd">            float: The min area in hectares.</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>        <span class="k">for</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>            <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">)</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>    <span class="k">def</span> <span class="nf">get_max_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a><span class="sd">        Get the max area covered by trajectories per user.</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a><span class="sd">        Args:</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a><span class="sd">            data (TrajectoriesFrame): Input data.</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a><span class="sd">        Returns:</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a><span class="sd">            float: The max area in hectares.</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>        <span class="k">for</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>            <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">)</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>    <span class="k">def</span> <span class="nf">get_std_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">        Get the std of area covered by trajectories per user.</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a><span class="sd">        Args:</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a><span class="sd">            data (TrajectoriesFrame): Input data.</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a><span class="sd">        Returns:</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="sd">            float: The std of area in hectares.</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>        <span class="k">for</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>            <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">)</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>            <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a><span class="k">class</span> <span class="nc">DataSetStats</span><span class="p">:</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a><span class="sd">    A class for managing dataset statistics, storing various statistical</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a><span class="sd">    measures, and saving them into a structured DataFrame.</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a><span class="sd">    Attributes:</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a><span class="sd">        output_dir (str): Directory to save the dataset statistics.</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a><span class="sd">        record (dict): A dictionary to store temporary statistics</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a><span class="sd">            before adding them to the dataset.</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a><span class="sd">        stats_set (pd.DataFrame): A DataFrame containing all the</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a><span class="sd">            statistics collected for different datasets.</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="sd">        Initializes the DataSetStats class.</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="sd">        Args:</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="sd">            output_dir (str): The directory where output files</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a><span class="sd">                will be stored.</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">output_dir</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">record</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_set</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>                <span class="s2">&quot;animal&quot;</span><span class="p">,</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>                <span class="s2">&quot;animal_no&quot;</span><span class="p">,</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>                <span class="s2">&quot;animal_after_filtration&quot;</span><span class="p">,</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>                <span class="s2">&quot;time_period&quot;</span><span class="p">,</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>                <span class="s2">&quot;min_label_no&quot;</span><span class="p">,</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>                <span class="s2">&quot;mean_label_no&quot;</span><span class="p">,</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>                <span class="s2">&quot;std_label_no&quot;</span><span class="p">,</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>                <span class="s2">&quot;min_records&quot;</span><span class="p">,</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>                <span class="s2">&quot;mean_records&quot;</span><span class="p">,</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>                <span class="s2">&quot;std_records&quot;</span><span class="p">,</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>                <span class="s2">&quot;avg_duration&quot;</span><span class="p">,</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>                <span class="s2">&quot;std_duration&quot;</span><span class="p">,</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>                <span class="s2">&quot;min_duration&quot;</span><span class="p">,</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>                <span class="s2">&quot;max_duration&quot;</span><span class="p">,</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>                <span class="s2">&quot;overall_set_area&quot;</span><span class="p">,</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>                <span class="s2">&quot;average_set_area&quot;</span><span class="p">,</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>                <span class="s2">&quot;min_area&quot;</span><span class="p">,</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>                <span class="s2">&quot;max_area&quot;</span><span class="p">,</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>                <span class="s2">&quot;std_area&quot;</span><span class="p">,</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>                <span class="s2">&quot;visitation_frequency&quot;</span><span class="p">,</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>                <span class="s2">&quot;visitation_frequency_params&quot;</span><span class="p">,</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>                <span class="s2">&quot;distinct_locations_over_time&quot;</span><span class="p">,</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>                <span class="s2">&quot;distinct_locations_over_time_params&quot;</span><span class="p">,</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>                <span class="s2">&quot;jump_lengths_distribution&quot;</span><span class="p">,</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>                <span class="s2">&quot;jump_lengths_distribution_params&quot;</span><span class="p">,</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>                <span class="s2">&quot;waiting_times&quot;</span><span class="p">,</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>                <span class="s2">&quot;waiting_times_params&quot;</span><span class="p">,</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>                <span class="s2">&quot;msd_curve&quot;</span><span class="p">,</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>                <span class="s2">&quot;msd_curve_params&quot;</span><span class="p">,</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>                <span class="c1"># &quot;travel_times&quot;,</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>                <span class="c1"># &quot;travel_times_params&quot;,</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>                <span class="c1"># &quot;rog&quot;,</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>                <span class="c1"># &quot;rog_params&quot;,</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>                <span class="s2">&quot;rog_over_time&quot;</span><span class="p">,</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>                <span class="s2">&quot;rog_over_time_params&quot;</span><span class="p">,</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>                <span class="s2">&quot;msd_distribution&quot;</span><span class="p">,</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>                <span class="s2">&quot;msd_distribution_params&quot;</span><span class="p">,</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>                <span class="c1"># &quot;return_time_distribution&quot;,</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>                <span class="c1"># &quot;return_time_distribution_params&quot;,</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>                <span class="c1"># &quot;exploration_time&quot;,</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>                <span class="c1"># &quot;exploration_time_params&quot;,</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>                <span class="s2">&quot;rho&quot;</span><span class="p">,</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>                <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>            <span class="p">]</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>        <span class="p">)</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>    <span class="k">def</span> <span class="nf">add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a><span class="sd">        Updates the record dictionary with new data.</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a><span class="sd">        Args:</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a><span class="sd">            data (dict): A dictionary containing key-value</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a><span class="sd">                pairs of statistics to be added.</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">record</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">data</span><span class="p">))</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>    <span class="k">def</span> <span class="nf">add_record</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a><span class="sd">        Adds the current record to the stats_set DataFrame</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a><span class="sd">        and resets the record dictionary.</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_set</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>            <span class="p">[</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stats_set</span><span class="p">,</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">record</span><span class="p">])</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>            <span class="p">],</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>            <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">record</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a><span class="k">class</span> <span class="nc">Prepocessing</span><span class="p">:</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a><span class="sd">    A class containing static methods for preprocessing animal</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a><span class="sd">    trajectory data.</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a><span class="sd">        Initializes the Prepocessing class.</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>        <span class="k">pass</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>    <span class="k">def</span> <span class="nf">get_mean_points</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a><span class="sd">        Computes the mean latitude and longitude for each label.</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a><span class="sd">        Args:</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a><span class="sd">            data (TrajectoriesFrame): The trajectory dataset.</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a><span class="sd">        Returns:</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a><span class="sd">            TrajectoriesFrame: A new dataset with averaged locations</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a><span class="sd">                per label.</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>        <span class="n">basic_df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>        <span class="n">geometry_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>        <span class="k">for</span> <span class="n">an_id</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>        <span class="p">):</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">basic_df</span><span class="p">[</span><span class="n">basic_df</span><span class="p">[</span><span class="s2">&quot;user_id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">an_id</span><span class="p">]</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>            <span class="n">lables_pack</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>            <span class="k">for</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="n">lables_pack</span><span class="p">:</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>                <span class="n">label_df</span> <span class="o">=</span> <span class="n">filtered_df</span><span class="p">[</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lbl</span><span class="p">]</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>                <span class="n">label_df</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_df</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>                <span class="n">label_df</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_df</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>                <span class="n">label_df</span> <span class="o">=</span> <span class="n">label_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>                <span class="n">geometry_df</span> <span class="o">=</span> <span class="n">geometry_df</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>                    <span class="n">label_df</span><span class="p">[[</span><span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">]],</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>                    <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>                <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>                <span class="c1"># geometry_df = pd.concat([geometry_df, label_df], ignore_index=True)</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>        <span class="k">return</span> <span class="n">TrajectoriesFrame</span><span class="p">(</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>            <span class="n">geometry_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>            <span class="p">)</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>    <span class="k">def</span> <span class="nf">set_start_stop_time</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a><span class="sd">        Sets the start and stop time for each trajectory point.</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a><span class="sd">        Args:</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a><span class="sd">            data (TrajectoriesFrame): The input trajectory dataset.</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a><span class="sd">        Returns:</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a><span class="sd">            TrajectoriesFrame: A dataset with added start and stop times.</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>        <span class="n">compressed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>            <span class="n">start_end</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>                <span class="p">[</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>                    <span class="s2">&quot;user_id&quot;</span><span class="p">,</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>                    <span class="s2">&quot;datetime&quot;</span><span class="p">,</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>                    <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>                    <span class="s2">&quot;lat&quot;</span><span class="p">,</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>                    <span class="s2">&quot;lon&quot;</span><span class="p">,</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>                    <span class="s2">&quot;date&quot;</span><span class="p">,</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>                    <span class="s2">&quot;start&quot;</span><span class="p">,</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>                    <span class="s2">&quot;end&quot;</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>                <span class="p">]</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>            <span class="p">]</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>        <span class="p">)</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>        <span class="k">return</span> <span class="n">TrajectoriesFrame</span><span class="p">(</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>            <span class="n">compressed</span><span class="p">,</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>            <span class="p">{</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>                <span class="s2">&quot;names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;animal_id&quot;</span><span class="p">],</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>                <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="n">const</span><span class="o">.</span><span class="n">ELLIPSOIDAL_CRS</span><span class="p">,</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>            <span class="p">},</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>        <span class="p">)</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>    <span class="k">def</span> <span class="nf">set_crs</span><span class="p">(</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>        <span class="n">base_csr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">ELLIPSOIDAL_CRS</span><span class="p">,</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>        <span class="n">target_crs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">CARTESIAN_CRS</span><span class="p">,</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a><span class="sd">        Converts the coordinate reference system (CRS) of the dataset.</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a><span class="sd">        Args:</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a><span class="sd">            data (TrajectoriesFrame): The input dataset.</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a><span class="sd">            base_csr (int): The current CRS of the dataset.</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a><span class="sd">            target_crs (int): The target CRS to convert to.</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a><span class="sd">        Returns:</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a><span class="sd">            TrajectoriesFrame: The dataset with the transformed CRS.</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>        <span class="n">data_frame</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">base_csr</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>        <span class="k">return</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">target_crs</span><span class="p">)</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>    <span class="k">def</span> <span class="nf">filter_by_min_number</span><span class="p">(</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span> <span class="n">min_labels_no</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">MIN_LABEL_NO</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="sd">        Filters data to include only individuals with a minimum</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="sd">        number of labels.</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a><span class="sd">        Args:</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a><span class="sd">            data (TrajectoriesFrame): The input trajectory dataset.</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="sd">            min_labels_no (int): The minimum number of labels required.</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">        Returns:</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a><span class="sd">            TrajectoriesFrame: The filtered dataset.</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>        <span class="n">data_without_nans</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>        <span class="n">distinct_locations</span> <span class="o">=</span> <span class="n">num_of_distinct_locations</span><span class="p">(</span><span class="n">data_without_nans</span><span class="p">)</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>        <span class="k">return</span> <span class="n">TrajectoriesFrame</span><span class="p">(</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>            <span class="n">data_without_nans</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>                <span class="n">distinct_locations</span><span class="p">[</span><span class="n">distinct_locations</span> <span class="o">&gt;</span> <span class="n">min_labels_no</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>            <span class="p">]</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>        <span class="p">)</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>    <span class="k">def</span> <span class="nf">filter_by_quartiles</span><span class="p">(</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span> <span class="n">quartile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">QUARTILE</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a><span class="sd">        Filters data based on quartile values of distinct locations.</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="sd">        Args:</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a><span class="sd">            data (TrajectoriesFrame): The input dataset.</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a><span class="sd">            quartile (float): The quartile value (must be 0.25, 0.5, or 0.75).</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="sd">        Returns:</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a><span class="sd">            TrajectoriesFrame: The filtered dataset.</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a><span class="sd">        Raises:</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="sd">            ValueError: If the provided quartile value is not one of</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a><span class="sd">                the allowed values.</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>        <span class="n">allowed_quartiles</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">}</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>        <span class="k">if</span> <span class="n">quartile</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_quartiles</span><span class="p">:</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>                <span class="sa">f</span><span class="s2">&quot;Invalid quartile value: </span><span class="si">{</span><span class="n">quartile</span><span class="si">}</span><span class="s2">. &quot;</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>                <span class="sa">f</span><span class="s2">&quot;Allowed values are </span><span class="si">{</span><span class="n">allowed_quartiles</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>            <span class="p">)</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>            <span class="n">data_without_nans</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>            <span class="n">distinct_locations</span> <span class="o">=</span> <span class="n">num_of_distinct_locations</span><span class="p">(</span><span class="n">data_without_nans</span><span class="p">)</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>            <span class="n">quartile_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">distinct_locations</span><span class="p">,</span> <span class="n">quartile</span><span class="p">)</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>            <span class="k">if</span> <span class="n">quartile_value</span> <span class="o">&lt;</span> <span class="n">const</span><span class="o">.</span><span class="n">MIN_QUARTILE_VALUE</span><span class="p">:</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>                <span class="n">quartile_value</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">MIN_QUARTILE_VALUE</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>            <span class="k">return</span> <span class="n">TrajectoriesFrame</span><span class="p">(</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>                <span class="n">data_without_nans</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>                    <span class="n">distinct_locations</span><span class="p">[</span><span class="n">distinct_locations</span> <span class="o">&gt;</span> <span class="n">quartile_value</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>                <span class="p">]</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>            <span class="p">)</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>    <span class="k">def</span> <span class="nf">filing_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a><span class="sd">        Processes trajectory data to fill missing values by selecting</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a><span class="sd">        the most visited location.</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a><span class="sd">        Args:</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a><span class="sd">            data (pd.DataFrame): The input trajectory dataset.</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a><span class="sd">        Returns:</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a><span class="sd">            pd.DataFrame: A processed dataset with missing values filled.</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>        <span class="k">def</span> <span class="nf">longest_visited_row</span><span class="p">(</span><span class="n">groupa</span><span class="p">):</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a><span class="sd">            Returns the row where the individual spent the longest</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a><span class="sd">            time in an interval.</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>            <span class="k">if</span> <span class="n">groupa</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>            <span class="n">max_label</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>                <span class="n">groupa</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">)[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>            <span class="p">)</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>            <span class="n">row</span> <span class="o">=</span> <span class="n">groupa</span><span class="p">[</span><span class="n">groupa</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_label</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>            <span class="k">return</span> <span class="n">row</span><span class="o">.</span><span class="n">T</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>        <span class="n">to_conca</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>        <span class="k">for</span> <span class="n">uid</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>            <span class="n">group</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>                <span class="o">~</span><span class="n">group</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>            <span class="p">]</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>                <span class="k">continue</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>            <span class="n">group</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>                <span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>            <span class="p">)</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>            <span class="n">group</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>                <span class="n">group</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">group</span><span class="o">.</span><span class="n">index</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>            <span class="n">group</span><span class="p">[</span><span class="s2">&quot;next&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">labels</span> <span class="o">!=</span> <span class="n">group</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>            <span class="n">group</span><span class="p">[</span><span class="s2">&quot;moved&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>            <span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;moved&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>            <span class="n">group</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>            <span class="n">group_resampled</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1h&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">longest_visited_row</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>            <span class="k">if</span> <span class="n">group_resampled</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>                <span class="n">group_resampled</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1h&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">longest_visited_row</span><span class="p">)</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>            <span class="n">group_resampled</span> <span class="o">=</span> <span class="n">group_resampled</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1h&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>            <span class="n">group_resampled</span> <span class="o">=</span> <span class="n">group_resampled</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span><span class="o">.</span><span class="n">bfill</span><span class="p">()</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>            <span class="n">to_conca</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_resampled</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">to_conca</span><span class="p">))</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;is_new&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">~</span><span class="n">x</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>        <span class="p">)</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;new_sum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>            <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">is_new</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>        <span class="p">)</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a><span class="k">class</span> <span class="nc">Flexation</span><span class="p">:</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a><span class="sd">    A class used for identifying and fitting statistical distributions to</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a><span class="sd">    segmented data based on flexation points.</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a><span class="sd">    Flexation points are identified using the PELT (Pruned Exact Linear Time)</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a><span class="sd">    change point detection algorithm. Once flexation points are detected,</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a><span class="sd">    the data is split into left and right segments, and statistical models</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a><span class="sd">    are fitted to each segment. The goodness of fit is evaluated using</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a><span class="sd">    the Wasserstein distance between the empirical density and the fitted</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a><span class="sd">    model.</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a><span class="sd">    Attributes:</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a><span class="sd">    -----------</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a><span class="sd">    None</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>        <span class="k">pass</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>    <span class="k">def</span> <span class="nf">_calculate_penalty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a><span class="sd">        Calculates a penalty value based on the dataset size</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a><span class="sd">        and predefined sensitivity settings.</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a><span class="sd">        The penalty is determined using logarithmic scaling and</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a><span class="sd">        depends on the sensitivity level set</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a><span class="sd">        in `const.FLEXATION_POINTS_SENSITIVITY`.</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a><span class="sd">        -----------</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a><span class="sd">        data : ndarray</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a><span class="sd">            The numerical dataset for which the penalty is calculated.</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a><span class="sd">        Returns:</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a><span class="sd">        --------</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a><span class="sd">        float</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a><span class="sd">            The computed penalty value based on the selected</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a><span class="sd">                sensitivity level.</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>        <span class="k">if</span> <span class="n">const</span><span class="o">.</span><span class="n">FLEXATION_POINTS_SENSITIVITY</span> <span class="o">==</span> <span class="s2">&quot;Low&quot;</span><span class="p">:</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>            <span class="k">return</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>        <span class="k">elif</span> <span class="n">const</span><span class="o">.</span><span class="n">FLEXATION_POINTS_SENSITIVITY</span> <span class="o">==</span> <span class="s2">&quot;Medium&quot;</span><span class="p">:</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>            <span class="k">return</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>        <span class="k">elif</span> <span class="n">const</span><span class="o">.</span><span class="n">FLEXATION_POINTS_SENSITIVITY</span> <span class="o">==</span> <span class="s2">&quot;High&quot;</span><span class="p">:</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>            <span class="k">return</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>    <span class="k">def</span> <span class="nf">_calc_main_model_wasser</span><span class="p">(</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">model_obj</span><span class="p">:</span> <span class="n">distfit</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">flexation_point</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a><span class="sd">        Calculates the Wasserstein distance between the empirical density</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a><span class="sd">        and the fitted model for data split at a given flexation point.</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a><span class="sd">        -----------</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a><span class="sd">        model_obj : distfit</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a><span class="sd">            A fitted distfit model object used for density estimation.</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a><span class="sd">        data : ndarray</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a><span class="sd">            The numerical dataset to be analyzed.</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a><span class="sd">        flexation_point : int</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a><span class="sd">            The point at which the data is split into left and right subsets.</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a><span class="sd">        Returns:</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a><span class="sd">        --------</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a><span class="sd">        float</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a><span class="sd">            The Wasserstein distance between the empirical and model densities.</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>        <span class="n">left_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="n">flexation_point</span><span class="p">]</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>        <span class="n">right_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="n">flexation_point</span><span class="p">]</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>        <span class="n">main_dfit</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">()</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>        <span class="n">left_main_bins</span><span class="p">,</span> <span class="n">left_main_empiric_density</span> <span class="o">=</span> <span class="n">main_dfit</span><span class="o">.</span><span class="n">density</span><span class="p">(</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">left_set</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">left_set</span><span class="p">)</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>        <span class="p">)</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>        <span class="n">right_main_bins</span><span class="p">,</span> <span class="n">right_main_empiric_density</span> <span class="o">=</span> <span class="n">main_dfit</span><span class="o">.</span><span class="n">density</span><span class="p">(</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">right_set</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">right_set</span><span class="p">)</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>        <span class="p">)</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>        <span class="n">left_main_model_density</span> <span class="o">=</span> <span class="n">model_obj</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">left_main_bins</span><span class="p">)</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a>        <span class="n">right_main_model_density</span> <span class="o">=</span> <span class="n">model_obj</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">right_main_bins</span><span class="p">)</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>        <span class="n">empiric_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>            <span class="p">(</span><span class="n">left_main_empiric_density</span><span class="p">,</span> <span class="n">right_main_empiric_density</span><span class="p">)</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a>        <span class="p">)</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>        <span class="n">model_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>            <span class="p">(</span><span class="n">left_main_model_density</span><span class="p">,</span> <span class="n">right_main_model_density</span><span class="p">)</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>        <span class="p">)</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>        <span class="k">return</span> <span class="n">wasserstein_distance</span><span class="p">(</span><span class="n">empiric_density</span><span class="p">,</span> <span class="n">model_density</span><span class="p">)</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>    <span class="k">def</span> <span class="nf">_fit_mixed_models</span><span class="p">(</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>            <span class="n">data</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>            <span class="n">flexation_points</span><span class="p">:</span> <span class="nb">list</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a><span class="sd">        Fits statistical distributions to data segments split at given</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a><span class="sd">        flexation points and evaluates their goodness of fit using</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a><span class="sd">        the Wasserstein distance metric.</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a><span class="sd">        -----------</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a><span class="sd">        data : ndarray</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a><span class="sd">            The numerical dataset to be analyzed.</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a><span class="sd">        flexation_points : list</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a><span class="sd">            A list of points at which the data is split into left</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a><span class="sd">                and right subsets.</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a><span class="sd">        Returns:</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a><span class="sd">        --------</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a><span class="sd">            A DataFrame containing:</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a><span class="sd">            - &#39;point&#39;: The flexation point.</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a><span class="sd">            - &#39;left_model&#39;: Best-fitted distribution name for the left subset.</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a><span class="sd">            - &#39;left_score&#39;: Fit score of the left model from distfit.</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a><span class="sd">            - &#39;left_score_calc&#39;: Calculated Wasserstein distance for</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a><span class="sd">                the left subset.</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a><span class="sd">            - &#39;right_model&#39;: Best-fitted distribution name for</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a><span class="sd">                the right subset.</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a><span class="sd">            - &#39;right_score&#39;: Fit score of the right model from distfit.</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a><span class="sd">            - &#39;right_score_calc&#39;: Calculated Wasserstein distance for</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a><span class="sd">                the right subset.</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a><span class="sd">            - &#39;overall_score&#39;: Combined Wasserstein distance score</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a><span class="sd">                for the entire dataset.</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>        <span class="n">fitting_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>                <span class="s2">&quot;point&quot;</span><span class="p">,</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>                <span class="s2">&quot;left_model&quot;</span><span class="p">,</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>                <span class="s2">&quot;left_score&quot;</span><span class="p">,</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>                <span class="s2">&quot;left_score_calc&quot;</span><span class="p">,</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>                <span class="s2">&quot;right_model&quot;</span><span class="p">,</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a>                <span class="s2">&quot;right_score&quot;</span><span class="p">,</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a>                <span class="s2">&quot;right_score_calc&quot;</span><span class="p">,</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a>                <span class="s2">&quot;overall_score&quot;</span><span class="p">,</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a>            <span class="p">]</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a>        <span class="p">)</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">flexation_points</span><span class="p">:</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a>            <span class="n">left_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="n">point</span><span class="p">]</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>            <span class="n">right_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="n">point</span><span class="p">]</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a>            <span class="k">if</span> <span class="n">left_set</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">right_set</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># FIXME:</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>                <span class="n">left_model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>                    <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>                        <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>                        <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>                        <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a>                        <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>                        <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>                        <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>                        <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>                        <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>                        <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>                        <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>                        <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>                        <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>                        <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>                        <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>                        <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>                    <span class="p">],</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>                    <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>                <span class="p">)</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>                <span class="n">right_model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>                    <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>                        <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>                        <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>                        <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>                        <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>                        <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>                        <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>                        <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>                        <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>                        <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>                        <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>                        <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>                        <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>                        <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>                        <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>                        <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>                    <span class="p">],</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>                    <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>                <span class="p">)</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>                <span class="n">left_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">left_set</span><span class="p">)</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>                <span class="n">right_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">right_set</span><span class="p">)</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>                <span class="n">left_dfit</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">()</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>                <span class="n">left_bins</span><span class="p">,</span> <span class="n">left_empiric_density</span> <span class="o">=</span> <span class="n">left_dfit</span><span class="o">.</span><span class="n">density</span><span class="p">(</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>                    <span class="n">X</span><span class="o">=</span><span class="n">left_set</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">left_set</span><span class="p">)</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>                <span class="p">)</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>                <span class="n">left_model_density</span> <span class="o">=</span> <span class="n">left_model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">left_bins</span><span class="p">)</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>                <span class="n">right_dfit</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">()</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>                <span class="n">right_bins</span><span class="p">,</span> <span class="n">right_empiric_density</span> <span class="o">=</span> <span class="n">right_dfit</span><span class="o">.</span><span class="n">density</span><span class="p">(</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>                    <span class="n">X</span><span class="o">=</span><span class="n">right_set</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">right_set</span><span class="p">)</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>                <span class="p">)</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>                <span class="n">right_model_density</span> <span class="o">=</span> <span class="n">right_model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">right_bins</span><span class="p">)</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>                <span class="n">left_score_calc</span> <span class="o">=</span> <span class="n">wasserstein_distance</span><span class="p">(</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>                    <span class="n">left_empiric_density</span><span class="p">,</span> <span class="n">left_model_density</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>                <span class="p">)</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a>                <span class="n">right_score_calc</span> <span class="o">=</span> <span class="n">wasserstein_distance</span><span class="p">(</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>                    <span class="n">right_empiric_density</span><span class="p">,</span> <span class="n">right_model_density</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a>                <span class="p">)</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>                <span class="n">empiric_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a>                    <span class="p">(</span><span class="n">left_empiric_density</span><span class="p">,</span> <span class="n">right_empiric_density</span><span class="p">)</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>                <span class="p">)</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>                <span class="n">model_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>                    <span class="p">(</span><span class="n">left_model_density</span><span class="p">,</span> <span class="n">right_model_density</span><span class="p">)</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a>                <span class="p">)</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>                <span class="n">overall_score</span> <span class="o">=</span> <span class="n">wasserstein_distance</span><span class="p">(</span><span class="n">empiric_density</span><span class="p">,</span> <span class="n">model_density</span><span class="p">)</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>                <span class="n">fitting_results</span> <span class="o">=</span> <span class="n">fitting_results</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>                    <span class="p">{</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a>                        <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="n">point</span><span class="p">,</span>  <span class="c1"># flexation point</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>                        <span class="s2">&quot;left_model&quot;</span><span class="p">:</span> <span class="n">left_model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>  <span class="c1"># left model name</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a>                        <span class="s2">&quot;left_score&quot;</span><span class="p">:</span> <span class="n">left_model</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">)[</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>                            <span class="s2">&quot;score&quot;</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>                        <span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>                            <span class="mi">0</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>                        <span class="p">],</span>  <span class="c1"># left model score from distfit</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>                        <span class="s2">&quot;left_score_calc&quot;</span><span class="p">:</span> <span class="n">left_score_calc</span><span class="p">,</span>  <span class="c1"># left model score from our calc</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>                        <span class="s2">&quot;right_model&quot;</span><span class="p">:</span> <span class="n">right_model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>  <span class="c1"># right model name</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>                        <span class="s2">&quot;right_score&quot;</span><span class="p">:</span> <span class="n">right_model</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">)[</span>  <span class="c1"># type: ignore</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>                            <span class="s2">&quot;score&quot;</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a>                        <span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a>                            <span class="mi">0</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a>                        <span class="p">],</span>  <span class="c1"># right model score from distfit</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>                        <span class="s2">&quot;right_score_calc&quot;</span><span class="p">:</span> <span class="n">right_score_calc</span><span class="p">,</span>  <span class="c1"># right model score from our calc</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>                        <span class="s2">&quot;overall_score&quot;</span><span class="p">:</span> <span class="n">overall_score</span><span class="p">,</span>  <span class="c1"># wasserstein calculated for mix-distribution approach</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>                    <span class="p">},</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>                    <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a>                <span class="p">)</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>                <span class="k">pass</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>        <span class="k">return</span> <span class="n">fitting_results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;right_score&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a>    <span class="k">def</span> <span class="nf">_find_flexation_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a><span class="sd">        Identifies flexation points in the given dataset using the</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a><span class="sd">        PELT (Pruned Exact Linear Time) change point detection algorithm.</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a><span class="sd">        The function applies the Pelt model with an &quot;rbf&quot; cost</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a><span class="sd">        function to detect significant changes in the data distribution.</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a><span class="sd">        A penalty value is used to control the sensitivity of change detection,</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a><span class="sd">        which is calculated using `_calculate_penalty`.</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a><span class="sd">        -----------</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a><span class="sd">        data : ndarray</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a><span class="sd">            The numerical dataset in which flexation points (change points)</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a><span class="sd">                are to be found.</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a><span class="sd">        Returns:</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a><span class="sd">        --------</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a><span class="sd">        list</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a><span class="sd">            A list of detected flexation points, represented as values</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a><span class="sd">                from the dataset.</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a>        <span class="n">penalty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_penalty</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">rpt</span><span class="o">.</span><span class="n">Pelt</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;rbf&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a>        <span class="n">break_points_indx</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pen</span><span class="o">=</span><span class="n">penalty</span><span class="p">)</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">break_points_indx</span><span class="p">]</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a>    <span class="k">def</span> <span class="nf">find_distributions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">distfit</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">):</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a><span class="sd">        Identifies the best-fitting distributions for segmented parts of the</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a><span class="sd">        dataset based on flexation points.</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a><span class="sd">        The function detects flexation points in the data, evaluates fitting</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a><span class="sd">        scores, and compares the segmented model&#39;s performance to the main</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a><span class="sd">        model. If a segmented approach improves the fit, it returns the left</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a><span class="sd">        and right distributions along with their respective datasets.</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a><span class="sd">        -----------</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a><span class="sd">        model : distfit</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a><span class="sd">            A pre-fitted `distfit` model used as a reference for comparison.</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a><span class="sd">        data : ndarray</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a><span class="sd">            The numerical dataset for which distributions</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a><span class="sd">                are to be identified.</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a><span class="sd">        Returns:</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a><span class="sd">        --------</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a><span class="sd">        tuple or None</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a><span class="sd">            - If segmentation improves the model fit, returns</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a><span class="sd">                a tuple containing:</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a><span class="sd">                - left_model (distfit): The best-fitting distribution</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a><span class="sd">                    for the left segment.</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a><span class="sd">                - right_model (distfit): The best-fitting distribution</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a><span class="sd">                    for the right segment.</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a><span class="sd">                - left_set (ndarray): The left segment of the data.</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a><span class="sd">                - right_set (ndarray): The right segment of the data.</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a><span class="sd">                - best_point (float): The chosen flexation point that</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a><span class="sd">                    defines segmentation.</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a><span class="sd">            - If no improvement is found, returns `None`.</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a>        <span class="n">flexation_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_flexation_points</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a>        <span class="n">fitting_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_mixed_models</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">flexation_points</span><span class="p">)</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a>        <span class="k">if</span> <span class="n">fitting_results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a>            <span class="n">fitting_score</span> <span class="o">=</span> <span class="n">fitting_results</span><span class="p">[</span><span class="s2">&quot;right_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a>            <span class="n">best_point</span> <span class="o">=</span> <span class="n">fitting_results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;point&quot;</span><span class="p">]</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a>            <span class="n">main_model_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_main_model_wasser</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">best_point</span><span class="p">)</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a>            <span class="k">if</span> <span class="n">main_model_score</span> <span class="o">-</span> <span class="n">fitting_score</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a>            <span class="k">if</span> <span class="n">main_model_score</span> <span class="o">-</span> <span class="n">fitting_score</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a>                <span class="n">left_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="n">best_point</span><span class="p">]</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a>                <span class="n">right_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="n">best_point</span><span class="p">]</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a>                <span class="n">left_model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>                    <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a>                        <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a>                        <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>                        <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>                        <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>                        <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>                        <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>                        <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a>                        <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a>                        <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>                        <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>                        <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>                        <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>                        <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>                        <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>                        <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>                    <span class="p">],</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>                    <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>                <span class="p">)</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a>                <span class="n">right_model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>                    <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a>                        <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a>                        <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a>                        <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a>                        <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a>                        <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>                        <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>                        <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a>                        <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a>                        <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a>                        <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a>                        <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a>                        <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a>                        <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a>                        <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a>                        <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a>                    <span class="p">],</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a>                    <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a>                <span class="p">)</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a>                <span class="n">left_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">left_set</span><span class="p">)</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a>                <span class="n">right_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">right_set</span><span class="p">)</span>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a>                <span class="k">return</span> <span class="n">left_model</span><span class="p">,</span> <span class="n">right_model</span><span class="p">,</span> <span class="n">left_set</span><span class="p">,</span> <span class="n">right_set</span><span class="p">,</span> <span class="n">best_point</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a><span class="k">class</span> <span class="nc">Laws</span><span class="p">:</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a><span class="sd">    A class for handling statistical data analysis and generating</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a><span class="sd">    reports in PDF format.</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a><span class="sd">    This class takes in a dataset, performs statistical analysis,</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a><span class="sd">    applies curve fitting techniques, and generates a PDF report</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a><span class="sd">    summarizing the results.</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a><span class="sd">    Parameters:</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a><span class="sd">    -----------</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a><span class="sd">    pdf_object : FPDF</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a><span class="sd">        An instance of the `FPDF` class used for generating the</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a><span class="sd">            PDF report.</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a><span class="sd">    stats_frame : DataSetStats</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a><span class="sd">        An instance of `DataSetStats` containing statistical</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a><span class="sd">            information about the dataset.</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a><span class="sd">    output_path : str</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a><span class="sd">        The file path where the generated PDF report will be saved.</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a><span class="sd">    Attributes:</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a><span class="sd">    -----------</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a><span class="sd">    pdf_object : FPDF</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a><span class="sd">        The PDF object used for report generation.</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a><span class="sd">    output_path : str</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a><span class="sd">        The location where the final report will be stored.</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a><span class="sd">    stats_frame : DataSetStats</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a><span class="sd">        The dataset statistics object containing calculated metrics.</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a><span class="sd">    curve_fitting : DistributionFitingTools</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a><span class="sd">        A toolset for fitting distributions to the dataset.</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a>            <span class="n">pdf_object</span><span class="p">:</span> <span class="n">FPDF</span><span class="p">,</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>            <span class="n">stats_frame</span><span class="p">:</span> <span class="n">DataSetStats</span><span class="p">,</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>            <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>        <span class="p">):</span>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a><span class="sd">        -----------</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a><span class="sd">        pdf_object : FPDF</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a><span class="sd">            An instance of the `FPDF` class used for generating the</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a><span class="sd">                PDF report.</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a><span class="sd">        stats_frame : DataSetStats</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a><span class="sd">            An instance of `DataSetStats` containing statistical</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a><span class="sd">                information about the dataset.</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a><span class="sd">        output_path : str</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a><span class="sd">            The file path where the generated PDF report will be saved.</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span> <span class="o">=</span> <span class="n">pdf_object</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span> <span class="o">=</span> <span class="n">output_path</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span> <span class="o">=</span> <span class="n">stats_frame</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">curve_fitting</span> <span class="o">=</span> <span class="n">DistributionFitingTools</span><span class="p">()</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a>    <span class="k">def</span> <span class="nf">_add_pdf_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">txt_to_add</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a><span class="sd">        Add a single line of text to the PDF.</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a><span class="sd">        Parameters</span>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a><span class="sd">        ----------</span>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a><span class="sd">        txt_to_add : str</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a><span class="sd">            Text to be added to the PDF document.</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">txt_to_add</span><span class="p">,</span> <span class="n">ln</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">)</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a>    <span class="k">def</span> <span class="nf">_add_pdf_plot</span><span class="p">(</span>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a>        <span class="n">plot_obj</span><span class="p">:</span> <span class="n">BytesIO</span><span class="p">,</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a>        <span class="n">image_width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a>        <span class="n">image_height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>        <span class="n">x_position</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a>        <span class="n">y_position</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a><span class="sd">        Add a plot to the PDF.</span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a><span class="sd">        Parameters</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a><span class="sd">        ----------</span>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a><span class="sd">        plot_obj : BytesIO</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a><span class="sd">            A BytesIO object containing the plot image.</span>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a><span class="sd">        image_width : int</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a><span class="sd">            Width of the plot in the PDF.</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a><span class="sd">        image_height : int</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a><span class="sd">            Height of the plot in the PDF.</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a><span class="sd">        x_position : int, optional</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a><span class="sd">            X-coordinate position of the plot, by default 10.</span>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a>        <span class="k">if</span> <span class="n">y_position</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a>            <span class="n">y_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a>            <span class="n">y_position</span> <span class="o">=</span> <span class="n">y_position</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">image</span><span class="p">(</span>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a>                <span class="n">plot_obj</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x_position</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_position</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">image_width</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">image_height</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a>            <span class="p">)</span>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_y</span><span class="p">(</span><span class="n">y_position</span> <span class="o">+</span> <span class="n">image_height</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a>            <span class="n">plot_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to add plot to PDF: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a>    <span class="k">def</span> <span class="nf">_add_pdf_curves_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a><span class="sd">        Adds a table to the PDF summarizing fitted curve parameters.</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a><span class="sd">        The table includes curve names, their weights, and parameters.</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a><span class="sd">        -----------</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a><span class="sd">        data : pd.DataFrame</span>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a><span class="sd">            A DataFrame containing the curve fitting results with columns:</span>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a><span class="sd">            - &quot;curve&quot; (str): Name of the fitted curve.</span>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a><span class="sd">            - &quot;weight&quot; (float): Weight assigned to the curve.</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a><span class="sd">            - &quot;param1&quot; (float): First parameter of the curve.</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a><span class="sd">            - &quot;param2&quot; (float): Second parameter of the curve.</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a><span class="sd">        x_offset : int, optional</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a><span class="sd">            The horizontal offset for table placement in the PDF</span>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a><span class="sd">                (default is 10).</span>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a><span class="sd">        y_offset : int, optional</span>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a><span class="sd">            The vertical offset for table placement. If None,</span>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a><span class="sd">                it uses the current Y position.</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a>        <span class="k">if</span> <span class="n">y_offset</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a>            <span class="n">y_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a>            <span class="n">y_offset</span> <span class="o">=</span> <span class="n">y_offset</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">)</span>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a>        <span class="n">col_width</span> <span class="o">=</span> <span class="mi">25</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Curve&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Weight&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Param 1&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Param 2&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">],</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a>                <span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a>            <span class="p">)</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a>                <span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a>            <span class="p">)</span>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a>                <span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a>            <span class="p">)</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a>    <span class="k">def</span> <span class="nf">_add_pdf_msd_split_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">x_offset</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a><span class="sd">        Adds a table to the PDF displaying MSD split analysis.</span>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a><span class="sd">        The table includes ranges of Radius of Gyration (RoG)</span>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a><span class="sd">        and associated curve parameters.</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a><span class="sd">        -----------</span>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos">1739</span></a><span class="sd">        data : pd.DataFrame</span>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos">1740</span></a><span class="sd">            A DataFrame containing MSD split results with columns:</span>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos">1741</span></a><span class="sd">            - &quot;RoG range [km]&quot; (str): The range of RoG values.</span>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos">1742</span></a><span class="sd">            - &quot;curve&quot; (str): Name of the fitted curve.</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos">1743</span></a><span class="sd">            - &quot;param1&quot; (float): First parameter of the curve.</span>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos">1744</span></a><span class="sd">            - &quot;param2&quot; (float): Second parameter of the curve.</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos">1745</span></a><span class="sd">        x_offset : int, optional</span>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos">1746</span></a><span class="sd">            The horizontal offset for table placement in the</span>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos">1747</span></a><span class="sd">                PDF (default is 10).</span>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos">1748</span></a><span class="sd">        y_offset : int, optional</span>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos">1749</span></a><span class="sd">            The vertical offset for table placement.</span>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos">1750</span></a><span class="sd">                If None, it uses the current Y position.</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos">1751</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos">1752</span></a>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos">1753</span></a>        <span class="k">if</span> <span class="n">y_offset</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos">1754</span></a>            <span class="n">y_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos">1755</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos">1756</span></a>            <span class="n">y_offset</span> <span class="o">=</span> <span class="n">y_offset</span>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos">1757</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">)</span>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos">1758</span></a>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos">1759</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos">1760</span></a>        <span class="n">col_width</span> <span class="o">=</span> <span class="mi">25</span>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos">1761</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos">1762</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;RoG range [km]&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos">1763</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Curve&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos">1764</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Param 1&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos">1765</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Param 2&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos">1766</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos">1767</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos">1768</span></a>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos">1769</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos">1770</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos">1771</span></a>                <span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;RoG range [km]&quot;</span><span class="p">],</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos">1772</span></a>            <span class="p">)</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos">1773</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">],</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos">1774</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos">1775</span></a>                <span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos">1776</span></a>            <span class="p">)</span>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos">1777</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos">1778</span></a>                <span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos">1779</span></a>            <span class="p">)</span>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos">1780</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos">1781</span></a>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos">1782</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos">1783</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos">1784</span></a>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos">1785</span></a>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos">1786</span></a>    <span class="k">def</span> <span class="nf">_add_pdf_distribution_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos">1787</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos">1788</span></a><span class="sd">        Adds a table to the PDF displaying distribution fitting results.</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos">1789</span></a>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos">1790</span></a><span class="sd">        The table includes distribution names, scores, and fitted parameters.</span>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos">1791</span></a>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos">1792</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos">1793</span></a><span class="sd">        -----------</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos">1794</span></a><span class="sd">        data : pd.DataFrame</span>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos">1795</span></a><span class="sd">            A DataFrame containing distribution fitting results with columns:</span>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos">1796</span></a><span class="sd">            - &quot;name&quot; (str): Name of the fitted distribution.</span>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos">1797</span></a><span class="sd">            - &quot;score&quot; (float): Score associated with the fitted distribution.</span>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos">1798</span></a><span class="sd">            - &quot;params&quot; (tuple of float): Fitted parameters for</span>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos">1799</span></a><span class="sd">                the distribution.</span>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos">1800</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos">1801</span></a>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos">1802</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos">1803</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Distribution&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos">1804</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Score&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos">1805</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Params&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos">1806</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos">1807</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos">1808</span></a>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos">1809</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos">1810</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos">1811</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos">1812</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos">1813</span></a>                    <span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;score&quot;</span><span class="p">],</span> <span class="mi">15</span><span class="p">)),</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos">1814</span></a>                <span class="p">)</span>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos">1815</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos">1816</span></a>                    <span class="mi">100</span><span class="p">,</span>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos">1817</span></a>                    <span class="mi">3</span><span class="p">,</span>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos">1818</span></a>                    <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]))</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos">1819</span></a>                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos">1820</span></a>                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos">1821</span></a>                    <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos">1822</span></a>                    <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos">1823</span></a>                <span class="p">)</span>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos">1824</span></a>                <span class="c1"># self.pdf_object.cell(40, 5, str(row[&quot;params&quot;]), border=1, align=&quot;C&quot;)</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos">1825</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos">1826</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos">1827</span></a>                <span class="k">pass</span>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos">1828</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">185</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos">1829</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos">1830</span></a>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos">1831</span></a>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos">1832</span></a>    <span class="k">def</span> <span class="nf">_plot_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func_name</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">exp_y_pred</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos">1833</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos">1834</span></a><span class="sd">        Plots a fitted curve along with the original data</span>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos">1835</span></a><span class="sd">        and saves it as a PNG file.</span>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos">1836</span></a>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos">1837</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos">1838</span></a><span class="sd">        -----------</span>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos">1839</span></a><span class="sd">        func_name : str</span>
</span><span id="L-1840"><a href="#L-1840"><span class="linenos">1840</span></a><span class="sd">            The name of the function, used for saving the file.</span>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos">1841</span></a><span class="sd">        plot_data : pd.Series or pd.DataFrame</span>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos">1842</span></a><span class="sd">            The original data points to be plotted as scatter points.</span>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos">1843</span></a><span class="sd">        y_pred : np.ndarray</span>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos">1844</span></a><span class="sd">            The predicted values for the fitted curve.</span>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos">1845</span></a><span class="sd">        labels : list of str</span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos">1846</span></a><span class="sd">            A list containing x-axis and y-axis labels.</span>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos">1847</span></a><span class="sd">        exp_y_pred : np.ndarray, optional</span>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos">1848</span></a><span class="sd">            If provided, an additional exponential curve is plotted.</span>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos">1849</span></a>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos">1850</span></a><span class="sd">        Returns:</span>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos">1851</span></a><span class="sd">        --------</span>
</span><span id="L-1852"><a href="#L-1852"><span class="linenos">1852</span></a><span class="sd">        BytesIO</span>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos">1853</span></a><span class="sd">            A buffer containing the saved image.</span>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos">1854</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos">1855</span></a>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos">1856</span></a>        <span class="n">buffer</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos">1857</span></a>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos">1858</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos">1859</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos">1860</span></a>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos">1861</span></a>        <span class="k">if</span> <span class="n">exp_y_pred</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">exp_y_pred</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos">1862</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Sigmoid&quot;</span><span class="p">)</span>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos">1863</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos">1864</span></a>                <span class="n">plot_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">exp_y_pred</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Expon neg&quot;</span>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos">1865</span></a>            <span class="p">)</span>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos">1866</span></a>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos">1867</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos">1868</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos">1869</span></a>                <span class="n">plot_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fitted curve&quot;</span>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos">1870</span></a>            <span class="p">)</span>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos">1871</span></a>
</span><span id="L-1872"><a href="#L-1872"><span class="linenos">1872</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">plot_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Data&quot;</span><span class="p">)</span>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos">1873</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos">1874</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos">1875</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos">1876</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos">1877</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos">1878</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos">1879</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos">1880</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos">1881</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos">1882</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos">1883</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos">1884</span></a>            <span class="p">)</span>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos">1885</span></a>        <span class="p">)</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos">1886</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos">1887</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos">1888</span></a>        <span class="n">buffer</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos">1889</span></a>
</span><span id="L-1890"><a href="#L-1890"><span class="linenos">1890</span></a>        <span class="k">return</span> <span class="n">buffer</span>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos">1891</span></a>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos">1892</span></a>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos">1893</span></a>    <span class="k">def</span> <span class="nf">_plot_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">measure_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Values&quot;</span><span class="p">):</span>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos">1894</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos">1895</span></a><span class="sd">        Plots a histogram of values and a fitted probability distribution model.</span>
</span><span id="L-1896"><a href="#L-1896"><span class="linenos">1896</span></a>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos">1897</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos">1898</span></a><span class="sd">        -----------</span>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos">1899</span></a><span class="sd">        model : distfit</span>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos">1900</span></a><span class="sd">            A fitted distribution model.</span>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos">1901</span></a><span class="sd">        values : np.ndarray</span>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos">1902</span></a><span class="sd">            The dataset values to be plotted.</span>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos">1903</span></a><span class="sd">        measure_type : str, optional</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos">1904</span></a><span class="sd">            The type of measure for labeling the x-axis (default is &quot;Values&quot;).</span>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos">1905</span></a>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos">1906</span></a><span class="sd">        Returns:</span>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos">1907</span></a><span class="sd">        --------</span>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos">1908</span></a><span class="sd">        tuple (BytesIO, BytesIO)</span>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos">1909</span></a><span class="sd">            Buffers containing the saved histogram and fitted model plots.</span>
</span><span id="L-1910"><a href="#L-1910"><span class="linenos">1910</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1911"><a href="#L-1911"><span class="linenos">1911</span></a>
</span><span id="L-1912"><a href="#L-1912"><span class="linenos">1912</span></a>        <span class="n">buffer_plot_distribution</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="L-1913"><a href="#L-1913"><span class="linenos">1913</span></a>        <span class="n">buffer_plot_model</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos">1914</span></a>
</span><span id="L-1915"><a href="#L-1915"><span class="linenos">1915</span></a>        <span class="n">measure_type</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos">1916</span></a>            <span class="n">measure_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;distribution&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos">1917</span></a>        <span class="p">)</span>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos">1918</span></a>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos">1919</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos">1920</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos">1921</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos">1922</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">measure_type</span><span class="p">)</span>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos">1923</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Values&quot;</span><span class="p">)</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos">1924</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos">1925</span></a>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos">1926</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="L-1927"><a href="#L-1927"><span class="linenos">1927</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-1928"><a href="#L-1928"><span class="linenos">1928</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="L-1929"><a href="#L-1929"><span class="linenos">1929</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">measure_type</span><span class="si">}</span><span class="s2">_distribution.png&quot;</span><span class="p">,</span>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos">1930</span></a>            <span class="p">)</span>
</span><span id="L-1931"><a href="#L-1931"><span class="linenos">1931</span></a>        <span class="p">)</span>
</span><span id="L-1932"><a href="#L-1932"><span class="linenos">1932</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer_plot_distribution</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos">1933</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos">1934</span></a>        <span class="n">buffer_plot_distribution</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos">1935</span></a>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos">1936</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos">1937</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos">1938</span></a>            <span class="n">pdf_properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;linestyle&quot;</span><span class="p">:</span> <span class="s2">&quot;--&quot;</span><span class="p">},</span>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos">1939</span></a>            <span class="n">bar_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos">1940</span></a>            <span class="n">cii_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos">1941</span></a>            <span class="n">emp_properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="s2">&quot;o&quot;</span><span class="p">},</span>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos">1942</span></a>            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos">1943</span></a>        <span class="p">)</span>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos">1944</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">measure_type</span><span class="p">)</span>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos">1945</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos">1946</span></a>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos">1947</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="L-1948"><a href="#L-1948"><span class="linenos">1948</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos">1949</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos">1950</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">measure_type</span><span class="si">}</span><span class="s2">_model_distribution.png&quot;</span><span class="p">,</span>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos">1951</span></a>            <span class="p">)</span>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos">1952</span></a>        <span class="p">)</span>
</span><span id="L-1953"><a href="#L-1953"><span class="linenos">1953</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer_plot_model</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos">1954</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos">1955</span></a>        <span class="n">buffer_plot_model</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos">1956</span></a>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos">1957</span></a>        <span class="k">return</span> <span class="n">buffer_plot_distribution</span><span class="p">,</span> <span class="n">buffer_plot_model</span>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos">1958</span></a>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos">1959</span></a>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos">1960</span></a>    <span class="k">def</span> <span class="nf">_plot_double_distribution</span><span class="p">(</span>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos">1961</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos">1962</span></a>        <span class="n">left_model</span><span class="p">,</span>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos">1963</span></a>        <span class="n">right_model</span><span class="p">,</span>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos">1964</span></a>        <span class="n">left_values</span><span class="p">,</span>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos">1965</span></a>        <span class="n">right_values</span><span class="p">,</span>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos">1966</span></a>        <span class="n">flexation_point</span><span class="p">,</span>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos">1967</span></a>        <span class="n">measure_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Values&quot;</span><span class="p">,</span>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos">1968</span></a>    <span class="p">):</span>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos">1969</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1970"><a href="#L-1970"><span class="linenos">1970</span></a><span class="sd">        Plots and saves histograms for two subsets of data</span>
</span><span id="L-1971"><a href="#L-1971"><span class="linenos">1971</span></a><span class="sd">        and their fitted distribution models.</span>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos">1972</span></a>
</span><span id="L-1973"><a href="#L-1973"><span class="linenos">1973</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos">1974</span></a><span class="sd">        -----------</span>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos">1975</span></a><span class="sd">        left_model : distfit</span>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos">1976</span></a><span class="sd">            A fitted distribution model for the left subset.</span>
</span><span id="L-1977"><a href="#L-1977"><span class="linenos">1977</span></a><span class="sd">        right_model : distfit</span>
</span><span id="L-1978"><a href="#L-1978"><span class="linenos">1978</span></a><span class="sd">            A fitted distribution model for the right subset.</span>
</span><span id="L-1979"><a href="#L-1979"><span class="linenos">1979</span></a><span class="sd">        left_values : np.ndarray</span>
</span><span id="L-1980"><a href="#L-1980"><span class="linenos">1980</span></a><span class="sd">            The left subset of data values.</span>
</span><span id="L-1981"><a href="#L-1981"><span class="linenos">1981</span></a><span class="sd">        right_values : np.ndarray</span>
</span><span id="L-1982"><a href="#L-1982"><span class="linenos">1982</span></a><span class="sd">            The right subset of data values.</span>
</span><span id="L-1983"><a href="#L-1983"><span class="linenos">1983</span></a><span class="sd">        flexation_point : float</span>
</span><span id="L-1984"><a href="#L-1984"><span class="linenos">1984</span></a><span class="sd">            The point at which the data was split.</span>
</span><span id="L-1985"><a href="#L-1985"><span class="linenos">1985</span></a><span class="sd">        measure_type : str, optional</span>
</span><span id="L-1986"><a href="#L-1986"><span class="linenos">1986</span></a><span class="sd">            The type of measure for labeling the x-axis</span>
</span><span id="L-1987"><a href="#L-1987"><span class="linenos">1987</span></a><span class="sd">                (default is &quot;Values&quot;).</span>
</span><span id="L-1988"><a href="#L-1988"><span class="linenos">1988</span></a>
</span><span id="L-1989"><a href="#L-1989"><span class="linenos">1989</span></a><span class="sd">        Returns:</span>
</span><span id="L-1990"><a href="#L-1990"><span class="linenos">1990</span></a><span class="sd">        --------</span>
</span><span id="L-1991"><a href="#L-1991"><span class="linenos">1991</span></a><span class="sd">        tuple (BytesIO, BytesIO)</span>
</span><span id="L-1992"><a href="#L-1992"><span class="linenos">1992</span></a><span class="sd">            Buffers containing the saved histograms and model plots.</span>
</span><span id="L-1993"><a href="#L-1993"><span class="linenos">1993</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1994"><a href="#L-1994"><span class="linenos">1994</span></a>
</span><span id="L-1995"><a href="#L-1995"><span class="linenos">1995</span></a>        <span class="n">measure_type</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1996"><a href="#L-1996"><span class="linenos">1996</span></a>            <span class="n">measure_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;distribution&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="L-1997"><a href="#L-1997"><span class="linenos">1997</span></a>        <span class="p">)</span>
</span><span id="L-1998"><a href="#L-1998"><span class="linenos">1998</span></a>
</span><span id="L-1999"><a href="#L-1999"><span class="linenos">1999</span></a>        <span class="n">buffer_plot_distribution</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="L-2000"><a href="#L-2000"><span class="linenos">2000</span></a>        <span class="n">buffer_plot_model</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="L-2001"><a href="#L-2001"><span class="linenos">2001</span></a>
</span><span id="L-2002"><a href="#L-2002"><span class="linenos">2002</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</span><span id="L-2003"><a href="#L-2003"><span class="linenos">2003</span></a>
</span><span id="L-2004"><a href="#L-2004"><span class="linenos">2004</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-2005"><a href="#L-2005"><span class="linenos">2005</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
</span><span id="L-2006"><a href="#L-2006"><span class="linenos">2006</span></a>            <span class="n">left_values</span><span class="p">,</span>
</span><span id="L-2007"><a href="#L-2007"><span class="linenos">2007</span></a>            <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
</span><span id="L-2008"><a href="#L-2008"><span class="linenos">2008</span></a>            <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-2009"><a href="#L-2009"><span class="linenos">2009</span></a>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Left Set&quot;</span><span class="p">,</span>
</span><span id="L-2010"><a href="#L-2010"><span class="linenos">2010</span></a>            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span>
</span><span id="L-2011"><a href="#L-2011"><span class="linenos">2011</span></a>        <span class="p">)</span>
</span><span id="L-2012"><a href="#L-2012"><span class="linenos">2012</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
</span><span id="L-2013"><a href="#L-2013"><span class="linenos">2013</span></a>            <span class="n">right_values</span><span class="p">,</span>
</span><span id="L-2014"><a href="#L-2014"><span class="linenos">2014</span></a>            <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
</span><span id="L-2015"><a href="#L-2015"><span class="linenos">2015</span></a>            <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-2016"><a href="#L-2016"><span class="linenos">2016</span></a>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Right Set&quot;</span><span class="p">,</span>
</span><span id="L-2017"><a href="#L-2017"><span class="linenos">2017</span></a>            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span>
</span><span id="L-2018"><a href="#L-2018"><span class="linenos">2018</span></a>        <span class="p">)</span>
</span><span id="L-2019"><a href="#L-2019"><span class="linenos">2019</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</span><span id="L-2020"><a href="#L-2020"><span class="linenos">2020</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">measure_type</span><span class="p">)</span>
</span><span id="L-2021"><a href="#L-2021"><span class="linenos">2021</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Values&quot;</span><span class="p">)</span>
</span><span id="L-2022"><a href="#L-2022"><span class="linenos">2022</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="L-2023"><a href="#L-2023"><span class="linenos">2023</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-2024"><a href="#L-2024"><span class="linenos">2024</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="L-2025"><a href="#L-2025"><span class="linenos">2025</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">measure_type</span><span class="si">}</span><span class="s2">_distribution_with_flexation_point_</span><span class="si">{</span><span class="n">flexation_point</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span>
</span><span id="L-2026"><a href="#L-2026"><span class="linenos">2026</span></a>            <span class="p">)</span>
</span><span id="L-2027"><a href="#L-2027"><span class="linenos">2027</span></a>        <span class="p">)</span>
</span><span id="L-2028"><a href="#L-2028"><span class="linenos">2028</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer_plot_distribution</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="L-2029"><a href="#L-2029"><span class="linenos">2029</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-2030"><a href="#L-2030"><span class="linenos">2030</span></a>        <span class="n">buffer_plot_distribution</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-2031"><a href="#L-2031"><span class="linenos">2031</span></a>
</span><span id="L-2032"><a href="#L-2032"><span class="linenos">2032</span></a>        <span class="n">left_model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="L-2033"><a href="#L-2033"><span class="linenos">2033</span></a>            <span class="n">pdf_properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;linestyle&quot;</span><span class="p">:</span> <span class="s2">&quot;--&quot;</span><span class="p">},</span>
</span><span id="L-2034"><a href="#L-2034"><span class="linenos">2034</span></a>            <span class="n">bar_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-2035"><a href="#L-2035"><span class="linenos">2035</span></a>            <span class="n">cii_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-2036"><a href="#L-2036"><span class="linenos">2036</span></a>            <span class="n">emp_properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="s2">&quot;o&quot;</span><span class="p">},</span>
</span><span id="L-2037"><a href="#L-2037"><span class="linenos">2037</span></a>            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
</span><span id="L-2038"><a href="#L-2038"><span class="linenos">2038</span></a>        <span class="p">)</span>
</span><span id="L-2039"><a href="#L-2039"><span class="linenos">2039</span></a>
</span><span id="L-2040"><a href="#L-2040"><span class="linenos">2040</span></a>        <span class="n">right_model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="L-2041"><a href="#L-2041"><span class="linenos">2041</span></a>            <span class="n">pdf_properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;linestyle&quot;</span><span class="p">:</span> <span class="s2">&quot;--&quot;</span><span class="p">},</span>
</span><span id="L-2042"><a href="#L-2042"><span class="linenos">2042</span></a>            <span class="n">bar_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-2043"><a href="#L-2043"><span class="linenos">2043</span></a>            <span class="n">cii_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-2044"><a href="#L-2044"><span class="linenos">2044</span></a>            <span class="n">emp_properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="s2">&quot;o&quot;</span><span class="p">},</span>
</span><span id="L-2045"><a href="#L-2045"><span class="linenos">2045</span></a>            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
</span><span id="L-2046"><a href="#L-2046"><span class="linenos">2046</span></a>        <span class="p">)</span>
</span><span id="L-2047"><a href="#L-2047"><span class="linenos">2047</span></a>
</span><span id="L-2048"><a href="#L-2048"><span class="linenos">2048</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-2049"><a href="#L-2049"><span class="linenos">2049</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="L-2050"><a href="#L-2050"><span class="linenos">2050</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</span><span id="L-2051"><a href="#L-2051"><span class="linenos">2051</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="L-2052"><a href="#L-2052"><span class="linenos">2052</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-2053"><a href="#L-2053"><span class="linenos">2053</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="L-2054"><a href="#L-2054"><span class="linenos">2054</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">measure_type</span><span class="si">}</span><span class="s2">_model_distribution_with_flexation_point_</span><span class="si">{</span><span class="n">flexation_point</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span>
</span><span id="L-2055"><a href="#L-2055"><span class="linenos">2055</span></a>            <span class="p">)</span>
</span><span id="L-2056"><a href="#L-2056"><span class="linenos">2056</span></a>        <span class="p">)</span>
</span><span id="L-2057"><a href="#L-2057"><span class="linenos">2057</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer_plot_model</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="L-2058"><a href="#L-2058"><span class="linenos">2058</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-2059"><a href="#L-2059"><span class="linenos">2059</span></a>        <span class="n">buffer_plot_model</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-2060"><a href="#L-2060"><span class="linenos">2060</span></a>
</span><span id="L-2061"><a href="#L-2061"><span class="linenos">2061</span></a>        <span class="k">return</span> <span class="n">buffer_plot_distribution</span><span class="p">,</span> <span class="n">buffer_plot_model</span>
</span><span id="L-2062"><a href="#L-2062"><span class="linenos">2062</span></a>
</span><span id="L-2063"><a href="#L-2063"><span class="linenos">2063</span></a>
</span><span id="L-2064"><a href="#L-2064"><span class="linenos">2064</span></a>    <span class="k">def</span> <span class="nf">_plot_P_new</span><span class="p">(</span>
</span><span id="L-2065"><a href="#L-2065"><span class="linenos">2065</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">rho_est</span><span class="p">,</span> <span class="n">gamma_est</span><span class="p">,</span> <span class="n">DeltaS</span><span class="p">,</span> <span class="n">S_mid</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span>
</span><span id="L-2066"><a href="#L-2066"><span class="linenos">2066</span></a>    <span class="p">):</span>
</span><span id="L-2067"><a href="#L-2067"><span class="linenos">2067</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2068"><a href="#L-2068"><span class="linenos">2068</span></a><span class="sd">        Plots and saves two figures:</span>
</span><span id="L-2069"><a href="#L-2069"><span class="linenos">2069</span></a><span class="sd">        1. A comparison between estimated and reference probability functions.</span>
</span><span id="L-2070"><a href="#L-2070"><span class="linenos">2070</span></a><span class="sd">        2. A log-log plot of S vs. S with a fitted regression line.</span>
</span><span id="L-2071"><a href="#L-2071"><span class="linenos">2071</span></a>
</span><span id="L-2072"><a href="#L-2072"><span class="linenos">2072</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2073"><a href="#L-2073"><span class="linenos">2073</span></a><span class="sd">        -----------</span>
</span><span id="L-2074"><a href="#L-2074"><span class="linenos">2074</span></a><span class="sd">        rho_est : float</span>
</span><span id="L-2075"><a href="#L-2075"><span class="linenos">2075</span></a><span class="sd">            Estimated scaling factor for P_new.</span>
</span><span id="L-2076"><a href="#L-2076"><span class="linenos">2076</span></a><span class="sd">        gamma_est : float</span>
</span><span id="L-2077"><a href="#L-2077"><span class="linenos">2077</span></a><span class="sd">            Estimated exponent for P_new.</span>
</span><span id="L-2078"><a href="#L-2078"><span class="linenos">2078</span></a><span class="sd">        DeltaS : np.ndarray</span>
</span><span id="L-2079"><a href="#L-2079"><span class="linenos">2079</span></a><span class="sd">            Change in S values for log-log regression.</span>
</span><span id="L-2080"><a href="#L-2080"><span class="linenos">2080</span></a><span class="sd">        S_mid : np.ndarray</span>
</span><span id="L-2081"><a href="#L-2081"><span class="linenos">2081</span></a><span class="sd">            Midpoints of S values for log-log regression.</span>
</span><span id="L-2082"><a href="#L-2082"><span class="linenos">2082</span></a><span class="sd">        intercept : float</span>
</span><span id="L-2083"><a href="#L-2083"><span class="linenos">2083</span></a><span class="sd">            Intercept of the fitted regression line in log-log plot.</span>
</span><span id="L-2084"><a href="#L-2084"><span class="linenos">2084</span></a><span class="sd">        slope : float</span>
</span><span id="L-2085"><a href="#L-2085"><span class="linenos">2085</span></a><span class="sd">            Slope of the fitted regression line in log-log plot.</span>
</span><span id="L-2086"><a href="#L-2086"><span class="linenos">2086</span></a><span class="sd">        nrows : int</span>
</span><span id="L-2087"><a href="#L-2087"><span class="linenos">2087</span></a><span class="sd">            Number of time steps for P_new estimation.</span>
</span><span id="L-2088"><a href="#L-2088"><span class="linenos">2088</span></a><span class="sd">        n_data : int</span>
</span><span id="L-2089"><a href="#L-2089"><span class="linenos">2089</span></a><span class="sd">            Number of data points in the dataset.</span>
</span><span id="L-2090"><a href="#L-2090"><span class="linenos">2090</span></a>
</span><span id="L-2091"><a href="#L-2091"><span class="linenos">2091</span></a><span class="sd">        Returns:</span>
</span><span id="L-2092"><a href="#L-2092"><span class="linenos">2092</span></a><span class="sd">        --------</span>
</span><span id="L-2093"><a href="#L-2093"><span class="linenos">2093</span></a><span class="sd">        tuple (BytesIO, BytesIO)</span>
</span><span id="L-2094"><a href="#L-2094"><span class="linenos">2094</span></a><span class="sd">            Buffers containing the saved plots.</span>
</span><span id="L-2095"><a href="#L-2095"><span class="linenos">2095</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2096"><a href="#L-2096"><span class="linenos">2096</span></a>
</span><span id="L-2097"><a href="#L-2097"><span class="linenos">2097</span></a>        <span class="n">buffer1</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="L-2098"><a href="#L-2098"><span class="linenos">2098</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</span><span id="L-2099"><a href="#L-2099"><span class="linenos">2099</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
</span><span id="L-2100"><a href="#L-2100"><span class="linenos">2100</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="L-2101"><a href="#L-2101"><span class="linenos">2101</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
</span><span id="L-2102"><a href="#L-2102"><span class="linenos">2102</span></a>            <span class="p">[</span><span class="n">rho_est</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">gamma_est</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)],</span>
</span><span id="L-2103"><a href="#L-2103"><span class="linenos">2103</span></a>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Estimated&quot;</span><span class="p">,</span>
</span><span id="L-2104"><a href="#L-2104"><span class="linenos">2104</span></a>            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span>
</span><span id="L-2105"><a href="#L-2105"><span class="linenos">2105</span></a>        <span class="p">)</span>
</span><span id="L-2106"><a href="#L-2106"><span class="linenos">2106</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="L-2107"><a href="#L-2107"><span class="linenos">2107</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
</span><span id="L-2108"><a href="#L-2108"><span class="linenos">2108</span></a>            <span class="p">[</span><span class="mf">0.6</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.21</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)],</span>
</span><span id="L-2109"><a href="#L-2109"><span class="linenos">2109</span></a>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Paper&quot;</span><span class="p">,</span>
</span><span id="L-2110"><a href="#L-2110"><span class="linenos">2110</span></a>            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
</span><span id="L-2111"><a href="#L-2111"><span class="linenos">2111</span></a>        <span class="p">)</span>
</span><span id="L-2112"><a href="#L-2112"><span class="linenos">2112</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-2113"><a href="#L-2113"><span class="linenos">2113</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time steps (n)&quot;</span><span class="p">)</span>
</span><span id="L-2114"><a href="#L-2114"><span class="linenos">2114</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;P_new (estimated vs. reference)&quot;</span><span class="p">)</span>
</span><span id="L-2115"><a href="#L-2115"><span class="linenos">2115</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparison of Estimated vs. Paper Model&quot;</span><span class="p">)</span>
</span><span id="L-2116"><a href="#L-2116"><span class="linenos">2116</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="L-2117"><a href="#L-2117"><span class="linenos">2117</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-2118"><a href="#L-2118"><span class="linenos">2118</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="L-2119"><a href="#L-2119"><span class="linenos">2119</span></a>                <span class="s2">&quot;P new comparison of Estimated vs. Paper Model.png&quot;</span><span class="p">,</span>
</span><span id="L-2120"><a href="#L-2120"><span class="linenos">2120</span></a>            <span class="p">)</span>
</span><span id="L-2121"><a href="#L-2121"><span class="linenos">2121</span></a>        <span class="p">)</span>
</span><span id="L-2122"><a href="#L-2122"><span class="linenos">2122</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer1</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="L-2123"><a href="#L-2123"><span class="linenos">2123</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-2124"><a href="#L-2124"><span class="linenos">2124</span></a>        <span class="n">buffer1</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-2125"><a href="#L-2125"><span class="linenos">2125</span></a>
</span><span id="L-2126"><a href="#L-2126"><span class="linenos">2126</span></a>        <span class="n">buffer2</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="L-2127"><a href="#L-2127"><span class="linenos">2127</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</span><span id="L-2128"><a href="#L-2128"><span class="linenos">2128</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
</span><span id="L-2129"><a href="#L-2129"><span class="linenos">2129</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="L-2130"><a href="#L-2130"><span class="linenos">2130</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">S_mid</span><span class="p">),</span>
</span><span id="L-2131"><a href="#L-2131"><span class="linenos">2131</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">DeltaS</span><span class="p">),</span>
</span><span id="L-2132"><a href="#L-2132"><span class="linenos">2132</span></a>            <span class="s2">&quot;o&quot;</span><span class="p">,</span>
</span><span id="L-2133"><a href="#L-2133"><span class="linenos">2133</span></a>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Data (log-log)&quot;</span><span class="p">,</span>
</span><span id="L-2134"><a href="#L-2134"><span class="linenos">2134</span></a>            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span>
</span><span id="L-2135"><a href="#L-2135"><span class="linenos">2135</span></a>        <span class="p">)</span>
</span><span id="L-2136"><a href="#L-2136"><span class="linenos">2136</span></a>        <span class="n">X_line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">S_mid</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">S_mid</span><span class="p">)),</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="L-2137"><a href="#L-2137"><span class="linenos">2137</span></a>        <span class="n">y_line</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">X_line</span>
</span><span id="L-2138"><a href="#L-2138"><span class="linenos">2138</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_line</span><span class="p">,</span> <span class="n">y_line</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="L-2139"><a href="#L-2139"><span class="linenos">2139</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;ln(S)&quot;</span><span class="p">)</span>
</span><span id="L-2140"><a href="#L-2140"><span class="linenos">2140</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;ln(S)&quot;</span><span class="p">)</span>
</span><span id="L-2141"><a href="#L-2141"><span class="linenos">2141</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;log(S) vs. log(S)&quot;</span><span class="p">)</span>
</span><span id="L-2142"><a href="#L-2142"><span class="linenos">2142</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-2143"><a href="#L-2143"><span class="linenos">2143</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="L-2144"><a href="#L-2144"><span class="linenos">2144</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-2145"><a href="#L-2145"><span class="linenos">2145</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="L-2146"><a href="#L-2146"><span class="linenos">2146</span></a>                <span class="s2">&quot;P_loglog.png&quot;</span><span class="p">,</span>
</span><span id="L-2147"><a href="#L-2147"><span class="linenos">2147</span></a>            <span class="p">)</span>
</span><span id="L-2148"><a href="#L-2148"><span class="linenos">2148</span></a>        <span class="p">)</span>
</span><span id="L-2149"><a href="#L-2149"><span class="linenos">2149</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer2</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="L-2150"><a href="#L-2150"><span class="linenos">2150</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-2151"><a href="#L-2151"><span class="linenos">2151</span></a>        <span class="n">buffer2</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-2152"><a href="#L-2152"><span class="linenos">2152</span></a>
</span><span id="L-2153"><a href="#L-2153"><span class="linenos">2153</span></a>        <span class="k">return</span> <span class="n">buffer1</span><span class="p">,</span> <span class="n">buffer2</span>
</span><span id="L-2154"><a href="#L-2154"><span class="linenos">2154</span></a>
</span><span id="L-2155"><a href="#L-2155"><span class="linenos">2155</span></a>
</span><span id="L-2156"><a href="#L-2156"><span class="linenos">2156</span></a>    <span class="k">def</span> <span class="nf">log_curve_fitting_resluts</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="L-2157"><a href="#L-2157"><span class="linenos">2157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2158"><a href="#L-2158"><span class="linenos">2158</span></a><span class="sd">        A decorator that logs and saves curve fitting results</span>
</span><span id="L-2159"><a href="#L-2159"><span class="linenos">2159</span></a><span class="sd">        to a PDF report.</span>
</span><span id="L-2160"><a href="#L-2160"><span class="linenos">2160</span></a>
</span><span id="L-2161"><a href="#L-2161"><span class="linenos">2161</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="L-2162"><a href="#L-2162"><span class="linenos">2162</span></a><span class="sd">        - func_name (str): Name of the function.</span>
</span><span id="L-2163"><a href="#L-2163"><span class="linenos">2163</span></a><span class="sd">        - best_fit (str): Name of the best-fitting curve.</span>
</span><span id="L-2164"><a href="#L-2164"><span class="linenos">2164</span></a><span class="sd">        - param_frame (pd.DataFrame): DataFrame containing</span>
</span><span id="L-2165"><a href="#L-2165"><span class="linenos">2165</span></a><span class="sd">            curve parameters.</span>
</span><span id="L-2166"><a href="#L-2166"><span class="linenos">2166</span></a><span class="sd">        - plot_obj (BytesIO): The plot image object.</span>
</span><span id="L-2167"><a href="#L-2167"><span class="linenos">2167</span></a>
</span><span id="L-2168"><a href="#L-2168"><span class="linenos">2168</span></a><span class="sd">        The results are logged in `self.stats_frame`</span>
</span><span id="L-2169"><a href="#L-2169"><span class="linenos">2169</span></a><span class="sd">            and added to a PDF report.</span>
</span><span id="L-2170"><a href="#L-2170"><span class="linenos">2170</span></a>
</span><span id="L-2171"><a href="#L-2171"><span class="linenos">2171</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2172"><a href="#L-2172"><span class="linenos">2172</span></a><span class="sd">        -----------</span>
</span><span id="L-2173"><a href="#L-2173"><span class="linenos">2173</span></a><span class="sd">        func : function</span>
</span><span id="L-2174"><a href="#L-2174"><span class="linenos">2174</span></a><span class="sd">            The function performing curve fitting.</span>
</span><span id="L-2175"><a href="#L-2175"><span class="linenos">2175</span></a>
</span><span id="L-2176"><a href="#L-2176"><span class="linenos">2176</span></a><span class="sd">        Returns:</span>
</span><span id="L-2177"><a href="#L-2177"><span class="linenos">2177</span></a><span class="sd">        --------</span>
</span><span id="L-2178"><a href="#L-2178"><span class="linenos">2178</span></a><span class="sd">        function</span>
</span><span id="L-2179"><a href="#L-2179"><span class="linenos">2179</span></a><span class="sd">            Wrapped function with additional logging and PDF output.</span>
</span><span id="L-2180"><a href="#L-2180"><span class="linenos">2180</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2181"><a href="#L-2181"><span class="linenos">2181</span></a>
</span><span id="L-2182"><a href="#L-2182"><span class="linenos">2182</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-2183"><a href="#L-2183"><span class="linenos">2183</span></a>            <span class="n">func_name</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-2184"><a href="#L-2184"><span class="linenos">2184</span></a>            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">param_frame</span><span class="p">[</span><span class="n">param_frame</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_fit</span><span class="p">]</span>
</span><span id="L-2185"><a href="#L-2185"><span class="linenos">2185</span></a>
</span><span id="L-2186"><a href="#L-2186"><span class="linenos">2186</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">func_name</span><span class="p">:</span> <span class="n">best_fit</span><span class="p">})</span>
</span><span id="L-2187"><a href="#L-2187"><span class="linenos">2187</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-2188"><a href="#L-2188"><span class="linenos">2188</span></a>                <span class="p">{</span>
</span><span id="L-2189"><a href="#L-2189"><span class="linenos">2189</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">filtered_df</span><span class="p">[</span>
</span><span id="L-2190"><a href="#L-2190"><span class="linenos">2190</span></a>                        <span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">,</span> <span class="s2">&quot;param2&quot;</span><span class="p">]</span>
</span><span id="L-2191"><a href="#L-2191"><span class="linenos">2191</span></a>                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-2192"><a href="#L-2192"><span class="linenos">2192</span></a>                <span class="p">}</span>
</span><span id="L-2193"><a href="#L-2193"><span class="linenos">2193</span></a>            <span class="p">)</span>
</span><span id="L-2194"><a href="#L-2194"><span class="linenos">2194</span></a>
</span><span id="L-2195"><a href="#L-2195"><span class="linenos">2195</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">func_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="L-2196"><a href="#L-2196"><span class="linenos">2196</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="L-2197"><a href="#L-2197"><span class="linenos">2197</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="L-2198"><a href="#L-2198"><span class="linenos">2198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2199"><a href="#L-2199"><span class="linenos">2199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="L-2200"><a href="#L-2200"><span class="linenos">2200</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="L-2201"><a href="#L-2201"><span class="linenos">2201</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">best_fit</span><span class="si">}</span><span class="s1"> with Param 1: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">,&#39;</span>
</span><span id="L-2202"><a href="#L-2202"><span class="linenos">2202</span></a>                <span class="sa">f</span><span class="s1">&#39;Param 2: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-2203"><a href="#L-2203"><span class="linenos">2203</span></a>            <span class="p">)</span>
</span><span id="L-2204"><a href="#L-2204"><span class="linenos">2204</span></a>
</span><span id="L-2205"><a href="#L-2205"><span class="linenos">2205</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="L-2206"><a href="#L-2206"><span class="linenos">2206</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_curves_table</span><span class="p">(</span>
</span><span id="L-2207"><a href="#L-2207"><span class="linenos">2207</span></a>                <span class="n">param_frame</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="n">y_position_global</span> <span class="o">+</span> <span class="mi">13</span>
</span><span id="L-2208"><a href="#L-2208"><span class="linenos">2208</span></a>            <span class="p">)</span>
</span><span id="L-2209"><a href="#L-2209"><span class="linenos">2209</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="L-2210"><a href="#L-2210"><span class="linenos">2210</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj</span><span class="p">,</span>
</span><span id="L-2211"><a href="#L-2211"><span class="linenos">2211</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="L-2212"><a href="#L-2212"><span class="linenos">2212</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="L-2213"><a href="#L-2213"><span class="linenos">2213</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span>
</span><span id="L-2214"><a href="#L-2214"><span class="linenos">2214</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="L-2215"><a href="#L-2215"><span class="linenos">2215</span></a>            <span class="p">)</span>
</span><span id="L-2216"><a href="#L-2216"><span class="linenos">2216</span></a>
</span><span id="L-2217"><a href="#L-2217"><span class="linenos">2217</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="L-2218"><a href="#L-2218"><span class="linenos">2218</span></a>
</span><span id="L-2219"><a href="#L-2219"><span class="linenos">2219</span></a>
</span><span id="L-2220"><a href="#L-2220"><span class="linenos">2220</span></a>    <span class="k">def</span> <span class="nf">log_distribution_fitting_resluts</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="L-2221"><a href="#L-2221"><span class="linenos">2221</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2222"><a href="#L-2222"><span class="linenos">2222</span></a><span class="sd">        A decorator that logs and saves distribution fitting</span>
</span><span id="L-2223"><a href="#L-2223"><span class="linenos">2223</span></a><span class="sd">        results to a PDF report.</span>
</span><span id="L-2224"><a href="#L-2224"><span class="linenos">2224</span></a>
</span><span id="L-2225"><a href="#L-2225"><span class="linenos">2225</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="L-2226"><a href="#L-2226"><span class="linenos">2226</span></a><span class="sd">        - results[0] (str): The name of the fitted distribution.</span>
</span><span id="L-2227"><a href="#L-2227"><span class="linenos">2227</span></a><span class="sd">        - results[1] (distfit object): Fitted distribution model.</span>
</span><span id="L-2228"><a href="#L-2228"><span class="linenos">2228</span></a><span class="sd">        - results[2] (BytesIO): Distribution plot.</span>
</span><span id="L-2229"><a href="#L-2229"><span class="linenos">2229</span></a><span class="sd">        - results[3] (BytesIO): Model plot.</span>
</span><span id="L-2230"><a href="#L-2230"><span class="linenos">2230</span></a><span class="sd">        - results[4] (tuple, optional): If present, contains</span>
</span><span id="L-2231"><a href="#L-2231"><span class="linenos">2231</span></a><span class="sd">            information about a flexion point.</span>
</span><span id="L-2232"><a href="#L-2232"><span class="linenos">2232</span></a>
</span><span id="L-2233"><a href="#L-2233"><span class="linenos">2233</span></a><span class="sd">        If a flexion point is detected, it logs both left</span>
</span><span id="L-2234"><a href="#L-2234"><span class="linenos">2234</span></a><span class="sd">        and right distributions and plots them separately.</span>
</span><span id="L-2235"><a href="#L-2235"><span class="linenos">2235</span></a>
</span><span id="L-2236"><a href="#L-2236"><span class="linenos">2236</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2237"><a href="#L-2237"><span class="linenos">2237</span></a><span class="sd">        -----------</span>
</span><span id="L-2238"><a href="#L-2238"><span class="linenos">2238</span></a><span class="sd">        func : function</span>
</span><span id="L-2239"><a href="#L-2239"><span class="linenos">2239</span></a><span class="sd">            The function performing distribution fitting.</span>
</span><span id="L-2240"><a href="#L-2240"><span class="linenos">2240</span></a>
</span><span id="L-2241"><a href="#L-2241"><span class="linenos">2241</span></a><span class="sd">        Returns:</span>
</span><span id="L-2242"><a href="#L-2242"><span class="linenos">2242</span></a><span class="sd">        --------</span>
</span><span id="L-2243"><a href="#L-2243"><span class="linenos">2243</span></a><span class="sd">        function</span>
</span><span id="L-2244"><a href="#L-2244"><span class="linenos">2244</span></a><span class="sd">            Wrapped function with additional logging and PDF output.</span>
</span><span id="L-2245"><a href="#L-2245"><span class="linenos">2245</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2246"><a href="#L-2246"><span class="linenos">2246</span></a>
</span><span id="L-2247"><a href="#L-2247"><span class="linenos">2247</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-2248"><a href="#L-2248"><span class="linenos">2248</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-2249"><a href="#L-2249"><span class="linenos">2249</span></a>
</span><span id="L-2250"><a href="#L-2250"><span class="linenos">2250</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]})</span>
</span><span id="L-2251"><a href="#L-2251"><span class="linenos">2251</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-2252"><a href="#L-2252"><span class="linenos">2252</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]}</span>
</span><span id="L-2253"><a href="#L-2253"><span class="linenos">2253</span></a>            <span class="p">)</span>
</span><span id="L-2254"><a href="#L-2254"><span class="linenos">2254</span></a>
</span><span id="L-2255"><a href="#L-2255"><span class="linenos">2255</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="L-2256"><a href="#L-2256"><span class="linenos">2256</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="L-2257"><a href="#L-2257"><span class="linenos">2257</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="L-2258"><a href="#L-2258"><span class="linenos">2258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2259"><a href="#L-2259"><span class="linenos">2259</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="L-2260"><a href="#L-2260"><span class="linenos">2260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="L-2261"><a href="#L-2261"><span class="linenos">2261</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-2262"><a href="#L-2262"><span class="linenos">2262</span></a>            <span class="p">)</span>
</span><span id="L-2263"><a href="#L-2263"><span class="linenos">2263</span></a>
</span><span id="L-2264"><a href="#L-2264"><span class="linenos">2264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="L-2265"><a href="#L-2265"><span class="linenos">2265</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="L-2266"><a href="#L-2266"><span class="linenos">2266</span></a>            <span class="p">)</span>
</span><span id="L-2267"><a href="#L-2267"><span class="linenos">2267</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="L-2268"><a href="#L-2268"><span class="linenos">2268</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="L-2269"><a href="#L-2269"><span class="linenos">2269</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="L-2270"><a href="#L-2270"><span class="linenos">2270</span></a>            <span class="p">)</span>
</span><span id="L-2271"><a href="#L-2271"><span class="linenos">2271</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="L-2272"><a href="#L-2272"><span class="linenos">2272</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="L-2273"><a href="#L-2273"><span class="linenos">2273</span></a>            <span class="p">)</span>
</span><span id="L-2274"><a href="#L-2274"><span class="linenos">2274</span></a>
</span><span id="L-2275"><a href="#L-2275"><span class="linenos">2275</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="L-2276"><a href="#L-2276"><span class="linenos">2276</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="L-2277"><a href="#L-2277"><span class="linenos">2277</span></a>                    <span class="sa">f</span><span class="s2">&quot;At point </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">, the flexion point of the distributions was found&quot;</span>
</span><span id="L-2278"><a href="#L-2278"><span class="linenos">2278</span></a>                <span class="p">)</span>
</span><span id="L-2279"><a href="#L-2279"><span class="linenos">2279</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="L-2280"><a href="#L-2280"><span class="linenos">2280</span></a>                    <span class="sa">f</span><span class="s1">&#39;Left distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-2281"><a href="#L-2281"><span class="linenos">2281</span></a>                <span class="p">)</span>
</span><span id="L-2282"><a href="#L-2282"><span class="linenos">2282</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="L-2283"><a href="#L-2283"><span class="linenos">2283</span></a>                    <span class="sa">f</span><span class="s1">&#39;Right distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-2284"><a href="#L-2284"><span class="linenos">2284</span></a>                <span class="p">)</span>
</span><span id="L-2285"><a href="#L-2285"><span class="linenos">2285</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="L-2286"><a href="#L-2286"><span class="linenos">2286</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="L-2287"><a href="#L-2287"><span class="linenos">2287</span></a>                <span class="p">)</span>
</span><span id="L-2288"><a href="#L-2288"><span class="linenos">2288</span></a>                <span class="n">plot_distribution</span><span class="p">,</span> <span class="n">plot_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_double_distribution</span><span class="p">(</span>
</span><span id="L-2289"><a href="#L-2289"><span class="linenos">2289</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-2290"><a href="#L-2290"><span class="linenos">2290</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
</span><span id="L-2291"><a href="#L-2291"><span class="linenos">2291</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
</span><span id="L-2292"><a href="#L-2292"><span class="linenos">2292</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
</span><span id="L-2293"><a href="#L-2293"><span class="linenos">2293</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
</span><span id="L-2294"><a href="#L-2294"><span class="linenos">2294</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-2295"><a href="#L-2295"><span class="linenos">2295</span></a>                <span class="p">)</span>
</span><span id="L-2296"><a href="#L-2296"><span class="linenos">2296</span></a>                <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="L-2297"><a href="#L-2297"><span class="linenos">2297</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="L-2298"><a href="#L-2298"><span class="linenos">2298</span></a>                    <span class="n">plot_distribution</span><span class="p">,</span>
</span><span id="L-2299"><a href="#L-2299"><span class="linenos">2299</span></a>                    <span class="mi">80</span><span class="p">,</span>
</span><span id="L-2300"><a href="#L-2300"><span class="linenos">2300</span></a>                    <span class="mi">60</span><span class="p">,</span>
</span><span id="L-2301"><a href="#L-2301"><span class="linenos">2301</span></a>                    <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="L-2302"><a href="#L-2302"><span class="linenos">2302</span></a>                    <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="L-2303"><a href="#L-2303"><span class="linenos">2303</span></a>                <span class="p">)</span>
</span><span id="L-2304"><a href="#L-2304"><span class="linenos">2304</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="L-2305"><a href="#L-2305"><span class="linenos">2305</span></a>                    <span class="n">plot_models</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="L-2306"><a href="#L-2306"><span class="linenos">2306</span></a>                <span class="p">)</span>
</span><span id="L-2307"><a href="#L-2307"><span class="linenos">2307</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span><span id="L-2308"><a href="#L-2308"><span class="linenos">2308</span></a>
</span><span id="L-2309"><a href="#L-2309"><span class="linenos">2309</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="L-2310"><a href="#L-2310"><span class="linenos">2310</span></a>
</span><span id="L-2311"><a href="#L-2311"><span class="linenos">2311</span></a>
</span><span id="L-2312"><a href="#L-2312"><span class="linenos">2312</span></a>    <span class="k">def</span> <span class="nf">log_pnew_estimation</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="L-2313"><a href="#L-2313"><span class="linenos">2313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2314"><a href="#L-2314"><span class="linenos">2314</span></a><span class="sd">        A decorator that logs and saves P_new estimation results</span>
</span><span id="L-2315"><a href="#L-2315"><span class="linenos">2315</span></a><span class="sd">        to a PDF report.</span>
</span><span id="L-2316"><a href="#L-2316"><span class="linenos">2316</span></a>
</span><span id="L-2317"><a href="#L-2317"><span class="linenos">2317</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="L-2318"><a href="#L-2318"><span class="linenos">2318</span></a><span class="sd">        - rho_est (float): Estimated rho parameter.</span>
</span><span id="L-2319"><a href="#L-2319"><span class="linenos">2319</span></a><span class="sd">        - gamma_est (float): Estimated gamma parameter.</span>
</span><span id="L-2320"><a href="#L-2320"><span class="linenos">2320</span></a><span class="sd">        - DeltaS (np.ndarray): Change in S values for log-log regression.</span>
</span><span id="L-2321"><a href="#L-2321"><span class="linenos">2321</span></a><span class="sd">        - S_mid (np.ndarray): Midpoints of S values for log-log regression.</span>
</span><span id="L-2322"><a href="#L-2322"><span class="linenos">2322</span></a><span class="sd">        - intercept (float): Intercept of the fitted regression line.</span>
</span><span id="L-2323"><a href="#L-2323"><span class="linenos">2323</span></a><span class="sd">        - slope (float): Slope of the fitted regression line.</span>
</span><span id="L-2324"><a href="#L-2324"><span class="linenos">2324</span></a><span class="sd">        - nrows (int): Number of time steps for estimation.</span>
</span><span id="L-2325"><a href="#L-2325"><span class="linenos">2325</span></a><span class="sd">        - n_data (int): Number of data points.</span>
</span><span id="L-2326"><a href="#L-2326"><span class="linenos">2326</span></a>
</span><span id="L-2327"><a href="#L-2327"><span class="linenos">2327</span></a><span class="sd">        The results are logged in `self.stats_frame`</span>
</span><span id="L-2328"><a href="#L-2328"><span class="linenos">2328</span></a><span class="sd">        and visualized in a PDF.</span>
</span><span id="L-2329"><a href="#L-2329"><span class="linenos">2329</span></a>
</span><span id="L-2330"><a href="#L-2330"><span class="linenos">2330</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2331"><a href="#L-2331"><span class="linenos">2331</span></a><span class="sd">        -----------</span>
</span><span id="L-2332"><a href="#L-2332"><span class="linenos">2332</span></a><span class="sd">        func : function</span>
</span><span id="L-2333"><a href="#L-2333"><span class="linenos">2333</span></a><span class="sd">            The function performing P_new estimation.</span>
</span><span id="L-2334"><a href="#L-2334"><span class="linenos">2334</span></a>
</span><span id="L-2335"><a href="#L-2335"><span class="linenos">2335</span></a><span class="sd">        Returns:</span>
</span><span id="L-2336"><a href="#L-2336"><span class="linenos">2336</span></a><span class="sd">        --------</span>
</span><span id="L-2337"><a href="#L-2337"><span class="linenos">2337</span></a><span class="sd">        function</span>
</span><span id="L-2338"><a href="#L-2338"><span class="linenos">2338</span></a><span class="sd">            Wrapped function with additional logging and PDF output.</span>
</span><span id="L-2339"><a href="#L-2339"><span class="linenos">2339</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2340"><a href="#L-2340"><span class="linenos">2340</span></a>
</span><span id="L-2341"><a href="#L-2341"><span class="linenos">2341</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-2342"><a href="#L-2342"><span class="linenos">2342</span></a>            <span class="n">rho_est</span><span class="p">,</span> <span class="n">gamma_est</span><span class="p">,</span> <span class="n">DeltaS</span><span class="p">,</span> <span class="n">S_mid</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span>
</span><span id="L-2343"><a href="#L-2343"><span class="linenos">2343</span></a>                <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-2344"><a href="#L-2344"><span class="linenos">2344</span></a>            <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-2345"><a href="#L-2345"><span class="linenos">2345</span></a>
</span><span id="L-2346"><a href="#L-2346"><span class="linenos">2346</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;rho&quot;</span><span class="p">:</span> <span class="n">rho_est</span><span class="p">})</span>
</span><span id="L-2347"><a href="#L-2347"><span class="linenos">2347</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">gamma_est</span><span class="p">})</span>
</span><span id="L-2348"><a href="#L-2348"><span class="linenos">2348</span></a>
</span><span id="L-2349"><a href="#L-2349"><span class="linenos">2349</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="L-2350"><a href="#L-2350"><span class="linenos">2350</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="s2">&quot;Pnew estimation&quot;</span><span class="p">)</span>
</span><span id="L-2351"><a href="#L-2351"><span class="linenos">2351</span></a>
</span><span id="L-2352"><a href="#L-2352"><span class="linenos">2352</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="L-2353"><a href="#L-2353"><span class="linenos">2353</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="L-2354"><a href="#L-2354"><span class="linenos">2354</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="L-2355"><a href="#L-2355"><span class="linenos">2355</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;gamma  = </span><span class="si">{</span><span class="n">gamma_est</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2356"><a href="#L-2356"><span class="linenos">2356</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;rho  = </span><span class="si">{</span><span class="n">rho_est</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2357"><a href="#L-2357"><span class="linenos">2357</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="L-2358"><a href="#L-2358"><span class="linenos">2358</span></a>            <span class="n">plot_obj1</span><span class="p">,</span> <span class="n">plot_obj2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_P_new</span><span class="p">(</span>
</span><span id="L-2359"><a href="#L-2359"><span class="linenos">2359</span></a>                <span class="n">rho_est</span><span class="p">,</span> <span class="n">gamma_est</span><span class="p">,</span> <span class="n">DeltaS</span><span class="p">,</span> <span class="n">S_mid</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span>
</span><span id="L-2360"><a href="#L-2360"><span class="linenos">2360</span></a>            <span class="p">)</span>
</span><span id="L-2361"><a href="#L-2361"><span class="linenos">2361</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="L-2362"><a href="#L-2362"><span class="linenos">2362</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj1</span><span class="p">,</span>
</span><span id="L-2363"><a href="#L-2363"><span class="linenos">2363</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="L-2364"><a href="#L-2364"><span class="linenos">2364</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="L-2365"><a href="#L-2365"><span class="linenos">2365</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="L-2366"><a href="#L-2366"><span class="linenos">2366</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="L-2367"><a href="#L-2367"><span class="linenos">2367</span></a>            <span class="p">)</span>
</span><span id="L-2368"><a href="#L-2368"><span class="linenos">2368</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="L-2369"><a href="#L-2369"><span class="linenos">2369</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj2</span><span class="p">,</span>
</span><span id="L-2370"><a href="#L-2370"><span class="linenos">2370</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="L-2371"><a href="#L-2371"><span class="linenos">2371</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="L-2372"><a href="#L-2372"><span class="linenos">2372</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span>
</span><span id="L-2373"><a href="#L-2373"><span class="linenos">2373</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="L-2374"><a href="#L-2374"><span class="linenos">2374</span></a>            <span class="p">)</span>
</span><span id="L-2375"><a href="#L-2375"><span class="linenos">2375</span></a>
</span><span id="L-2376"><a href="#L-2376"><span class="linenos">2376</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="L-2377"><a href="#L-2377"><span class="linenos">2377</span></a>
</span><span id="L-2378"><a href="#L-2378"><span class="linenos">2378</span></a>
</span><span id="L-2379"><a href="#L-2379"><span class="linenos">2379</span></a>    <span class="k">def</span> <span class="nf">log_msd_split</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="L-2380"><a href="#L-2380"><span class="linenos">2380</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2381"><a href="#L-2381"><span class="linenos">2381</span></a><span class="sd">        A decorator that logs and saves MSD split results</span>
</span><span id="L-2382"><a href="#L-2382"><span class="linenos">2382</span></a><span class="sd">        to a PDF report.</span>
</span><span id="L-2383"><a href="#L-2383"><span class="linenos">2383</span></a>
</span><span id="L-2384"><a href="#L-2384"><span class="linenos">2384</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="L-2385"><a href="#L-2385"><span class="linenos">2385</span></a><span class="sd">        - msd_results (pd.DataFrame): MSD split results</span>
</span><span id="L-2386"><a href="#L-2386"><span class="linenos">2386</span></a><span class="sd">            including range and curve parameters.</span>
</span><span id="L-2387"><a href="#L-2387"><span class="linenos">2387</span></a><span class="sd">        - plot_obj (BytesIO): The plot image object.</span>
</span><span id="L-2388"><a href="#L-2388"><span class="linenos">2388</span></a>
</span><span id="L-2389"><a href="#L-2389"><span class="linenos">2389</span></a><span class="sd">        The results are stored in `self.stats_frame`</span>
</span><span id="L-2390"><a href="#L-2390"><span class="linenos">2390</span></a><span class="sd">        and included in a PDF report.</span>
</span><span id="L-2391"><a href="#L-2391"><span class="linenos">2391</span></a>
</span><span id="L-2392"><a href="#L-2392"><span class="linenos">2392</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2393"><a href="#L-2393"><span class="linenos">2393</span></a><span class="sd">        -----------</span>
</span><span id="L-2394"><a href="#L-2394"><span class="linenos">2394</span></a><span class="sd">        func : function</span>
</span><span id="L-2395"><a href="#L-2395"><span class="linenos">2395</span></a><span class="sd">            The function performing MSD split analysis.</span>
</span><span id="L-2396"><a href="#L-2396"><span class="linenos">2396</span></a>
</span><span id="L-2397"><a href="#L-2397"><span class="linenos">2397</span></a><span class="sd">        Returns:</span>
</span><span id="L-2398"><a href="#L-2398"><span class="linenos">2398</span></a><span class="sd">        --------</span>
</span><span id="L-2399"><a href="#L-2399"><span class="linenos">2399</span></a><span class="sd">        function</span>
</span><span id="L-2400"><a href="#L-2400"><span class="linenos">2400</span></a><span class="sd">            Wrapped function with additional logging and PDF output.</span>
</span><span id="L-2401"><a href="#L-2401"><span class="linenos">2401</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2402"><a href="#L-2402"><span class="linenos">2402</span></a>
</span><span id="L-2403"><a href="#L-2403"><span class="linenos">2403</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-2404"><a href="#L-2404"><span class="linenos">2404</span></a>            <span class="n">msd_results</span><span class="p">,</span> <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-2405"><a href="#L-2405"><span class="linenos">2405</span></a>            <span class="n">msd_curve</span> <span class="o">=</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-2406"><a href="#L-2406"><span class="linenos">2406</span></a>                <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;RoG range [km]&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span>
</span><span id="L-2407"><a href="#L-2407"><span class="linenos">2407</span></a>            <span class="p">)</span>
</span><span id="L-2408"><a href="#L-2408"><span class="linenos">2408</span></a>            <span class="n">msd_curve_params</span> <span class="o">=</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-2409"><a href="#L-2409"><span class="linenos">2409</span></a>                <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;RoG range [km]&quot;</span><span class="p">]</span>
</span><span id="L-2410"><a href="#L-2410"><span class="linenos">2410</span></a>                <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
</span><span id="L-2411"><a href="#L-2411"><span class="linenos">2411</span></a>                <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span>
</span><span id="L-2412"><a href="#L-2412"><span class="linenos">2412</span></a>                <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</span><span id="L-2413"><a href="#L-2413"><span class="linenos">2413</span></a>                <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
</span><span id="L-2414"><a href="#L-2414"><span class="linenos">2414</span></a>                <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="L-2415"><a href="#L-2415"><span class="linenos">2415</span></a>                <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
</span><span id="L-2416"><a href="#L-2416"><span class="linenos">2416</span></a>                <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="L-2417"><a href="#L-2417"><span class="linenos">2417</span></a>            <span class="p">)</span>
</span><span id="L-2418"><a href="#L-2418"><span class="linenos">2418</span></a>
</span><span id="L-2419"><a href="#L-2419"><span class="linenos">2419</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;msd_curve&quot;</span><span class="p">:</span> <span class="n">msd_curve</span><span class="p">})</span>
</span><span id="L-2420"><a href="#L-2420"><span class="linenos">2420</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;msd_curve_params&quot;</span><span class="p">:</span> <span class="n">msd_curve_params</span><span class="p">})</span>
</span><span id="L-2421"><a href="#L-2421"><span class="linenos">2421</span></a>
</span><span id="L-2422"><a href="#L-2422"><span class="linenos">2422</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="L-2423"><a href="#L-2423"><span class="linenos">2423</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="s2">&quot;MSD split&quot;</span><span class="p">)</span>
</span><span id="L-2424"><a href="#L-2424"><span class="linenos">2424</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="L-2425"><a href="#L-2425"><span class="linenos">2425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="L-2426"><a href="#L-2426"><span class="linenos">2426</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_msd_split_table</span><span class="p">(</span><span class="n">msd_results</span><span class="p">)</span>
</span><span id="L-2427"><a href="#L-2427"><span class="linenos">2427</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="L-2428"><a href="#L-2428"><span class="linenos">2428</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj</span><span class="p">,</span>
</span><span id="L-2429"><a href="#L-2429"><span class="linenos">2429</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="L-2430"><a href="#L-2430"><span class="linenos">2430</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="L-2431"><a href="#L-2431"><span class="linenos">2431</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span>
</span><span id="L-2432"><a href="#L-2432"><span class="linenos">2432</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="L-2433"><a href="#L-2433"><span class="linenos">2433</span></a>            <span class="p">)</span>
</span><span id="L-2434"><a href="#L-2434"><span class="linenos">2434</span></a>
</span><span id="L-2435"><a href="#L-2435"><span class="linenos">2435</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="L-2436"><a href="#L-2436"><span class="linenos">2436</span></a>
</span><span id="L-2437"><a href="#L-2437"><span class="linenos">2437</span></a>
</span><span id="L-2438"><a href="#L-2438"><span class="linenos">2438</span></a>    <span class="k">def</span> <span class="nf">check_curve_fit</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="L-2439"><a href="#L-2439"><span class="linenos">2439</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2440"><a href="#L-2440"><span class="linenos">2440</span></a><span class="sd">        A decorator that evaluates curve fitting results</span>
</span><span id="L-2441"><a href="#L-2441"><span class="linenos">2441</span></a><span class="sd">        and generates a corresponding plot.</span>
</span><span id="L-2442"><a href="#L-2442"><span class="linenos">2442</span></a>
</span><span id="L-2443"><a href="#L-2443"><span class="linenos">2443</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="L-2444"><a href="#L-2444"><span class="linenos">2444</span></a><span class="sd">        - best_fit (str): Name of the best-fitting curve.</span>
</span><span id="L-2445"><a href="#L-2445"><span class="linenos">2445</span></a><span class="sd">        - param_frame (pd.DataFrame): DataFrame containing</span>
</span><span id="L-2446"><a href="#L-2446"><span class="linenos">2446</span></a><span class="sd">            curve parameters.</span>
</span><span id="L-2447"><a href="#L-2447"><span class="linenos">2447</span></a><span class="sd">        - y_pred (np.ndarray): Predicted values based on</span>
</span><span id="L-2448"><a href="#L-2448"><span class="linenos">2448</span></a><span class="sd">            the curve fitting.</span>
</span><span id="L-2449"><a href="#L-2449"><span class="linenos">2449</span></a><span class="sd">        - exp_y_pred (np.ndarray or None): Exponential</span>
</span><span id="L-2450"><a href="#L-2450"><span class="linenos">2450</span></a><span class="sd">            curve prediction (if applicable).</span>
</span><span id="L-2451"><a href="#L-2451"><span class="linenos">2451</span></a><span class="sd">        - plot_data (pd.Series or np.ndarray): Data used for fitting.</span>
</span><span id="L-2452"><a href="#L-2452"><span class="linenos">2452</span></a><span class="sd">        - labels (list): Axis labels for the plot.</span>
</span><span id="L-2453"><a href="#L-2453"><span class="linenos">2453</span></a>
</span><span id="L-2454"><a href="#L-2454"><span class="linenos">2454</span></a><span class="sd">        If `best_fit` is not among {&quot;linear&quot;, &quot;expon&quot;, &quot;expon_neg&quot;},</span>
</span><span id="L-2455"><a href="#L-2455"><span class="linenos">2455</span></a><span class="sd">        both the fitted curve and an additional exponential curve</span>
</span><span id="L-2456"><a href="#L-2456"><span class="linenos">2456</span></a><span class="sd">        are plotted. Otherwise, only the fitted curve is plotted.</span>
</span><span id="L-2457"><a href="#L-2457"><span class="linenos">2457</span></a>
</span><span id="L-2458"><a href="#L-2458"><span class="linenos">2458</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2459"><a href="#L-2459"><span class="linenos">2459</span></a><span class="sd">        -----------</span>
</span><span id="L-2460"><a href="#L-2460"><span class="linenos">2460</span></a><span class="sd">        func : function</span>
</span><span id="L-2461"><a href="#L-2461"><span class="linenos">2461</span></a><span class="sd">            The function performing curve fitting.</span>
</span><span id="L-2462"><a href="#L-2462"><span class="linenos">2462</span></a>
</span><span id="L-2463"><a href="#L-2463"><span class="linenos">2463</span></a><span class="sd">        Returns:</span>
</span><span id="L-2464"><a href="#L-2464"><span class="linenos">2464</span></a><span class="sd">        --------</span>
</span><span id="L-2465"><a href="#L-2465"><span class="linenos">2465</span></a><span class="sd">        function</span>
</span><span id="L-2466"><a href="#L-2466"><span class="linenos">2466</span></a><span class="sd">            Wrapped function that returns:</span>
</span><span id="L-2467"><a href="#L-2467"><span class="linenos">2467</span></a><span class="sd">            - func.__name__ (str): Name of the function.</span>
</span><span id="L-2468"><a href="#L-2468"><span class="linenos">2468</span></a><span class="sd">            - best_fit (str): Best fitting curve name.</span>
</span><span id="L-2469"><a href="#L-2469"><span class="linenos">2469</span></a><span class="sd">            - param_frame (pd.DataFrame): Parameters of</span>
</span><span id="L-2470"><a href="#L-2470"><span class="linenos">2470</span></a><span class="sd">                the best fit.</span>
</span><span id="L-2471"><a href="#L-2471"><span class="linenos">2471</span></a><span class="sd">            - plot_obj (BytesIO): Image object containing</span>
</span><span id="L-2472"><a href="#L-2472"><span class="linenos">2472</span></a><span class="sd">                the generated plot.</span>
</span><span id="L-2473"><a href="#L-2473"><span class="linenos">2473</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2474"><a href="#L-2474"><span class="linenos">2474</span></a>
</span><span id="L-2475"><a href="#L-2475"><span class="linenos">2475</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-2476"><a href="#L-2476"><span class="linenos">2476</span></a>            <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">exp_y_pred</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span>
</span><span id="L-2477"><a href="#L-2477"><span class="linenos">2477</span></a>                <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-2478"><a href="#L-2478"><span class="linenos">2478</span></a>            <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-2479"><a href="#L-2479"><span class="linenos">2479</span></a>            <span class="k">if</span> <span class="n">best_fit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="s2">&quot;expon&quot;</span><span class="p">,</span> <span class="s2">&quot;expon_neg&quot;</span><span class="p">}:</span>
</span><span id="L-2480"><a href="#L-2480"><span class="linenos">2480</span></a>                <span class="n">plot_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_curve</span><span class="p">(</span>
</span><span id="L-2481"><a href="#L-2481"><span class="linenos">2481</span></a>                    <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">exp_y_pred</span>
</span><span id="L-2482"><a href="#L-2482"><span class="linenos">2482</span></a>                <span class="p">)</span>
</span><span id="L-2483"><a href="#L-2483"><span class="linenos">2483</span></a>                <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">plot_obj</span>
</span><span id="L-2484"><a href="#L-2484"><span class="linenos">2484</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2485"><a href="#L-2485"><span class="linenos">2485</span></a>                <span class="n">plot_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_curve</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</span><span id="L-2486"><a href="#L-2486"><span class="linenos">2486</span></a>                <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">plot_obj</span>
</span><span id="L-2487"><a href="#L-2487"><span class="linenos">2487</span></a>
</span><span id="L-2488"><a href="#L-2488"><span class="linenos">2488</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="L-2489"><a href="#L-2489"><span class="linenos">2489</span></a>
</span><span id="L-2490"><a href="#L-2490"><span class="linenos">2490</span></a>
</span><span id="L-2491"><a href="#L-2491"><span class="linenos">2491</span></a>    <span class="k">def</span> <span class="nf">check_distribution_fit</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="L-2492"><a href="#L-2492"><span class="linenos">2492</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2493"><a href="#L-2493"><span class="linenos">2493</span></a><span class="sd">        A decorator that evaluates the results of distribution</span>
</span><span id="L-2494"><a href="#L-2494"><span class="linenos">2494</span></a><span class="sd">        fitting and detects flexation points.</span>
</span><span id="L-2495"><a href="#L-2495"><span class="linenos">2495</span></a>
</span><span id="L-2496"><a href="#L-2496"><span class="linenos">2496</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="L-2497"><a href="#L-2497"><span class="linenos">2497</span></a><span class="sd">        - model (distfit object): The best-fitted distribution</span>
</span><span id="L-2498"><a href="#L-2498"><span class="linenos">2498</span></a><span class="sd">            model.</span>
</span><span id="L-2499"><a href="#L-2499"><span class="linenos">2499</span></a><span class="sd">        - data (pd.Series or np.ndarray): Data used for</span>
</span><span id="L-2500"><a href="#L-2500"><span class="linenos">2500</span></a><span class="sd">            distribution fitting.</span>
</span><span id="L-2501"><a href="#L-2501"><span class="linenos">2501</span></a>
</span><span id="L-2502"><a href="#L-2502"><span class="linenos">2502</span></a><span class="sd">        The function generates:</span>
</span><span id="L-2503"><a href="#L-2503"><span class="linenos">2503</span></a><span class="sd">        - A histogram plot of the fitted distribution.</span>
</span><span id="L-2504"><a href="#L-2504"><span class="linenos">2504</span></a><span class="sd">        - A model plot displaying the probability density function (PDF).</span>
</span><span id="L-2505"><a href="#L-2505"><span class="linenos">2505</span></a>
</span><span id="L-2506"><a href="#L-2506"><span class="linenos">2506</span></a><span class="sd">        If the fitted distribution is not in `const.DISTRIBUTIONS`</span>
</span><span id="L-2507"><a href="#L-2507"><span class="linenos">2507</span></a><span class="sd">        and the data has at least 4 observations, or if specific conditions</span>
</span><span id="L-2508"><a href="#L-2508"><span class="linenos">2508</span></a><span class="sd">        apply (e.g., Pareto or Lognormal with parameter &gt; 2),</span>
</span><span id="L-2509"><a href="#L-2509"><span class="linenos">2509</span></a><span class="sd">        an attempt is made to detect flexation points in the distribution.</span>
</span><span id="L-2510"><a href="#L-2510"><span class="linenos">2510</span></a>
</span><span id="L-2511"><a href="#L-2511"><span class="linenos">2511</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2512"><a href="#L-2512"><span class="linenos">2512</span></a><span class="sd">        -----------</span>
</span><span id="L-2513"><a href="#L-2513"><span class="linenos">2513</span></a><span class="sd">        func : function</span>
</span><span id="L-2514"><a href="#L-2514"><span class="linenos">2514</span></a><span class="sd">            The function performing distribution fitting.</span>
</span><span id="L-2515"><a href="#L-2515"><span class="linenos">2515</span></a>
</span><span id="L-2516"><a href="#L-2516"><span class="linenos">2516</span></a><span class="sd">        Returns:</span>
</span><span id="L-2517"><a href="#L-2517"><span class="linenos">2517</span></a><span class="sd">        --------</span>
</span><span id="L-2518"><a href="#L-2518"><span class="linenos">2518</span></a><span class="sd">        function</span>
</span><span id="L-2519"><a href="#L-2519"><span class="linenos">2519</span></a><span class="sd">            Wrapped function that returns:</span>
</span><span id="L-2520"><a href="#L-2520"><span class="linenos">2520</span></a><span class="sd">            - func.__name__ (str): Name of the function.</span>
</span><span id="L-2521"><a href="#L-2521"><span class="linenos">2521</span></a><span class="sd">            - model (distfit object): Best-fitting distribution model.</span>
</span><span id="L-2522"><a href="#L-2522"><span class="linenos">2522</span></a><span class="sd">            - plot_distribution_obj (BytesIO): Image object containing</span>
</span><span id="L-2523"><a href="#L-2523"><span class="linenos">2523</span></a><span class="sd">                the histogram plot.</span>
</span><span id="L-2524"><a href="#L-2524"><span class="linenos">2524</span></a><span class="sd">            - plot_model_obj (BytesIO): Image object containing the PDF plot.</span>
</span><span id="L-2525"><a href="#L-2525"><span class="linenos">2525</span></a><span class="sd">            - flexation_point_detection_results (tuple, optional):</span>
</span><span id="L-2526"><a href="#L-2526"><span class="linenos">2526</span></a><span class="sd">            If flexation points are found, returns details of left</span>
</span><span id="L-2527"><a href="#L-2527"><span class="linenos">2527</span></a><span class="sd">            and right distributions.</span>
</span><span id="L-2528"><a href="#L-2528"><span class="linenos">2528</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2529"><a href="#L-2529"><span class="linenos">2529</span></a>
</span><span id="L-2530"><a href="#L-2530"><span class="linenos">2530</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-2531"><a href="#L-2531"><span class="linenos">2531</span></a>            <span class="n">model</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-2532"><a href="#L-2532"><span class="linenos">2532</span></a>
</span><span id="L-2533"><a href="#L-2533"><span class="linenos">2533</span></a>            <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_distribution</span><span class="p">(</span>
</span><span id="L-2534"><a href="#L-2534"><span class="linenos">2534</span></a>                <span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="L-2535"><a href="#L-2535"><span class="linenos">2535</span></a>            <span class="p">)</span>
</span><span id="L-2536"><a href="#L-2536"><span class="linenos">2536</span></a>            <span class="k">if</span> <span class="p">(</span>
</span><span id="L-2537"><a href="#L-2537"><span class="linenos">2537</span></a>                <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">const</span><span class="o">.</span><span class="n">DISTRIBUTIONS</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">4</span>
</span><span id="L-2538"><a href="#L-2538"><span class="linenos">2538</span></a>            <span class="p">):</span>  <span class="c1"># FIXME:</span>
</span><span id="L-2539"><a href="#L-2539"><span class="linenos">2539</span></a>                <span class="n">flexation_point_detection_results</span> <span class="o">=</span> <span class="n">Flexation</span><span class="p">()</span><span class="o">.</span><span class="n">find_distributions</span><span class="p">(</span>
</span><span id="L-2540"><a href="#L-2540"><span class="linenos">2540</span></a>                    <span class="n">model</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-2541"><a href="#L-2541"><span class="linenos">2541</span></a>                <span class="p">)</span>
</span><span id="L-2542"><a href="#L-2542"><span class="linenos">2542</span></a>                <span class="k">if</span> <span class="n">flexation_point_detection_results</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2543"><a href="#L-2543"><span class="linenos">2543</span></a>
</span><span id="L-2544"><a href="#L-2544"><span class="linenos">2544</span></a>                    <span class="k">return</span> <span class="p">(</span>
</span><span id="L-2545"><a href="#L-2545"><span class="linenos">2545</span></a>                        <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="L-2546"><a href="#L-2546"><span class="linenos">2546</span></a>                        <span class="n">model</span><span class="p">,</span>
</span><span id="L-2547"><a href="#L-2547"><span class="linenos">2547</span></a>                        <span class="n">plot_distribution_obj</span><span class="p">,</span>
</span><span id="L-2548"><a href="#L-2548"><span class="linenos">2548</span></a>                        <span class="n">plot_model_obj</span><span class="p">,</span>
</span><span id="L-2549"><a href="#L-2549"><span class="linenos">2549</span></a>                        <span class="n">flexation_point_detection_results</span><span class="p">,</span>
</span><span id="L-2550"><a href="#L-2550"><span class="linenos">2550</span></a>                    <span class="p">)</span>
</span><span id="L-2551"><a href="#L-2551"><span class="linenos">2551</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-2552"><a href="#L-2552"><span class="linenos">2552</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span>
</span><span id="L-2553"><a href="#L-2553"><span class="linenos">2553</span></a>            <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;pareto&quot;</span> <span class="ow">and</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-2554"><a href="#L-2554"><span class="linenos">2554</span></a>                <span class="n">flexation_point_detection_results</span> <span class="o">=</span> <span class="n">Flexation</span><span class="p">()</span><span class="o">.</span><span class="n">find_distributions</span><span class="p">(</span>
</span><span id="L-2555"><a href="#L-2555"><span class="linenos">2555</span></a>                    <span class="n">model</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-2556"><a href="#L-2556"><span class="linenos">2556</span></a>                <span class="p">)</span>
</span><span id="L-2557"><a href="#L-2557"><span class="linenos">2557</span></a>                <span class="k">if</span> <span class="n">flexation_point_detection_results</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2558"><a href="#L-2558"><span class="linenos">2558</span></a>
</span><span id="L-2559"><a href="#L-2559"><span class="linenos">2559</span></a>                    <span class="k">return</span> <span class="p">(</span>
</span><span id="L-2560"><a href="#L-2560"><span class="linenos">2560</span></a>                        <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="L-2561"><a href="#L-2561"><span class="linenos">2561</span></a>                        <span class="n">model</span><span class="p">,</span>
</span><span id="L-2562"><a href="#L-2562"><span class="linenos">2562</span></a>                        <span class="n">plot_distribution_obj</span><span class="p">,</span>
</span><span id="L-2563"><a href="#L-2563"><span class="linenos">2563</span></a>                        <span class="n">plot_model_obj</span><span class="p">,</span>
</span><span id="L-2564"><a href="#L-2564"><span class="linenos">2564</span></a>                        <span class="n">flexation_point_detection_results</span><span class="p">,</span>
</span><span id="L-2565"><a href="#L-2565"><span class="linenos">2565</span></a>                    <span class="p">)</span>
</span><span id="L-2566"><a href="#L-2566"><span class="linenos">2566</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-2567"><a href="#L-2567"><span class="linenos">2567</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span>
</span><span id="L-2568"><a href="#L-2568"><span class="linenos">2568</span></a>            <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;lognorm&quot;</span> <span class="ow">and</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-2569"><a href="#L-2569"><span class="linenos">2569</span></a>                <span class="n">flexation_point_detection_results</span> <span class="o">=</span> <span class="n">Flexation</span><span class="p">()</span><span class="o">.</span><span class="n">find_distributions</span><span class="p">(</span>
</span><span id="L-2570"><a href="#L-2570"><span class="linenos">2570</span></a>                    <span class="n">model</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-2571"><a href="#L-2571"><span class="linenos">2571</span></a>                <span class="p">)</span>
</span><span id="L-2572"><a href="#L-2572"><span class="linenos">2572</span></a>                <span class="k">if</span> <span class="n">flexation_point_detection_results</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2573"><a href="#L-2573"><span class="linenos">2573</span></a>
</span><span id="L-2574"><a href="#L-2574"><span class="linenos">2574</span></a>                    <span class="k">return</span> <span class="p">(</span>
</span><span id="L-2575"><a href="#L-2575"><span class="linenos">2575</span></a>                        <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="L-2576"><a href="#L-2576"><span class="linenos">2576</span></a>                        <span class="n">model</span><span class="p">,</span>
</span><span id="L-2577"><a href="#L-2577"><span class="linenos">2577</span></a>                        <span class="n">plot_distribution_obj</span><span class="p">,</span>
</span><span id="L-2578"><a href="#L-2578"><span class="linenos">2578</span></a>                        <span class="n">plot_model_obj</span><span class="p">,</span>
</span><span id="L-2579"><a href="#L-2579"><span class="linenos">2579</span></a>                        <span class="n">flexation_point_detection_results</span><span class="p">,</span>
</span><span id="L-2580"><a href="#L-2580"><span class="linenos">2580</span></a>                    <span class="p">)</span>
</span><span id="L-2581"><a href="#L-2581"><span class="linenos">2581</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-2582"><a href="#L-2582"><span class="linenos">2582</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span>
</span><span id="L-2583"><a href="#L-2583"><span class="linenos">2583</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2584"><a href="#L-2584"><span class="linenos">2584</span></a>                <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span>
</span><span id="L-2585"><a href="#L-2585"><span class="linenos">2585</span></a>
</span><span id="L-2586"><a href="#L-2586"><span class="linenos">2586</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="L-2587"><a href="#L-2587"><span class="linenos">2587</span></a>
</span><span id="L-2588"><a href="#L-2588"><span class="linenos">2588</span></a>
</span><span id="L-2589"><a href="#L-2589"><span class="linenos">2589</span></a>    <span class="nd">@log_curve_fitting_resluts</span>
</span><span id="L-2590"><a href="#L-2590"><span class="linenos">2590</span></a>    <span class="nd">@check_curve_fit</span>
</span><span id="L-2591"><a href="#L-2591"><span class="linenos">2591</span></a>    <span class="k">def</span> <span class="nf">visitation_frequency</span><span class="p">(</span>
</span><span id="L-2592"><a href="#L-2592"><span class="linenos">2592</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span> <span class="n">min_labels_no</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-2593"><a href="#L-2593"><span class="linenos">2593</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-2594"><a href="#L-2594"><span class="linenos">2594</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2595"><a href="#L-2595"><span class="linenos">2595</span></a><span class="sd">        Computes the visitation frequency of locations based</span>
</span><span id="L-2596"><a href="#L-2596"><span class="linenos">2596</span></a><span class="sd">        on trajectory data.</span>
</span><span id="L-2597"><a href="#L-2597"><span class="linenos">2597</span></a>
</span><span id="L-2598"><a href="#L-2598"><span class="linenos">2598</span></a><span class="sd">        The function:</span>
</span><span id="L-2599"><a href="#L-2599"><span class="linenos">2599</span></a><span class="sd">        - Computes visitation frequency from trajectory data.</span>
</span><span id="L-2600"><a href="#L-2600"><span class="linenos">2600</span></a><span class="sd">        - Averages visitation frequency over a specified</span>
</span><span id="L-2601"><a href="#L-2601"><span class="linenos">2601</span></a><span class="sd">            minimum number of labels.</span>
</span><span id="L-2602"><a href="#L-2602"><span class="linenos">2602</span></a><span class="sd">        - Performs curve fitting to find the best function</span>
</span><span id="L-2603"><a href="#L-2603"><span class="linenos">2603</span></a><span class="sd">            describing the relationship.</span>
</span><span id="L-2604"><a href="#L-2604"><span class="linenos">2604</span></a><span class="sd">        - Returns fitting results, including predictions</span>
</span><span id="L-2605"><a href="#L-2605"><span class="linenos">2605</span></a><span class="sd">            and parameter estimates.</span>
</span><span id="L-2606"><a href="#L-2606"><span class="linenos">2606</span></a>
</span><span id="L-2607"><a href="#L-2607"><span class="linenos">2607</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2608"><a href="#L-2608"><span class="linenos">2608</span></a><span class="sd">        -----------</span>
</span><span id="L-2609"><a href="#L-2609"><span class="linenos">2609</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="L-2610"><a href="#L-2610"><span class="linenos">2610</span></a><span class="sd">            A trajectory dataset containing location visit information.</span>
</span><span id="L-2611"><a href="#L-2611"><span class="linenos">2611</span></a><span class="sd">        min_labels_no : int</span>
</span><span id="L-2612"><a href="#L-2612"><span class="linenos">2612</span></a><span class="sd">            Minimum number of labels required for averaging</span>
</span><span id="L-2613"><a href="#L-2613"><span class="linenos">2613</span></a><span class="sd">                the visitation frequency.</span>
</span><span id="L-2614"><a href="#L-2614"><span class="linenos">2614</span></a>
</span><span id="L-2615"><a href="#L-2615"><span class="linenos">2615</span></a><span class="sd">        Returns:</span>
</span><span id="L-2616"><a href="#L-2616"><span class="linenos">2616</span></a><span class="sd">        --------</span>
</span><span id="L-2617"><a href="#L-2617"><span class="linenos">2617</span></a><span class="sd">        tuple:</span>
</span><span id="L-2618"><a href="#L-2618"><span class="linenos">2618</span></a><span class="sd">            - best_fit (str): Best fitting curve name.</span>
</span><span id="L-2619"><a href="#L-2619"><span class="linenos">2619</span></a><span class="sd">            - global_params (pd.DataFrame): Parameters of the best fit.</span>
</span><span id="L-2620"><a href="#L-2620"><span class="linenos">2620</span></a><span class="sd">            - y_pred (np.ndarray): Predicted visitation frequencies.</span>
</span><span id="L-2621"><a href="#L-2621"><span class="linenos">2621</span></a><span class="sd">            - exp_y_pred (np.ndarray or None): Exponential curve</span>
</span><span id="L-2622"><a href="#L-2622"><span class="linenos">2622</span></a><span class="sd">                predictions (if applicable).</span>
</span><span id="L-2623"><a href="#L-2623"><span class="linenos">2623</span></a><span class="sd">            - avg_vf (pd.Series): Averaged visitation frequency data.</span>
</span><span id="L-2624"><a href="#L-2624"><span class="linenos">2624</span></a><span class="sd">            - labels (list): Axis labels for the plot.</span>
</span><span id="L-2625"><a href="#L-2625"><span class="linenos">2625</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2626"><a href="#L-2626"><span class="linenos">2626</span></a>
</span><span id="L-2627"><a href="#L-2627"><span class="linenos">2627</span></a>        <span class="n">vf</span> <span class="o">=</span> <span class="n">visitation_frequency</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-2628"><a href="#L-2628"><span class="linenos">2628</span></a>        <span class="n">avg_vf</span> <span class="o">=</span> <span class="n">rowwise_average</span><span class="p">(</span><span class="n">vf</span><span class="p">,</span> <span class="n">row_count</span><span class="o">=</span><span class="n">min_labels_no</span><span class="p">)</span>
</span><span id="L-2629"><a href="#L-2629"><span class="linenos">2629</span></a>        <span class="n">avg_vf</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-2630"><a href="#L-2630"><span class="linenos">2630</span></a>        <span class="n">vf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</span><span id="L-2631"><a href="#L-2631"><span class="linenos">2631</span></a>        <span class="n">avg_vf</span> <span class="o">=</span> <span class="n">avg_vf</span><span class="p">[</span><span class="o">~</span><span class="n">avg_vf</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</span><span id="L-2632"><a href="#L-2632"><span class="linenos">2632</span></a>
</span><span id="L-2633"><a href="#L-2633"><span class="linenos">2633</span></a>        <span class="n">y_pred</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">best_fit_params</span><span class="p">,</span> <span class="n">global_params</span><span class="p">,</span> <span class="n">expon_y_pred</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-2634"><a href="#L-2634"><span class="linenos">2634</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curve_fitting</span><span class="o">.</span><span class="n">model_choose</span><span class="p">(</span><span class="n">avg_vf</span><span class="p">)</span>
</span><span id="L-2635"><a href="#L-2635"><span class="linenos">2635</span></a>        <span class="p">)</span>
</span><span id="L-2636"><a href="#L-2636"><span class="linenos">2636</span></a>
</span><span id="L-2637"><a href="#L-2637"><span class="linenos">2637</span></a>        <span class="k">return</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">global_params</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">expon_y_pred</span><span class="p">,</span> <span class="n">avg_vf</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Rank&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">]</span>
</span><span id="L-2638"><a href="#L-2638"><span class="linenos">2638</span></a>
</span><span id="L-2639"><a href="#L-2639"><span class="linenos">2639</span></a>
</span><span id="L-2640"><a href="#L-2640"><span class="linenos">2640</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="L-2641"><a href="#L-2641"><span class="linenos">2641</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="L-2642"><a href="#L-2642"><span class="linenos">2642</span></a>    <span class="k">def</span> <span class="nf">jump_lengths_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-2643"><a href="#L-2643"><span class="linenos">2643</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2644"><a href="#L-2644"><span class="linenos">2644</span></a><span class="sd">        Computes the distribution of jump lengths in a trajectory dataset.</span>
</span><span id="L-2645"><a href="#L-2645"><span class="linenos">2645</span></a>
</span><span id="L-2646"><a href="#L-2646"><span class="linenos">2646</span></a><span class="sd">        The function:</span>
</span><span id="L-2647"><a href="#L-2647"><span class="linenos">2647</span></a><span class="sd">        - Extracts jump lengths from the dataset.</span>
</span><span id="L-2648"><a href="#L-2648"><span class="linenos">2648</span></a><span class="sd">        - Removes zero values and converts the data into a distribution.</span>
</span><span id="L-2649"><a href="#L-2649"><span class="linenos">2649</span></a><span class="sd">        - Fits multiple statistical distributions and selects the best fit.</span>
</span><span id="L-2650"><a href="#L-2650"><span class="linenos">2650</span></a>
</span><span id="L-2651"><a href="#L-2651"><span class="linenos">2651</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2652"><a href="#L-2652"><span class="linenos">2652</span></a><span class="sd">        -----------</span>
</span><span id="L-2653"><a href="#L-2653"><span class="linenos">2653</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="L-2654"><a href="#L-2654"><span class="linenos">2654</span></a><span class="sd">            A trajectory dataset containing movement data.</span>
</span><span id="L-2655"><a href="#L-2655"><span class="linenos">2655</span></a>
</span><span id="L-2656"><a href="#L-2656"><span class="linenos">2656</span></a><span class="sd">        Returns:</span>
</span><span id="L-2657"><a href="#L-2657"><span class="linenos">2657</span></a><span class="sd">        --------</span>
</span><span id="L-2658"><a href="#L-2658"><span class="linenos">2658</span></a><span class="sd">        tuple:</span>
</span><span id="L-2659"><a href="#L-2659"><span class="linenos">2659</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="L-2660"><a href="#L-2660"><span class="linenos">2660</span></a><span class="sd">            - jl (pd.Series): The processed jump length data.</span>
</span><span id="L-2661"><a href="#L-2661"><span class="linenos">2661</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2662"><a href="#L-2662"><span class="linenos">2662</span></a>
</span><span id="L-2663"><a href="#L-2663"><span class="linenos">2663</span></a>        <span class="n">jl</span> <span class="o">=</span> <span class="n">jump_lengths</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-2664"><a href="#L-2664"><span class="linenos">2664</span></a>        <span class="n">jl</span> <span class="o">=</span> <span class="n">jl</span><span class="p">[</span><span class="n">jl</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-2665"><a href="#L-2665"><span class="linenos">2665</span></a>        <span class="n">jl_dist</span> <span class="o">=</span> <span class="n">convert_to_distribution</span><span class="p">(</span><span class="n">jl</span><span class="p">,</span> <span class="n">num_of_classes</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span><span id="L-2666"><a href="#L-2666"><span class="linenos">2666</span></a>
</span><span id="L-2667"><a href="#L-2667"><span class="linenos">2667</span></a>        <span class="c1"># Fit to find the best theoretical distribution</span>
</span><span id="L-2668"><a href="#L-2668"><span class="linenos">2668</span></a>        <span class="n">jl</span> <span class="o">=</span> <span class="n">jl</span><span class="p">[</span><span class="o">~</span><span class="n">jl</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</span><span id="L-2669"><a href="#L-2669"><span class="linenos">2669</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="L-2670"><a href="#L-2670"><span class="linenos">2670</span></a>            <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-2671"><a href="#L-2671"><span class="linenos">2671</span></a>                <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="L-2672"><a href="#L-2672"><span class="linenos">2672</span></a>                <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="L-2673"><a href="#L-2673"><span class="linenos">2673</span></a>                <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="L-2674"><a href="#L-2674"><span class="linenos">2674</span></a>                <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="L-2675"><a href="#L-2675"><span class="linenos">2675</span></a>                <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="L-2676"><a href="#L-2676"><span class="linenos">2676</span></a>                <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="L-2677"><a href="#L-2677"><span class="linenos">2677</span></a>                <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="L-2678"><a href="#L-2678"><span class="linenos">2678</span></a>                <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="L-2679"><a href="#L-2679"><span class="linenos">2679</span></a>                <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="L-2680"><a href="#L-2680"><span class="linenos">2680</span></a>                <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="L-2681"><a href="#L-2681"><span class="linenos">2681</span></a>                <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="L-2682"><a href="#L-2682"><span class="linenos">2682</span></a>                <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="L-2683"><a href="#L-2683"><span class="linenos">2683</span></a>                <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="L-2684"><a href="#L-2684"><span class="linenos">2684</span></a>                <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="L-2685"><a href="#L-2685"><span class="linenos">2685</span></a>                <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="L-2686"><a href="#L-2686"><span class="linenos">2686</span></a>            <span class="p">],</span>
</span><span id="L-2687"><a href="#L-2687"><span class="linenos">2687</span></a>            <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="L-2688"><a href="#L-2688"><span class="linenos">2688</span></a>        <span class="p">)</span>
</span><span id="L-2689"><a href="#L-2689"><span class="linenos">2689</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">jl</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-2690"><a href="#L-2690"><span class="linenos">2690</span></a>
</span><span id="L-2691"><a href="#L-2691"><span class="linenos">2691</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">jl</span>
</span><span id="L-2692"><a href="#L-2692"><span class="linenos">2692</span></a>
</span><span id="L-2693"><a href="#L-2693"><span class="linenos">2693</span></a>
</span><span id="L-2694"><a href="#L-2694"><span class="linenos">2694</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="L-2695"><a href="#L-2695"><span class="linenos">2695</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="L-2696"><a href="#L-2696"><span class="linenos">2696</span></a>    <span class="k">def</span> <span class="nf">waiting_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-2697"><a href="#L-2697"><span class="linenos">2697</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2698"><a href="#L-2698"><span class="linenos">2698</span></a><span class="sd">        Computes the distribution of waiting times in a trajectory dataset.</span>
</span><span id="L-2699"><a href="#L-2699"><span class="linenos">2699</span></a>
</span><span id="L-2700"><a href="#L-2700"><span class="linenos">2700</span></a><span class="sd">        The function:</span>
</span><span id="L-2701"><a href="#L-2701"><span class="linenos">2701</span></a><span class="sd">        - Calculates the waiting times as the difference between start</span>
</span><span id="L-2702"><a href="#L-2702"><span class="linenos">2702</span></a><span class="sd">            and end times.</span>
</span><span id="L-2703"><a href="#L-2703"><span class="linenos">2703</span></a><span class="sd">        - Removes missing and zero values.</span>
</span><span id="L-2704"><a href="#L-2704"><span class="linenos">2704</span></a><span class="sd">        - Fits multiple statistical distributions and selects the best fit.</span>
</span><span id="L-2705"><a href="#L-2705"><span class="linenos">2705</span></a>
</span><span id="L-2706"><a href="#L-2706"><span class="linenos">2706</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2707"><a href="#L-2707"><span class="linenos">2707</span></a><span class="sd">        -----------</span>
</span><span id="L-2708"><a href="#L-2708"><span class="linenos">2708</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="L-2709"><a href="#L-2709"><span class="linenos">2709</span></a><span class="sd">            A trajectory dataset containing time-based movement data.</span>
</span><span id="L-2710"><a href="#L-2710"><span class="linenos">2710</span></a>
</span><span id="L-2711"><a href="#L-2711"><span class="linenos">2711</span></a><span class="sd">        Returns:</span>
</span><span id="L-2712"><a href="#L-2712"><span class="linenos">2712</span></a><span class="sd">        --------</span>
</span><span id="L-2713"><a href="#L-2713"><span class="linenos">2713</span></a><span class="sd">        tuple:</span>
</span><span id="L-2714"><a href="#L-2714"><span class="linenos">2714</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="L-2715"><a href="#L-2715"><span class="linenos">2715</span></a><span class="sd">            - wt (pd.Series): The processed waiting time data.</span>
</span><span id="L-2716"><a href="#L-2716"><span class="linenos">2716</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2717"><a href="#L-2717"><span class="linenos">2717</span></a>
</span><span id="L-2718"><a href="#L-2718"><span class="linenos">2718</span></a>        <span class="n">data_set</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-2719"><a href="#L-2719"><span class="linenos">2719</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-2720"><a href="#L-2720"><span class="linenos">2720</span></a>            <span class="n">wt</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="L-2721"><a href="#L-2721"><span class="linenos">2721</span></a>                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
</span><span id="L-2722"><a href="#L-2722"><span class="linenos">2722</span></a>            <span class="p">)</span>
</span><span id="L-2723"><a href="#L-2723"><span class="linenos">2723</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-2724"><a href="#L-2724"><span class="linenos">2724</span></a>            <span class="n">wt</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
</span><span id="L-2725"><a href="#L-2725"><span class="linenos">2725</span></a>
</span><span id="L-2726"><a href="#L-2726"><span class="linenos">2726</span></a>        <span class="n">wt</span> <span class="o">=</span> <span class="n">wt</span><span class="p">[</span><span class="o">~</span><span class="n">wt</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>  <span class="c1"># type: ignore</span>
</span><span id="L-2727"><a href="#L-2727"><span class="linenos">2727</span></a>        <span class="n">wt</span> <span class="o">=</span> <span class="n">wt</span><span class="p">[</span><span class="n">wt</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-2728"><a href="#L-2728"><span class="linenos">2728</span></a>
</span><span id="L-2729"><a href="#L-2729"><span class="linenos">2729</span></a>        <span class="c1"># Fit to find the best theoretical distribution</span>
</span><span id="L-2730"><a href="#L-2730"><span class="linenos">2730</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="L-2731"><a href="#L-2731"><span class="linenos">2731</span></a>            <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-2732"><a href="#L-2732"><span class="linenos">2732</span></a>                <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="L-2733"><a href="#L-2733"><span class="linenos">2733</span></a>                <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="L-2734"><a href="#L-2734"><span class="linenos">2734</span></a>                <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="L-2735"><a href="#L-2735"><span class="linenos">2735</span></a>                <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="L-2736"><a href="#L-2736"><span class="linenos">2736</span></a>                <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="L-2737"><a href="#L-2737"><span class="linenos">2737</span></a>                <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="L-2738"><a href="#L-2738"><span class="linenos">2738</span></a>                <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="L-2739"><a href="#L-2739"><span class="linenos">2739</span></a>                <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="L-2740"><a href="#L-2740"><span class="linenos">2740</span></a>                <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="L-2741"><a href="#L-2741"><span class="linenos">2741</span></a>                <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="L-2742"><a href="#L-2742"><span class="linenos">2742</span></a>                <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="L-2743"><a href="#L-2743"><span class="linenos">2743</span></a>                <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="L-2744"><a href="#L-2744"><span class="linenos">2744</span></a>                <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="L-2745"><a href="#L-2745"><span class="linenos">2745</span></a>                <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="L-2746"><a href="#L-2746"><span class="linenos">2746</span></a>                <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="L-2747"><a href="#L-2747"><span class="linenos">2747</span></a>            <span class="p">],</span>
</span><span id="L-2748"><a href="#L-2748"><span class="linenos">2748</span></a>            <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="L-2749"><a href="#L-2749"><span class="linenos">2749</span></a>        <span class="p">)</span>
</span><span id="L-2750"><a href="#L-2750"><span class="linenos">2750</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">wt</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-2751"><a href="#L-2751"><span class="linenos">2751</span></a>
</span><span id="L-2752"><a href="#L-2752"><span class="linenos">2752</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">wt</span>
</span><span id="L-2753"><a href="#L-2753"><span class="linenos">2753</span></a>
</span><span id="L-2754"><a href="#L-2754"><span class="linenos">2754</span></a>
</span><span id="L-2755"><a href="#L-2755"><span class="linenos">2755</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="L-2756"><a href="#L-2756"><span class="linenos">2756</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="L-2757"><a href="#L-2757"><span class="linenos">2757</span></a>    <span class="k">def</span> <span class="nf">travel_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-2758"><a href="#L-2758"><span class="linenos">2758</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2759"><a href="#L-2759"><span class="linenos">2759</span></a><span class="sd">        Computes the distribution of travel times between locations.</span>
</span><span id="L-2760"><a href="#L-2760"><span class="linenos">2760</span></a>
</span><span id="L-2761"><a href="#L-2761"><span class="linenos">2761</span></a><span class="sd">        The function:</span>
</span><span id="L-2762"><a href="#L-2762"><span class="linenos">2762</span></a><span class="sd">        - Calculates travel times as the time difference between</span>
</span><span id="L-2763"><a href="#L-2763"><span class="linenos">2763</span></a><span class="sd">            consecutive trajectory points.</span>
</span><span id="L-2764"><a href="#L-2764"><span class="linenos">2764</span></a><span class="sd">        - Removes missing values.</span>
</span><span id="L-2765"><a href="#L-2765"><span class="linenos">2765</span></a><span class="sd">        - Fits multiple statistical distributions and selects the best fit.</span>
</span><span id="L-2766"><a href="#L-2766"><span class="linenos">2766</span></a>
</span><span id="L-2767"><a href="#L-2767"><span class="linenos">2767</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2768"><a href="#L-2768"><span class="linenos">2768</span></a><span class="sd">        -----------</span>
</span><span id="L-2769"><a href="#L-2769"><span class="linenos">2769</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="L-2770"><a href="#L-2770"><span class="linenos">2770</span></a><span class="sd">            A trajectory dataset containing time-based movement data.</span>
</span><span id="L-2771"><a href="#L-2771"><span class="linenos">2771</span></a>
</span><span id="L-2772"><a href="#L-2772"><span class="linenos">2772</span></a><span class="sd">        Returns:</span>
</span><span id="L-2773"><a href="#L-2773"><span class="linenos">2773</span></a><span class="sd">        --------</span>
</span><span id="L-2774"><a href="#L-2774"><span class="linenos">2774</span></a><span class="sd">        tuple:</span>
</span><span id="L-2775"><a href="#L-2775"><span class="linenos">2775</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="L-2776"><a href="#L-2776"><span class="linenos">2776</span></a><span class="sd">            - tt (pd.Series): The processed travel time data.</span>
</span><span id="L-2777"><a href="#L-2777"><span class="linenos">2777</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2778"><a href="#L-2778"><span class="linenos">2778</span></a>
</span><span id="L-2779"><a href="#L-2779"><span class="linenos">2779</span></a>        <span class="n">data_set</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-2780"><a href="#L-2780"><span class="linenos">2780</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-2781"><a href="#L-2781"><span class="linenos">2781</span></a>            <span class="n">tt</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-2782"><a href="#L-2782"><span class="linenos">2782</span></a>                <span class="n">data_set</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-2783"><a href="#L-2783"><span class="linenos">2783</span></a>                <span class="o">.</span><span class="n">progress_apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-2784"><a href="#L-2784"><span class="linenos">2784</span></a>                <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-2785"><a href="#L-2785"><span class="linenos">2785</span></a>            <span class="p">)</span>
</span><span id="L-2786"><a href="#L-2786"><span class="linenos">2786</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-2787"><a href="#L-2787"><span class="linenos">2787</span></a>            <span class="n">shifted_start</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2788"><a href="#L-2788"><span class="linenos">2788</span></a>            <span class="n">tt</span> <span class="o">=</span> <span class="n">shifted_start</span> <span class="o">-</span> <span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
</span><span id="L-2789"><a href="#L-2789"><span class="linenos">2789</span></a>            <span class="n">tt</span> <span class="o">=</span> <span class="n">tt</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-2790"><a href="#L-2790"><span class="linenos">2790</span></a>
</span><span id="L-2791"><a href="#L-2791"><span class="linenos">2791</span></a>        <span class="n">tt</span> <span class="o">=</span> <span class="n">tt</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</span><span id="L-2792"><a href="#L-2792"><span class="linenos">2792</span></a>        <span class="n">tt</span> <span class="o">=</span> <span class="n">tt</span><span class="p">[</span><span class="o">~</span><span class="n">tt</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</span><span id="L-2793"><a href="#L-2793"><span class="linenos">2793</span></a>
</span><span id="L-2794"><a href="#L-2794"><span class="linenos">2794</span></a>        <span class="c1"># Fit to find the best theoretical distribution</span>
</span><span id="L-2795"><a href="#L-2795"><span class="linenos">2795</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="L-2796"><a href="#L-2796"><span class="linenos">2796</span></a>            <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-2797"><a href="#L-2797"><span class="linenos">2797</span></a>                <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="L-2798"><a href="#L-2798"><span class="linenos">2798</span></a>                <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="L-2799"><a href="#L-2799"><span class="linenos">2799</span></a>                <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="L-2800"><a href="#L-2800"><span class="linenos">2800</span></a>                <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="L-2801"><a href="#L-2801"><span class="linenos">2801</span></a>                <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="L-2802"><a href="#L-2802"><span class="linenos">2802</span></a>                <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="L-2803"><a href="#L-2803"><span class="linenos">2803</span></a>                <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="L-2804"><a href="#L-2804"><span class="linenos">2804</span></a>                <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="L-2805"><a href="#L-2805"><span class="linenos">2805</span></a>                <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="L-2806"><a href="#L-2806"><span class="linenos">2806</span></a>                <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="L-2807"><a href="#L-2807"><span class="linenos">2807</span></a>                <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="L-2808"><a href="#L-2808"><span class="linenos">2808</span></a>                <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="L-2809"><a href="#L-2809"><span class="linenos">2809</span></a>                <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="L-2810"><a href="#L-2810"><span class="linenos">2810</span></a>                <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="L-2811"><a href="#L-2811"><span class="linenos">2811</span></a>                <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="L-2812"><a href="#L-2812"><span class="linenos">2812</span></a>            <span class="p">],</span>
</span><span id="L-2813"><a href="#L-2813"><span class="linenos">2813</span></a>            <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="L-2814"><a href="#L-2814"><span class="linenos">2814</span></a>        <span class="p">)</span>
</span><span id="L-2815"><a href="#L-2815"><span class="linenos">2815</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-2816"><a href="#L-2816"><span class="linenos">2816</span></a>
</span><span id="L-2817"><a href="#L-2817"><span class="linenos">2817</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">tt</span>
</span><span id="L-2818"><a href="#L-2818"><span class="linenos">2818</span></a>
</span><span id="L-2819"><a href="#L-2819"><span class="linenos">2819</span></a>
</span><span id="L-2820"><a href="#L-2820"><span class="linenos">2820</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="L-2821"><a href="#L-2821"><span class="linenos">2821</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="L-2822"><a href="#L-2822"><span class="linenos">2822</span></a>    <span class="k">def</span> <span class="nf">rog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-2823"><a href="#L-2823"><span class="linenos">2823</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2824"><a href="#L-2824"><span class="linenos">2824</span></a><span class="sd">        Computes the distribution of the radius of gyration (RoG).</span>
</span><span id="L-2825"><a href="#L-2825"><span class="linenos">2825</span></a>
</span><span id="L-2826"><a href="#L-2826"><span class="linenos">2826</span></a><span class="sd">        The function:</span>
</span><span id="L-2827"><a href="#L-2827"><span class="linenos">2827</span></a><span class="sd">        - Computes the radius of gyration for each trajectory.</span>
</span><span id="L-2828"><a href="#L-2828"><span class="linenos">2828</span></a><span class="sd">        - Fits multiple statistical distributions and selects the best fit.</span>
</span><span id="L-2829"><a href="#L-2829"><span class="linenos">2829</span></a>
</span><span id="L-2830"><a href="#L-2830"><span class="linenos">2830</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2831"><a href="#L-2831"><span class="linenos">2831</span></a><span class="sd">        -----------</span>
</span><span id="L-2832"><a href="#L-2832"><span class="linenos">2832</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="L-2833"><a href="#L-2833"><span class="linenos">2833</span></a><span class="sd">            A trajectory dataset containing spatial movement data.</span>
</span><span id="L-2834"><a href="#L-2834"><span class="linenos">2834</span></a>
</span><span id="L-2835"><a href="#L-2835"><span class="linenos">2835</span></a><span class="sd">        Returns:</span>
</span><span id="L-2836"><a href="#L-2836"><span class="linenos">2836</span></a><span class="sd">        --------</span>
</span><span id="L-2837"><a href="#L-2837"><span class="linenos">2837</span></a><span class="sd">        tuple:</span>
</span><span id="L-2838"><a href="#L-2838"><span class="linenos">2838</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="L-2839"><a href="#L-2839"><span class="linenos">2839</span></a><span class="sd">            - rog (pd.Series): The processed radius of gyration data.</span>
</span><span id="L-2840"><a href="#L-2840"><span class="linenos">2840</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2841"><a href="#L-2841"><span class="linenos">2841</span></a>
</span><span id="L-2842"><a href="#L-2842"><span class="linenos">2842</span></a>        <span class="n">rog</span> <span class="o">=</span> <span class="n">radius_of_gyration</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time_evolution</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-2843"><a href="#L-2843"><span class="linenos">2843</span></a>
</span><span id="L-2844"><a href="#L-2844"><span class="linenos">2844</span></a>        <span class="c1"># Fit to find the best theoretical distribution</span>
</span><span id="L-2845"><a href="#L-2845"><span class="linenos">2845</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="L-2846"><a href="#L-2846"><span class="linenos">2846</span></a>            <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-2847"><a href="#L-2847"><span class="linenos">2847</span></a>                <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="L-2848"><a href="#L-2848"><span class="linenos">2848</span></a>                <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="L-2849"><a href="#L-2849"><span class="linenos">2849</span></a>                <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="L-2850"><a href="#L-2850"><span class="linenos">2850</span></a>                <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="L-2851"><a href="#L-2851"><span class="linenos">2851</span></a>                <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="L-2852"><a href="#L-2852"><span class="linenos">2852</span></a>                <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="L-2853"><a href="#L-2853"><span class="linenos">2853</span></a>                <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="L-2854"><a href="#L-2854"><span class="linenos">2854</span></a>                <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="L-2855"><a href="#L-2855"><span class="linenos">2855</span></a>                <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="L-2856"><a href="#L-2856"><span class="linenos">2856</span></a>                <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="L-2857"><a href="#L-2857"><span class="linenos">2857</span></a>                <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="L-2858"><a href="#L-2858"><span class="linenos">2858</span></a>                <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="L-2859"><a href="#L-2859"><span class="linenos">2859</span></a>                <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="L-2860"><a href="#L-2860"><span class="linenos">2860</span></a>                <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="L-2861"><a href="#L-2861"><span class="linenos">2861</span></a>                <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="L-2862"><a href="#L-2862"><span class="linenos">2862</span></a>            <span class="p">],</span>
</span><span id="L-2863"><a href="#L-2863"><span class="linenos">2863</span></a>            <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="L-2864"><a href="#L-2864"><span class="linenos">2864</span></a>        <span class="p">)</span>
</span><span id="L-2865"><a href="#L-2865"><span class="linenos">2865</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">rog</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-2866"><a href="#L-2866"><span class="linenos">2866</span></a>
</span><span id="L-2867"><a href="#L-2867"><span class="linenos">2867</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">rog</span>
</span><span id="L-2868"><a href="#L-2868"><span class="linenos">2868</span></a>
</span><span id="L-2869"><a href="#L-2869"><span class="linenos">2869</span></a>
</span><span id="L-2870"><a href="#L-2870"><span class="linenos">2870</span></a>    <span class="nd">@log_curve_fitting_resluts</span>
</span><span id="L-2871"><a href="#L-2871"><span class="linenos">2871</span></a>    <span class="nd">@check_curve_fit</span>
</span><span id="L-2872"><a href="#L-2872"><span class="linenos">2872</span></a>    <span class="k">def</span> <span class="nf">rog_over_time</span><span class="p">(</span>
</span><span id="L-2873"><a href="#L-2873"><span class="linenos">2873</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-2874"><a href="#L-2874"><span class="linenos">2874</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span>
</span><span id="L-2875"><a href="#L-2875"><span class="linenos">2875</span></a>        <span class="n">min_records_no</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-2876"><a href="#L-2876"><span class="linenos">2876</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-2877"><a href="#L-2877"><span class="linenos">2877</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2878"><a href="#L-2878"><span class="linenos">2878</span></a><span class="sd">        Computes the evolution of the radius of gyration (RoG) over time.</span>
</span><span id="L-2879"><a href="#L-2879"><span class="linenos">2879</span></a>
</span><span id="L-2880"><a href="#L-2880"><span class="linenos">2880</span></a><span class="sd">        The function:</span>
</span><span id="L-2881"><a href="#L-2881"><span class="linenos">2881</span></a><span class="sd">        - Computes the radius of gyration for each trajectory over time.</span>
</span><span id="L-2882"><a href="#L-2882"><span class="linenos">2882</span></a><span class="sd">        - Averages the RoG values using a specified number of records.</span>
</span><span id="L-2883"><a href="#L-2883"><span class="linenos">2883</span></a><span class="sd">        - Fits a curve to model the evolution of RoG.</span>
</span><span id="L-2884"><a href="#L-2884"><span class="linenos">2884</span></a>
</span><span id="L-2885"><a href="#L-2885"><span class="linenos">2885</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2886"><a href="#L-2886"><span class="linenos">2886</span></a><span class="sd">        -----------</span>
</span><span id="L-2887"><a href="#L-2887"><span class="linenos">2887</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="L-2888"><a href="#L-2888"><span class="linenos">2888</span></a><span class="sd">            A trajectory dataset containing movement data.</span>
</span><span id="L-2889"><a href="#L-2889"><span class="linenos">2889</span></a><span class="sd">        min_records_no : int</span>
</span><span id="L-2890"><a href="#L-2890"><span class="linenos">2890</span></a><span class="sd">            Minimum number of records required for averaging.</span>
</span><span id="L-2891"><a href="#L-2891"><span class="linenos">2891</span></a>
</span><span id="L-2892"><a href="#L-2892"><span class="linenos">2892</span></a><span class="sd">        Returns:</span>
</span><span id="L-2893"><a href="#L-2893"><span class="linenos">2893</span></a><span class="sd">        --------</span>
</span><span id="L-2894"><a href="#L-2894"><span class="linenos">2894</span></a><span class="sd">        tuple:</span>
</span><span id="L-2895"><a href="#L-2895"><span class="linenos">2895</span></a><span class="sd">            - best_fit (str): Name of the best fitting model.</span>
</span><span id="L-2896"><a href="#L-2896"><span class="linenos">2896</span></a><span class="sd">            - global_params (dict): Parameters of the best fit.</span>
</span><span id="L-2897"><a href="#L-2897"><span class="linenos">2897</span></a><span class="sd">            - y_pred (ndarray): Predicted values from the curve fit.</span>
</span><span id="L-2898"><a href="#L-2898"><span class="linenos">2898</span></a><span class="sd">            - expon_y_pred (ndarray): Alternative exponential model</span>
</span><span id="L-2899"><a href="#L-2899"><span class="linenos">2899</span></a><span class="sd">                predictions.</span>
</span><span id="L-2900"><a href="#L-2900"><span class="linenos">2900</span></a><span class="sd">            - avg_rog (pd.Series): Averaged RoG values over time.</span>
</span><span id="L-2901"><a href="#L-2901"><span class="linenos">2901</span></a><span class="sd">            - [&quot;Time&quot;, &quot;Values&quot;] (list): Column labels.</span>
</span><span id="L-2902"><a href="#L-2902"><span class="linenos">2902</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2903"><a href="#L-2903"><span class="linenos">2903</span></a>
</span><span id="L-2904"><a href="#L-2904"><span class="linenos">2904</span></a>        <span class="n">rog</span> <span class="o">=</span> <span class="n">radius_of_gyration</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time_evolution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-2905"><a href="#L-2905"><span class="linenos">2905</span></a>        <span class="n">avg_rog</span> <span class="o">=</span> <span class="n">rowwise_average</span><span class="p">(</span><span class="n">rog</span><span class="p">,</span> <span class="n">row_count</span><span class="o">=</span><span class="n">min_records_no</span><span class="p">)</span>
</span><span id="L-2906"><a href="#L-2906"><span class="linenos">2906</span></a>        <span class="n">avg_rog</span> <span class="o">=</span> <span class="n">avg_rog</span><span class="p">[</span><span class="o">~</span><span class="n">avg_rog</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</span><span id="L-2907"><a href="#L-2907"><span class="linenos">2907</span></a>
</span><span id="L-2908"><a href="#L-2908"><span class="linenos">2908</span></a>        <span class="c1"># model selection</span>
</span><span id="L-2909"><a href="#L-2909"><span class="linenos">2909</span></a>        <span class="n">y_pred</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">best_fit_params</span><span class="p">,</span> <span class="n">global_params</span><span class="p">,</span> <span class="n">expon_y_pred</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-2910"><a href="#L-2910"><span class="linenos">2910</span></a>            <span class="n">DistributionFitingTools</span><span class="p">()</span><span class="o">.</span><span class="n">model_choose</span><span class="p">(</span><span class="n">avg_rog</span><span class="p">)</span>
</span><span id="L-2911"><a href="#L-2911"><span class="linenos">2911</span></a>        <span class="p">)</span>
</span><span id="L-2912"><a href="#L-2912"><span class="linenos">2912</span></a>
</span><span id="L-2913"><a href="#L-2913"><span class="linenos">2913</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-2914"><a href="#L-2914"><span class="linenos">2914</span></a>            <span class="n">best_fit</span><span class="p">,</span>
</span><span id="L-2915"><a href="#L-2915"><span class="linenos">2915</span></a>            <span class="n">global_params</span><span class="p">,</span>
</span><span id="L-2916"><a href="#L-2916"><span class="linenos">2916</span></a>            <span class="n">y_pred</span><span class="p">,</span>
</span><span id="L-2917"><a href="#L-2917"><span class="linenos">2917</span></a>            <span class="n">expon_y_pred</span><span class="p">,</span>
</span><span id="L-2918"><a href="#L-2918"><span class="linenos">2918</span></a>            <span class="n">avg_rog</span><span class="p">,</span>
</span><span id="L-2919"><a href="#L-2919"><span class="linenos">2919</span></a>            <span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;Values&quot;</span><span class="p">],</span>
</span><span id="L-2920"><a href="#L-2920"><span class="linenos">2920</span></a>        <span class="p">)</span>
</span><span id="L-2921"><a href="#L-2921"><span class="linenos">2921</span></a>
</span><span id="L-2922"><a href="#L-2922"><span class="linenos">2922</span></a>
</span><span id="L-2923"><a href="#L-2923"><span class="linenos">2923</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="L-2924"><a href="#L-2924"><span class="linenos">2924</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="L-2925"><a href="#L-2925"><span class="linenos">2925</span></a>    <span class="k">def</span> <span class="nf">msd_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-2926"><a href="#L-2926"><span class="linenos">2926</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2927"><a href="#L-2927"><span class="linenos">2927</span></a><span class="sd">        Computes the distribution of mean squared displacement (MSD).</span>
</span><span id="L-2928"><a href="#L-2928"><span class="linenos">2928</span></a>
</span><span id="L-2929"><a href="#L-2929"><span class="linenos">2929</span></a><span class="sd">        The function:</span>
</span><span id="L-2930"><a href="#L-2930"><span class="linenos">2930</span></a><span class="sd">        - Computes MSD without time evolution.</span>
</span><span id="L-2931"><a href="#L-2931"><span class="linenos">2931</span></a><span class="sd">        - Fits multiple statistical distributions and selects the best fit.</span>
</span><span id="L-2932"><a href="#L-2932"><span class="linenos">2932</span></a>
</span><span id="L-2933"><a href="#L-2933"><span class="linenos">2933</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2934"><a href="#L-2934"><span class="linenos">2934</span></a><span class="sd">        -----------</span>
</span><span id="L-2935"><a href="#L-2935"><span class="linenos">2935</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="L-2936"><a href="#L-2936"><span class="linenos">2936</span></a><span class="sd">            A trajectory dataset containing movement data.</span>
</span><span id="L-2937"><a href="#L-2937"><span class="linenos">2937</span></a>
</span><span id="L-2938"><a href="#L-2938"><span class="linenos">2938</span></a><span class="sd">        Returns:</span>
</span><span id="L-2939"><a href="#L-2939"><span class="linenos">2939</span></a><span class="sd">        --------</span>
</span><span id="L-2940"><a href="#L-2940"><span class="linenos">2940</span></a><span class="sd">        tuple:</span>
</span><span id="L-2941"><a href="#L-2941"><span class="linenos">2941</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="L-2942"><a href="#L-2942"><span class="linenos">2942</span></a><span class="sd">            - msd (pd.Series): The computed MSD values.</span>
</span><span id="L-2943"><a href="#L-2943"><span class="linenos">2943</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2944"><a href="#L-2944"><span class="linenos">2944</span></a>
</span><span id="L-2945"><a href="#L-2945"><span class="linenos">2945</span></a>        <span class="n">msd</span> <span class="o">=</span> <span class="n">mean_square_displacement</span><span class="p">(</span>
</span><span id="L-2946"><a href="#L-2946"><span class="linenos">2946</span></a>            <span class="n">data</span><span class="p">,</span>
</span><span id="L-2947"><a href="#L-2947"><span class="linenos">2947</span></a>            <span class="n">time_evolution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-2948"><a href="#L-2948"><span class="linenos">2948</span></a>            <span class="n">from_center</span><span class="o">=</span><span class="kc">True</span>
</span><span id="L-2949"><a href="#L-2949"><span class="linenos">2949</span></a>        <span class="p">)</span>
</span><span id="L-2950"><a href="#L-2950"><span class="linenos">2950</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="L-2951"><a href="#L-2951"><span class="linenos">2951</span></a>            <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-2952"><a href="#L-2952"><span class="linenos">2952</span></a>                <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="L-2953"><a href="#L-2953"><span class="linenos">2953</span></a>                <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="L-2954"><a href="#L-2954"><span class="linenos">2954</span></a>                <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="L-2955"><a href="#L-2955"><span class="linenos">2955</span></a>                <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="L-2956"><a href="#L-2956"><span class="linenos">2956</span></a>                <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="L-2957"><a href="#L-2957"><span class="linenos">2957</span></a>                <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="L-2958"><a href="#L-2958"><span class="linenos">2958</span></a>                <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="L-2959"><a href="#L-2959"><span class="linenos">2959</span></a>                <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="L-2960"><a href="#L-2960"><span class="linenos">2960</span></a>                <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="L-2961"><a href="#L-2961"><span class="linenos">2961</span></a>                <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="L-2962"><a href="#L-2962"><span class="linenos">2962</span></a>                <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="L-2963"><a href="#L-2963"><span class="linenos">2963</span></a>                <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="L-2964"><a href="#L-2964"><span class="linenos">2964</span></a>                <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="L-2965"><a href="#L-2965"><span class="linenos">2965</span></a>                <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="L-2966"><a href="#L-2966"><span class="linenos">2966</span></a>                <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="L-2967"><a href="#L-2967"><span class="linenos">2967</span></a>            <span class="p">],</span>
</span><span id="L-2968"><a href="#L-2968"><span class="linenos">2968</span></a>            <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="L-2969"><a href="#L-2969"><span class="linenos">2969</span></a>        <span class="p">)</span>
</span><span id="L-2970"><a href="#L-2970"><span class="linenos">2970</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">msd</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-2971"><a href="#L-2971"><span class="linenos">2971</span></a>
</span><span id="L-2972"><a href="#L-2972"><span class="linenos">2972</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">msd</span>
</span><span id="L-2973"><a href="#L-2973"><span class="linenos">2973</span></a>
</span><span id="L-2974"><a href="#L-2974"><span class="linenos">2974</span></a>
</span><span id="L-2975"><a href="#L-2975"><span class="linenos">2975</span></a>    <span class="nd">@log_curve_fitting_resluts</span>
</span><span id="L-2976"><a href="#L-2976"><span class="linenos">2976</span></a>    <span class="nd">@check_curve_fit</span>
</span><span id="L-2977"><a href="#L-2977"><span class="linenos">2977</span></a>    <span class="k">def</span> <span class="nf">msd_curve</span><span class="p">(</span>
</span><span id="L-2978"><a href="#L-2978"><span class="linenos">2978</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-2979"><a href="#L-2979"><span class="linenos">2979</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span>
</span><span id="L-2980"><a href="#L-2980"><span class="linenos">2980</span></a>        <span class="n">min_records_no</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-2981"><a href="#L-2981"><span class="linenos">2981</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-2982"><a href="#L-2982"><span class="linenos">2982</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2983"><a href="#L-2983"><span class="linenos">2983</span></a><span class="sd">        Computes the mean squared displacement (MSD) curve over time.</span>
</span><span id="L-2984"><a href="#L-2984"><span class="linenos">2984</span></a>
</span><span id="L-2985"><a href="#L-2985"><span class="linenos">2985</span></a><span class="sd">        The function:</span>
</span><span id="L-2986"><a href="#L-2986"><span class="linenos">2986</span></a><span class="sd">        - Computes MSD over time.</span>
</span><span id="L-2987"><a href="#L-2987"><span class="linenos">2987</span></a><span class="sd">        - Averages MSD values using a specified number of records.</span>
</span><span id="L-2988"><a href="#L-2988"><span class="linenos">2988</span></a><span class="sd">        - Fits a curve to model MSD behavior.</span>
</span><span id="L-2989"><a href="#L-2989"><span class="linenos">2989</span></a>
</span><span id="L-2990"><a href="#L-2990"><span class="linenos">2990</span></a><span class="sd">        Parameters:</span>
</span><span id="L-2991"><a href="#L-2991"><span class="linenos">2991</span></a><span class="sd">        -----------</span>
</span><span id="L-2992"><a href="#L-2992"><span class="linenos">2992</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="L-2993"><a href="#L-2993"><span class="linenos">2993</span></a><span class="sd">            A trajectory dataset containing movement data.</span>
</span><span id="L-2994"><a href="#L-2994"><span class="linenos">2994</span></a><span class="sd">        min_records_no : int</span>
</span><span id="L-2995"><a href="#L-2995"><span class="linenos">2995</span></a><span class="sd">            Minimum number of records required for averaging.</span>
</span><span id="L-2996"><a href="#L-2996"><span class="linenos">2996</span></a>
</span><span id="L-2997"><a href="#L-2997"><span class="linenos">2997</span></a><span class="sd">        Returns:</span>
</span><span id="L-2998"><a href="#L-2998"><span class="linenos">2998</span></a><span class="sd">        --------</span>
</span><span id="L-2999"><a href="#L-2999"><span class="linenos">2999</span></a><span class="sd">        tuple:</span>
</span><span id="L-3000"><a href="#L-3000"><span class="linenos">3000</span></a><span class="sd">            - best_fit (str): Name of the best fitting model.</span>
</span><span id="L-3001"><a href="#L-3001"><span class="linenos">3001</span></a><span class="sd">            - global_params (dict): Parameters of the best fit.</span>
</span><span id="L-3002"><a href="#L-3002"><span class="linenos">3002</span></a><span class="sd">            - y_pred (ndarray): Predicted values from the curve fit.</span>
</span><span id="L-3003"><a href="#L-3003"><span class="linenos">3003</span></a><span class="sd">            - expon_y_pred (ndarray): Alternative exponential model</span>
</span><span id="L-3004"><a href="#L-3004"><span class="linenos">3004</span></a><span class="sd">                predictions.</span>
</span><span id="L-3005"><a href="#L-3005"><span class="linenos">3005</span></a><span class="sd">            - avg_msd (pd.Series): Averaged MSD values over time.</span>
</span><span id="L-3006"><a href="#L-3006"><span class="linenos">3006</span></a><span class="sd">            - [&quot;t&quot;, &quot;MSD&quot;] (list): Column labels.</span>
</span><span id="L-3007"><a href="#L-3007"><span class="linenos">3007</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3008"><a href="#L-3008"><span class="linenos">3008</span></a>
</span><span id="L-3009"><a href="#L-3009"><span class="linenos">3009</span></a>        <span class="n">msd</span> <span class="o">=</span> <span class="n">mean_square_displacement</span><span class="p">(</span>
</span><span id="L-3010"><a href="#L-3010"><span class="linenos">3010</span></a>            <span class="n">data</span><span class="p">,</span>
</span><span id="L-3011"><a href="#L-3011"><span class="linenos">3011</span></a>            <span class="n">time_evolution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-3012"><a href="#L-3012"><span class="linenos">3012</span></a>            <span class="n">from_center</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-3013"><a href="#L-3013"><span class="linenos">3013</span></a>        <span class="p">)</span>
</span><span id="L-3014"><a href="#L-3014"><span class="linenos">3014</span></a>        <span class="n">avg_msd</span> <span class="o">=</span> <span class="n">rowwise_average</span><span class="p">(</span><span class="n">msd</span><span class="p">,</span> <span class="n">row_count</span><span class="o">=</span><span class="n">min_records_no</span><span class="p">)</span>
</span><span id="L-3015"><a href="#L-3015"><span class="linenos">3015</span></a>        <span class="n">avg_msd</span> <span class="o">=</span> <span class="n">avg_msd</span><span class="p">[</span><span class="o">~</span><span class="n">avg_msd</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</span><span id="L-3016"><a href="#L-3016"><span class="linenos">3016</span></a>        <span class="c1"># model selection</span>
</span><span id="L-3017"><a href="#L-3017"><span class="linenos">3017</span></a>        <span class="n">y_pred</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">best_fit_params</span><span class="p">,</span> <span class="n">global_params</span><span class="p">,</span> <span class="n">expon_y_pred</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-3018"><a href="#L-3018"><span class="linenos">3018</span></a>            <span class="n">DistributionFitingTools</span><span class="p">()</span><span class="o">.</span><span class="n">model_choose</span><span class="p">(</span><span class="n">avg_msd</span><span class="p">)</span>
</span><span id="L-3019"><a href="#L-3019"><span class="linenos">3019</span></a>        <span class="p">)</span>
</span><span id="L-3020"><a href="#L-3020"><span class="linenos">3020</span></a>
</span><span id="L-3021"><a href="#L-3021"><span class="linenos">3021</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-3022"><a href="#L-3022"><span class="linenos">3022</span></a>            <span class="n">best_fit</span><span class="p">,</span>
</span><span id="L-3023"><a href="#L-3023"><span class="linenos">3023</span></a>            <span class="n">global_params</span><span class="p">,</span>
</span><span id="L-3024"><a href="#L-3024"><span class="linenos">3024</span></a>            <span class="n">y_pred</span><span class="p">,</span>
</span><span id="L-3025"><a href="#L-3025"><span class="linenos">3025</span></a>            <span class="n">expon_y_pred</span><span class="p">,</span>
</span><span id="L-3026"><a href="#L-3026"><span class="linenos">3026</span></a>            <span class="n">avg_msd</span><span class="p">,</span>
</span><span id="L-3027"><a href="#L-3027"><span class="linenos">3027</span></a>            <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;MSD&quot;</span><span class="p">]</span>
</span><span id="L-3028"><a href="#L-3028"><span class="linenos">3028</span></a>        <span class="p">)</span>
</span><span id="L-3029"><a href="#L-3029"><span class="linenos">3029</span></a>
</span><span id="L-3030"><a href="#L-3030"><span class="linenos">3030</span></a>
</span><span id="L-3031"><a href="#L-3031"><span class="linenos">3031</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="L-3032"><a href="#L-3032"><span class="linenos">3032</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="L-3033"><a href="#L-3033"><span class="linenos">3033</span></a>    <span class="k">def</span> <span class="nf">return_time_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-3034"><a href="#L-3034"><span class="linenos">3034</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3035"><a href="#L-3035"><span class="linenos">3035</span></a><span class="sd">        Computes the distribution of return times.</span>
</span><span id="L-3036"><a href="#L-3036"><span class="linenos">3036</span></a>
</span><span id="L-3037"><a href="#L-3037"><span class="linenos">3037</span></a><span class="sd">        The function:</span>
</span><span id="L-3038"><a href="#L-3038"><span class="linenos">3038</span></a><span class="sd">        - Identifies return times based on revisited locations.</span>
</span><span id="L-3039"><a href="#L-3039"><span class="linenos">3039</span></a><span class="sd">        - Fits a statistical distribution to the return time values.</span>
</span><span id="L-3040"><a href="#L-3040"><span class="linenos">3040</span></a>
</span><span id="L-3041"><a href="#L-3041"><span class="linenos">3041</span></a><span class="sd">        Parameters:</span>
</span><span id="L-3042"><a href="#L-3042"><span class="linenos">3042</span></a><span class="sd">        -----------</span>
</span><span id="L-3043"><a href="#L-3043"><span class="linenos">3043</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="L-3044"><a href="#L-3044"><span class="linenos">3044</span></a><span class="sd">            A trajectory dataset containing labeled locations and timestamps.</span>
</span><span id="L-3045"><a href="#L-3045"><span class="linenos">3045</span></a>
</span><span id="L-3046"><a href="#L-3046"><span class="linenos">3046</span></a><span class="sd">        Returns:</span>
</span><span id="L-3047"><a href="#L-3047"><span class="linenos">3047</span></a><span class="sd">        --------</span>
</span><span id="L-3048"><a href="#L-3048"><span class="linenos">3048</span></a><span class="sd">        tuple:</span>
</span><span id="L-3049"><a href="#L-3049"><span class="linenos">3049</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="L-3050"><a href="#L-3050"><span class="linenos">3050</span></a><span class="sd">            - rt (pd.Series): The computed return time values.</span>
</span><span id="L-3051"><a href="#L-3051"><span class="linenos">3051</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3052"><a href="#L-3052"><span class="linenos">3052</span></a>
</span><span id="L-3053"><a href="#L-3053"><span class="linenos">3053</span></a>        <span class="n">to_concat</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-3054"><a href="#L-3054"><span class="linenos">3054</span></a>        <span class="n">data_set</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-3055"><a href="#L-3055"><span class="linenos">3055</span></a>        <span class="k">for</span> <span class="n">uid</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
</span><span id="L-3056"><a href="#L-3056"><span class="linenos">3056</span></a>            <span class="n">data_set</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="L-3057"><a href="#L-3057"><span class="linenos">3057</span></a>            <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">))),</span>
</span><span id="L-3058"><a href="#L-3058"><span class="linenos">3058</span></a>        <span class="p">):</span>
</span><span id="L-3059"><a href="#L-3059"><span class="linenos">3059</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()[[</span><span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">]]</span>
</span><span id="L-3060"><a href="#L-3060"><span class="linenos">3060</span></a>
</span><span id="L-3061"><a href="#L-3061"><span class="linenos">3061</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;new_place&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">~</span><span class="n">vals</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
</span><span id="L-3062"><a href="#L-3062"><span class="linenos">3062</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;new_place&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="L-3063"><a href="#L-3063"><span class="linenos">3063</span></a>                <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="s2">&quot;new_place&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;new_place&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</span><span id="L-3064"><a href="#L-3064"><span class="linenos">3064</span></a>            <span class="p">)</span>
</span><span id="L-3065"><a href="#L-3065"><span class="linenos">3065</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands_reach&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>
</span><span id="L-3066"><a href="#L-3066"><span class="linenos">3066</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[[</span><span class="s2">&quot;islands&quot;</span><span class="p">,</span> <span class="s2">&quot;islands_reach&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-3067"><a href="#L-3067"><span class="linenos">3067</span></a>
</span><span id="L-3068"><a href="#L-3068"><span class="linenos">3068</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;islands_reach&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-3069"><a href="#L-3069"><span class="linenos">3069</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">vals</span><span class="o">.</span><span class="n">islands</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-3070"><a href="#L-3070"><span class="linenos">3070</span></a>
</span><span id="L-3071"><a href="#L-3071"><span class="linenos">3071</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;islands&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="L-3072"><a href="#L-3072"><span class="linenos">3072</span></a>                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># type: ignore</span>
</span><span id="L-3073"><a href="#L-3073"><span class="linenos">3073</span></a>            <span class="p">)</span>
</span><span id="L-3074"><a href="#L-3074"><span class="linenos">3074</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</span><span id="L-3075"><a href="#L-3075"><span class="linenos">3075</span></a>            <span class="n">to_concat</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="L-3076"><a href="#L-3076"><span class="linenos">3076</span></a>
</span><span id="L-3077"><a href="#L-3077"><span class="linenos">3077</span></a>        <span class="n">rt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">to_concat</span><span class="p">)</span>
</span><span id="L-3078"><a href="#L-3078"><span class="linenos">3078</span></a>        <span class="n">rt</span> <span class="o">=</span> <span class="n">rt</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-3079"><a href="#L-3079"><span class="linenos">3079</span></a>        <span class="n">rt</span> <span class="o">=</span> <span class="n">rt</span><span class="p">[</span><span class="n">rt</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-3080"><a href="#L-3080"><span class="linenos">3080</span></a>        <span class="n">rt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">to_concat</span><span class="p">)</span>
</span><span id="L-3081"><a href="#L-3081"><span class="linenos">3081</span></a>        <span class="n">rt</span> <span class="o">=</span> <span class="n">rt</span><span class="p">[</span><span class="n">rt</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-3082"><a href="#L-3082"><span class="linenos">3082</span></a>
</span><span id="L-3083"><a href="#L-3083"><span class="linenos">3083</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">)</span>
</span><span id="L-3084"><a href="#L-3084"><span class="linenos">3084</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">rt</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-3085"><a href="#L-3085"><span class="linenos">3085</span></a>
</span><span id="L-3086"><a href="#L-3086"><span class="linenos">3086</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">rt</span>
</span><span id="L-3087"><a href="#L-3087"><span class="linenos">3087</span></a>
</span><span id="L-3088"><a href="#L-3088"><span class="linenos">3088</span></a>
</span><span id="L-3089"><a href="#L-3089"><span class="linenos">3089</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="L-3090"><a href="#L-3090"><span class="linenos">3090</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="L-3091"><a href="#L-3091"><span class="linenos">3091</span></a>    <span class="k">def</span> <span class="nf">exploration_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-3092"><a href="#L-3092"><span class="linenos">3092</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3093"><a href="#L-3093"><span class="linenos">3093</span></a><span class="sd">        Computes the distribution of exploration times.</span>
</span><span id="L-3094"><a href="#L-3094"><span class="linenos">3094</span></a>
</span><span id="L-3095"><a href="#L-3095"><span class="linenos">3095</span></a><span class="sd">        The function:</span>
</span><span id="L-3096"><a href="#L-3096"><span class="linenos">3096</span></a><span class="sd">        - Identifies exploration periods as the time spent in</span>
</span><span id="L-3097"><a href="#L-3097"><span class="linenos">3097</span></a><span class="sd">            newly visited locations.</span>
</span><span id="L-3098"><a href="#L-3098"><span class="linenos">3098</span></a><span class="sd">        - Fits a statistical distribution to the exploration time values.</span>
</span><span id="L-3099"><a href="#L-3099"><span class="linenos">3099</span></a>
</span><span id="L-3100"><a href="#L-3100"><span class="linenos">3100</span></a><span class="sd">        Parameters:</span>
</span><span id="L-3101"><a href="#L-3101"><span class="linenos">3101</span></a><span class="sd">        -----------</span>
</span><span id="L-3102"><a href="#L-3102"><span class="linenos">3102</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="L-3103"><a href="#L-3103"><span class="linenos">3103</span></a><span class="sd">            A trajectory dataset containing labeled locations and timestamps.</span>
</span><span id="L-3104"><a href="#L-3104"><span class="linenos">3104</span></a>
</span><span id="L-3105"><a href="#L-3105"><span class="linenos">3105</span></a><span class="sd">        Returns:</span>
</span><span id="L-3106"><a href="#L-3106"><span class="linenos">3106</span></a><span class="sd">        --------</span>
</span><span id="L-3107"><a href="#L-3107"><span class="linenos">3107</span></a><span class="sd">        tuple:</span>
</span><span id="L-3108"><a href="#L-3108"><span class="linenos">3108</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="L-3109"><a href="#L-3109"><span class="linenos">3109</span></a><span class="sd">            - et (pd.Series): The computed exploration time values.</span>
</span><span id="L-3110"><a href="#L-3110"><span class="linenos">3110</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3111"><a href="#L-3111"><span class="linenos">3111</span></a>
</span><span id="L-3112"><a href="#L-3112"><span class="linenos">3112</span></a>        <span class="n">to_concat</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-3113"><a href="#L-3113"><span class="linenos">3113</span></a>        <span class="n">data_set</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-3114"><a href="#L-3114"><span class="linenos">3114</span></a>        <span class="k">for</span> <span class="n">uid</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
</span><span id="L-3115"><a href="#L-3115"><span class="linenos">3115</span></a>            <span class="n">data_set</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="L-3116"><a href="#L-3116"><span class="linenos">3116</span></a>            <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">))),</span>
</span><span id="L-3117"><a href="#L-3117"><span class="linenos">3117</span></a>        <span class="p">):</span>
</span><span id="L-3118"><a href="#L-3118"><span class="linenos">3118</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()[[</span><span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">]]</span>
</span><span id="L-3119"><a href="#L-3119"><span class="linenos">3119</span></a>
</span><span id="L-3120"><a href="#L-3120"><span class="linenos">3120</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;old_place&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
</span><span id="L-3121"><a href="#L-3121"><span class="linenos">3121</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;old_place&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="L-3122"><a href="#L-3122"><span class="linenos">3122</span></a>                <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="s2">&quot;old_place&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;old_place&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</span><span id="L-3123"><a href="#L-3123"><span class="linenos">3123</span></a>            <span class="p">)</span>
</span><span id="L-3124"><a href="#L-3124"><span class="linenos">3124</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands_reach&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>
</span><span id="L-3125"><a href="#L-3125"><span class="linenos">3125</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[[</span><span class="s2">&quot;islands&quot;</span><span class="p">,</span> <span class="s2">&quot;islands_reach&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-3126"><a href="#L-3126"><span class="linenos">3126</span></a>
</span><span id="L-3127"><a href="#L-3127"><span class="linenos">3127</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;islands_reach&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-3128"><a href="#L-3128"><span class="linenos">3128</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">vals</span><span class="o">.</span><span class="n">islands</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-3129"><a href="#L-3129"><span class="linenos">3129</span></a>
</span><span id="L-3130"><a href="#L-3130"><span class="linenos">3130</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;islands&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="L-3131"><a href="#L-3131"><span class="linenos">3131</span></a>                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># type: ignore</span>
</span><span id="L-3132"><a href="#L-3132"><span class="linenos">3132</span></a>            <span class="p">)</span>
</span><span id="L-3133"><a href="#L-3133"><span class="linenos">3133</span></a>            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-3134"><a href="#L-3134"><span class="linenos">3134</span></a>                <span class="k">continue</span>
</span><span id="L-3135"><a href="#L-3135"><span class="linenos">3135</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</span><span id="L-3136"><a href="#L-3136"><span class="linenos">3136</span></a>            <span class="n">to_concat</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="L-3137"><a href="#L-3137"><span class="linenos">3137</span></a>
</span><span id="L-3138"><a href="#L-3138"><span class="linenos">3138</span></a>        <span class="n">et</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">to_concat</span><span class="p">)</span>
</span><span id="L-3139"><a href="#L-3139"><span class="linenos">3139</span></a>        <span class="n">et</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-3140"><a href="#L-3140"><span class="linenos">3140</span></a>        <span class="n">et</span> <span class="o">=</span> <span class="n">et</span><span class="p">[</span><span class="n">et</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-3141"><a href="#L-3141"><span class="linenos">3141</span></a>
</span><span id="L-3142"><a href="#L-3142"><span class="linenos">3142</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">)</span>
</span><span id="L-3143"><a href="#L-3143"><span class="linenos">3143</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">et</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-3144"><a href="#L-3144"><span class="linenos">3144</span></a>
</span><span id="L-3145"><a href="#L-3145"><span class="linenos">3145</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">et</span>
</span><span id="L-3146"><a href="#L-3146"><span class="linenos">3146</span></a>
</span><span id="L-3147"><a href="#L-3147"><span class="linenos">3147</span></a>
</span><span id="L-3148"><a href="#L-3148"><span class="linenos">3148</span></a>    <span class="nd">@log_msd_split</span>
</span><span id="L-3149"><a href="#L-3149"><span class="linenos">3149</span></a>    <span class="k">def</span> <span class="nf">msd_curve_split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="L-3150"><a href="#L-3150"><span class="linenos">3150</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3151"><a href="#L-3151"><span class="linenos">3151</span></a><span class="sd">        Computes and groups MSD curves based on the radius of gyration (RoG).</span>
</span><span id="L-3152"><a href="#L-3152"><span class="linenos">3152</span></a>
</span><span id="L-3153"><a href="#L-3153"><span class="linenos">3153</span></a><span class="sd">        The function:</span>
</span><span id="L-3154"><a href="#L-3154"><span class="linenos">3154</span></a><span class="sd">        - Converts trajectory data to a GeoDataFrame.</span>
</span><span id="L-3155"><a href="#L-3155"><span class="linenos">3155</span></a><span class="sd">        - Computes the center of mass and starting points for each trajectory.</span>
</span><span id="L-3156"><a href="#L-3156"><span class="linenos">3156</span></a><span class="sd">        - Filters data to only include new explorations.</span>
</span><span id="L-3157"><a href="#L-3157"><span class="linenos">3157</span></a><span class="sd">        - Computes MSD and RoG values for each group.</span>
</span><span id="L-3158"><a href="#L-3158"><span class="linenos">3158</span></a><span class="sd">        - Groups MSD curves based on RoG bins and fits curves to them.</span>
</span><span id="L-3159"><a href="#L-3159"><span class="linenos">3159</span></a>
</span><span id="L-3160"><a href="#L-3160"><span class="linenos">3160</span></a><span class="sd">        Parameters:</span>
</span><span id="L-3161"><a href="#L-3161"><span class="linenos">3161</span></a><span class="sd">        -----------</span>
</span><span id="L-3162"><a href="#L-3162"><span class="linenos">3162</span></a><span class="sd">        data : pd.DataFrame</span>
</span><span id="L-3163"><a href="#L-3163"><span class="linenos">3163</span></a><span class="sd">            A dataset containing longitude and latitude coordinates.</span>
</span><span id="L-3164"><a href="#L-3164"><span class="linenos">3164</span></a>
</span><span id="L-3165"><a href="#L-3165"><span class="linenos">3165</span></a><span class="sd">        Returns:</span>
</span><span id="L-3166"><a href="#L-3166"><span class="linenos">3166</span></a><span class="sd">        --------</span>
</span><span id="L-3167"><a href="#L-3167"><span class="linenos">3167</span></a><span class="sd">        tuple:</span>
</span><span id="L-3168"><a href="#L-3168"><span class="linenos">3168</span></a><span class="sd">            - msd_results (pd.DataFrame): Summary of MSD curve fitting for</span>
</span><span id="L-3169"><a href="#L-3169"><span class="linenos">3169</span></a><span class="sd">                different RoG ranges.</span>
</span><span id="L-3170"><a href="#L-3170"><span class="linenos">3170</span></a><span class="sd">            - buffer (BytesIO): A buffer containing the saved MSD plot.</span>
</span><span id="L-3171"><a href="#L-3171"><span class="linenos">3171</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3172"><a href="#L-3172"><span class="linenos">3172</span></a>
</span><span id="L-3173"><a href="#L-3173"><span class="linenos">3173</span></a>        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
</span><span id="L-3174"><a href="#L-3174"><span class="linenos">3174</span></a>            <span class="n">data</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">points_from_xy</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">])</span>
</span><span id="L-3175"><a href="#L-3175"><span class="linenos">3175</span></a>        <span class="p">)</span>
</span><span id="L-3176"><a href="#L-3176"><span class="linenos">3176</span></a>        <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="mi">4326</span>
</span><span id="L-3177"><a href="#L-3177"><span class="linenos">3177</span></a>        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="mi">3857</span><span class="p">)</span>
</span><span id="L-3178"><a href="#L-3178"><span class="linenos">3178</span></a>        <span class="n">com</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="L-3179"><a href="#L-3179"><span class="linenos">3179</span></a>            <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">Point</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">z</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</span><span id="L-3180"><a href="#L-3180"><span class="linenos">3180</span></a>        <span class="p">)</span>
</span><span id="L-3181"><a href="#L-3181"><span class="linenos">3181</span></a>        <span class="n">starting_points</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-3182"><a href="#L-3182"><span class="linenos">3182</span></a>            <span class="n">gdf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">geometry</span>
</span><span id="L-3183"><a href="#L-3183"><span class="linenos">3183</span></a>        <span class="p">)</span>
</span><span id="L-3184"><a href="#L-3184"><span class="linenos">3184</span></a>        <span class="n">to_concat_msd</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-3185"><a href="#L-3185"><span class="linenos">3185</span></a>        <span class="n">to_concat_rog</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-3186"><a href="#L-3186"><span class="linenos">3186</span></a>        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-3187"><a href="#L-3187"><span class="linenos">3187</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;is_new&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">~</span><span class="n">vals</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
</span><span id="L-3188"><a href="#L-3188"><span class="linenos">3188</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">vals</span><span class="p">[</span><span class="s2">&quot;is_new&quot;</span><span class="p">]]</span>
</span><span id="L-3189"><a href="#L-3189"><span class="linenos">3189</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="L-3190"><a href="#L-3190"><span class="linenos">3190</span></a>            <span class="n">msd_ind</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">starting_points</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="L-3191"><a href="#L-3191"><span class="linenos">3191</span></a>            <span class="n">rog_ind</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">com</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="L-3192"><a href="#L-3192"><span class="linenos">3192</span></a>            <span class="n">msd_ind</span> <span class="o">=</span> <span class="n">groupwise_expansion</span><span class="p">(</span><span class="n">msd_ind</span><span class="p">)</span>
</span><span id="L-3193"><a href="#L-3193"><span class="linenos">3193</span></a>            <span class="n">to_concat_msd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msd_ind</span><span class="p">)</span>
</span><span id="L-3194"><a href="#L-3194"><span class="linenos">3194</span></a>            <span class="n">to_concat_rog</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rog_ind</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="L-3195"><a href="#L-3195"><span class="linenos">3195</span></a>        <span class="n">final_msd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">to_concat_msd</span><span class="p">)</span>
</span><span id="L-3196"><a href="#L-3196"><span class="linenos">3196</span></a>        <span class="n">final_rog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
</span><span id="L-3197"><a href="#L-3197"><span class="linenos">3197</span></a>            <span class="n">to_concat_rog</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span>
</span><span id="L-3198"><a href="#L-3198"><span class="linenos">3198</span></a>        <span class="p">)</span>
</span><span id="L-3199"><a href="#L-3199"><span class="linenos">3199</span></a>
</span><span id="L-3200"><a href="#L-3200"><span class="linenos">3200</span></a>        <span class="n">final_rog</span><span class="p">[</span><span class="s2">&quot;bins&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span>
</span><span id="L-3201"><a href="#L-3201"><span class="linenos">3201</span></a>            <span class="n">final_rog</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
</span><span id="L-3202"><a href="#L-3202"><span class="linenos">3202</span></a>            <span class="n">bins</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-3203"><a href="#L-3203"><span class="linenos">3203</span></a>                <span class="mi">0</span><span class="p">,</span> <span class="mf">2e3</span><span class="p">,</span> <span class="mf">4e3</span><span class="p">,</span> <span class="mf">8e3</span><span class="p">,</span> <span class="mf">16e3</span><span class="p">,</span> <span class="mf">32e3</span><span class="p">,</span> <span class="mf">64e3</span><span class="p">,</span> <span class="mf">128e3</span><span class="p">,</span> <span class="mf">256e3</span><span class="p">,</span> <span class="mf">512e3</span><span class="p">,</span> <span class="mf">1024e3</span>
</span><span id="L-3204"><a href="#L-3204"><span class="linenos">3204</span></a>            <span class="p">],</span>
</span><span id="L-3205"><a href="#L-3205"><span class="linenos">3205</span></a>        <span class="p">)</span>
</span><span id="L-3206"><a href="#L-3206"><span class="linenos">3206</span></a>        <span class="n">msd_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="L-3207"><a href="#L-3207"><span class="linenos">3207</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;RoG range [km]&quot;</span><span class="p">,</span> <span class="s2">&quot;curve&quot;</span><span class="p">,</span> <span class="s2">&quot;param1&quot;</span><span class="p">,</span> <span class="s2">&quot;param2&quot;</span><span class="p">]</span>
</span><span id="L-3208"><a href="#L-3208"><span class="linenos">3208</span></a>        <span class="p">)</span>
</span><span id="L-3209"><a href="#L-3209"><span class="linenos">3209</span></a>        <span class="n">buffer</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="L-3210"><a href="#L-3210"><span class="linenos">3210</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</span><span id="L-3211"><a href="#L-3211"><span class="linenos">3211</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
</span><span id="L-3212"><a href="#L-3212"><span class="linenos">3212</span></a>        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">final_rog</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;bins&quot;</span><span class="p">):</span>
</span><span id="L-3213"><a href="#L-3213"><span class="linenos">3213</span></a>            <span class="k">if</span> <span class="n">vals</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-3214"><a href="#L-3214"><span class="linenos">3214</span></a>                <span class="k">continue</span>
</span><span id="L-3215"><a href="#L-3215"><span class="linenos">3215</span></a>            <span class="k">if</span> <span class="n">vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-3216"><a href="#L-3216"><span class="linenos">3216</span></a>                <span class="k">continue</span>
</span><span id="L-3217"><a href="#L-3217"><span class="linenos">3217</span></a>            <span class="n">msd_pick</span> <span class="o">=</span> <span class="n">final_msd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
</span><span id="L-3218"><a href="#L-3218"><span class="linenos">3218</span></a>            <span class="n">msd_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
</span><span id="L-3219"><a href="#L-3219"><span class="linenos">3219</span></a>                <span class="n">msd_pick</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-3220"><a href="#L-3220"><span class="linenos">3220</span></a>            <span class="p">)</span>  <span class="c1"># find min number of rows for</span>
</span><span id="L-3221"><a href="#L-3221"><span class="linenos">3221</span></a>            <span class="c1"># individuals</span>
</span><span id="L-3222"><a href="#L-3222"><span class="linenos">3222</span></a>            <span class="n">msd_pick_avg</span> <span class="o">=</span> <span class="n">rowwise_average</span><span class="p">(</span><span class="n">msd_pick</span><span class="p">,</span> <span class="n">msd_rows</span><span class="p">)</span>
</span><span id="L-3223"><a href="#L-3223"><span class="linenos">3223</span></a>            <span class="k">try</span><span class="p">:</span>  <span class="c1"># now average rowwise</span>
</span><span id="L-3224"><a href="#L-3224"><span class="linenos">3224</span></a>                <span class="n">msd_chosen</span> <span class="o">=</span> <span class="n">DistributionFitingTools</span><span class="p">()</span><span class="o">.</span><span class="n">model_choose</span><span class="p">(</span>
</span><span id="L-3225"><a href="#L-3225"><span class="linenos">3225</span></a>                    <span class="n">msd_pick_avg</span>
</span><span id="L-3226"><a href="#L-3226"><span class="linenos">3226</span></a>                <span class="p">)</span>  <span class="c1"># pick model</span>
</span><span id="L-3227"><a href="#L-3227"><span class="linenos">3227</span></a>            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-3228"><a href="#L-3228"><span class="linenos">3228</span></a>                <span class="k">continue</span>
</span><span id="L-3229"><a href="#L-3229"><span class="linenos">3229</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">msd_chosen</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-3230"><a href="#L-3230"><span class="linenos">3230</span></a>                <span class="k">continue</span>
</span><span id="L-3231"><a href="#L-3231"><span class="linenos">3231</span></a>            <span class="n">avg_error</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span>
</span><span id="L-3232"><a href="#L-3232"><span class="linenos">3232</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">msd_pick_avg</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">msd_chosen</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="L-3233"><a href="#L-3233"><span class="linenos">3233</span></a>            <span class="p">)</span>
</span><span id="L-3234"><a href="#L-3234"><span class="linenos">3234</span></a>            <span class="k">if</span> <span class="n">avg_error</span> <span class="o">&lt;</span> <span class="mf">0.25</span><span class="p">:</span>
</span><span id="L-3235"><a href="#L-3235"><span class="linenos">3235</span></a>                <span class="k">continue</span>
</span><span id="L-3236"><a href="#L-3236"><span class="linenos">3236</span></a>            <span class="n">msd_results</span> <span class="o">=</span> <span class="n">msd_results</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span>
</span><span id="L-3237"><a href="#L-3237"><span class="linenos">3237</span></a>                <span class="p">{</span>
</span><span id="L-3238"><a href="#L-3238"><span class="linenos">3238</span></a>                    <span class="s2">&quot;RoG range [km]&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ind</span><span class="o">.</span><span class="n">left</span><span class="o">/</span><span class="mi">1000</span><span class="p">))</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ind</span><span class="o">.</span><span class="n">right</span><span class="o">/</span><span class="mi">1000</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-3239"><a href="#L-3239"><span class="linenos">3239</span></a>                    <span class="s2">&quot;curve&quot;</span><span class="p">:</span> <span class="n">msd_chosen</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span id="L-3240"><a href="#L-3240"><span class="linenos">3240</span></a>                    <span class="s2">&quot;param1&quot;</span><span class="p">:</span> <span class="n">msd_chosen</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-3241"><a href="#L-3241"><span class="linenos">3241</span></a>                    <span class="s2">&quot;param2&quot;</span><span class="p">:</span> <span class="n">msd_chosen</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
</span><span id="L-3242"><a href="#L-3242"><span class="linenos">3242</span></a>                <span class="p">},</span>
</span><span id="L-3243"><a href="#L-3243"><span class="linenos">3243</span></a>                <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-3244"><a href="#L-3244"><span class="linenos">3244</span></a>            <span class="p">)</span>
</span><span id="L-3245"><a href="#L-3245"><span class="linenos">3245</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">msd_rows</span><span class="p">),</span> <span class="n">msd_pick_avg</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-3246"><a href="#L-3246"><span class="linenos">3246</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="L-3247"><a href="#L-3247"><span class="linenos">3247</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">msd_pick_avg</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="L-3248"><a href="#L-3248"><span class="linenos">3248</span></a>                <span class="n">msd_chosen</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-3249"><a href="#L-3249"><span class="linenos">3249</span></a>                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;RoG:&lt;</span><span class="si">{</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ind</span><span class="o">.</span><span class="n">right</span><span class="o">/</span><span class="mi">1000</span><span class="p">))</span><span class="si">}</span><span class="s2">km (</span><span class="si">{</span><span class="n">vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-3250"><a href="#L-3250"><span class="linenos">3250</span></a>            <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-3251"><a href="#L-3251"><span class="linenos">3251</span></a>
</span><span id="L-3252"><a href="#L-3252"><span class="linenos">3252</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-3253"><a href="#L-3253"><span class="linenos">3253</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</span><span id="L-3254"><a href="#L-3254"><span class="linenos">3254</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
</span><span id="L-3255"><a href="#L-3255"><span class="linenos">3255</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;MSD&quot;</span><span class="p">)</span>
</span><span id="L-3256"><a href="#L-3256"><span class="linenos">3256</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="L-3257"><a href="#L-3257"><span class="linenos">3257</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-3258"><a href="#L-3258"><span class="linenos">3258</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="L-3259"><a href="#L-3259"><span class="linenos">3259</span></a>                <span class="s2">&quot;MSD split.png&quot;</span><span class="p">,</span>
</span><span id="L-3260"><a href="#L-3260"><span class="linenos">3260</span></a>            <span class="p">)</span>
</span><span id="L-3261"><a href="#L-3261"><span class="linenos">3261</span></a>        <span class="p">)</span>
</span><span id="L-3262"><a href="#L-3262"><span class="linenos">3262</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="L-3263"><a href="#L-3263"><span class="linenos">3263</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-3264"><a href="#L-3264"><span class="linenos">3264</span></a>        <span class="n">buffer</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-3265"><a href="#L-3265"><span class="linenos">3265</span></a>
</span><span id="L-3266"><a href="#L-3266"><span class="linenos">3266</span></a>        <span class="k">return</span> <span class="n">msd_results</span><span class="p">,</span> <span class="n">buffer</span>
</span><span id="L-3267"><a href="#L-3267"><span class="linenos">3267</span></a>
</span><span id="L-3268"><a href="#L-3268"><span class="linenos">3268</span></a>
</span><span id="L-3269"><a href="#L-3269"><span class="linenos">3269</span></a>    <span class="nd">@log_curve_fitting_resluts</span>
</span><span id="L-3270"><a href="#L-3270"><span class="linenos">3270</span></a>    <span class="nd">@check_curve_fit</span>
</span><span id="L-3271"><a href="#L-3271"><span class="linenos">3271</span></a>    <span class="k">def</span> <span class="nf">distinct_locations_over_time</span><span class="p">(</span>
</span><span id="L-3272"><a href="#L-3272"><span class="linenos">3272</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-3273"><a href="#L-3273"><span class="linenos">3273</span></a>        <span class="n">nrows</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="L-3274"><a href="#L-3274"><span class="linenos">3274</span></a>        <span class="n">n_data</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="L-3275"><a href="#L-3275"><span class="linenos">3275</span></a>        <span class="n">data</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span>
</span><span id="L-3276"><a href="#L-3276"><span class="linenos">3276</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-3277"><a href="#L-3277"><span class="linenos">3277</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3278"><a href="#L-3278"><span class="linenos">3278</span></a><span class="sd">        Computes the number of distinct locations visited over time.</span>
</span><span id="L-3279"><a href="#L-3279"><span class="linenos">3279</span></a>
</span><span id="L-3280"><a href="#L-3280"><span class="linenos">3280</span></a><span class="sd">        The function:</span>
</span><span id="L-3281"><a href="#L-3281"><span class="linenos">3281</span></a><span class="sd">        - Computes the cumulative number of distinct locations visited.</span>
</span><span id="L-3282"><a href="#L-3282"><span class="linenos">3282</span></a><span class="sd">        - Fits a curve to model the growth of visited locations over time.</span>
</span><span id="L-3283"><a href="#L-3283"><span class="linenos">3283</span></a>
</span><span id="L-3284"><a href="#L-3284"><span class="linenos">3284</span></a><span class="sd">        Parameters:</span>
</span><span id="L-3285"><a href="#L-3285"><span class="linenos">3285</span></a><span class="sd">        -----------</span>
</span><span id="L-3286"><a href="#L-3286"><span class="linenos">3286</span></a><span class="sd">        nrows : int</span>
</span><span id="L-3287"><a href="#L-3287"><span class="linenos">3287</span></a><span class="sd">            Number of rows in the dataset.</span>
</span><span id="L-3288"><a href="#L-3288"><span class="linenos">3288</span></a><span class="sd">        n_data : int</span>
</span><span id="L-3289"><a href="#L-3289"><span class="linenos">3289</span></a><span class="sd">            Total data points available.</span>
</span><span id="L-3290"><a href="#L-3290"><span class="linenos">3290</span></a><span class="sd">        data : pd.Series</span>
</span><span id="L-3291"><a href="#L-3291"><span class="linenos">3291</span></a><span class="sd">            A dataset containing the count of distinct locations.</span>
</span><span id="L-3292"><a href="#L-3292"><span class="linenos">3292</span></a>
</span><span id="L-3293"><a href="#L-3293"><span class="linenos">3293</span></a><span class="sd">        Returns:</span>
</span><span id="L-3294"><a href="#L-3294"><span class="linenos">3294</span></a><span class="sd">        --------</span>
</span><span id="L-3295"><a href="#L-3295"><span class="linenos">3295</span></a><span class="sd">        tuple:</span>
</span><span id="L-3296"><a href="#L-3296"><span class="linenos">3296</span></a><span class="sd">            - best_fit (str): Name of the best fitting model.</span>
</span><span id="L-3297"><a href="#L-3297"><span class="linenos">3297</span></a><span class="sd">            - global_params (dict): Parameters of the best fit.</span>
</span><span id="L-3298"><a href="#L-3298"><span class="linenos">3298</span></a><span class="sd">            - y_pred (ndarray): Predicted values from the curve fit.</span>
</span><span id="L-3299"><a href="#L-3299"><span class="linenos">3299</span></a><span class="sd">            - expon_y_pred (ndarray): Alternative exponential model</span>
</span><span id="L-3300"><a href="#L-3300"><span class="linenos">3300</span></a><span class="sd">                predictions.</span>
</span><span id="L-3301"><a href="#L-3301"><span class="linenos">3301</span></a><span class="sd">            - pd.Series(data): The input data as a pandas Series.</span>
</span><span id="L-3302"><a href="#L-3302"><span class="linenos">3302</span></a><span class="sd">            - [&quot;t&quot;, &quot;S(t)&quot;] (list): Column labels.</span>
</span><span id="L-3303"><a href="#L-3303"><span class="linenos">3303</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3304"><a href="#L-3304"><span class="linenos">3304</span></a>
</span><span id="L-3305"><a href="#L-3305"><span class="linenos">3305</span></a>        <span class="n">y_pred</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">best_fit_params</span><span class="p">,</span> <span class="n">global_params</span><span class="p">,</span> <span class="n">expon_y_pred</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-3306"><a href="#L-3306"><span class="linenos">3306</span></a>            <span class="n">DistributionFitingTools</span><span class="p">()</span><span class="o">.</span><span class="n">model_choose</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</span><span id="L-3307"><a href="#L-3307"><span class="linenos">3307</span></a>        <span class="p">)</span>
</span><span id="L-3308"><a href="#L-3308"><span class="linenos">3308</span></a>
</span><span id="L-3309"><a href="#L-3309"><span class="linenos">3309</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-3310"><a href="#L-3310"><span class="linenos">3310</span></a>            <span class="n">best_fit</span><span class="p">,</span>
</span><span id="L-3311"><a href="#L-3311"><span class="linenos">3311</span></a>            <span class="n">global_params</span><span class="p">,</span>
</span><span id="L-3312"><a href="#L-3312"><span class="linenos">3312</span></a>            <span class="n">y_pred</span><span class="p">,</span>
</span><span id="L-3313"><a href="#L-3313"><span class="linenos">3313</span></a>            <span class="n">expon_y_pred</span><span class="p">,</span>
</span><span id="L-3314"><a href="#L-3314"><span class="linenos">3314</span></a>            <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
</span><span id="L-3315"><a href="#L-3315"><span class="linenos">3315</span></a>            <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;S(t)&quot;</span><span class="p">],</span>
</span><span id="L-3316"><a href="#L-3316"><span class="linenos">3316</span></a>        <span class="p">)</span>
</span><span id="L-3317"><a href="#L-3317"><span class="linenos">3317</span></a>
</span><span id="L-3318"><a href="#L-3318"><span class="linenos">3318</span></a>
</span><span id="L-3319"><a href="#L-3319"><span class="linenos">3319</span></a>    <span class="nd">@log_pnew_estimation</span>
</span><span id="L-3320"><a href="#L-3320"><span class="linenos">3320</span></a>    <span class="k">def</span> <span class="nf">estimate_pnew</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filled_data</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-3321"><a href="#L-3321"><span class="linenos">3321</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3322"><a href="#L-3322"><span class="linenos">3322</span></a><span class="sd">        Estimates parameters (rho, gamma) for the probability of</span>
</span><span id="L-3323"><a href="#L-3323"><span class="linenos">3323</span></a><span class="sd">        discovering new locations.</span>
</span><span id="L-3324"><a href="#L-3324"><span class="linenos">3324</span></a>
</span><span id="L-3325"><a href="#L-3325"><span class="linenos">3325</span></a><span class="sd">        The function:</span>
</span><span id="L-3326"><a href="#L-3326"><span class="linenos">3326</span></a><span class="sd">        - Computes the rate of discovery of new locations (P_new).</span>
</span><span id="L-3327"><a href="#L-3327"><span class="linenos">3327</span></a><span class="sd">        - Fits a linear model in log-log space to estimate the parameters.</span>
</span><span id="L-3328"><a href="#L-3328"><span class="linenos">3328</span></a>
</span><span id="L-3329"><a href="#L-3329"><span class="linenos">3329</span></a><span class="sd">        Parameters:</span>
</span><span id="L-3330"><a href="#L-3330"><span class="linenos">3330</span></a><span class="sd">        -----------</span>
</span><span id="L-3331"><a href="#L-3331"><span class="linenos">3331</span></a><span class="sd">        nrows : int</span>
</span><span id="L-3332"><a href="#L-3332"><span class="linenos">3332</span></a><span class="sd">            Number of rows in the dataset.</span>
</span><span id="L-3333"><a href="#L-3333"><span class="linenos">3333</span></a><span class="sd">        n_data : int</span>
</span><span id="L-3334"><a href="#L-3334"><span class="linenos">3334</span></a><span class="sd">            Total data points available.</span>
</span><span id="L-3335"><a href="#L-3335"><span class="linenos">3335</span></a><span class="sd">        S_t : list or np.array</span>
</span><span id="L-3336"><a href="#L-3336"><span class="linenos">3336</span></a><span class="sd">            Sequence of distinct locations visited over time.</span>
</span><span id="L-3337"><a href="#L-3337"><span class="linenos">3337</span></a>
</span><span id="L-3338"><a href="#L-3338"><span class="linenos">3338</span></a><span class="sd">        Returns:</span>
</span><span id="L-3339"><a href="#L-3339"><span class="linenos">3339</span></a><span class="sd">        --------</span>
</span><span id="L-3340"><a href="#L-3340"><span class="linenos">3340</span></a><span class="sd">        tuple:</span>
</span><span id="L-3341"><a href="#L-3341"><span class="linenos">3341</span></a><span class="sd">            - rho_hat (float): Estimated rho parameter.</span>
</span><span id="L-3342"><a href="#L-3342"><span class="linenos">3342</span></a><span class="sd">            - gamma_hat (float): Estimated gamma parameter.</span>
</span><span id="L-3343"><a href="#L-3343"><span class="linenos">3343</span></a><span class="sd">            - DeltaS (np.array): Changes in S(t).</span>
</span><span id="L-3344"><a href="#L-3344"><span class="linenos">3344</span></a><span class="sd">            - S_mid (np.array): Midpoints of S(t).</span>
</span><span id="L-3345"><a href="#L-3345"><span class="linenos">3345</span></a><span class="sd">            - intercept (float): Intercept of the log-log regression.</span>
</span><span id="L-3346"><a href="#L-3346"><span class="linenos">3346</span></a><span class="sd">            - slope (float): Slope of the log-log regression (negative gamma).</span>
</span><span id="L-3347"><a href="#L-3347"><span class="linenos">3347</span></a><span class="sd">            - nrows (int): Number of rows in the dataset.</span>
</span><span id="L-3348"><a href="#L-3348"><span class="linenos">3348</span></a><span class="sd">            - n_data (int): Total data points available.</span>
</span><span id="L-3349"><a href="#L-3349"><span class="linenos">3349</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3350"><a href="#L-3350"><span class="linenos">3350</span></a>        <span class="n">filled_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;filled_data.csv&quot;</span><span class="p">)</span>
</span><span id="L-3351"><a href="#L-3351"><span class="linenos">3351</span></a>        <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filled_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</span><span id="L-3352"><a href="#L-3352"><span class="linenos">3352</span></a>        <span class="n">t_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-3353"><a href="#L-3353"><span class="linenos">3353</span></a>
</span><span id="L-3354"><a href="#L-3354"><span class="linenos">3354</span></a>        <span class="n">n_array</span> <span class="o">=</span> <span class="n">filled_data</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>
</span><span id="L-3355"><a href="#L-3355"><span class="linenos">3355</span></a>        <span class="n">n_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">n_array</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)])</span>
</span><span id="L-3356"><a href="#L-3356"><span class="linenos">3356</span></a>
</span><span id="L-3357"><a href="#L-3357"><span class="linenos">3357</span></a>
</span><span id="L-3358"><a href="#L-3358"><span class="linenos">3358</span></a>        <span class="n">S_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">filled_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s1">&#39;new_sum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)])</span>
</span><span id="L-3359"><a href="#L-3359"><span class="linenos">3359</span></a>
</span><span id="L-3360"><a href="#L-3360"><span class="linenos">3360</span></a>        <span class="n">fit_n</span> <span class="o">=</span> <span class="n">powerlaw</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">n_array</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="n">discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-3361"><a href="#L-3361"><span class="linenos">3361</span></a>        <span class="n">beta_est</span> <span class="o">=</span> <span class="n">fit_n</span><span class="o">.</span><span class="n">power_law</span><span class="o">.</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-3362"><a href="#L-3362"><span class="linenos">3362</span></a>        <span class="n">C_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n_array</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">)</span> <span class="o">-</span> <span class="n">beta_est</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">t_array</span><span class="p">)))</span>
</span><span id="L-3363"><a href="#L-3363"><span class="linenos">3363</span></a>
</span><span id="L-3364"><a href="#L-3364"><span class="linenos">3364</span></a>        <span class="n">fit_s</span> <span class="o">=</span> <span class="n">powerlaw</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">S_array</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="n">discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-3365"><a href="#L-3365"><span class="linenos">3365</span></a>        <span class="n">alpha_est</span> <span class="o">=</span> <span class="n">fit_s</span><span class="o">.</span><span class="n">power_law</span><span class="o">.</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-3366"><a href="#L-3366"><span class="linenos">3366</span></a>        <span class="n">K_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">S_array</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">)</span> <span class="o">-</span> <span class="n">alpha_est</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">t_array</span><span class="p">)))</span>
</span><span id="L-3367"><a href="#L-3367"><span class="linenos">3367</span></a>
</span><span id="L-3368"><a href="#L-3368"><span class="linenos">3368</span></a>        <span class="c1"># Gamma from theory</span>
</span><span id="L-3369"><a href="#L-3369"><span class="linenos">3369</span></a>        <span class="n">gamma_est</span> <span class="o">=</span> <span class="n">beta_est</span> <span class="o">/</span> <span class="n">alpha_est</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-3370"><a href="#L-3370"><span class="linenos">3370</span></a>
</span><span id="L-3371"><a href="#L-3371"><span class="linenos">3371</span></a>        <span class="c1"># Estimate rho from prefactor relation</span>
</span><span id="L-3372"><a href="#L-3372"><span class="linenos">3372</span></a>        <span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">K_est</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">gamma_est</span><span class="p">)</span>
</span><span id="L-3373"><a href="#L-3373"><span class="linenos">3373</span></a>        <span class="n">den</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">gamma_est</span><span class="p">)</span>
</span><span id="L-3374"><a href="#L-3374"><span class="linenos">3374</span></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">num</span> <span class="o">/</span> <span class="n">den</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">C_est</span><span class="p">)</span>
</span><span id="L-3375"><a href="#L-3375"><span class="linenos">3375</span></a>        <span class="n">rho_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</span><span id="L-3376"><a href="#L-3376"><span class="linenos">3376</span></a>
</span><span id="L-3377"><a href="#L-3377"><span class="linenos">3377</span></a>        <span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma_est</span>
</span><span id="L-3378"><a href="#L-3378"><span class="linenos">3378</span></a>        <span class="n">rho</span> <span class="o">=</span> <span class="n">rho_est</span>
</span><span id="L-3379"><a href="#L-3379"><span class="linenos">3379</span></a>
</span><span id="L-3380"><a href="#L-3380"><span class="linenos">3380</span></a>
</span><span id="L-3381"><a href="#L-3381"><span class="linenos">3381</span></a>        <span class="n">DeltaS</span> <span class="o">=</span> <span class="n">S_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">S_array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-3382"><a href="#L-3382"><span class="linenos">3382</span></a>        <span class="n">S_mid</span> <span class="o">=</span> <span class="n">S_array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-3383"><a href="#L-3383"><span class="linenos">3383</span></a>        <span class="n">slope</span> <span class="o">=</span> <span class="o">-</span><span class="n">gamma</span>
</span><span id="L-3384"><a href="#L-3384"><span class="linenos">3384</span></a>        <span class="n">intercept</span> <span class="o">=</span> <span class="n">temp</span>
</span><span id="L-3385"><a href="#L-3385"><span class="linenos">3385</span></a>
</span><span id="L-3386"><a href="#L-3386"><span class="linenos">3386</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">DeltaS</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">S_mid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-3387"><a href="#L-3387"><span class="linenos">3387</span></a>        <span class="n">DeltaS</span> <span class="o">=</span> <span class="n">DeltaS</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span><span id="L-3388"><a href="#L-3388"><span class="linenos">3388</span></a>        <span class="n">S_mid</span> <span class="o">=</span> <span class="n">S_mid</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span><span id="L-3389"><a href="#L-3389"><span class="linenos">3389</span></a>
</span><span id="L-3390"><a href="#L-3390"><span class="linenos">3390</span></a>        <span class="c1"># S_t = np.array(S_t)</span>
</span><span id="L-3391"><a href="#L-3391"><span class="linenos">3391</span></a>        <span class="c1"># DeltaS = S_t[1:] - S_t[:-1]</span>
</span><span id="L-3392"><a href="#L-3392"><span class="linenos">3392</span></a>        <span class="c1"># S_mid = S_t[:-1]</span>
</span><span id="L-3393"><a href="#L-3393"><span class="linenos">3393</span></a>        <span class="c1"># mask = (DeltaS &gt; 0) &amp; (S_mid &gt; 0)</span>
</span><span id="L-3394"><a href="#L-3394"><span class="linenos">3394</span></a>        <span class="c1"># DeltaS = DeltaS[mask]</span>
</span><span id="L-3395"><a href="#L-3395"><span class="linenos">3395</span></a>        <span class="c1"># S_mid = S_mid[mask]</span>
</span><span id="L-3396"><a href="#L-3396"><span class="linenos">3396</span></a>
</span><span id="L-3397"><a href="#L-3397"><span class="linenos">3397</span></a>        <span class="c1"># X = np.log(S_mid).reshape(-1, 1)  # predictor</span>
</span><span id="L-3398"><a href="#L-3398"><span class="linenos">3398</span></a>        <span class="c1"># y = np.log(DeltaS)  # response</span>
</span><span id="L-3399"><a href="#L-3399"><span class="linenos">3399</span></a>
</span><span id="L-3400"><a href="#L-3400"><span class="linenos">3400</span></a>        <span class="c1"># model = LinearRegression()</span>
</span><span id="L-3401"><a href="#L-3401"><span class="linenos">3401</span></a>        <span class="c1"># model.fit(X, y)</span>
</span><span id="L-3402"><a href="#L-3402"><span class="linenos">3402</span></a>
</span><span id="L-3403"><a href="#L-3403"><span class="linenos">3403</span></a>        <span class="c1"># slope = model.coef_[0]</span>
</span><span id="L-3404"><a href="#L-3404"><span class="linenos">3404</span></a>        <span class="c1"># intercept = model.intercept_</span>
</span><span id="L-3405"><a href="#L-3405"><span class="linenos">3405</span></a>        <span class="c1"># gamma_est = -slope</span>
</span><span id="L-3406"><a href="#L-3406"><span class="linenos">3406</span></a>        <span class="c1"># rho_est = np.exp(intercept)</span>
</span><span id="L-3407"><a href="#L-3407"><span class="linenos">3407</span></a>
</span><span id="L-3408"><a href="#L-3408"><span class="linenos">3408</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-3409"><a href="#L-3409"><span class="linenos">3409</span></a>            <span class="n">rho</span><span class="p">,</span>
</span><span id="L-3410"><a href="#L-3410"><span class="linenos">3410</span></a>            <span class="n">gamma</span><span class="p">,</span>
</span><span id="L-3411"><a href="#L-3411"><span class="linenos">3411</span></a>            <span class="n">DeltaS</span><span class="p">,</span>
</span><span id="L-3412"><a href="#L-3412"><span class="linenos">3412</span></a>            <span class="n">S_mid</span><span class="p">,</span>
</span><span id="L-3413"><a href="#L-3413"><span class="linenos">3413</span></a>            <span class="n">intercept</span><span class="p">,</span>
</span><span id="L-3414"><a href="#L-3414"><span class="linenos">3414</span></a>            <span class="n">slope</span><span class="p">,</span>
</span><span id="L-3415"><a href="#L-3415"><span class="linenos">3415</span></a>            <span class="n">nrows</span><span class="p">,</span>
</span><span id="L-3416"><a href="#L-3416"><span class="linenos">3416</span></a>            <span class="n">t_array</span>
</span><span id="L-3417"><a href="#L-3417"><span class="linenos">3417</span></a>            <span class="p">)</span>
</span><span id="L-3418"><a href="#L-3418"><span class="linenos">3418</span></a>
</span><span id="L-3419"><a href="#L-3419"><span class="linenos">3419</span></a>
</span><span id="L-3420"><a href="#L-3420"><span class="linenos">3420</span></a>
</span><span id="L-3421"><a href="#L-3421"><span class="linenos">3421</span></a><span class="k">class</span> <span class="nc">ScalingLawsCalc</span><span class="p">:</span>
</span><span id="L-3422"><a href="#L-3422"><span class="linenos">3422</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3423"><a href="#L-3423"><span class="linenos">3423</span></a><span class="sd">    A class for processing animal trajectory data, performing</span>
</span><span id="L-3424"><a href="#L-3424"><span class="linenos">3424</span></a><span class="sd">    statistical analyses, and generating a PDF report with results.</span>
</span><span id="L-3425"><a href="#L-3425"><span class="linenos">3425</span></a>
</span><span id="L-3426"><a href="#L-3426"><span class="linenos">3426</span></a><span class="sd">    Attributes:</span>
</span><span id="L-3427"><a href="#L-3427"><span class="linenos">3427</span></a><span class="sd">        data (TrajectoriesFrame): The trajectory data of animals.</span>
</span><span id="L-3428"><a href="#L-3428"><span class="linenos">3428</span></a><span class="sd">        animal_name (str): Name of the dataset.</span>
</span><span id="L-3429"><a href="#L-3429"><span class="linenos">3429</span></a><span class="sd">        output_dir (str): Directory to store the output files.</span>
</span><span id="L-3430"><a href="#L-3430"><span class="linenos">3430</span></a><span class="sd">        output_dir_animal (str): Path for the specific dataset output.</span>
</span><span id="L-3431"><a href="#L-3431"><span class="linenos">3431</span></a><span class="sd">        pdf (FPDF): PDF object to generate reports.</span>
</span><span id="L-3432"><a href="#L-3432"><span class="linenos">3432</span></a><span class="sd">        stats_frame (DataSetStats): Object for tracking dataset statistics.</span>
</span><span id="L-3433"><a href="#L-3433"><span class="linenos">3433</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3434"><a href="#L-3434"><span class="linenos">3434</span></a>
</span><span id="L-3435"><a href="#L-3435"><span class="linenos">3435</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-3436"><a href="#L-3436"><span class="linenos">3436</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-3437"><a href="#L-3437"><span class="linenos">3437</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span>
</span><span id="L-3438"><a href="#L-3438"><span class="linenos">3438</span></a>        <span class="n">data_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-3439"><a href="#L-3439"><span class="linenos">3439</span></a>        <span class="n">output_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-3440"><a href="#L-3440"><span class="linenos">3440</span></a>        <span class="n">stats_frame</span><span class="p">:</span> <span class="n">DataSetStats</span><span class="p">,</span>
</span><span id="L-3441"><a href="#L-3441"><span class="linenos">3441</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3442"><a href="#L-3442"><span class="linenos">3442</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3443"><a href="#L-3443"><span class="linenos">3443</span></a><span class="sd">        Initializes the ScalingLawsCalc class.</span>
</span><span id="L-3444"><a href="#L-3444"><span class="linenos">3444</span></a>
</span><span id="L-3445"><a href="#L-3445"><span class="linenos">3445</span></a><span class="sd">        Args:</span>
</span><span id="L-3446"><a href="#L-3446"><span class="linenos">3446</span></a><span class="sd">            data (TrajectoriesFrame): The trajectory dataset.</span>
</span><span id="L-3447"><a href="#L-3447"><span class="linenos">3447</span></a><span class="sd">            data_name (str): The name of the dataset.</span>
</span><span id="L-3448"><a href="#L-3448"><span class="linenos">3448</span></a><span class="sd">            output_dir (str): Directory to save output files.</span>
</span><span id="L-3449"><a href="#L-3449"><span class="linenos">3449</span></a><span class="sd">            stats_frame (DataSetStats): Object to store statistics</span>
</span><span id="L-3450"><a href="#L-3450"><span class="linenos">3450</span></a><span class="sd">                of the dataset.</span>
</span><span id="L-3451"><a href="#L-3451"><span class="linenos">3451</span></a>
</span><span id="L-3452"><a href="#L-3452"><span class="linenos">3452</span></a><span class="sd">        Raises:</span>
</span><span id="L-3453"><a href="#L-3453"><span class="linenos">3453</span></a><span class="sd">            FileExistsError: If the output directory for the dataset</span>
</span><span id="L-3454"><a href="#L-3454"><span class="linenos">3454</span></a><span class="sd">                already exists.</span>
</span><span id="L-3455"><a href="#L-3455"><span class="linenos">3455</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3456"><a href="#L-3456"><span class="linenos">3456</span></a>
</span><span id="L-3457"><a href="#L-3457"><span class="linenos">3457</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="L-3458"><a href="#L-3458"><span class="linenos">3458</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span> <span class="o">=</span> <span class="n">data_name</span>
</span><span id="L-3459"><a href="#L-3459"><span class="linenos">3459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">output_dir</span>
</span><span id="L-3460"><a href="#L-3460"><span class="linenos">3460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">data_name</span><span class="p">)</span>
</span><span id="L-3461"><a href="#L-3461"><span class="linenos">3461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span> <span class="o">=</span> <span class="n">FPDF</span><span class="p">()</span>
</span><span id="L-3462"><a href="#L-3462"><span class="linenos">3462</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span> <span class="o">=</span> <span class="n">stats_frame</span>
</span><span id="L-3463"><a href="#L-3463"><span class="linenos">3463</span></a>
</span><span id="L-3464"><a href="#L-3464"><span class="linenos">3464</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-3465"><a href="#L-3465"><span class="linenos">3465</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span><span class="p">)</span>
</span><span id="L-3466"><a href="#L-3466"><span class="linenos">3466</span></a>        <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
</span><span id="L-3467"><a href="#L-3467"><span class="linenos">3467</span></a>            <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span>
</span><span id="L-3468"><a href="#L-3468"><span class="linenos">3468</span></a>                <span class="sa">f</span><span class="s2">&quot;The directory </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span><span class="si">}</span><span class="s2"> already exists. &quot;</span>
</span><span id="L-3469"><a href="#L-3469"><span class="linenos">3469</span></a>                <span class="sa">f</span><span class="s2">&quot;Please remove it or specify a different name.&quot;</span>
</span><span id="L-3470"><a href="#L-3470"><span class="linenos">3470</span></a>            <span class="p">)</span>
</span><span id="L-3471"><a href="#L-3471"><span class="linenos">3471</span></a>
</span><span id="L-3472"><a href="#L-3472"><span class="linenos">3472</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span><span id="L-3473"><a href="#L-3473"><span class="linenos">3473</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">set_auto_page_break</span><span class="p">(</span><span class="n">auto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</span><span id="L-3474"><a href="#L-3474"><span class="linenos">3474</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="L-3475"><a href="#L-3475"><span class="linenos">3475</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="L-3476"><a href="#L-3476"><span class="linenos">3476</span></a>            <span class="mi">200</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ln</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="L-3477"><a href="#L-3477"><span class="linenos">3477</span></a>        <span class="p">)</span>
</span><span id="L-3478"><a href="#L-3478"><span class="linenos">3478</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</span><span id="L-3479"><a href="#L-3479"><span class="linenos">3479</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-3480"><a href="#L-3480"><span class="linenos">3480</span></a>
</span><span id="L-3481"><a href="#L-3481"><span class="linenos">3481</span></a>
</span><span id="L-3482"><a href="#L-3482"><span class="linenos">3482</span></a>    <span class="k">def</span> <span class="nf">_preprocess_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="L-3483"><a href="#L-3483"><span class="linenos">3483</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3484"><a href="#L-3484"><span class="linenos">3484</span></a><span class="sd">        Preprocesses the trajectory data by filtering, converting</span>
</span><span id="L-3485"><a href="#L-3485"><span class="linenos">3485</span></a><span class="sd">        coordinate systems, and calculating summary statistics.</span>
</span><span id="L-3486"><a href="#L-3486"><span class="linenos">3486</span></a>
</span><span id="L-3487"><a href="#L-3487"><span class="linenos">3487</span></a><span class="sd">        Returns:</span>
</span><span id="L-3488"><a href="#L-3488"><span class="linenos">3488</span></a><span class="sd">            TrajectoriesFrame: The preprocessed trajectory data.</span>
</span><span id="L-3489"><a href="#L-3489"><span class="linenos">3489</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3490"><a href="#L-3490"><span class="linenos">3490</span></a>
</span><span id="L-3491"><a href="#L-3491"><span class="linenos">3491</span></a>        <span class="n">preproc</span> <span class="o">=</span> <span class="n">Prepocessing</span><span class="p">()</span>
</span><span id="L-3492"><a href="#L-3492"><span class="linenos">3492</span></a>        <span class="n">stats</span> <span class="o">=</span> <span class="n">Stats</span><span class="p">()</span>
</span><span id="L-3493"><a href="#L-3493"><span class="linenos">3493</span></a>        <span class="n">mean_points_values</span> <span class="o">=</span> <span class="n">preproc</span><span class="o">.</span><span class="n">get_mean_points</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-3494"><a href="#L-3494"><span class="linenos">3494</span></a>        <span class="n">compressed_points</span> <span class="o">=</span> <span class="n">preproc</span><span class="o">.</span><span class="n">set_start_stop_time</span><span class="p">(</span><span class="n">mean_points_values</span><span class="p">)</span>
</span><span id="L-3495"><a href="#L-3495"><span class="linenos">3495</span></a>        <span class="n">converted_to_cartesian</span> <span class="o">=</span> <span class="n">preproc</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">compressed_points</span><span class="p">)</span>
</span><span id="L-3496"><a href="#L-3496"><span class="linenos">3496</span></a>        <span class="n">filtered_animals</span> <span class="o">=</span> <span class="n">preproc</span><span class="o">.</span><span class="n">filter_by_quartiles</span><span class="p">(</span><span class="n">converted_to_cartesian</span><span class="p">)</span>
</span><span id="L-3497"><a href="#L-3497"><span class="linenos">3497</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;animal_no&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_animals_no</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)})</span>
</span><span id="L-3498"><a href="#L-3498"><span class="linenos">3498</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3499"><a href="#L-3499"><span class="linenos">3499</span></a>            <span class="p">{</span><span class="s2">&quot;animal_after_filtration&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_animals_no</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="L-3500"><a href="#L-3500"><span class="linenos">3500</span></a>        <span class="p">)</span>
</span><span id="L-3501"><a href="#L-3501"><span class="linenos">3501</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;time_period&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_period</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)})</span>
</span><span id="L-3502"><a href="#L-3502"><span class="linenos">3502</span></a>
</span><span id="L-3503"><a href="#L-3503"><span class="linenos">3503</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3504"><a href="#L-3504"><span class="linenos">3504</span></a>            <span class="p">{</span>
</span><span id="L-3505"><a href="#L-3505"><span class="linenos">3505</span></a>                <span class="s2">&quot;min_label_no&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="L-3506"><a href="#L-3506"><span class="linenos">3506</span></a>                    <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;user_id : </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;no: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="L-3507"><a href="#L-3507"><span class="linenos">3507</span></a>                    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_min_labels_no_after_filtration</span><span class="p">(</span>
</span><span id="L-3508"><a href="#L-3508"><span class="linenos">3508</span></a>                        <span class="n">filtered_animals</span>
</span><span id="L-3509"><a href="#L-3509"><span class="linenos">3509</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="L-3510"><a href="#L-3510"><span class="linenos">3510</span></a>                <span class="p">]</span>
</span><span id="L-3511"><a href="#L-3511"><span class="linenos">3511</span></a>            <span class="p">}</span>
</span><span id="L-3512"><a href="#L-3512"><span class="linenos">3512</span></a>        <span class="p">)</span>
</span><span id="L-3513"><a href="#L-3513"><span class="linenos">3513</span></a>
</span><span id="L-3514"><a href="#L-3514"><span class="linenos">3514</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3515"><a href="#L-3515"><span class="linenos">3515</span></a>            <span class="p">{</span>
</span><span id="L-3516"><a href="#L-3516"><span class="linenos">3516</span></a>                <span class="s2">&quot;min_records&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="L-3517"><a href="#L-3517"><span class="linenos">3517</span></a>                    <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;user_id : </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;no: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="L-3518"><a href="#L-3518"><span class="linenos">3518</span></a>                    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_min_records_no_before_filtration</span><span class="p">(</span>
</span><span id="L-3519"><a href="#L-3519"><span class="linenos">3519</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
</span><span id="L-3520"><a href="#L-3520"><span class="linenos">3520</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="L-3521"><a href="#L-3521"><span class="linenos">3521</span></a>                <span class="p">]</span>
</span><span id="L-3522"><a href="#L-3522"><span class="linenos">3522</span></a>            <span class="p">}</span>
</span><span id="L-3523"><a href="#L-3523"><span class="linenos">3523</span></a>        <span class="p">)</span>
</span><span id="L-3524"><a href="#L-3524"><span class="linenos">3524</span></a>
</span><span id="L-3525"><a href="#L-3525"><span class="linenos">3525</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3526"><a href="#L-3526"><span class="linenos">3526</span></a>            <span class="p">{</span><span class="s2">&quot;avg_duration&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_mean_periods</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="L-3527"><a href="#L-3527"><span class="linenos">3527</span></a>        <span class="p">)</span>
</span><span id="L-3528"><a href="#L-3528"><span class="linenos">3528</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3529"><a href="#L-3529"><span class="linenos">3529</span></a>            <span class="p">{</span><span class="s2">&quot;min_duration&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_min_periods</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="L-3530"><a href="#L-3530"><span class="linenos">3530</span></a>        <span class="p">)</span>
</span><span id="L-3531"><a href="#L-3531"><span class="linenos">3531</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3532"><a href="#L-3532"><span class="linenos">3532</span></a>            <span class="p">{</span><span class="s2">&quot;max_duration&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_max_periods</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="L-3533"><a href="#L-3533"><span class="linenos">3533</span></a>        <span class="p">)</span>
</span><span id="L-3534"><a href="#L-3534"><span class="linenos">3534</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3535"><a href="#L-3535"><span class="linenos">3535</span></a>            <span class="p">{</span><span class="s2">&quot;overall_set_area&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_overall_area</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="L-3536"><a href="#L-3536"><span class="linenos">3536</span></a>        <span class="p">)</span>
</span><span id="L-3537"><a href="#L-3537"><span class="linenos">3537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3538"><a href="#L-3538"><span class="linenos">3538</span></a>            <span class="p">{</span><span class="s2">&quot;average_set_area&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_mean_area</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="L-3539"><a href="#L-3539"><span class="linenos">3539</span></a>        <span class="p">)</span>
</span><span id="L-3540"><a href="#L-3540"><span class="linenos">3540</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3541"><a href="#L-3541"><span class="linenos">3541</span></a>            <span class="p">{</span><span class="s2">&quot;min_area&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_min_area</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="L-3542"><a href="#L-3542"><span class="linenos">3542</span></a>        <span class="p">)</span>
</span><span id="L-3543"><a href="#L-3543"><span class="linenos">3543</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3544"><a href="#L-3544"><span class="linenos">3544</span></a>            <span class="p">{</span><span class="s2">&quot;max_area&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_max_area</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="L-3545"><a href="#L-3545"><span class="linenos">3545</span></a>        <span class="p">)</span>
</span><span id="L-3546"><a href="#L-3546"><span class="linenos">3546</span></a>
</span><span id="L-3547"><a href="#L-3547"><span class="linenos">3547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3548"><a href="#L-3548"><span class="linenos">3548</span></a>            <span class="p">{</span>
</span><span id="L-3549"><a href="#L-3549"><span class="linenos">3549</span></a>                <span class="s2">&quot;mean_label_no&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_mean_labels_no_after_filtration</span><span class="p">(</span>
</span><span id="L-3550"><a href="#L-3550"><span class="linenos">3550</span></a>                    <span class="n">filtered_animals</span>
</span><span id="L-3551"><a href="#L-3551"><span class="linenos">3551</span></a>                <span class="p">)</span>
</span><span id="L-3552"><a href="#L-3552"><span class="linenos">3552</span></a>            <span class="p">}</span>
</span><span id="L-3553"><a href="#L-3553"><span class="linenos">3553</span></a>        <span class="p">)</span>
</span><span id="L-3554"><a href="#L-3554"><span class="linenos">3554</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3555"><a href="#L-3555"><span class="linenos">3555</span></a>            <span class="p">{</span><span class="s2">&quot;std_label_no&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_std_labels_no_after_filtration</span><span class="p">(</span>
</span><span id="L-3556"><a href="#L-3556"><span class="linenos">3556</span></a>                <span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="L-3557"><a href="#L-3557"><span class="linenos">3557</span></a>            <span class="p">}</span>
</span><span id="L-3558"><a href="#L-3558"><span class="linenos">3558</span></a>        <span class="p">)</span>
</span><span id="L-3559"><a href="#L-3559"><span class="linenos">3559</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3560"><a href="#L-3560"><span class="linenos">3560</span></a>            <span class="p">{</span><span class="s2">&quot;mean_records&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_mean_records_no_before_filtration</span><span class="p">(</span>
</span><span id="L-3561"><a href="#L-3561"><span class="linenos">3561</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-3562"><a href="#L-3562"><span class="linenos">3562</span></a>            <span class="p">}</span>
</span><span id="L-3563"><a href="#L-3563"><span class="linenos">3563</span></a>        <span class="p">)</span>
</span><span id="L-3564"><a href="#L-3564"><span class="linenos">3564</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3565"><a href="#L-3565"><span class="linenos">3565</span></a>            <span class="p">{</span><span class="s2">&quot;std_records&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_std_records_no_before_filtration</span><span class="p">(</span>
</span><span id="L-3566"><a href="#L-3566"><span class="linenos">3566</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-3567"><a href="#L-3567"><span class="linenos">3567</span></a>            <span class="p">}</span>
</span><span id="L-3568"><a href="#L-3568"><span class="linenos">3568</span></a>        <span class="p">)</span>
</span><span id="L-3569"><a href="#L-3569"><span class="linenos">3569</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3570"><a href="#L-3570"><span class="linenos">3570</span></a>            <span class="p">{</span><span class="s2">&quot;std_duration&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_std_periods</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="L-3571"><a href="#L-3571"><span class="linenos">3571</span></a>        <span class="p">)</span>
</span><span id="L-3572"><a href="#L-3572"><span class="linenos">3572</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="L-3573"><a href="#L-3573"><span class="linenos">3573</span></a>            <span class="p">{</span><span class="s2">&quot;std_area&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_std_area</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="L-3574"><a href="#L-3574"><span class="linenos">3574</span></a>        <span class="p">)</span>
</span><span id="L-3575"><a href="#L-3575"><span class="linenos">3575</span></a>
</span><span id="L-3576"><a href="#L-3576"><span class="linenos">3576</span></a>        <span class="k">return</span> <span class="n">filtered_animals</span>
</span><span id="L-3577"><a href="#L-3577"><span class="linenos">3577</span></a>
</span><span id="L-3578"><a href="#L-3578"><span class="linenos">3578</span></a>
</span><span id="L-3579"><a href="#L-3579"><span class="linenos">3579</span></a>    <span class="k">def</span> <span class="nf">_advenced_preprocessing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-3580"><a href="#L-3580"><span class="linenos">3580</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3581"><a href="#L-3581"><span class="linenos">3581</span></a><span class="sd">        Performs advanced preprocessing by filtering, filling missing data,</span>
</span><span id="L-3582"><a href="#L-3582"><span class="linenos">3582</span></a><span class="sd">        and calculating distinct locations over time.</span>
</span><span id="L-3583"><a href="#L-3583"><span class="linenos">3583</span></a>
</span><span id="L-3584"><a href="#L-3584"><span class="linenos">3584</span></a><span class="sd">        Returns:</span>
</span><span id="L-3585"><a href="#L-3585"><span class="linenos">3585</span></a><span class="sd">            tuple: Processed data, number of rows, data index, and unique</span>
</span><span id="L-3586"><a href="#L-3586"><span class="linenos">3586</span></a><span class="sd">                locations count.</span>
</span><span id="L-3587"><a href="#L-3587"><span class="linenos">3587</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3588"><a href="#L-3588"><span class="linenos">3588</span></a>
</span><span id="L-3589"><a href="#L-3589"><span class="linenos">3589</span></a>        <span class="n">preproc</span> <span class="o">=</span> <span class="n">Prepocessing</span><span class="p">()</span>
</span><span id="L-3590"><a href="#L-3590"><span class="linenos">3590</span></a>        <span class="n">filtrated_data</span> <span class="o">=</span> <span class="n">preproc</span><span class="o">.</span><span class="n">filter_by_quartiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-3591"><a href="#L-3591"><span class="linenos">3591</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-3592"><a href="#L-3592"><span class="linenos">3592</span></a>            <span class="n">filtrated_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="L-3593"><a href="#L-3593"><span class="linenos">3593</span></a>            <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Unnamed: 0&quot;</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">])</span>
</span><span id="L-3594"><a href="#L-3594"><span class="linenos">3594</span></a>            <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</span><span id="L-3595"><a href="#L-3595"><span class="linenos">3595</span></a>            <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="L-3596"><a href="#L-3596"><span class="linenos">3596</span></a>        <span class="p">)</span>
</span><span id="L-3597"><a href="#L-3597"><span class="linenos">3597</span></a>        <span class="n">filled_data</span> <span class="o">=</span> <span class="n">preproc</span><span class="o">.</span><span class="n">filing_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-3598"><a href="#L-3598"><span class="linenos">3598</span></a>        <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filled_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</span><span id="L-3599"><a href="#L-3599"><span class="linenos">3599</span></a>        <span class="n">n_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-3600"><a href="#L-3600"><span class="linenos">3600</span></a>        <span class="n">S_data</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-3601"><a href="#L-3601"><span class="linenos">3601</span></a>            <span class="n">filled_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s2">&quot;new_sum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)</span>
</span><span id="L-3602"><a href="#L-3602"><span class="linenos">3602</span></a>        <span class="p">]</span>
</span><span id="L-3603"><a href="#L-3603"><span class="linenos">3603</span></a>
</span><span id="L-3604"><a href="#L-3604"><span class="linenos">3604</span></a>        <span class="k">return</span> <span class="n">filled_data</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span><span class="p">,</span> <span class="n">S_data</span>
</span><span id="L-3605"><a href="#L-3605"><span class="linenos">3605</span></a>
</span><span id="L-3606"><a href="#L-3606"><span class="linenos">3606</span></a>
</span><span id="L-3607"><a href="#L-3607"><span class="linenos">3607</span></a>    <span class="k">def</span> <span class="nf">process_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3608"><a href="#L-3608"><span class="linenos">3608</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3609"><a href="#L-3609"><span class="linenos">3609</span></a><span class="sd">        Main processing function that executes preprocessing,</span>
</span><span id="L-3610"><a href="#L-3610"><span class="linenos">3610</span></a><span class="sd">        statistical analysis, and generates a PDF report with various</span>
</span><span id="L-3611"><a href="#L-3611"><span class="linenos">3611</span></a><span class="sd">        scaling laws.</span>
</span><span id="L-3612"><a href="#L-3612"><span class="linenos">3612</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3613"><a href="#L-3613"><span class="linenos">3613</span></a>
</span><span id="L-3614"><a href="#L-3614"><span class="linenos">3614</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;animal&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span><span class="p">})</span>
</span><span id="L-3615"><a href="#L-3615"><span class="linenos">3615</span></a>
</span><span id="L-3616"><a href="#L-3616"><span class="linenos">3616</span></a>        <span class="n">filtered_animals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess_data</span><span class="p">()</span>
</span><span id="L-3617"><a href="#L-3617"><span class="linenos">3617</span></a>        <span class="n">filtered_animals</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
</span><span id="L-3618"><a href="#L-3618"><span class="linenos">3618</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;compressed_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
</span><span id="L-3619"><a href="#L-3619"><span class="linenos">3619</span></a>        <span class="p">)</span>
</span><span id="L-3620"><a href="#L-3620"><span class="linenos">3620</span></a>        <span class="n">filled_data</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span><span class="p">,</span> <span class="n">S_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advenced_preprocessing</span><span class="p">()</span>
</span><span id="L-3621"><a href="#L-3621"><span class="linenos">3621</span></a>
</span><span id="L-3622"><a href="#L-3622"><span class="linenos">3622</span></a>        <span class="n">min_label_no</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-3623"><a href="#L-3623"><span class="linenos">3623</span></a>            <span class="p">[</span><span class="n">value</span><span class="p">]</span>
</span><span id="L-3624"><a href="#L-3624"><span class="linenos">3624</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">Stats</span><span class="p">()</span>
</span><span id="L-3625"><a href="#L-3625"><span class="linenos">3625</span></a>            <span class="o">.</span><span class="n">get_min_labels_no_after_filtration</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="L-3626"><a href="#L-3626"><span class="linenos">3626</span></a>            <span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="L-3627"><a href="#L-3627"><span class="linenos">3627</span></a>        <span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-3628"><a href="#L-3628"><span class="linenos">3628</span></a>
</span><span id="L-3629"><a href="#L-3629"><span class="linenos">3629</span></a>        <span class="n">min_records</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-3630"><a href="#L-3630"><span class="linenos">3630</span></a>            <span class="p">[</span><span class="n">value</span><span class="p">]</span>
</span><span id="L-3631"><a href="#L-3631"><span class="linenos">3631</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">Stats</span><span class="p">()</span>
</span><span id="L-3632"><a href="#L-3632"><span class="linenos">3632</span></a>            <span class="o">.</span><span class="n">get_min_records_no_before_filtration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-3633"><a href="#L-3633"><span class="linenos">3633</span></a>            <span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="L-3634"><a href="#L-3634"><span class="linenos">3634</span></a>        <span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-3635"><a href="#L-3635"><span class="linenos">3635</span></a>
</span><span id="L-3636"><a href="#L-3636"><span class="linenos">3636</span></a>        <span class="n">laws</span> <span class="o">=</span> <span class="n">Laws</span><span class="p">(</span>
</span><span id="L-3637"><a href="#L-3637"><span class="linenos">3637</span></a>            <span class="n">pdf_object</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span>
</span><span id="L-3638"><a href="#L-3638"><span class="linenos">3638</span></a>            <span class="n">stats_frame</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="p">,</span>
</span><span id="L-3639"><a href="#L-3639"><span class="linenos">3639</span></a>            <span class="n">output_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span><span class="p">,</span>
</span><span id="L-3640"><a href="#L-3640"><span class="linenos">3640</span></a>        <span class="p">)</span>
</span><span id="L-3641"><a href="#L-3641"><span class="linenos">3641</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">visitation_frequency</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">,</span> <span class="n">min_label_no</span><span class="p">)</span>
</span><span id="L-3642"><a href="#L-3642"><span class="linenos">3642</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">distinct_locations_over_time</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span><span class="p">,</span> <span class="n">S_data</span><span class="p">)</span>
</span><span id="L-3643"><a href="#L-3643"><span class="linenos">3643</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">msd_curve_split</span><span class="p">(</span><span class="n">filled_data</span><span class="p">)</span>
</span><span id="L-3644"><a href="#L-3644"><span class="linenos">3644</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">rog_over_time</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">,</span> <span class="n">min_records</span><span class="p">)</span>
</span><span id="L-3645"><a href="#L-3645"><span class="linenos">3645</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span><span id="L-3646"><a href="#L-3646"><span class="linenos">3646</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">waiting_times</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="L-3647"><a href="#L-3647"><span class="linenos">3647</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">jump_lengths_distribution</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="L-3648"><a href="#L-3648"><span class="linenos">3648</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">travel_times</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="L-3649"><a href="#L-3649"><span class="linenos">3649</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">rog</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="L-3650"><a href="#L-3650"><span class="linenos">3650</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">msd_distribution</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="L-3651"><a href="#L-3651"><span class="linenos">3651</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">return_time_distribution</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="L-3652"><a href="#L-3652"><span class="linenos">3652</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">exploration_time</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="L-3653"><a href="#L-3653"><span class="linenos">3653</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">estimate_pnew</span><span class="p">(</span><span class="n">filled_data</span><span class="p">)</span>
</span><span id="L-3654"><a href="#L-3654"><span class="linenos">3654</span></a>
</span><span id="L-3655"><a href="#L-3655"><span class="linenos">3655</span></a>        <span class="n">pdf_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-3656"><a href="#L-3656"><span class="linenos">3656</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span><span class="si">}</span><span class="s2">.pdf&quot;</span>
</span><span id="L-3657"><a href="#L-3657"><span class="linenos">3657</span></a>        <span class="p">)</span>
</span><span id="L-3658"><a href="#L-3658"><span class="linenos">3658</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">pdf_path</span><span class="p">)</span>
</span><span id="L-3659"><a href="#L-3659"><span class="linenos">3659</span></a>
</span><span id="L-3660"><a href="#L-3660"><span class="linenos">3660</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_record</span><span class="p">()</span>
</span></pre></div>


            </section>
                <section id="Curves">
                            <input id="Curves-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Curves</span>:

                <label class="view-source-button" for="Curves-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves-65"><a href="#Curves-65"><span class="linenos"> 65</span></a><span class="k">class</span> <span class="nc">Curves</span><span class="p">:</span>
</span><span id="Curves-66"><a href="#Curves-66"><span class="linenos"> 66</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-67"><a href="#Curves-67"><span class="linenos"> 67</span></a><span class="sd">    A class containing various static methods to model different</span>
</span><span id="Curves-68"><a href="#Curves-68"><span class="linenos"> 68</span></a><span class="sd">    mathematical curves. These methods take input values and parameters</span>
</span><span id="Curves-69"><a href="#Curves-69"><span class="linenos"> 69</span></a><span class="sd">    to compute specific mathematical transformations.</span>
</span><span id="Curves-70"><a href="#Curves-70"><span class="linenos"> 70</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Curves-71"><a href="#Curves-71"><span class="linenos"> 71</span></a>
</span><span id="Curves-72"><a href="#Curves-72"><span class="linenos"> 72</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves-73"><a href="#Curves-73"><span class="linenos"> 73</span></a>    <span class="k">def</span> <span class="nf">linear</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves-74"><a href="#Curves-74"><span class="linenos"> 74</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-75"><a href="#Curves-75"><span class="linenos"> 75</span></a><span class="sd">        Computes a linear transformation: y = a*x.</span>
</span><span id="Curves-76"><a href="#Curves-76"><span class="linenos"> 76</span></a>
</span><span id="Curves-77"><a href="#Curves-77"><span class="linenos"> 77</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves-78"><a href="#Curves-78"><span class="linenos"> 78</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves-79"><a href="#Curves-79"><span class="linenos"> 79</span></a><span class="sd">        a (float): Slope coefficient.</span>
</span><span id="Curves-80"><a href="#Curves-80"><span class="linenos"> 80</span></a><span class="sd">        b (float): Scaling coefficient.</span>
</span><span id="Curves-81"><a href="#Curves-81"><span class="linenos"> 81</span></a>
</span><span id="Curves-82"><a href="#Curves-82"><span class="linenos"> 82</span></a><span class="sd">        Returns:</span>
</span><span id="Curves-83"><a href="#Curves-83"><span class="linenos"> 83</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves-84"><a href="#Curves-84"><span class="linenos"> 84</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves-85"><a href="#Curves-85"><span class="linenos"> 85</span></a>
</span><span id="Curves-86"><a href="#Curves-86"><span class="linenos"> 86</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves-87"><a href="#Curves-87"><span class="linenos"> 87</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span>
</span><span id="Curves-88"><a href="#Curves-88"><span class="linenos"> 88</span></a>
</span><span id="Curves-89"><a href="#Curves-89"><span class="linenos"> 89</span></a>
</span><span id="Curves-90"><a href="#Curves-90"><span class="linenos"> 90</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves-91"><a href="#Curves-91"><span class="linenos"> 91</span></a>    <span class="k">def</span> <span class="nf">expon</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves-92"><a href="#Curves-92"><span class="linenos"> 92</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-93"><a href="#Curves-93"><span class="linenos"> 93</span></a><span class="sd">        Computes an exponential curve: y = a * x^b.</span>
</span><span id="Curves-94"><a href="#Curves-94"><span class="linenos"> 94</span></a>
</span><span id="Curves-95"><a href="#Curves-95"><span class="linenos"> 95</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves-96"><a href="#Curves-96"><span class="linenos"> 96</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves-97"><a href="#Curves-97"><span class="linenos"> 97</span></a><span class="sd">        a (float): Base scaling coefficient.</span>
</span><span id="Curves-98"><a href="#Curves-98"><span class="linenos"> 98</span></a><span class="sd">        b (float): Exponent.</span>
</span><span id="Curves-99"><a href="#Curves-99"><span class="linenos"> 99</span></a>
</span><span id="Curves-100"><a href="#Curves-100"><span class="linenos">100</span></a><span class="sd">        Returns:</span>
</span><span id="Curves-101"><a href="#Curves-101"><span class="linenos">101</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves-102"><a href="#Curves-102"><span class="linenos">102</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves-103"><a href="#Curves-103"><span class="linenos">103</span></a>
</span><span id="Curves-104"><a href="#Curves-104"><span class="linenos">104</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves-105"><a href="#Curves-105"><span class="linenos">105</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span><span id="Curves-106"><a href="#Curves-106"><span class="linenos">106</span></a>
</span><span id="Curves-107"><a href="#Curves-107"><span class="linenos">107</span></a>
</span><span id="Curves-108"><a href="#Curves-108"><span class="linenos">108</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves-109"><a href="#Curves-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="nf">expon_neg</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves-110"><a href="#Curves-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-111"><a href="#Curves-111"><span class="linenos">111</span></a><span class="sd">        Computes a negative exponential curve: y = a * x^(-b).</span>
</span><span id="Curves-112"><a href="#Curves-112"><span class="linenos">112</span></a>
</span><span id="Curves-113"><a href="#Curves-113"><span class="linenos">113</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves-114"><a href="#Curves-114"><span class="linenos">114</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves-115"><a href="#Curves-115"><span class="linenos">115</span></a><span class="sd">        a (float): Scaling coefficient.</span>
</span><span id="Curves-116"><a href="#Curves-116"><span class="linenos">116</span></a><span class="sd">        b (float): Negative exponent.</span>
</span><span id="Curves-117"><a href="#Curves-117"><span class="linenos">117</span></a>
</span><span id="Curves-118"><a href="#Curves-118"><span class="linenos">118</span></a><span class="sd">        Returns:</span>
</span><span id="Curves-119"><a href="#Curves-119"><span class="linenos">119</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves-120"><a href="#Curves-120"><span class="linenos">120</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves-121"><a href="#Curves-121"><span class="linenos">121</span></a>
</span><span id="Curves-122"><a href="#Curves-122"><span class="linenos">122</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves-123"><a href="#Curves-123"><span class="linenos">123</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="p">)</span>
</span><span id="Curves-124"><a href="#Curves-124"><span class="linenos">124</span></a>
</span><span id="Curves-125"><a href="#Curves-125"><span class="linenos">125</span></a>
</span><span id="Curves-126"><a href="#Curves-126"><span class="linenos">126</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves-127"><a href="#Curves-127"><span class="linenos">127</span></a>    <span class="k">def</span> <span class="nf">euler</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves-128"><a href="#Curves-128"><span class="linenos">128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-129"><a href="#Curves-129"><span class="linenos">129</span></a><span class="sd">        Computes an Euler&#39;s exponential curve: y = a * e^(b * x).</span>
</span><span id="Curves-130"><a href="#Curves-130"><span class="linenos">130</span></a>
</span><span id="Curves-131"><a href="#Curves-131"><span class="linenos">131</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves-132"><a href="#Curves-132"><span class="linenos">132</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves-133"><a href="#Curves-133"><span class="linenos">133</span></a><span class="sd">        a (float): Scaling coefficient.</span>
</span><span id="Curves-134"><a href="#Curves-134"><span class="linenos">134</span></a><span class="sd">        b (float): Exponent coefficient.</span>
</span><span id="Curves-135"><a href="#Curves-135"><span class="linenos">135</span></a>
</span><span id="Curves-136"><a href="#Curves-136"><span class="linenos">136</span></a><span class="sd">        Returns:</span>
</span><span id="Curves-137"><a href="#Curves-137"><span class="linenos">137</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves-138"><a href="#Curves-138"><span class="linenos">138</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves-139"><a href="#Curves-139"><span class="linenos">139</span></a>
</span><span id="Curves-140"><a href="#Curves-140"><span class="linenos">140</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves-141"><a href="#Curves-141"><span class="linenos">141</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Curves-142"><a href="#Curves-142"><span class="linenos">142</span></a>
</span><span id="Curves-143"><a href="#Curves-143"><span class="linenos">143</span></a>
</span><span id="Curves-144"><a href="#Curves-144"><span class="linenos">144</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves-145"><a href="#Curves-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves-146"><a href="#Curves-146"><span class="linenos">146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-147"><a href="#Curves-147"><span class="linenos">147</span></a><span class="sd">        Computes a power curve: y = a * b^x.</span>
</span><span id="Curves-148"><a href="#Curves-148"><span class="linenos">148</span></a>
</span><span id="Curves-149"><a href="#Curves-149"><span class="linenos">149</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves-150"><a href="#Curves-150"><span class="linenos">150</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves-151"><a href="#Curves-151"><span class="linenos">151</span></a><span class="sd">        a (float): Scaling coefficient.</span>
</span><span id="Curves-152"><a href="#Curves-152"><span class="linenos">152</span></a><span class="sd">        b (float): Base.</span>
</span><span id="Curves-153"><a href="#Curves-153"><span class="linenos">153</span></a>
</span><span id="Curves-154"><a href="#Curves-154"><span class="linenos">154</span></a><span class="sd">        Returns:</span>
</span><span id="Curves-155"><a href="#Curves-155"><span class="linenos">155</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves-156"><a href="#Curves-156"><span class="linenos">156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves-157"><a href="#Curves-157"><span class="linenos">157</span></a>
</span><span id="Curves-158"><a href="#Curves-158"><span class="linenos">158</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves-159"><a href="#Curves-159"><span class="linenos">159</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Curves-160"><a href="#Curves-160"><span class="linenos">160</span></a>
</span><span id="Curves-161"><a href="#Curves-161"><span class="linenos">161</span></a>
</span><span id="Curves-162"><a href="#Curves-162"><span class="linenos">162</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves-163"><a href="#Curves-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">power_neg</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves-164"><a href="#Curves-164"><span class="linenos">164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-165"><a href="#Curves-165"><span class="linenos">165</span></a><span class="sd">        Computes a negative power curve: y = a * b^(-x).</span>
</span><span id="Curves-166"><a href="#Curves-166"><span class="linenos">166</span></a>
</span><span id="Curves-167"><a href="#Curves-167"><span class="linenos">167</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves-168"><a href="#Curves-168"><span class="linenos">168</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves-169"><a href="#Curves-169"><span class="linenos">169</span></a><span class="sd">        a (float): Scaling coefficient.</span>
</span><span id="Curves-170"><a href="#Curves-170"><span class="linenos">170</span></a><span class="sd">        b (float): Base.</span>
</span><span id="Curves-171"><a href="#Curves-171"><span class="linenos">171</span></a>
</span><span id="Curves-172"><a href="#Curves-172"><span class="linenos">172</span></a><span class="sd">        Returns:</span>
</span><span id="Curves-173"><a href="#Curves-173"><span class="linenos">173</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves-174"><a href="#Curves-174"><span class="linenos">174</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves-175"><a href="#Curves-175"><span class="linenos">175</span></a>
</span><span id="Curves-176"><a href="#Curves-176"><span class="linenos">176</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves-177"><a href="#Curves-177"><span class="linenos">177</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span>
</span><span id="Curves-178"><a href="#Curves-178"><span class="linenos">178</span></a>
</span><span id="Curves-179"><a href="#Curves-179"><span class="linenos">179</span></a>
</span><span id="Curves-180"><a href="#Curves-180"><span class="linenos">180</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves-181"><a href="#Curves-181"><span class="linenos">181</span></a>    <span class="k">def</span> <span class="nf">logar</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves-182"><a href="#Curves-182"><span class="linenos">182</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-183"><a href="#Curves-183"><span class="linenos">183</span></a><span class="sd">        Computes a logarithmic curve: y = a + b * log(x).</span>
</span><span id="Curves-184"><a href="#Curves-184"><span class="linenos">184</span></a>
</span><span id="Curves-185"><a href="#Curves-185"><span class="linenos">185</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves-186"><a href="#Curves-186"><span class="linenos">186</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves-187"><a href="#Curves-187"><span class="linenos">187</span></a><span class="sd">        a (float): Constant offset.</span>
</span><span id="Curves-188"><a href="#Curves-188"><span class="linenos">188</span></a><span class="sd">        b (float): Logarithmic scaling factor.</span>
</span><span id="Curves-189"><a href="#Curves-189"><span class="linenos">189</span></a>
</span><span id="Curves-190"><a href="#Curves-190"><span class="linenos">190</span></a><span class="sd">        Returns:</span>
</span><span id="Curves-191"><a href="#Curves-191"><span class="linenos">191</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves-192"><a href="#Curves-192"><span class="linenos">192</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves-193"><a href="#Curves-193"><span class="linenos">193</span></a>
</span><span id="Curves-194"><a href="#Curves-194"><span class="linenos">194</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves-195"><a href="#Curves-195"><span class="linenos">195</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Curves-196"><a href="#Curves-196"><span class="linenos">196</span></a>
</span><span id="Curves-197"><a href="#Curves-197"><span class="linenos">197</span></a>
</span><span id="Curves-198"><a href="#Curves-198"><span class="linenos">198</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves-199"><a href="#Curves-199"><span class="linenos">199</span></a>    <span class="k">def</span> <span class="nf">cubic</span><span class="p">(</span>
</span><span id="Curves-200"><a href="#Curves-200"><span class="linenos">200</span></a>        <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="Curves-201"><a href="#Curves-201"><span class="linenos">201</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves-202"><a href="#Curves-202"><span class="linenos">202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-203"><a href="#Curves-203"><span class="linenos">203</span></a><span class="sd">        Computes a cubic curve: y = a*x^3 + b*x^2 + c*x + d.</span>
</span><span id="Curves-204"><a href="#Curves-204"><span class="linenos">204</span></a>
</span><span id="Curves-205"><a href="#Curves-205"><span class="linenos">205</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves-206"><a href="#Curves-206"><span class="linenos">206</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves-207"><a href="#Curves-207"><span class="linenos">207</span></a><span class="sd">        a, b, c, d (float): Coefficients for cubic, quadratic,</span>
</span><span id="Curves-208"><a href="#Curves-208"><span class="linenos">208</span></a><span class="sd">            linear, and constant terms.</span>
</span><span id="Curves-209"><a href="#Curves-209"><span class="linenos">209</span></a>
</span><span id="Curves-210"><a href="#Curves-210"><span class="linenos">210</span></a><span class="sd">        Returns:</span>
</span><span id="Curves-211"><a href="#Curves-211"><span class="linenos">211</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves-212"><a href="#Curves-212"><span class="linenos">212</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves-213"><a href="#Curves-213"><span class="linenos">213</span></a>
</span><span id="Curves-214"><a href="#Curves-214"><span class="linenos">214</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves-215"><a href="#Curves-215"><span class="linenos">215</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">d</span>
</span><span id="Curves-216"><a href="#Curves-216"><span class="linenos">216</span></a>
</span><span id="Curves-217"><a href="#Curves-217"><span class="linenos">217</span></a>
</span><span id="Curves-218"><a href="#Curves-218"><span class="linenos">218</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves-219"><a href="#Curves-219"><span class="linenos">219</span></a>    <span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves-220"><a href="#Curves-220"><span class="linenos">220</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-221"><a href="#Curves-221"><span class="linenos">221</span></a><span class="sd">        Computes a sigmoid curve: y = 1 / (1 + exp(a*x)).</span>
</span><span id="Curves-222"><a href="#Curves-222"><span class="linenos">222</span></a>
</span><span id="Curves-223"><a href="#Curves-223"><span class="linenos">223</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves-224"><a href="#Curves-224"><span class="linenos">224</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves-225"><a href="#Curves-225"><span class="linenos">225</span></a><span class="sd">        a (float): Scaling factor.</span>
</span><span id="Curves-226"><a href="#Curves-226"><span class="linenos">226</span></a><span class="sd">        b (float): Offset factor.</span>
</span><span id="Curves-227"><a href="#Curves-227"><span class="linenos">227</span></a>
</span><span id="Curves-228"><a href="#Curves-228"><span class="linenos">228</span></a><span class="sd">        Returns:</span>
</span><span id="Curves-229"><a href="#Curves-229"><span class="linenos">229</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves-230"><a href="#Curves-230"><span class="linenos">230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves-231"><a href="#Curves-231"><span class="linenos">231</span></a>
</span><span id="Curves-232"><a href="#Curves-232"><span class="linenos">232</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves-233"><a href="#Curves-233"><span class="linenos">233</span></a>        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>
</span><span id="Curves-234"><a href="#Curves-234"><span class="linenos">234</span></a>
</span><span id="Curves-235"><a href="#Curves-235"><span class="linenos">235</span></a>
</span><span id="Curves-236"><a href="#Curves-236"><span class="linenos">236</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves-237"><a href="#Curves-237"><span class="linenos">237</span></a>    <span class="k">def</span> <span class="nf">quad</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves-238"><a href="#Curves-238"><span class="linenos">238</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-239"><a href="#Curves-239"><span class="linenos">239</span></a><span class="sd">        Computes a quadratic curve: y = a*x^2 + b*x + c.</span>
</span><span id="Curves-240"><a href="#Curves-240"><span class="linenos">240</span></a>
</span><span id="Curves-241"><a href="#Curves-241"><span class="linenos">241</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves-242"><a href="#Curves-242"><span class="linenos">242</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves-243"><a href="#Curves-243"><span class="linenos">243</span></a><span class="sd">        a (float): Coefficient for the quadratic term.</span>
</span><span id="Curves-244"><a href="#Curves-244"><span class="linenos">244</span></a><span class="sd">        b (float): Coefficient for the linear term.</span>
</span><span id="Curves-245"><a href="#Curves-245"><span class="linenos">245</span></a><span class="sd">        c (float): Constant term.</span>
</span><span id="Curves-246"><a href="#Curves-246"><span class="linenos">246</span></a>
</span><span id="Curves-247"><a href="#Curves-247"><span class="linenos">247</span></a><span class="sd">        Returns:</span>
</span><span id="Curves-248"><a href="#Curves-248"><span class="linenos">248</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves-249"><a href="#Curves-249"><span class="linenos">249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves-250"><a href="#Curves-250"><span class="linenos">250</span></a>
</span><span id="Curves-251"><a href="#Curves-251"><span class="linenos">251</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves-252"><a href="#Curves-252"><span class="linenos">252</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span>
</span><span id="Curves-253"><a href="#Curves-253"><span class="linenos">253</span></a>
</span><span id="Curves-254"><a href="#Curves-254"><span class="linenos">254</span></a>
</span><span id="Curves-255"><a href="#Curves-255"><span class="linenos">255</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves-256"><a href="#Curves-256"><span class="linenos">256</span></a>    <span class="k">def</span> <span class="nf">four</span><span class="p">(</span>
</span><span id="Curves-257"><a href="#Curves-257"><span class="linenos">257</span></a>        <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="Curves-258"><a href="#Curves-258"><span class="linenos">258</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves-259"><a href="#Curves-259"><span class="linenos">259</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-260"><a href="#Curves-260"><span class="linenos">260</span></a><span class="sd">        Computes a quartic curve: y = a*x^4 + b*x^3 + c*x^2 + d*x + e.</span>
</span><span id="Curves-261"><a href="#Curves-261"><span class="linenos">261</span></a>
</span><span id="Curves-262"><a href="#Curves-262"><span class="linenos">262</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves-263"><a href="#Curves-263"><span class="linenos">263</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves-264"><a href="#Curves-264"><span class="linenos">264</span></a><span class="sd">        a, b, c, d, e (float): Coefficients for quartic, cubic,</span>
</span><span id="Curves-265"><a href="#Curves-265"><span class="linenos">265</span></a><span class="sd">        quadratic, linear, and constant terms.</span>
</span><span id="Curves-266"><a href="#Curves-266"><span class="linenos">266</span></a>
</span><span id="Curves-267"><a href="#Curves-267"><span class="linenos">267</span></a><span class="sd">        Returns:</span>
</span><span id="Curves-268"><a href="#Curves-268"><span class="linenos">268</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves-269"><a href="#Curves-269"><span class="linenos">269</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves-270"><a href="#Curves-270"><span class="linenos">270</span></a>
</span><span id="Curves-271"><a href="#Curves-271"><span class="linenos">271</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves-272"><a href="#Curves-272"><span class="linenos">272</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">e</span>
</span><span id="Curves-273"><a href="#Curves-273"><span class="linenos">273</span></a>
</span><span id="Curves-274"><a href="#Curves-274"><span class="linenos">274</span></a>
</span><span id="Curves-275"><a href="#Curves-275"><span class="linenos">275</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves-276"><a href="#Curves-276"><span class="linenos">276</span></a>    <span class="k">def</span> <span class="nf">zipf</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves-277"><a href="#Curves-277"><span class="linenos">277</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-278"><a href="#Curves-278"><span class="linenos">278</span></a><span class="sd">        Computes a Zipf curve: y = 1 / (x + a)^b.</span>
</span><span id="Curves-279"><a href="#Curves-279"><span class="linenos">279</span></a>
</span><span id="Curves-280"><a href="#Curves-280"><span class="linenos">280</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves-281"><a href="#Curves-281"><span class="linenos">281</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves-282"><a href="#Curves-282"><span class="linenos">282</span></a><span class="sd">        a (float): Offset to prevent division by zero.</span>
</span><span id="Curves-283"><a href="#Curves-283"><span class="linenos">283</span></a><span class="sd">        b (float): Exponent for scaling.</span>
</span><span id="Curves-284"><a href="#Curves-284"><span class="linenos">284</span></a>
</span><span id="Curves-285"><a href="#Curves-285"><span class="linenos">285</span></a><span class="sd">        Returns:</span>
</span><span id="Curves-286"><a href="#Curves-286"><span class="linenos">286</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves-287"><a href="#Curves-287"><span class="linenos">287</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves-288"><a href="#Curves-288"><span class="linenos">288</span></a>
</span><span id="Curves-289"><a href="#Curves-289"><span class="linenos">289</span></a>        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="n">b</span>
</span><span id="Curves-290"><a href="#Curves-290"><span class="linenos">290</span></a>
</span><span id="Curves-291"><a href="#Curves-291"><span class="linenos">291</span></a>
</span><span id="Curves-292"><a href="#Curves-292"><span class="linenos">292</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves-293"><a href="#Curves-293"><span class="linenos">293</span></a>    <span class="k">def</span> <span class="nf">power_law</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
</span><span id="Curves-294"><a href="#Curves-294"><span class="linenos">294</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves-295"><a href="#Curves-295"><span class="linenos">295</span></a><span class="sd">        Power-law function used to model the number of unique places</span>
</span><span id="Curves-296"><a href="#Curves-296"><span class="linenos">296</span></a><span class="sd">        visited over time.</span>
</span><span id="Curves-297"><a href="#Curves-297"><span class="linenos">297</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves-298"><a href="#Curves-298"><span class="linenos">298</span></a>
</span><span id="Curves-299"><a href="#Curves-299"><span class="linenos">299</span></a>        <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">n</span><span class="o">**</span><span class="n">B</span>
</span></pre></div>


            <div class="docstring"><p>A class containing various static methods to model different
mathematical curves. These methods take input values and parameters
to compute specific mathematical transformations.</p>
</div>


                            <div id="Curves.linear" class="classattr">
                                        <input id="Curves.linear-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">linear</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="Curves.linear-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves.linear"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves.linear-72"><a href="#Curves.linear-72"><span class="linenos">72</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves.linear-73"><a href="#Curves.linear-73"><span class="linenos">73</span></a>    <span class="k">def</span> <span class="nf">linear</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves.linear-74"><a href="#Curves.linear-74"><span class="linenos">74</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves.linear-75"><a href="#Curves.linear-75"><span class="linenos">75</span></a><span class="sd">        Computes a linear transformation: y = a*x.</span>
</span><span id="Curves.linear-76"><a href="#Curves.linear-76"><span class="linenos">76</span></a>
</span><span id="Curves.linear-77"><a href="#Curves.linear-77"><span class="linenos">77</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves.linear-78"><a href="#Curves.linear-78"><span class="linenos">78</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves.linear-79"><a href="#Curves.linear-79"><span class="linenos">79</span></a><span class="sd">        a (float): Slope coefficient.</span>
</span><span id="Curves.linear-80"><a href="#Curves.linear-80"><span class="linenos">80</span></a><span class="sd">        b (float): Scaling coefficient.</span>
</span><span id="Curves.linear-81"><a href="#Curves.linear-81"><span class="linenos">81</span></a>
</span><span id="Curves.linear-82"><a href="#Curves.linear-82"><span class="linenos">82</span></a><span class="sd">        Returns:</span>
</span><span id="Curves.linear-83"><a href="#Curves.linear-83"><span class="linenos">83</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves.linear-84"><a href="#Curves.linear-84"><span class="linenos">84</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves.linear-85"><a href="#Curves.linear-85"><span class="linenos">85</span></a>
</span><span id="Curves.linear-86"><a href="#Curves.linear-86"><span class="linenos">86</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves.linear-87"><a href="#Curves.linear-87"><span class="linenos">87</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span>
</span></pre></div>


            <div class="docstring"><p>Computes a linear transformation: y = a*x.</p>

<p>Parameters:
x (array-like): Input values.
a (float): Slope coefficient.
b (float): Scaling coefficient.</p>

<p>Returns:
array-like: Transformed values.</p>
</div>


                            </div>
                            <div id="Curves.expon" class="classattr">
                                        <input id="Curves.expon-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">expon</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="Curves.expon-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves.expon"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves.expon-90"><a href="#Curves.expon-90"><span class="linenos"> 90</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves.expon-91"><a href="#Curves.expon-91"><span class="linenos"> 91</span></a>    <span class="k">def</span> <span class="nf">expon</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves.expon-92"><a href="#Curves.expon-92"><span class="linenos"> 92</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves.expon-93"><a href="#Curves.expon-93"><span class="linenos"> 93</span></a><span class="sd">        Computes an exponential curve: y = a * x^b.</span>
</span><span id="Curves.expon-94"><a href="#Curves.expon-94"><span class="linenos"> 94</span></a>
</span><span id="Curves.expon-95"><a href="#Curves.expon-95"><span class="linenos"> 95</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves.expon-96"><a href="#Curves.expon-96"><span class="linenos"> 96</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves.expon-97"><a href="#Curves.expon-97"><span class="linenos"> 97</span></a><span class="sd">        a (float): Base scaling coefficient.</span>
</span><span id="Curves.expon-98"><a href="#Curves.expon-98"><span class="linenos"> 98</span></a><span class="sd">        b (float): Exponent.</span>
</span><span id="Curves.expon-99"><a href="#Curves.expon-99"><span class="linenos"> 99</span></a>
</span><span id="Curves.expon-100"><a href="#Curves.expon-100"><span class="linenos">100</span></a><span class="sd">        Returns:</span>
</span><span id="Curves.expon-101"><a href="#Curves.expon-101"><span class="linenos">101</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves.expon-102"><a href="#Curves.expon-102"><span class="linenos">102</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves.expon-103"><a href="#Curves.expon-103"><span class="linenos">103</span></a>
</span><span id="Curves.expon-104"><a href="#Curves.expon-104"><span class="linenos">104</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves.expon-105"><a href="#Curves.expon-105"><span class="linenos">105</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes an exponential curve: y = a * x^b.</p>

<p>Parameters:
x (array-like): Input values.
a (float): Base scaling coefficient.
b (float): Exponent.</p>

<p>Returns:
array-like: Transformed values.</p>
</div>


                            </div>
                            <div id="Curves.expon_neg" class="classattr">
                                        <input id="Curves.expon_neg-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">expon_neg</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="Curves.expon_neg-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves.expon_neg"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves.expon_neg-108"><a href="#Curves.expon_neg-108"><span class="linenos">108</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves.expon_neg-109"><a href="#Curves.expon_neg-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="nf">expon_neg</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves.expon_neg-110"><a href="#Curves.expon_neg-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves.expon_neg-111"><a href="#Curves.expon_neg-111"><span class="linenos">111</span></a><span class="sd">        Computes a negative exponential curve: y = a * x^(-b).</span>
</span><span id="Curves.expon_neg-112"><a href="#Curves.expon_neg-112"><span class="linenos">112</span></a>
</span><span id="Curves.expon_neg-113"><a href="#Curves.expon_neg-113"><span class="linenos">113</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves.expon_neg-114"><a href="#Curves.expon_neg-114"><span class="linenos">114</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves.expon_neg-115"><a href="#Curves.expon_neg-115"><span class="linenos">115</span></a><span class="sd">        a (float): Scaling coefficient.</span>
</span><span id="Curves.expon_neg-116"><a href="#Curves.expon_neg-116"><span class="linenos">116</span></a><span class="sd">        b (float): Negative exponent.</span>
</span><span id="Curves.expon_neg-117"><a href="#Curves.expon_neg-117"><span class="linenos">117</span></a>
</span><span id="Curves.expon_neg-118"><a href="#Curves.expon_neg-118"><span class="linenos">118</span></a><span class="sd">        Returns:</span>
</span><span id="Curves.expon_neg-119"><a href="#Curves.expon_neg-119"><span class="linenos">119</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves.expon_neg-120"><a href="#Curves.expon_neg-120"><span class="linenos">120</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves.expon_neg-121"><a href="#Curves.expon_neg-121"><span class="linenos">121</span></a>
</span><span id="Curves.expon_neg-122"><a href="#Curves.expon_neg-122"><span class="linenos">122</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves.expon_neg-123"><a href="#Curves.expon_neg-123"><span class="linenos">123</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes a negative exponential curve: y = a * x^(-b).</p>

<p>Parameters:
x (array-like): Input values.
a (float): Scaling coefficient.
b (float): Negative exponent.</p>

<p>Returns:
array-like: Transformed values.</p>
</div>


                            </div>
                            <div id="Curves.euler" class="classattr">
                                        <input id="Curves.euler-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">euler</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="Curves.euler-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves.euler"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves.euler-126"><a href="#Curves.euler-126"><span class="linenos">126</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves.euler-127"><a href="#Curves.euler-127"><span class="linenos">127</span></a>    <span class="k">def</span> <span class="nf">euler</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves.euler-128"><a href="#Curves.euler-128"><span class="linenos">128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves.euler-129"><a href="#Curves.euler-129"><span class="linenos">129</span></a><span class="sd">        Computes an Euler&#39;s exponential curve: y = a * e^(b * x).</span>
</span><span id="Curves.euler-130"><a href="#Curves.euler-130"><span class="linenos">130</span></a>
</span><span id="Curves.euler-131"><a href="#Curves.euler-131"><span class="linenos">131</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves.euler-132"><a href="#Curves.euler-132"><span class="linenos">132</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves.euler-133"><a href="#Curves.euler-133"><span class="linenos">133</span></a><span class="sd">        a (float): Scaling coefficient.</span>
</span><span id="Curves.euler-134"><a href="#Curves.euler-134"><span class="linenos">134</span></a><span class="sd">        b (float): Exponent coefficient.</span>
</span><span id="Curves.euler-135"><a href="#Curves.euler-135"><span class="linenos">135</span></a>
</span><span id="Curves.euler-136"><a href="#Curves.euler-136"><span class="linenos">136</span></a><span class="sd">        Returns:</span>
</span><span id="Curves.euler-137"><a href="#Curves.euler-137"><span class="linenos">137</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves.euler-138"><a href="#Curves.euler-138"><span class="linenos">138</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves.euler-139"><a href="#Curves.euler-139"><span class="linenos">139</span></a>
</span><span id="Curves.euler-140"><a href="#Curves.euler-140"><span class="linenos">140</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves.euler-141"><a href="#Curves.euler-141"><span class="linenos">141</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes an Euler's exponential curve: y = a * e^(b * x).</p>

<p>Parameters:
x (array-like): Input values.
a (float): Scaling coefficient.
b (float): Exponent coefficient.</p>

<p>Returns:
array-like: Transformed values.</p>
</div>


                            </div>
                            <div id="Curves.power" class="classattr">
                                        <input id="Curves.power-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">power</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="Curves.power-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves.power"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves.power-144"><a href="#Curves.power-144"><span class="linenos">144</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves.power-145"><a href="#Curves.power-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves.power-146"><a href="#Curves.power-146"><span class="linenos">146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves.power-147"><a href="#Curves.power-147"><span class="linenos">147</span></a><span class="sd">        Computes a power curve: y = a * b^x.</span>
</span><span id="Curves.power-148"><a href="#Curves.power-148"><span class="linenos">148</span></a>
</span><span id="Curves.power-149"><a href="#Curves.power-149"><span class="linenos">149</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves.power-150"><a href="#Curves.power-150"><span class="linenos">150</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves.power-151"><a href="#Curves.power-151"><span class="linenos">151</span></a><span class="sd">        a (float): Scaling coefficient.</span>
</span><span id="Curves.power-152"><a href="#Curves.power-152"><span class="linenos">152</span></a><span class="sd">        b (float): Base.</span>
</span><span id="Curves.power-153"><a href="#Curves.power-153"><span class="linenos">153</span></a>
</span><span id="Curves.power-154"><a href="#Curves.power-154"><span class="linenos">154</span></a><span class="sd">        Returns:</span>
</span><span id="Curves.power-155"><a href="#Curves.power-155"><span class="linenos">155</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves.power-156"><a href="#Curves.power-156"><span class="linenos">156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves.power-157"><a href="#Curves.power-157"><span class="linenos">157</span></a>
</span><span id="Curves.power-158"><a href="#Curves.power-158"><span class="linenos">158</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves.power-159"><a href="#Curves.power-159"><span class="linenos">159</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes a power curve: y = a * b^x.</p>

<p>Parameters:
x (array-like): Input values.
a (float): Scaling coefficient.
b (float): Base.</p>

<p>Returns:
array-like: Transformed values.</p>
</div>


                            </div>
                            <div id="Curves.power_neg" class="classattr">
                                        <input id="Curves.power_neg-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">power_neg</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="Curves.power_neg-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves.power_neg"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves.power_neg-162"><a href="#Curves.power_neg-162"><span class="linenos">162</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves.power_neg-163"><a href="#Curves.power_neg-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">power_neg</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves.power_neg-164"><a href="#Curves.power_neg-164"><span class="linenos">164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves.power_neg-165"><a href="#Curves.power_neg-165"><span class="linenos">165</span></a><span class="sd">        Computes a negative power curve: y = a * b^(-x).</span>
</span><span id="Curves.power_neg-166"><a href="#Curves.power_neg-166"><span class="linenos">166</span></a>
</span><span id="Curves.power_neg-167"><a href="#Curves.power_neg-167"><span class="linenos">167</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves.power_neg-168"><a href="#Curves.power_neg-168"><span class="linenos">168</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves.power_neg-169"><a href="#Curves.power_neg-169"><span class="linenos">169</span></a><span class="sd">        a (float): Scaling coefficient.</span>
</span><span id="Curves.power_neg-170"><a href="#Curves.power_neg-170"><span class="linenos">170</span></a><span class="sd">        b (float): Base.</span>
</span><span id="Curves.power_neg-171"><a href="#Curves.power_neg-171"><span class="linenos">171</span></a>
</span><span id="Curves.power_neg-172"><a href="#Curves.power_neg-172"><span class="linenos">172</span></a><span class="sd">        Returns:</span>
</span><span id="Curves.power_neg-173"><a href="#Curves.power_neg-173"><span class="linenos">173</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves.power_neg-174"><a href="#Curves.power_neg-174"><span class="linenos">174</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves.power_neg-175"><a href="#Curves.power_neg-175"><span class="linenos">175</span></a>
</span><span id="Curves.power_neg-176"><a href="#Curves.power_neg-176"><span class="linenos">176</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves.power_neg-177"><a href="#Curves.power_neg-177"><span class="linenos">177</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes a negative power curve: y = a * b^(-x).</p>

<p>Parameters:
x (array-like): Input values.
a (float): Scaling coefficient.
b (float): Base.</p>

<p>Returns:
array-like: Transformed values.</p>
</div>


                            </div>
                            <div id="Curves.logar" class="classattr">
                                        <input id="Curves.logar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">logar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="Curves.logar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves.logar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves.logar-180"><a href="#Curves.logar-180"><span class="linenos">180</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves.logar-181"><a href="#Curves.logar-181"><span class="linenos">181</span></a>    <span class="k">def</span> <span class="nf">logar</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves.logar-182"><a href="#Curves.logar-182"><span class="linenos">182</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves.logar-183"><a href="#Curves.logar-183"><span class="linenos">183</span></a><span class="sd">        Computes a logarithmic curve: y = a + b * log(x).</span>
</span><span id="Curves.logar-184"><a href="#Curves.logar-184"><span class="linenos">184</span></a>
</span><span id="Curves.logar-185"><a href="#Curves.logar-185"><span class="linenos">185</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves.logar-186"><a href="#Curves.logar-186"><span class="linenos">186</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves.logar-187"><a href="#Curves.logar-187"><span class="linenos">187</span></a><span class="sd">        a (float): Constant offset.</span>
</span><span id="Curves.logar-188"><a href="#Curves.logar-188"><span class="linenos">188</span></a><span class="sd">        b (float): Logarithmic scaling factor.</span>
</span><span id="Curves.logar-189"><a href="#Curves.logar-189"><span class="linenos">189</span></a>
</span><span id="Curves.logar-190"><a href="#Curves.logar-190"><span class="linenos">190</span></a><span class="sd">        Returns:</span>
</span><span id="Curves.logar-191"><a href="#Curves.logar-191"><span class="linenos">191</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves.logar-192"><a href="#Curves.logar-192"><span class="linenos">192</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves.logar-193"><a href="#Curves.logar-193"><span class="linenos">193</span></a>
</span><span id="Curves.logar-194"><a href="#Curves.logar-194"><span class="linenos">194</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves.logar-195"><a href="#Curves.logar-195"><span class="linenos">195</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes a logarithmic curve: y = a + b * log(x).</p>

<p>Parameters:
x (array-like): Input values.
a (float): Constant offset.
b (float): Logarithmic scaling factor.</p>

<p>Returns:
array-like: Transformed values.</p>
</div>


                            </div>
                            <div id="Curves.cubic" class="classattr">
                                        <input id="Curves.cubic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">cubic</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">a</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">b</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">c</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">d</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="Curves.cubic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves.cubic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves.cubic-198"><a href="#Curves.cubic-198"><span class="linenos">198</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves.cubic-199"><a href="#Curves.cubic-199"><span class="linenos">199</span></a>    <span class="k">def</span> <span class="nf">cubic</span><span class="p">(</span>
</span><span id="Curves.cubic-200"><a href="#Curves.cubic-200"><span class="linenos">200</span></a>        <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="Curves.cubic-201"><a href="#Curves.cubic-201"><span class="linenos">201</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves.cubic-202"><a href="#Curves.cubic-202"><span class="linenos">202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves.cubic-203"><a href="#Curves.cubic-203"><span class="linenos">203</span></a><span class="sd">        Computes a cubic curve: y = a*x^3 + b*x^2 + c*x + d.</span>
</span><span id="Curves.cubic-204"><a href="#Curves.cubic-204"><span class="linenos">204</span></a>
</span><span id="Curves.cubic-205"><a href="#Curves.cubic-205"><span class="linenos">205</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves.cubic-206"><a href="#Curves.cubic-206"><span class="linenos">206</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves.cubic-207"><a href="#Curves.cubic-207"><span class="linenos">207</span></a><span class="sd">        a, b, c, d (float): Coefficients for cubic, quadratic,</span>
</span><span id="Curves.cubic-208"><a href="#Curves.cubic-208"><span class="linenos">208</span></a><span class="sd">            linear, and constant terms.</span>
</span><span id="Curves.cubic-209"><a href="#Curves.cubic-209"><span class="linenos">209</span></a>
</span><span id="Curves.cubic-210"><a href="#Curves.cubic-210"><span class="linenos">210</span></a><span class="sd">        Returns:</span>
</span><span id="Curves.cubic-211"><a href="#Curves.cubic-211"><span class="linenos">211</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves.cubic-212"><a href="#Curves.cubic-212"><span class="linenos">212</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves.cubic-213"><a href="#Curves.cubic-213"><span class="linenos">213</span></a>
</span><span id="Curves.cubic-214"><a href="#Curves.cubic-214"><span class="linenos">214</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves.cubic-215"><a href="#Curves.cubic-215"><span class="linenos">215</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">d</span>
</span></pre></div>


            <div class="docstring"><p>Computes a cubic curve: y = a<em>x^3 + b</em>x^2 + c*x + d.</p>

<p>Parameters:
x (array-like): Input values.
a, b, c, d (float): Coefficients for cubic, quadratic,
    linear, and constant terms.</p>

<p>Returns:
array-like: Transformed values.</p>
</div>


                            </div>
                            <div id="Curves.sigmoid" class="classattr">
                                        <input id="Curves.sigmoid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">sigmoid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="Curves.sigmoid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves.sigmoid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves.sigmoid-218"><a href="#Curves.sigmoid-218"><span class="linenos">218</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves.sigmoid-219"><a href="#Curves.sigmoid-219"><span class="linenos">219</span></a>    <span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves.sigmoid-220"><a href="#Curves.sigmoid-220"><span class="linenos">220</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves.sigmoid-221"><a href="#Curves.sigmoid-221"><span class="linenos">221</span></a><span class="sd">        Computes a sigmoid curve: y = 1 / (1 + exp(a*x)).</span>
</span><span id="Curves.sigmoid-222"><a href="#Curves.sigmoid-222"><span class="linenos">222</span></a>
</span><span id="Curves.sigmoid-223"><a href="#Curves.sigmoid-223"><span class="linenos">223</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves.sigmoid-224"><a href="#Curves.sigmoid-224"><span class="linenos">224</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves.sigmoid-225"><a href="#Curves.sigmoid-225"><span class="linenos">225</span></a><span class="sd">        a (float): Scaling factor.</span>
</span><span id="Curves.sigmoid-226"><a href="#Curves.sigmoid-226"><span class="linenos">226</span></a><span class="sd">        b (float): Offset factor.</span>
</span><span id="Curves.sigmoid-227"><a href="#Curves.sigmoid-227"><span class="linenos">227</span></a>
</span><span id="Curves.sigmoid-228"><a href="#Curves.sigmoid-228"><span class="linenos">228</span></a><span class="sd">        Returns:</span>
</span><span id="Curves.sigmoid-229"><a href="#Curves.sigmoid-229"><span class="linenos">229</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves.sigmoid-230"><a href="#Curves.sigmoid-230"><span class="linenos">230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves.sigmoid-231"><a href="#Curves.sigmoid-231"><span class="linenos">231</span></a>
</span><span id="Curves.sigmoid-232"><a href="#Curves.sigmoid-232"><span class="linenos">232</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves.sigmoid-233"><a href="#Curves.sigmoid-233"><span class="linenos">233</span></a>        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Computes a sigmoid curve: y = 1 / (1 + exp(a*x)).</p>

<p>Parameters:
x (array-like): Input values.
a (float): Scaling factor.
b (float): Offset factor.</p>

<p>Returns:
array-like: Transformed values.</p>
</div>


                            </div>
                            <div id="Curves.quad" class="classattr">
                                        <input id="Curves.quad-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">quad</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">c</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="Curves.quad-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves.quad"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves.quad-236"><a href="#Curves.quad-236"><span class="linenos">236</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves.quad-237"><a href="#Curves.quad-237"><span class="linenos">237</span></a>    <span class="k">def</span> <span class="nf">quad</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves.quad-238"><a href="#Curves.quad-238"><span class="linenos">238</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves.quad-239"><a href="#Curves.quad-239"><span class="linenos">239</span></a><span class="sd">        Computes a quadratic curve: y = a*x^2 + b*x + c.</span>
</span><span id="Curves.quad-240"><a href="#Curves.quad-240"><span class="linenos">240</span></a>
</span><span id="Curves.quad-241"><a href="#Curves.quad-241"><span class="linenos">241</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves.quad-242"><a href="#Curves.quad-242"><span class="linenos">242</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves.quad-243"><a href="#Curves.quad-243"><span class="linenos">243</span></a><span class="sd">        a (float): Coefficient for the quadratic term.</span>
</span><span id="Curves.quad-244"><a href="#Curves.quad-244"><span class="linenos">244</span></a><span class="sd">        b (float): Coefficient for the linear term.</span>
</span><span id="Curves.quad-245"><a href="#Curves.quad-245"><span class="linenos">245</span></a><span class="sd">        c (float): Constant term.</span>
</span><span id="Curves.quad-246"><a href="#Curves.quad-246"><span class="linenos">246</span></a>
</span><span id="Curves.quad-247"><a href="#Curves.quad-247"><span class="linenos">247</span></a><span class="sd">        Returns:</span>
</span><span id="Curves.quad-248"><a href="#Curves.quad-248"><span class="linenos">248</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves.quad-249"><a href="#Curves.quad-249"><span class="linenos">249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves.quad-250"><a href="#Curves.quad-250"><span class="linenos">250</span></a>
</span><span id="Curves.quad-251"><a href="#Curves.quad-251"><span class="linenos">251</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves.quad-252"><a href="#Curves.quad-252"><span class="linenos">252</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span>
</span></pre></div>


            <div class="docstring"><p>Computes a quadratic curve: y = a<em>x^2 + b</em>x + c.</p>

<p>Parameters:
x (array-like): Input values.
a (float): Coefficient for the quadratic term.
b (float): Coefficient for the linear term.
c (float): Constant term.</p>

<p>Returns:
array-like: Transformed values.</p>
</div>


                            </div>
                            <div id="Curves.four" class="classattr">
                                        <input id="Curves.four-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">four</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">a</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">b</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">c</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">d</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">e</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="Curves.four-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves.four"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves.four-255"><a href="#Curves.four-255"><span class="linenos">255</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves.four-256"><a href="#Curves.four-256"><span class="linenos">256</span></a>    <span class="k">def</span> <span class="nf">four</span><span class="p">(</span>
</span><span id="Curves.four-257"><a href="#Curves.four-257"><span class="linenos">257</span></a>        <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="Curves.four-258"><a href="#Curves.four-258"><span class="linenos">258</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves.four-259"><a href="#Curves.four-259"><span class="linenos">259</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves.four-260"><a href="#Curves.four-260"><span class="linenos">260</span></a><span class="sd">        Computes a quartic curve: y = a*x^4 + b*x^3 + c*x^2 + d*x + e.</span>
</span><span id="Curves.four-261"><a href="#Curves.four-261"><span class="linenos">261</span></a>
</span><span id="Curves.four-262"><a href="#Curves.four-262"><span class="linenos">262</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves.four-263"><a href="#Curves.four-263"><span class="linenos">263</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves.four-264"><a href="#Curves.four-264"><span class="linenos">264</span></a><span class="sd">        a, b, c, d, e (float): Coefficients for quartic, cubic,</span>
</span><span id="Curves.four-265"><a href="#Curves.four-265"><span class="linenos">265</span></a><span class="sd">        quadratic, linear, and constant terms.</span>
</span><span id="Curves.four-266"><a href="#Curves.four-266"><span class="linenos">266</span></a>
</span><span id="Curves.four-267"><a href="#Curves.four-267"><span class="linenos">267</span></a><span class="sd">        Returns:</span>
</span><span id="Curves.four-268"><a href="#Curves.four-268"><span class="linenos">268</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves.four-269"><a href="#Curves.four-269"><span class="linenos">269</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves.four-270"><a href="#Curves.four-270"><span class="linenos">270</span></a>
</span><span id="Curves.four-271"><a href="#Curves.four-271"><span class="linenos">271</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Curves.four-272"><a href="#Curves.four-272"><span class="linenos">272</span></a>        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">e</span>
</span></pre></div>


            <div class="docstring"><p>Computes a quartic curve: y = a<em>x^4 + b</em>x^3 + c<em>x^2 + d</em>x + e.</p>

<p>Parameters:
x (array-like): Input values.
a, b, c, d, e (float): Coefficients for quartic, cubic,
quadratic, linear, and constant terms.</p>

<p>Returns:
array-like: Transformed values.</p>
</div>


                            </div>
                            <div id="Curves.zipf" class="classattr">
                                        <input id="Curves.zipf-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">zipf</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="Curves.zipf-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves.zipf"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves.zipf-275"><a href="#Curves.zipf-275"><span class="linenos">275</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves.zipf-276"><a href="#Curves.zipf-276"><span class="linenos">276</span></a>    <span class="k">def</span> <span class="nf">zipf</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Curves.zipf-277"><a href="#Curves.zipf-277"><span class="linenos">277</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves.zipf-278"><a href="#Curves.zipf-278"><span class="linenos">278</span></a><span class="sd">        Computes a Zipf curve: y = 1 / (x + a)^b.</span>
</span><span id="Curves.zipf-279"><a href="#Curves.zipf-279"><span class="linenos">279</span></a>
</span><span id="Curves.zipf-280"><a href="#Curves.zipf-280"><span class="linenos">280</span></a><span class="sd">        Parameters:</span>
</span><span id="Curves.zipf-281"><a href="#Curves.zipf-281"><span class="linenos">281</span></a><span class="sd">        x (array-like): Input values.</span>
</span><span id="Curves.zipf-282"><a href="#Curves.zipf-282"><span class="linenos">282</span></a><span class="sd">        a (float): Offset to prevent division by zero.</span>
</span><span id="Curves.zipf-283"><a href="#Curves.zipf-283"><span class="linenos">283</span></a><span class="sd">        b (float): Exponent for scaling.</span>
</span><span id="Curves.zipf-284"><a href="#Curves.zipf-284"><span class="linenos">284</span></a>
</span><span id="Curves.zipf-285"><a href="#Curves.zipf-285"><span class="linenos">285</span></a><span class="sd">        Returns:</span>
</span><span id="Curves.zipf-286"><a href="#Curves.zipf-286"><span class="linenos">286</span></a><span class="sd">        array-like: Transformed values.</span>
</span><span id="Curves.zipf-287"><a href="#Curves.zipf-287"><span class="linenos">287</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves.zipf-288"><a href="#Curves.zipf-288"><span class="linenos">288</span></a>
</span><span id="Curves.zipf-289"><a href="#Curves.zipf-289"><span class="linenos">289</span></a>        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="n">b</span>
</span></pre></div>


            <div class="docstring"><p>Computes a Zipf curve: y = 1 / (x + a)^b.</p>

<p>Parameters:
x (array-like): Input values.
a (float): Offset to prevent division by zero.
b (float): Exponent for scaling.</p>

<p>Returns:
array-like: Transformed values.</p>
</div>


                            </div>
                            <div id="Curves.power_law" class="classattr">
                                        <input id="Curves.power_law-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">power_law</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">n</span>, </span><span class="param"><span class="n">A</span>, </span><span class="param"><span class="n">B</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Curves.power_law-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Curves.power_law"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Curves.power_law-292"><a href="#Curves.power_law-292"><span class="linenos">292</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Curves.power_law-293"><a href="#Curves.power_law-293"><span class="linenos">293</span></a>    <span class="k">def</span> <span class="nf">power_law</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
</span><span id="Curves.power_law-294"><a href="#Curves.power_law-294"><span class="linenos">294</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Curves.power_law-295"><a href="#Curves.power_law-295"><span class="linenos">295</span></a><span class="sd">        Power-law function used to model the number of unique places</span>
</span><span id="Curves.power_law-296"><a href="#Curves.power_law-296"><span class="linenos">296</span></a><span class="sd">        visited over time.</span>
</span><span id="Curves.power_law-297"><a href="#Curves.power_law-297"><span class="linenos">297</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Curves.power_law-298"><a href="#Curves.power_law-298"><span class="linenos">298</span></a>
</span><span id="Curves.power_law-299"><a href="#Curves.power_law-299"><span class="linenos">299</span></a>        <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">n</span><span class="o">**</span><span class="n">B</span>
</span></pre></div>


            <div class="docstring"><p>Power-law function used to model the number of unique places
visited over time.</p>
</div>


                            </div>
                </section>
                <section id="DistributionFitingTools">
                            <input id="DistributionFitingTools-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DistributionFitingTools</span>:

                <label class="view-source-button" for="DistributionFitingTools-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionFitingTools"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionFitingTools-302"><a href="#DistributionFitingTools-302"><span class="linenos">302</span></a><span class="k">class</span> <span class="nc">DistributionFitingTools</span><span class="p">:</span>
</span><span id="DistributionFitingTools-303"><a href="#DistributionFitingTools-303"><span class="linenos">303</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionFitingTools-304"><a href="#DistributionFitingTools-304"><span class="linenos">304</span></a><span class="sd">    A class containing tools for fitting distributions and models to data.</span>
</span><span id="DistributionFitingTools-305"><a href="#DistributionFitingTools-305"><span class="linenos">305</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DistributionFitingTools-306"><a href="#DistributionFitingTools-306"><span class="linenos">306</span></a>
</span><span id="DistributionFitingTools-307"><a href="#DistributionFitingTools-307"><span class="linenos">307</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionFitingTools-308"><a href="#DistributionFitingTools-308"><span class="linenos">308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">curves</span> <span class="o">=</span> <span class="n">Curves</span><span class="p">()</span>
</span><span id="DistributionFitingTools-309"><a href="#DistributionFitingTools-309"><span class="linenos">309</span></a>
</span><span id="DistributionFitingTools-310"><a href="#DistributionFitingTools-310"><span class="linenos">310</span></a>
</span><span id="DistributionFitingTools-311"><a href="#DistributionFitingTools-311"><span class="linenos">311</span></a>    <span class="k">def</span> <span class="nf">_fit_distribution</span><span class="p">(</span>
</span><span id="DistributionFitingTools-312"><a href="#DistributionFitingTools-312"><span class="linenos">312</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">distribution</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span>
</span><span id="DistributionFitingTools-313"><a href="#DistributionFitingTools-313"><span class="linenos">313</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="DistributionFitingTools-314"><a href="#DistributionFitingTools-314"><span class="linenos">314</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionFitingTools-315"><a href="#DistributionFitingTools-315"><span class="linenos">315</span></a><span class="sd">        Fits a given distribution to the data</span>
</span><span id="DistributionFitingTools-316"><a href="#DistributionFitingTools-316"><span class="linenos">316</span></a>
</span><span id="DistributionFitingTools-317"><a href="#DistributionFitingTools-317"><span class="linenos">317</span></a><span class="sd">        Parameters:</span>
</span><span id="DistributionFitingTools-318"><a href="#DistributionFitingTools-318"><span class="linenos">318</span></a><span class="sd">        ----------</span>
</span><span id="DistributionFitingTools-319"><a href="#DistributionFitingTools-319"><span class="linenos">319</span></a><span class="sd">        data : numpy.ndarray</span>
</span><span id="DistributionFitingTools-320"><a href="#DistributionFitingTools-320"><span class="linenos">320</span></a><span class="sd">            The data to which the distribution is fitted.</span>
</span><span id="DistributionFitingTools-321"><a href="#DistributionFitingTools-321"><span class="linenos">321</span></a><span class="sd">        distribution : scipy.stats.rv_continuous</span>
</span><span id="DistributionFitingTools-322"><a href="#DistributionFitingTools-322"><span class="linenos">322</span></a><span class="sd">            The distribution to fit to the data.</span>
</span><span id="DistributionFitingTools-323"><a href="#DistributionFitingTools-323"><span class="linenos">323</span></a>
</span><span id="DistributionFitingTools-324"><a href="#DistributionFitingTools-324"><span class="linenos">324</span></a><span class="sd">        Returns:</span>
</span><span id="DistributionFitingTools-325"><a href="#DistributionFitingTools-325"><span class="linenos">325</span></a><span class="sd">        -------</span>
</span><span id="DistributionFitingTools-326"><a href="#DistributionFitingTools-326"><span class="linenos">326</span></a><span class="sd">        float</span>
</span><span id="DistributionFitingTools-327"><a href="#DistributionFitingTools-327"><span class="linenos">327</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionFitingTools-328"><a href="#DistributionFitingTools-328"><span class="linenos">328</span></a>
</span><span id="DistributionFitingTools-329"><a href="#DistributionFitingTools-329"><span class="linenos">329</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="DistributionFitingTools-330"><a href="#DistributionFitingTools-330"><span class="linenos">330</span></a>        <span class="n">arg</span> <span class="o">=</span> <span class="n">params</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="DistributionFitingTools-331"><a href="#DistributionFitingTools-331"><span class="linenos">331</span></a>        <span class="n">loc</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="DistributionFitingTools-332"><a href="#DistributionFitingTools-332"><span class="linenos">332</span></a>        <span class="n">scale</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="DistributionFitingTools-333"><a href="#DistributionFitingTools-333"><span class="linenos">333</span></a>        <span class="n">pdf_values</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span>
</span><span id="DistributionFitingTools-334"><a href="#DistributionFitingTools-334"><span class="linenos">334</span></a>        <span class="n">log_likelihood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pdf_values</span><span class="p">))</span>
</span><span id="DistributionFitingTools-335"><a href="#DistributionFitingTools-335"><span class="linenos">335</span></a>        <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="DistributionFitingTools-336"><a href="#DistributionFitingTools-336"><span class="linenos">336</span></a>        <span class="n">aic</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">log_likelihood</span>
</span><span id="DistributionFitingTools-337"><a href="#DistributionFitingTools-337"><span class="linenos">337</span></a>        <span class="n">aicc</span> <span class="o">=</span> <span class="n">aic</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">num_params</span> <span class="o">*</span> <span class="p">(</span><span class="n">num_params</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
</span><span id="DistributionFitingTools-338"><a href="#DistributionFitingTools-338"><span class="linenos">338</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">num_params</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="DistributionFitingTools-339"><a href="#DistributionFitingTools-339"><span class="linenos">339</span></a>        <span class="p">)</span>  <span class="c1"># AICc correction</span>
</span><span id="DistributionFitingTools-340"><a href="#DistributionFitingTools-340"><span class="linenos">340</span></a>
</span><span id="DistributionFitingTools-341"><a href="#DistributionFitingTools-341"><span class="linenos">341</span></a>        <span class="k">return</span> <span class="n">aicc</span>
</span><span id="DistributionFitingTools-342"><a href="#DistributionFitingTools-342"><span class="linenos">342</span></a>
</span><span id="DistributionFitingTools-343"><a href="#DistributionFitingTools-343"><span class="linenos">343</span></a>
</span><span id="DistributionFitingTools-344"><a href="#DistributionFitingTools-344"><span class="linenos">344</span></a>    <span class="k">def</span> <span class="nf">_calculate_akaike_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aic_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="DistributionFitingTools-345"><a href="#DistributionFitingTools-345"><span class="linenos">345</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionFitingTools-346"><a href="#DistributionFitingTools-346"><span class="linenos">346</span></a><span class="sd">        Calculates Akaike weights from AIC values.</span>
</span><span id="DistributionFitingTools-347"><a href="#DistributionFitingTools-347"><span class="linenos">347</span></a>
</span><span id="DistributionFitingTools-348"><a href="#DistributionFitingTools-348"><span class="linenos">348</span></a><span class="sd">        Parameters:</span>
</span><span id="DistributionFitingTools-349"><a href="#DistributionFitingTools-349"><span class="linenos">349</span></a><span class="sd">        ----------</span>
</span><span id="DistributionFitingTools-350"><a href="#DistributionFitingTools-350"><span class="linenos">350</span></a><span class="sd">        aic_values : list of float</span>
</span><span id="DistributionFitingTools-351"><a href="#DistributionFitingTools-351"><span class="linenos">351</span></a><span class="sd">            The list of AIC values for different models.</span>
</span><span id="DistributionFitingTools-352"><a href="#DistributionFitingTools-352"><span class="linenos">352</span></a>
</span><span id="DistributionFitingTools-353"><a href="#DistributionFitingTools-353"><span class="linenos">353</span></a><span class="sd">        Returns:</span>
</span><span id="DistributionFitingTools-354"><a href="#DistributionFitingTools-354"><span class="linenos">354</span></a><span class="sd">        -------</span>
</span><span id="DistributionFitingTools-355"><a href="#DistributionFitingTools-355"><span class="linenos">355</span></a><span class="sd">        numpy.ndarray</span>
</span><span id="DistributionFitingTools-356"><a href="#DistributionFitingTools-356"><span class="linenos">356</span></a><span class="sd">            The Akaike weights corresponding to each AIC value.</span>
</span><span id="DistributionFitingTools-357"><a href="#DistributionFitingTools-357"><span class="linenos">357</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionFitingTools-358"><a href="#DistributionFitingTools-358"><span class="linenos">358</span></a>
</span><span id="DistributionFitingTools-359"><a href="#DistributionFitingTools-359"><span class="linenos">359</span></a>        <span class="n">delta_aic</span> <span class="o">=</span> <span class="n">aic_values</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">aic_values</span><span class="p">)</span>
</span><span id="DistributionFitingTools-360"><a href="#DistributionFitingTools-360"><span class="linenos">360</span></a>        <span class="n">exp_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">delta_aic</span><span class="p">)</span>
</span><span id="DistributionFitingTools-361"><a href="#DistributionFitingTools-361"><span class="linenos">361</span></a>        <span class="n">weights</span> <span class="o">=</span> <span class="n">exp_term</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">exp_term</span><span class="p">)</span>
</span><span id="DistributionFitingTools-362"><a href="#DistributionFitingTools-362"><span class="linenos">362</span></a>
</span><span id="DistributionFitingTools-363"><a href="#DistributionFitingTools-363"><span class="linenos">363</span></a>        <span class="k">return</span> <span class="n">weights</span>
</span><span id="DistributionFitingTools-364"><a href="#DistributionFitingTools-364"><span class="linenos">364</span></a>
</span><span id="DistributionFitingTools-365"><a href="#DistributionFitingTools-365"><span class="linenos">365</span></a>
</span><span id="DistributionFitingTools-366"><a href="#DistributionFitingTools-366"><span class="linenos">366</span></a>    <span class="k">def</span> <span class="nf">_multiple_distributions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DistributionFitingTools-367"><a href="#DistributionFitingTools-367"><span class="linenos">367</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionFitingTools-368"><a href="#DistributionFitingTools-368"><span class="linenos">368</span></a><span class="sd">        Fits multiple distributions to the data and selects</span>
</span><span id="DistributionFitingTools-369"><a href="#DistributionFitingTools-369"><span class="linenos">369</span></a><span class="sd">        the best one based on AICc.</span>
</span><span id="DistributionFitingTools-370"><a href="#DistributionFitingTools-370"><span class="linenos">370</span></a>
</span><span id="DistributionFitingTools-371"><a href="#DistributionFitingTools-371"><span class="linenos">371</span></a><span class="sd">        Parameters:</span>
</span><span id="DistributionFitingTools-372"><a href="#DistributionFitingTools-372"><span class="linenos">372</span></a><span class="sd">        ----------</span>
</span><span id="DistributionFitingTools-373"><a href="#DistributionFitingTools-373"><span class="linenos">373</span></a><span class="sd">        data : numpy.ndarray</span>
</span><span id="DistributionFitingTools-374"><a href="#DistributionFitingTools-374"><span class="linenos">374</span></a><span class="sd">            The data to which the distributions are fitted.</span>
</span><span id="DistributionFitingTools-375"><a href="#DistributionFitingTools-375"><span class="linenos">375</span></a>
</span><span id="DistributionFitingTools-376"><a href="#DistributionFitingTools-376"><span class="linenos">376</span></a><span class="sd">        Returns:</span>
</span><span id="DistributionFitingTools-377"><a href="#DistributionFitingTools-377"><span class="linenos">377</span></a><span class="sd">        -------</span>
</span><span id="DistributionFitingTools-378"><a href="#DistributionFitingTools-378"><span class="linenos">378</span></a><span class="sd">        tuple</span>
</span><span id="DistributionFitingTools-379"><a href="#DistributionFitingTools-379"><span class="linenos">379</span></a><span class="sd">            The best fitting distribution and weights of results</span>
</span><span id="DistributionFitingTools-380"><a href="#DistributionFitingTools-380"><span class="linenos">380</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionFitingTools-381"><a href="#DistributionFitingTools-381"><span class="linenos">381</span></a>
</span><span id="DistributionFitingTools-382"><a href="#DistributionFitingTools-382"><span class="linenos">382</span></a>        <span class="n">distributions</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionFitingTools-383"><a href="#DistributionFitingTools-383"><span class="linenos">383</span></a>            <span class="n">scp_stats</span><span class="o">.</span><span class="n">lognorm</span><span class="p">,</span>
</span><span id="DistributionFitingTools-384"><a href="#DistributionFitingTools-384"><span class="linenos">384</span></a>            <span class="n">scp_stats</span><span class="o">.</span><span class="n">expon</span><span class="p">,</span>
</span><span id="DistributionFitingTools-385"><a href="#DistributionFitingTools-385"><span class="linenos">385</span></a>            <span class="n">scp_stats</span><span class="o">.</span><span class="n">powerlaw</span><span class="p">,</span>
</span><span id="DistributionFitingTools-386"><a href="#DistributionFitingTools-386"><span class="linenos">386</span></a>            <span class="n">scp_stats</span><span class="o">.</span><span class="n">norm</span><span class="p">,</span>
</span><span id="DistributionFitingTools-387"><a href="#DistributionFitingTools-387"><span class="linenos">387</span></a>            <span class="n">scp_stats</span><span class="o">.</span><span class="n">pareto</span><span class="p">,</span>
</span><span id="DistributionFitingTools-388"><a href="#DistributionFitingTools-388"><span class="linenos">388</span></a>        <span class="p">]</span>
</span><span id="DistributionFitingTools-389"><a href="#DistributionFitingTools-389"><span class="linenos">389</span></a>
</span><span id="DistributionFitingTools-390"><a href="#DistributionFitingTools-390"><span class="linenos">390</span></a>        <span class="n">aic_values</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DistributionFitingTools-391"><a href="#DistributionFitingTools-391"><span class="linenos">391</span></a>
</span><span id="DistributionFitingTools-392"><a href="#DistributionFitingTools-392"><span class="linenos">392</span></a>        <span class="k">for</span> <span class="n">distribution</span> <span class="ow">in</span> <span class="n">distributions</span><span class="p">:</span>
</span><span id="DistributionFitingTools-393"><a href="#DistributionFitingTools-393"><span class="linenos">393</span></a>            <span class="n">current_aic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_distribution</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">distribution</span><span class="p">)</span>
</span><span id="DistributionFitingTools-394"><a href="#DistributionFitingTools-394"><span class="linenos">394</span></a>            <span class="n">aic_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_aic</span><span class="p">)</span>
</span><span id="DistributionFitingTools-395"><a href="#DistributionFitingTools-395"><span class="linenos">395</span></a>
</span><span id="DistributionFitingTools-396"><a href="#DistributionFitingTools-396"><span class="linenos">396</span></a>        <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_akaike_weights</span><span class="p">(</span><span class="n">aic_values</span><span class="p">)</span>
</span><span id="DistributionFitingTools-397"><a href="#DistributionFitingTools-397"><span class="linenos">397</span></a>
</span><span id="DistributionFitingTools-398"><a href="#DistributionFitingTools-398"><span class="linenos">398</span></a>        <span class="n">best_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanargmin</span><span class="p">(</span><span class="n">aic_values</span><span class="p">)</span>
</span><span id="DistributionFitingTools-399"><a href="#DistributionFitingTools-399"><span class="linenos">399</span></a>        <span class="n">best_distribution</span> <span class="o">=</span> <span class="n">distributions</span><span class="p">[</span><span class="n">best_index</span><span class="p">]</span>
</span><span id="DistributionFitingTools-400"><a href="#DistributionFitingTools-400"><span class="linenos">400</span></a>
</span><span id="DistributionFitingTools-401"><a href="#DistributionFitingTools-401"><span class="linenos">401</span></a>        <span class="k">return</span> <span class="n">best_distribution</span><span class="p">,</span> <span class="n">weights</span>
</span><span id="DistributionFitingTools-402"><a href="#DistributionFitingTools-402"><span class="linenos">402</span></a>
</span><span id="DistributionFitingTools-403"><a href="#DistributionFitingTools-403"><span class="linenos">403</span></a>
</span><span id="DistributionFitingTools-404"><a href="#DistributionFitingTools-404"><span class="linenos">404</span></a>    <span class="k">def</span> <span class="nf">model_choose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vals</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DistributionFitingTools-405"><a href="#DistributionFitingTools-405"><span class="linenos">405</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionFitingTools-406"><a href="#DistributionFitingTools-406"><span class="linenos">406</span></a><span class="sd">        Chooses the best fitting model from a set of predefined curves</span>
</span><span id="DistributionFitingTools-407"><a href="#DistributionFitingTools-407"><span class="linenos">407</span></a><span class="sd">        based on AICc.</span>
</span><span id="DistributionFitingTools-408"><a href="#DistributionFitingTools-408"><span class="linenos">408</span></a>
</span><span id="DistributionFitingTools-409"><a href="#DistributionFitingTools-409"><span class="linenos">409</span></a><span class="sd">        Parameters:</span>
</span><span id="DistributionFitingTools-410"><a href="#DistributionFitingTools-410"><span class="linenos">410</span></a><span class="sd">        ----------</span>
</span><span id="DistributionFitingTools-411"><a href="#DistributionFitingTools-411"><span class="linenos">411</span></a><span class="sd">        vals : pandas.Series</span>
</span><span id="DistributionFitingTools-412"><a href="#DistributionFitingTools-412"><span class="linenos">412</span></a><span class="sd">            The data to which the models are fitted.</span>
</span><span id="DistributionFitingTools-413"><a href="#DistributionFitingTools-413"><span class="linenos">413</span></a>
</span><span id="DistributionFitingTools-414"><a href="#DistributionFitingTools-414"><span class="linenos">414</span></a><span class="sd">        Returns:</span>
</span><span id="DistributionFitingTools-415"><a href="#DistributionFitingTools-415"><span class="linenos">415</span></a><span class="sd">        -------</span>
</span><span id="DistributionFitingTools-416"><a href="#DistributionFitingTools-416"><span class="linenos">416</span></a><span class="sd">        tuple</span>
</span><span id="DistributionFitingTools-417"><a href="#DistributionFitingTools-417"><span class="linenos">417</span></a><span class="sd">            The best fit model, its name, parameters, and a DataFrame</span>
</span><span id="DistributionFitingTools-418"><a href="#DistributionFitingTools-418"><span class="linenos">418</span></a><span class="sd">            containing model information.</span>
</span><span id="DistributionFitingTools-419"><a href="#DistributionFitingTools-419"><span class="linenos">419</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionFitingTools-420"><a href="#DistributionFitingTools-420"><span class="linenos">420</span></a>
</span><span id="DistributionFitingTools-421"><a href="#DistributionFitingTools-421"><span class="linenos">421</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DistributionFitingTools-422"><a href="#DistributionFitingTools-422"><span class="linenos">422</span></a>        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DistributionFitingTools-423"><a href="#DistributionFitingTools-423"><span class="linenos">423</span></a>        <span class="n">expon_pred</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DistributionFitingTools-424"><a href="#DistributionFitingTools-424"><span class="linenos">424</span></a>        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="DistributionFitingTools-425"><a href="#DistributionFitingTools-425"><span class="linenos">425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">linear</span><span class="p">,</span>
</span><span id="DistributionFitingTools-426"><a href="#DistributionFitingTools-426"><span class="linenos">426</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">expon</span><span class="p">,</span>
</span><span id="DistributionFitingTools-427"><a href="#DistributionFitingTools-427"><span class="linenos">427</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">expon_neg</span><span class="p">,</span>
</span><span id="DistributionFitingTools-428"><a href="#DistributionFitingTools-428"><span class="linenos">428</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">,</span>
</span><span id="DistributionFitingTools-429"><a href="#DistributionFitingTools-429"><span class="linenos">429</span></a>        <span class="p">]:</span>
</span><span id="DistributionFitingTools-430"><a href="#DistributionFitingTools-430"><span class="linenos">430</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DistributionFitingTools-431"><a href="#DistributionFitingTools-431"><span class="linenos">431</span></a>                <span class="n">params</span><span class="p">,</span> <span class="n">covar</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="DistributionFitingTools-432"><a href="#DistributionFitingTools-432"><span class="linenos">432</span></a>                <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="DistributionFitingTools-433"><a href="#DistributionFitingTools-433"><span class="linenos">433</span></a>
</span><span id="DistributionFitingTools-434"><a href="#DistributionFitingTools-434"><span class="linenos">434</span></a>                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="DistributionFitingTools-435"><a href="#DistributionFitingTools-435"><span class="linenos">435</span></a>                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;expon&quot;</span><span class="p">:</span>
</span><span id="DistributionFitingTools-436"><a href="#DistributionFitingTools-436"><span class="linenos">436</span></a>                    <span class="n">expon_pred</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="DistributionFitingTools-437"><a href="#DistributionFitingTools-437"><span class="linenos">437</span></a>                <span class="n">residuals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">y_pred</span>
</span><span id="DistributionFitingTools-438"><a href="#DistributionFitingTools-438"><span class="linenos">438</span></a>
</span><span id="DistributionFitingTools-439"><a href="#DistributionFitingTools-439"><span class="linenos">439</span></a>                <span class="n">aic</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="DistributionFitingTools-440"><a href="#DistributionFitingTools-440"><span class="linenos">440</span></a>                <span class="n">aicc</span> <span class="o">=</span> <span class="n">aic</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">num_params</span> <span class="o">*</span> <span class="p">(</span><span class="n">num_params</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
</span><span id="DistributionFitingTools-441"><a href="#DistributionFitingTools-441"><span class="linenos">441</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="o">-</span> <span class="n">num_params</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="DistributionFitingTools-442"><a href="#DistributionFitingTools-442"><span class="linenos">442</span></a>                <span class="p">)</span>
</span><span id="DistributionFitingTools-443"><a href="#DistributionFitingTools-443"><span class="linenos">443</span></a>                <span class="n">scores</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">aicc</span>
</span><span id="DistributionFitingTools-444"><a href="#DistributionFitingTools-444"><span class="linenos">444</span></a>                <span class="n">parameters</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>
</span><span id="DistributionFitingTools-445"><a href="#DistributionFitingTools-445"><span class="linenos">445</span></a>
</span><span id="DistributionFitingTools-446"><a href="#DistributionFitingTools-446"><span class="linenos">446</span></a>            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DistributionFitingTools-447"><a href="#DistributionFitingTools-447"><span class="linenos">447</span></a>                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="DistributionFitingTools-448"><a href="#DistributionFitingTools-448"><span class="linenos">448</span></a>                <span class="k">continue</span>
</span><span id="DistributionFitingTools-449"><a href="#DistributionFitingTools-449"><span class="linenos">449</span></a>
</span><span id="DistributionFitingTools-450"><a href="#DistributionFitingTools-450"><span class="linenos">450</span></a>        <span class="n">min_aicc</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">scores</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="DistributionFitingTools-451"><a href="#DistributionFitingTools-451"><span class="linenos">451</span></a>        <span class="n">min_aicc</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">min_aicc</span><span class="p">]</span>
</span><span id="DistributionFitingTools-452"><a href="#DistributionFitingTools-452"><span class="linenos">452</span></a>        <span class="n">waicc</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="o">-</span> <span class="n">min_aicc</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="DistributionFitingTools-453"><a href="#DistributionFitingTools-453"><span class="linenos">453</span></a>        <span class="n">waicc</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">waicc</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="DistributionFitingTools-454"><a href="#DistributionFitingTools-454"><span class="linenos">454</span></a>        <span class="n">waicc</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">waicc</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">waicc</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="DistributionFitingTools-455"><a href="#DistributionFitingTools-455"><span class="linenos">455</span></a>
</span><span id="DistributionFitingTools-456"><a href="#DistributionFitingTools-456"><span class="linenos">456</span></a>        <span class="n">global_params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="DistributionFitingTools-457"><a href="#DistributionFitingTools-457"><span class="linenos">457</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
</span><span id="DistributionFitingTools-458"><a href="#DistributionFitingTools-458"><span class="linenos">458</span></a>                <span class="s2">&quot;curve&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="s2">&quot;param1&quot;</span><span class="p">,</span> <span class="s2">&quot;param2&quot;</span>
</span><span id="DistributionFitingTools-459"><a href="#DistributionFitingTools-459"><span class="linenos">459</span></a>                <span class="p">]</span>
</span><span id="DistributionFitingTools-460"><a href="#DistributionFitingTools-460"><span class="linenos">460</span></a>            <span class="p">)</span>
</span><span id="DistributionFitingTools-461"><a href="#DistributionFitingTools-461"><span class="linenos">461</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">key1</span><span class="p">,</span> <span class="n">value1</span><span class="p">),</span> <span class="p">(</span><span class="n">key2</span><span class="p">,</span> <span class="n">value2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">waicc</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
</span><span id="DistributionFitingTools-462"><a href="#DistributionFitingTools-462"><span class="linenos">462</span></a>            <span class="k">if</span> <span class="n">key1</span> <span class="o">==</span> <span class="n">key2</span><span class="p">:</span>
</span><span id="DistributionFitingTools-463"><a href="#DistributionFitingTools-463"><span class="linenos">463</span></a>                <span class="n">global_params</span> <span class="o">=</span> <span class="n">global_params</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span>
</span><span id="DistributionFitingTools-464"><a href="#DistributionFitingTools-464"><span class="linenos">464</span></a>                    <span class="p">{</span>
</span><span id="DistributionFitingTools-465"><a href="#DistributionFitingTools-465"><span class="linenos">465</span></a>                        <span class="s2">&quot;curve&quot;</span><span class="p">:</span> <span class="n">key2</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="DistributionFitingTools-466"><a href="#DistributionFitingTools-466"><span class="linenos">466</span></a>                        <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">value1</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
</span><span id="DistributionFitingTools-467"><a href="#DistributionFitingTools-467"><span class="linenos">467</span></a>                        <span class="s2">&quot;param1&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">value2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">25</span><span class="p">),</span>
</span><span id="DistributionFitingTools-468"><a href="#DistributionFitingTools-468"><span class="linenos">468</span></a>                        <span class="s2">&quot;param2&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">value2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">25</span><span class="p">),</span>
</span><span id="DistributionFitingTools-469"><a href="#DistributionFitingTools-469"><span class="linenos">469</span></a>                    <span class="p">},</span>
</span><span id="DistributionFitingTools-470"><a href="#DistributionFitingTools-470"><span class="linenos">470</span></a>                    <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DistributionFitingTools-471"><a href="#DistributionFitingTools-471"><span class="linenos">471</span></a>                <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="DistributionFitingTools-472"><a href="#DistributionFitingTools-472"><span class="linenos">472</span></a>
</span><span id="DistributionFitingTools-473"><a href="#DistributionFitingTools-473"><span class="linenos">473</span></a>        <span class="n">best_fit</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">waicc</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">waicc</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="DistributionFitingTools-474"><a href="#DistributionFitingTools-474"><span class="linenos">474</span></a>        <span class="n">params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">best_fit</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="DistributionFitingTools-475"><a href="#DistributionFitingTools-475"><span class="linenos">475</span></a>
</span><span id="DistributionFitingTools-476"><a href="#DistributionFitingTools-476"><span class="linenos">476</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="DistributionFitingTools-477"><a href="#DistributionFitingTools-477"><span class="linenos">477</span></a>            <span class="n">best_fit</span><span class="p">(</span><span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">),</span>
</span><span id="DistributionFitingTools-478"><a href="#DistributionFitingTools-478"><span class="linenos">478</span></a>            <span class="n">best_fit</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="DistributionFitingTools-479"><a href="#DistributionFitingTools-479"><span class="linenos">479</span></a>            <span class="n">params</span><span class="p">,</span>
</span><span id="DistributionFitingTools-480"><a href="#DistributionFitingTools-480"><span class="linenos">480</span></a>            <span class="n">global_params</span><span class="p">,</span>
</span><span id="DistributionFitingTools-481"><a href="#DistributionFitingTools-481"><span class="linenos">481</span></a>            <span class="n">expon_pred</span><span class="p">,</span>
</span><span id="DistributionFitingTools-482"><a href="#DistributionFitingTools-482"><span class="linenos">482</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A class containing tools for fitting distributions and models to data.</p>
</div>


                            <div id="DistributionFitingTools.curves" class="classattr">
                                <div class="attr variable">
            <span class="name">curves</span>

        
    </div>
    <a class="headerlink" href="#DistributionFitingTools.curves"></a>
    
    

                            </div>
                            <div id="DistributionFitingTools.model_choose" class="classattr">
                                        <input id="DistributionFitingTools.model_choose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">model_choose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">vals</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span></span><span class="return-annotation">) -> <span class="nb">tuple</span>:</span></span>

                <label class="view-source-button" for="DistributionFitingTools.model_choose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionFitingTools.model_choose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionFitingTools.model_choose-404"><a href="#DistributionFitingTools.model_choose-404"><span class="linenos">404</span></a>    <span class="k">def</span> <span class="nf">model_choose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vals</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="DistributionFitingTools.model_choose-405"><a href="#DistributionFitingTools.model_choose-405"><span class="linenos">405</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionFitingTools.model_choose-406"><a href="#DistributionFitingTools.model_choose-406"><span class="linenos">406</span></a><span class="sd">        Chooses the best fitting model from a set of predefined curves</span>
</span><span id="DistributionFitingTools.model_choose-407"><a href="#DistributionFitingTools.model_choose-407"><span class="linenos">407</span></a><span class="sd">        based on AICc.</span>
</span><span id="DistributionFitingTools.model_choose-408"><a href="#DistributionFitingTools.model_choose-408"><span class="linenos">408</span></a>
</span><span id="DistributionFitingTools.model_choose-409"><a href="#DistributionFitingTools.model_choose-409"><span class="linenos">409</span></a><span class="sd">        Parameters:</span>
</span><span id="DistributionFitingTools.model_choose-410"><a href="#DistributionFitingTools.model_choose-410"><span class="linenos">410</span></a><span class="sd">        ----------</span>
</span><span id="DistributionFitingTools.model_choose-411"><a href="#DistributionFitingTools.model_choose-411"><span class="linenos">411</span></a><span class="sd">        vals : pandas.Series</span>
</span><span id="DistributionFitingTools.model_choose-412"><a href="#DistributionFitingTools.model_choose-412"><span class="linenos">412</span></a><span class="sd">            The data to which the models are fitted.</span>
</span><span id="DistributionFitingTools.model_choose-413"><a href="#DistributionFitingTools.model_choose-413"><span class="linenos">413</span></a>
</span><span id="DistributionFitingTools.model_choose-414"><a href="#DistributionFitingTools.model_choose-414"><span class="linenos">414</span></a><span class="sd">        Returns:</span>
</span><span id="DistributionFitingTools.model_choose-415"><a href="#DistributionFitingTools.model_choose-415"><span class="linenos">415</span></a><span class="sd">        -------</span>
</span><span id="DistributionFitingTools.model_choose-416"><a href="#DistributionFitingTools.model_choose-416"><span class="linenos">416</span></a><span class="sd">        tuple</span>
</span><span id="DistributionFitingTools.model_choose-417"><a href="#DistributionFitingTools.model_choose-417"><span class="linenos">417</span></a><span class="sd">            The best fit model, its name, parameters, and a DataFrame</span>
</span><span id="DistributionFitingTools.model_choose-418"><a href="#DistributionFitingTools.model_choose-418"><span class="linenos">418</span></a><span class="sd">            containing model information.</span>
</span><span id="DistributionFitingTools.model_choose-419"><a href="#DistributionFitingTools.model_choose-419"><span class="linenos">419</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionFitingTools.model_choose-420"><a href="#DistributionFitingTools.model_choose-420"><span class="linenos">420</span></a>
</span><span id="DistributionFitingTools.model_choose-421"><a href="#DistributionFitingTools.model_choose-421"><span class="linenos">421</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DistributionFitingTools.model_choose-422"><a href="#DistributionFitingTools.model_choose-422"><span class="linenos">422</span></a>        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DistributionFitingTools.model_choose-423"><a href="#DistributionFitingTools.model_choose-423"><span class="linenos">423</span></a>        <span class="n">expon_pred</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DistributionFitingTools.model_choose-424"><a href="#DistributionFitingTools.model_choose-424"><span class="linenos">424</span></a>        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="DistributionFitingTools.model_choose-425"><a href="#DistributionFitingTools.model_choose-425"><span class="linenos">425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">linear</span><span class="p">,</span>
</span><span id="DistributionFitingTools.model_choose-426"><a href="#DistributionFitingTools.model_choose-426"><span class="linenos">426</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">expon</span><span class="p">,</span>
</span><span id="DistributionFitingTools.model_choose-427"><a href="#DistributionFitingTools.model_choose-427"><span class="linenos">427</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">expon_neg</span><span class="p">,</span>
</span><span id="DistributionFitingTools.model_choose-428"><a href="#DistributionFitingTools.model_choose-428"><span class="linenos">428</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">,</span>
</span><span id="DistributionFitingTools.model_choose-429"><a href="#DistributionFitingTools.model_choose-429"><span class="linenos">429</span></a>        <span class="p">]:</span>
</span><span id="DistributionFitingTools.model_choose-430"><a href="#DistributionFitingTools.model_choose-430"><span class="linenos">430</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DistributionFitingTools.model_choose-431"><a href="#DistributionFitingTools.model_choose-431"><span class="linenos">431</span></a>                <span class="n">params</span><span class="p">,</span> <span class="n">covar</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="DistributionFitingTools.model_choose-432"><a href="#DistributionFitingTools.model_choose-432"><span class="linenos">432</span></a>                <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="DistributionFitingTools.model_choose-433"><a href="#DistributionFitingTools.model_choose-433"><span class="linenos">433</span></a>
</span><span id="DistributionFitingTools.model_choose-434"><a href="#DistributionFitingTools.model_choose-434"><span class="linenos">434</span></a>                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="DistributionFitingTools.model_choose-435"><a href="#DistributionFitingTools.model_choose-435"><span class="linenos">435</span></a>                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;expon&quot;</span><span class="p">:</span>
</span><span id="DistributionFitingTools.model_choose-436"><a href="#DistributionFitingTools.model_choose-436"><span class="linenos">436</span></a>                    <span class="n">expon_pred</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="DistributionFitingTools.model_choose-437"><a href="#DistributionFitingTools.model_choose-437"><span class="linenos">437</span></a>                <span class="n">residuals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">y_pred</span>
</span><span id="DistributionFitingTools.model_choose-438"><a href="#DistributionFitingTools.model_choose-438"><span class="linenos">438</span></a>
</span><span id="DistributionFitingTools.model_choose-439"><a href="#DistributionFitingTools.model_choose-439"><span class="linenos">439</span></a>                <span class="n">aic</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="DistributionFitingTools.model_choose-440"><a href="#DistributionFitingTools.model_choose-440"><span class="linenos">440</span></a>                <span class="n">aicc</span> <span class="o">=</span> <span class="n">aic</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">num_params</span> <span class="o">*</span> <span class="p">(</span><span class="n">num_params</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
</span><span id="DistributionFitingTools.model_choose-441"><a href="#DistributionFitingTools.model_choose-441"><span class="linenos">441</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="o">-</span> <span class="n">num_params</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="DistributionFitingTools.model_choose-442"><a href="#DistributionFitingTools.model_choose-442"><span class="linenos">442</span></a>                <span class="p">)</span>
</span><span id="DistributionFitingTools.model_choose-443"><a href="#DistributionFitingTools.model_choose-443"><span class="linenos">443</span></a>                <span class="n">scores</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">aicc</span>
</span><span id="DistributionFitingTools.model_choose-444"><a href="#DistributionFitingTools.model_choose-444"><span class="linenos">444</span></a>                <span class="n">parameters</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>
</span><span id="DistributionFitingTools.model_choose-445"><a href="#DistributionFitingTools.model_choose-445"><span class="linenos">445</span></a>
</span><span id="DistributionFitingTools.model_choose-446"><a href="#DistributionFitingTools.model_choose-446"><span class="linenos">446</span></a>            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DistributionFitingTools.model_choose-447"><a href="#DistributionFitingTools.model_choose-447"><span class="linenos">447</span></a>                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="DistributionFitingTools.model_choose-448"><a href="#DistributionFitingTools.model_choose-448"><span class="linenos">448</span></a>                <span class="k">continue</span>
</span><span id="DistributionFitingTools.model_choose-449"><a href="#DistributionFitingTools.model_choose-449"><span class="linenos">449</span></a>
</span><span id="DistributionFitingTools.model_choose-450"><a href="#DistributionFitingTools.model_choose-450"><span class="linenos">450</span></a>        <span class="n">min_aicc</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">scores</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="DistributionFitingTools.model_choose-451"><a href="#DistributionFitingTools.model_choose-451"><span class="linenos">451</span></a>        <span class="n">min_aicc</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">min_aicc</span><span class="p">]</span>
</span><span id="DistributionFitingTools.model_choose-452"><a href="#DistributionFitingTools.model_choose-452"><span class="linenos">452</span></a>        <span class="n">waicc</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="o">-</span> <span class="n">min_aicc</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="DistributionFitingTools.model_choose-453"><a href="#DistributionFitingTools.model_choose-453"><span class="linenos">453</span></a>        <span class="n">waicc</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">waicc</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="DistributionFitingTools.model_choose-454"><a href="#DistributionFitingTools.model_choose-454"><span class="linenos">454</span></a>        <span class="n">waicc</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">waicc</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">waicc</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="DistributionFitingTools.model_choose-455"><a href="#DistributionFitingTools.model_choose-455"><span class="linenos">455</span></a>
</span><span id="DistributionFitingTools.model_choose-456"><a href="#DistributionFitingTools.model_choose-456"><span class="linenos">456</span></a>        <span class="n">global_params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="DistributionFitingTools.model_choose-457"><a href="#DistributionFitingTools.model_choose-457"><span class="linenos">457</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
</span><span id="DistributionFitingTools.model_choose-458"><a href="#DistributionFitingTools.model_choose-458"><span class="linenos">458</span></a>                <span class="s2">&quot;curve&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="s2">&quot;param1&quot;</span><span class="p">,</span> <span class="s2">&quot;param2&quot;</span>
</span><span id="DistributionFitingTools.model_choose-459"><a href="#DistributionFitingTools.model_choose-459"><span class="linenos">459</span></a>                <span class="p">]</span>
</span><span id="DistributionFitingTools.model_choose-460"><a href="#DistributionFitingTools.model_choose-460"><span class="linenos">460</span></a>            <span class="p">)</span>
</span><span id="DistributionFitingTools.model_choose-461"><a href="#DistributionFitingTools.model_choose-461"><span class="linenos">461</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">key1</span><span class="p">,</span> <span class="n">value1</span><span class="p">),</span> <span class="p">(</span><span class="n">key2</span><span class="p">,</span> <span class="n">value2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">waicc</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
</span><span id="DistributionFitingTools.model_choose-462"><a href="#DistributionFitingTools.model_choose-462"><span class="linenos">462</span></a>            <span class="k">if</span> <span class="n">key1</span> <span class="o">==</span> <span class="n">key2</span><span class="p">:</span>
</span><span id="DistributionFitingTools.model_choose-463"><a href="#DistributionFitingTools.model_choose-463"><span class="linenos">463</span></a>                <span class="n">global_params</span> <span class="o">=</span> <span class="n">global_params</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span>
</span><span id="DistributionFitingTools.model_choose-464"><a href="#DistributionFitingTools.model_choose-464"><span class="linenos">464</span></a>                    <span class="p">{</span>
</span><span id="DistributionFitingTools.model_choose-465"><a href="#DistributionFitingTools.model_choose-465"><span class="linenos">465</span></a>                        <span class="s2">&quot;curve&quot;</span><span class="p">:</span> <span class="n">key2</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="DistributionFitingTools.model_choose-466"><a href="#DistributionFitingTools.model_choose-466"><span class="linenos">466</span></a>                        <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">value1</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
</span><span id="DistributionFitingTools.model_choose-467"><a href="#DistributionFitingTools.model_choose-467"><span class="linenos">467</span></a>                        <span class="s2">&quot;param1&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">value2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">25</span><span class="p">),</span>
</span><span id="DistributionFitingTools.model_choose-468"><a href="#DistributionFitingTools.model_choose-468"><span class="linenos">468</span></a>                        <span class="s2">&quot;param2&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">value2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">25</span><span class="p">),</span>
</span><span id="DistributionFitingTools.model_choose-469"><a href="#DistributionFitingTools.model_choose-469"><span class="linenos">469</span></a>                    <span class="p">},</span>
</span><span id="DistributionFitingTools.model_choose-470"><a href="#DistributionFitingTools.model_choose-470"><span class="linenos">470</span></a>                    <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DistributionFitingTools.model_choose-471"><a href="#DistributionFitingTools.model_choose-471"><span class="linenos">471</span></a>                <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="DistributionFitingTools.model_choose-472"><a href="#DistributionFitingTools.model_choose-472"><span class="linenos">472</span></a>
</span><span id="DistributionFitingTools.model_choose-473"><a href="#DistributionFitingTools.model_choose-473"><span class="linenos">473</span></a>        <span class="n">best_fit</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">waicc</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">waicc</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="DistributionFitingTools.model_choose-474"><a href="#DistributionFitingTools.model_choose-474"><span class="linenos">474</span></a>        <span class="n">params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">best_fit</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="DistributionFitingTools.model_choose-475"><a href="#DistributionFitingTools.model_choose-475"><span class="linenos">475</span></a>
</span><span id="DistributionFitingTools.model_choose-476"><a href="#DistributionFitingTools.model_choose-476"><span class="linenos">476</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="DistributionFitingTools.model_choose-477"><a href="#DistributionFitingTools.model_choose-477"><span class="linenos">477</span></a>            <span class="n">best_fit</span><span class="p">(</span><span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">),</span>
</span><span id="DistributionFitingTools.model_choose-478"><a href="#DistributionFitingTools.model_choose-478"><span class="linenos">478</span></a>            <span class="n">best_fit</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="DistributionFitingTools.model_choose-479"><a href="#DistributionFitingTools.model_choose-479"><span class="linenos">479</span></a>            <span class="n">params</span><span class="p">,</span>
</span><span id="DistributionFitingTools.model_choose-480"><a href="#DistributionFitingTools.model_choose-480"><span class="linenos">480</span></a>            <span class="n">global_params</span><span class="p">,</span>
</span><span id="DistributionFitingTools.model_choose-481"><a href="#DistributionFitingTools.model_choose-481"><span class="linenos">481</span></a>            <span class="n">expon_pred</span><span class="p">,</span>
</span><span id="DistributionFitingTools.model_choose-482"><a href="#DistributionFitingTools.model_choose-482"><span class="linenos">482</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Chooses the best fitting model from a set of predefined curves
based on AICc.</p>

<h2 id="parameters">Parameters:</h2>

<p>vals : pandas.Series
    The data to which the models are fitted.</p>

<h2 id="returns">Returns:</h2>

<p>tuple
    The best fit model, its name, parameters, and a DataFrame
    containing model information.</p>
</div>


                            </div>
                </section>
                <section id="Stats">
                            <input id="Stats-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Stats</span>:

                <label class="view-source-button" for="Stats-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats-485"><a href="#Stats-485"><span class="linenos">485</span></a><span class="k">class</span> <span class="nc">Stats</span><span class="p">:</span>
</span><span id="Stats-486"><a href="#Stats-486"><span class="linenos">486</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-487"><a href="#Stats-487"><span class="linenos">487</span></a><span class="sd">    A utility class for calculating various statistics and metrics</span>
</span><span id="Stats-488"><a href="#Stats-488"><span class="linenos">488</span></a><span class="sd">    from a TrajectoriesFrame.</span>
</span><span id="Stats-489"><a href="#Stats-489"><span class="linenos">489</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Stats-490"><a href="#Stats-490"><span class="linenos">490</span></a>
</span><span id="Stats-491"><a href="#Stats-491"><span class="linenos">491</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-492"><a href="#Stats-492"><span class="linenos">492</span></a>    <span class="k">def</span> <span class="nf">get_animals_no</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Stats-493"><a href="#Stats-493"><span class="linenos">493</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-494"><a href="#Stats-494"><span class="linenos">494</span></a><span class="sd">        Get the total number of unique animals in the dataset.</span>
</span><span id="Stats-495"><a href="#Stats-495"><span class="linenos">495</span></a>
</span><span id="Stats-496"><a href="#Stats-496"><span class="linenos">496</span></a><span class="sd">        Args:</span>
</span><span id="Stats-497"><a href="#Stats-497"><span class="linenos">497</span></a><span class="sd">            data (TrajectoriesFrame): Input data with animal trajectories.</span>
</span><span id="Stats-498"><a href="#Stats-498"><span class="linenos">498</span></a>
</span><span id="Stats-499"><a href="#Stats-499"><span class="linenos">499</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-500"><a href="#Stats-500"><span class="linenos">500</span></a><span class="sd">            int: The number of unique animals.</span>
</span><span id="Stats-501"><a href="#Stats-501"><span class="linenos">501</span></a>
</span><span id="Stats-502"><a href="#Stats-502"><span class="linenos">502</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-503"><a href="#Stats-503"><span class="linenos">503</span></a>
</span><span id="Stats-504"><a href="#Stats-504"><span class="linenos">504</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get_users</span><span class="p">())</span>
</span><span id="Stats-505"><a href="#Stats-505"><span class="linenos">505</span></a>
</span><span id="Stats-506"><a href="#Stats-506"><span class="linenos">506</span></a>
</span><span id="Stats-507"><a href="#Stats-507"><span class="linenos">507</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-508"><a href="#Stats-508"><span class="linenos">508</span></a>    <span class="k">def</span> <span class="nf">get_period</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="Stats-509"><a href="#Stats-509"><span class="linenos">509</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-510"><a href="#Stats-510"><span class="linenos">510</span></a><span class="sd">        Get the total observation period of the dataset.</span>
</span><span id="Stats-511"><a href="#Stats-511"><span class="linenos">511</span></a>
</span><span id="Stats-512"><a href="#Stats-512"><span class="linenos">512</span></a><span class="sd">        Args:</span>
</span><span id="Stats-513"><a href="#Stats-513"><span class="linenos">513</span></a><span class="sd">            data (TrajectoriesFrame): Input data containing</span>
</span><span id="Stats-514"><a href="#Stats-514"><span class="linenos">514</span></a><span class="sd">                &#39;start&#39; and &#39;end&#39; columns.</span>
</span><span id="Stats-515"><a href="#Stats-515"><span class="linenos">515</span></a>
</span><span id="Stats-516"><a href="#Stats-516"><span class="linenos">516</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-517"><a href="#Stats-517"><span class="linenos">517</span></a><span class="sd">            pd.Timedelta: The duration between the earliest start</span>
</span><span id="Stats-518"><a href="#Stats-518"><span class="linenos">518</span></a><span class="sd">                and the latest end.</span>
</span><span id="Stats-519"><a href="#Stats-519"><span class="linenos">519</span></a>
</span><span id="Stats-520"><a href="#Stats-520"><span class="linenos">520</span></a><span class="sd">        Raises:</span>
</span><span id="Stats-521"><a href="#Stats-521"><span class="linenos">521</span></a><span class="sd">            KeyError: If columns &#39;start&#39; or &#39;end&#39; are missing</span>
</span><span id="Stats-522"><a href="#Stats-522"><span class="linenos">522</span></a><span class="sd">                in the dataset.</span>
</span><span id="Stats-523"><a href="#Stats-523"><span class="linenos">523</span></a><span class="sd">            ValueError: If columns &#39;start&#39; or &#39;end&#39; contain</span>
</span><span id="Stats-524"><a href="#Stats-524"><span class="linenos">524</span></a><span class="sd">                invalid datetime values.</span>
</span><span id="Stats-525"><a href="#Stats-525"><span class="linenos">525</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-526"><a href="#Stats-526"><span class="linenos">526</span></a>
</span><span id="Stats-527"><a href="#Stats-527"><span class="linenos">527</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Stats-528"><a href="#Stats-528"><span class="linenos">528</span></a>            <span class="n">min_start</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats-529"><a href="#Stats-529"><span class="linenos">529</span></a>            <span class="n">max_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="Stats-530"><a href="#Stats-530"><span class="linenos">530</span></a>        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Stats-531"><a href="#Stats-531"><span class="linenos">531</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid datetime format: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Stats-532"><a href="#Stats-532"><span class="linenos">532</span></a>
</span><span id="Stats-533"><a href="#Stats-533"><span class="linenos">533</span></a>        <span class="k">return</span> <span class="n">max_end</span> <span class="o">-</span> <span class="n">min_start</span>
</span><span id="Stats-534"><a href="#Stats-534"><span class="linenos">534</span></a>
</span><span id="Stats-535"><a href="#Stats-535"><span class="linenos">535</span></a>
</span><span id="Stats-536"><a href="#Stats-536"><span class="linenos">536</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-537"><a href="#Stats-537"><span class="linenos">537</span></a>    <span class="k">def</span> <span class="nf">get_min_labels_no_after_filtration</span><span class="p">(</span>
</span><span id="Stats-538"><a href="#Stats-538"><span class="linenos">538</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span>
</span><span id="Stats-539"><a href="#Stats-539"><span class="linenos">539</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="Stats-540"><a href="#Stats-540"><span class="linenos">540</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-541"><a href="#Stats-541"><span class="linenos">541</span></a><span class="sd">        Get the users with the minimum number of unique labels</span>
</span><span id="Stats-542"><a href="#Stats-542"><span class="linenos">542</span></a><span class="sd">        after filtration.</span>
</span><span id="Stats-543"><a href="#Stats-543"><span class="linenos">543</span></a>
</span><span id="Stats-544"><a href="#Stats-544"><span class="linenos">544</span></a><span class="sd">        Args:</span>
</span><span id="Stats-545"><a href="#Stats-545"><span class="linenos">545</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;user_id&#39;</span>
</span><span id="Stats-546"><a href="#Stats-546"><span class="linenos">546</span></a><span class="sd">                and &#39;labels&#39; columns.</span>
</span><span id="Stats-547"><a href="#Stats-547"><span class="linenos">547</span></a>
</span><span id="Stats-548"><a href="#Stats-548"><span class="linenos">548</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-549"><a href="#Stats-549"><span class="linenos">549</span></a><span class="sd">            pd.Series: Users with the minimum unique label count.</span>
</span><span id="Stats-550"><a href="#Stats-550"><span class="linenos">550</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-551"><a href="#Stats-551"><span class="linenos">551</span></a>
</span><span id="Stats-552"><a href="#Stats-552"><span class="linenos">552</span></a>        <span class="n">unique_label_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</span><span id="Stats-553"><a href="#Stats-553"><span class="linenos">553</span></a>        <span class="n">min_unique_label_count</span> <span class="o">=</span> <span class="n">unique_label_counts</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats-554"><a href="#Stats-554"><span class="linenos">554</span></a>
</span><span id="Stats-555"><a href="#Stats-555"><span class="linenos">555</span></a>        <span class="k">return</span> <span class="n">unique_label_counts</span><span class="p">[</span>
</span><span id="Stats-556"><a href="#Stats-556"><span class="linenos">556</span></a>            <span class="n">unique_label_counts</span> <span class="o">==</span> <span class="n">min_unique_label_count</span>
</span><span id="Stats-557"><a href="#Stats-557"><span class="linenos">557</span></a>        <span class="p">]</span>
</span><span id="Stats-558"><a href="#Stats-558"><span class="linenos">558</span></a>
</span><span id="Stats-559"><a href="#Stats-559"><span class="linenos">559</span></a>
</span><span id="Stats-560"><a href="#Stats-560"><span class="linenos">560</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-561"><a href="#Stats-561"><span class="linenos">561</span></a>    <span class="k">def</span> <span class="nf">get_mean_labels_no_after_filtration</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Stats-562"><a href="#Stats-562"><span class="linenos">562</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-563"><a href="#Stats-563"><span class="linenos">563</span></a><span class="sd">        Get the users mean number of unique labels</span>
</span><span id="Stats-564"><a href="#Stats-564"><span class="linenos">564</span></a><span class="sd">        after filtration.</span>
</span><span id="Stats-565"><a href="#Stats-565"><span class="linenos">565</span></a>
</span><span id="Stats-566"><a href="#Stats-566"><span class="linenos">566</span></a><span class="sd">        Args:</span>
</span><span id="Stats-567"><a href="#Stats-567"><span class="linenos">567</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;user_id&#39;</span>
</span><span id="Stats-568"><a href="#Stats-568"><span class="linenos">568</span></a><span class="sd">                and &#39;labels&#39; columns.</span>
</span><span id="Stats-569"><a href="#Stats-569"><span class="linenos">569</span></a>
</span><span id="Stats-570"><a href="#Stats-570"><span class="linenos">570</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-571"><a href="#Stats-571"><span class="linenos">571</span></a><span class="sd">            int: Users mean no. unique label count.</span>
</span><span id="Stats-572"><a href="#Stats-572"><span class="linenos">572</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-573"><a href="#Stats-573"><span class="linenos">573</span></a>
</span><span id="Stats-574"><a href="#Stats-574"><span class="linenos">574</span></a>        <span class="n">unique_label_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</span><span id="Stats-575"><a href="#Stats-575"><span class="linenos">575</span></a>        <span class="n">mean_unique_label_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">unique_label_counts</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</span><span id="Stats-576"><a href="#Stats-576"><span class="linenos">576</span></a>
</span><span id="Stats-577"><a href="#Stats-577"><span class="linenos">577</span></a>        <span class="k">return</span> <span class="n">mean_unique_label_count</span>
</span><span id="Stats-578"><a href="#Stats-578"><span class="linenos">578</span></a>
</span><span id="Stats-579"><a href="#Stats-579"><span class="linenos">579</span></a>
</span><span id="Stats-580"><a href="#Stats-580"><span class="linenos">580</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-581"><a href="#Stats-581"><span class="linenos">581</span></a>    <span class="k">def</span> <span class="nf">get_std_labels_no_after_filtration</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Stats-582"><a href="#Stats-582"><span class="linenos">582</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-583"><a href="#Stats-583"><span class="linenos">583</span></a><span class="sd">        Get the users std of unique labels</span>
</span><span id="Stats-584"><a href="#Stats-584"><span class="linenos">584</span></a><span class="sd">        after filtration.</span>
</span><span id="Stats-585"><a href="#Stats-585"><span class="linenos">585</span></a>
</span><span id="Stats-586"><a href="#Stats-586"><span class="linenos">586</span></a><span class="sd">        Args:</span>
</span><span id="Stats-587"><a href="#Stats-587"><span class="linenos">587</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;user_id&#39;</span>
</span><span id="Stats-588"><a href="#Stats-588"><span class="linenos">588</span></a><span class="sd">                and &#39;labels&#39; columns.</span>
</span><span id="Stats-589"><a href="#Stats-589"><span class="linenos">589</span></a>
</span><span id="Stats-590"><a href="#Stats-590"><span class="linenos">590</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-591"><a href="#Stats-591"><span class="linenos">591</span></a><span class="sd">            int: Users mean no. unique label count.</span>
</span><span id="Stats-592"><a href="#Stats-592"><span class="linenos">592</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-593"><a href="#Stats-593"><span class="linenos">593</span></a>
</span><span id="Stats-594"><a href="#Stats-594"><span class="linenos">594</span></a>        <span class="n">unique_label_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</span><span id="Stats-595"><a href="#Stats-595"><span class="linenos">595</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Stats-596"><a href="#Stats-596"><span class="linenos">596</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">unique_label_counts</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>  <span class="c1"># type: ignore</span>
</span><span id="Stats-597"><a href="#Stats-597"><span class="linenos">597</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Stats-598"><a href="#Stats-598"><span class="linenos">598</span></a>            <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># type: ignore</span>
</span><span id="Stats-599"><a href="#Stats-599"><span class="linenos">599</span></a>
</span><span id="Stats-600"><a href="#Stats-600"><span class="linenos">600</span></a>
</span><span id="Stats-601"><a href="#Stats-601"><span class="linenos">601</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-602"><a href="#Stats-602"><span class="linenos">602</span></a>    <span class="k">def</span> <span class="nf">get_min_records_no_before_filtration</span><span class="p">(</span>
</span><span id="Stats-603"><a href="#Stats-603"><span class="linenos">603</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span>
</span><span id="Stats-604"><a href="#Stats-604"><span class="linenos">604</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="Stats-605"><a href="#Stats-605"><span class="linenos">605</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-606"><a href="#Stats-606"><span class="linenos">606</span></a><span class="sd">        Get the animals with the minimum number of records</span>
</span><span id="Stats-607"><a href="#Stats-607"><span class="linenos">607</span></a><span class="sd">        before filtration.</span>
</span><span id="Stats-608"><a href="#Stats-608"><span class="linenos">608</span></a>
</span><span id="Stats-609"><a href="#Stats-609"><span class="linenos">609</span></a><span class="sd">        Args:</span>
</span><span id="Stats-610"><a href="#Stats-610"><span class="linenos">610</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;animal_id&#39;</span>
</span><span id="Stats-611"><a href="#Stats-611"><span class="linenos">611</span></a><span class="sd">                and &#39;time&#39; columns.</span>
</span><span id="Stats-612"><a href="#Stats-612"><span class="linenos">612</span></a>
</span><span id="Stats-613"><a href="#Stats-613"><span class="linenos">613</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-614"><a href="#Stats-614"><span class="linenos">614</span></a><span class="sd">            pd.Series: Animals with the minimum number of records.</span>
</span><span id="Stats-615"><a href="#Stats-615"><span class="linenos">615</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-616"><a href="#Stats-616"><span class="linenos">616</span></a>
</span><span id="Stats-617"><a href="#Stats-617"><span class="linenos">617</span></a>        <span class="n">records_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span><span id="Stats-618"><a href="#Stats-618"><span class="linenos">618</span></a>        <span class="n">min_label_count</span> <span class="o">=</span> <span class="n">records_counts</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats-619"><a href="#Stats-619"><span class="linenos">619</span></a>
</span><span id="Stats-620"><a href="#Stats-620"><span class="linenos">620</span></a>        <span class="k">return</span> <span class="n">records_counts</span><span class="p">[</span><span class="n">records_counts</span> <span class="o">==</span> <span class="n">min_label_count</span><span class="p">]</span>
</span><span id="Stats-621"><a href="#Stats-621"><span class="linenos">621</span></a>
</span><span id="Stats-622"><a href="#Stats-622"><span class="linenos">622</span></a>
</span><span id="Stats-623"><a href="#Stats-623"><span class="linenos">623</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-624"><a href="#Stats-624"><span class="linenos">624</span></a>    <span class="k">def</span> <span class="nf">get_mean_records_no_before_filtration</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Stats-625"><a href="#Stats-625"><span class="linenos">625</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-626"><a href="#Stats-626"><span class="linenos">626</span></a><span class="sd">        Get the mean number of records</span>
</span><span id="Stats-627"><a href="#Stats-627"><span class="linenos">627</span></a><span class="sd">        before filtration.</span>
</span><span id="Stats-628"><a href="#Stats-628"><span class="linenos">628</span></a>
</span><span id="Stats-629"><a href="#Stats-629"><span class="linenos">629</span></a><span class="sd">        Args:</span>
</span><span id="Stats-630"><a href="#Stats-630"><span class="linenos">630</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;animal_id&#39;</span>
</span><span id="Stats-631"><a href="#Stats-631"><span class="linenos">631</span></a><span class="sd">                and &#39;time&#39; columns.</span>
</span><span id="Stats-632"><a href="#Stats-632"><span class="linenos">632</span></a>
</span><span id="Stats-633"><a href="#Stats-633"><span class="linenos">633</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-634"><a href="#Stats-634"><span class="linenos">634</span></a><span class="sd">            int: mean number of records.</span>
</span><span id="Stats-635"><a href="#Stats-635"><span class="linenos">635</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-636"><a href="#Stats-636"><span class="linenos">636</span></a>
</span><span id="Stats-637"><a href="#Stats-637"><span class="linenos">637</span></a>        <span class="n">records_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span><span id="Stats-638"><a href="#Stats-638"><span class="linenos">638</span></a>        <span class="n">mean_label_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">records_counts</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</span><span id="Stats-639"><a href="#Stats-639"><span class="linenos">639</span></a>
</span><span id="Stats-640"><a href="#Stats-640"><span class="linenos">640</span></a>        <span class="k">return</span> <span class="n">mean_label_count</span>
</span><span id="Stats-641"><a href="#Stats-641"><span class="linenos">641</span></a>
</span><span id="Stats-642"><a href="#Stats-642"><span class="linenos">642</span></a>
</span><span id="Stats-643"><a href="#Stats-643"><span class="linenos">643</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-644"><a href="#Stats-644"><span class="linenos">644</span></a>    <span class="k">def</span> <span class="nf">get_std_records_no_before_filtration</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Stats-645"><a href="#Stats-645"><span class="linenos">645</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-646"><a href="#Stats-646"><span class="linenos">646</span></a><span class="sd">        Get the mean number of records</span>
</span><span id="Stats-647"><a href="#Stats-647"><span class="linenos">647</span></a><span class="sd">        before filtration.</span>
</span><span id="Stats-648"><a href="#Stats-648"><span class="linenos">648</span></a>
</span><span id="Stats-649"><a href="#Stats-649"><span class="linenos">649</span></a><span class="sd">        Args:</span>
</span><span id="Stats-650"><a href="#Stats-650"><span class="linenos">650</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;animal_id&#39;</span>
</span><span id="Stats-651"><a href="#Stats-651"><span class="linenos">651</span></a><span class="sd">                and &#39;time&#39; columns.</span>
</span><span id="Stats-652"><a href="#Stats-652"><span class="linenos">652</span></a>
</span><span id="Stats-653"><a href="#Stats-653"><span class="linenos">653</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-654"><a href="#Stats-654"><span class="linenos">654</span></a><span class="sd">            int: mean number of records.</span>
</span><span id="Stats-655"><a href="#Stats-655"><span class="linenos">655</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-656"><a href="#Stats-656"><span class="linenos">656</span></a>
</span><span id="Stats-657"><a href="#Stats-657"><span class="linenos">657</span></a>        <span class="n">records_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span><span id="Stats-658"><a href="#Stats-658"><span class="linenos">658</span></a>
</span><span id="Stats-659"><a href="#Stats-659"><span class="linenos">659</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Stats-660"><a href="#Stats-660"><span class="linenos">660</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">records_counts</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>  <span class="c1"># type: ignore</span>
</span><span id="Stats-661"><a href="#Stats-661"><span class="linenos">661</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Stats-662"><a href="#Stats-662"><span class="linenos">662</span></a>            <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># type: ignore</span>
</span><span id="Stats-663"><a href="#Stats-663"><span class="linenos">663</span></a>
</span><span id="Stats-664"><a href="#Stats-664"><span class="linenos">664</span></a>
</span><span id="Stats-665"><a href="#Stats-665"><span class="linenos">665</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-666"><a href="#Stats-666"><span class="linenos">666</span></a>    <span class="k">def</span> <span class="nf">get_mean_periods</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="Stats-667"><a href="#Stats-667"><span class="linenos">667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-668"><a href="#Stats-668"><span class="linenos">668</span></a><span class="sd">        Get the mean period between start and end times.</span>
</span><span id="Stats-669"><a href="#Stats-669"><span class="linenos">669</span></a>
</span><span id="Stats-670"><a href="#Stats-670"><span class="linenos">670</span></a><span class="sd">        Args:</span>
</span><span id="Stats-671"><a href="#Stats-671"><span class="linenos">671</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;start&#39;</span>
</span><span id="Stats-672"><a href="#Stats-672"><span class="linenos">672</span></a><span class="sd">                and &#39;end&#39; columns.</span>
</span><span id="Stats-673"><a href="#Stats-673"><span class="linenos">673</span></a>
</span><span id="Stats-674"><a href="#Stats-674"><span class="linenos">674</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-675"><a href="#Stats-675"><span class="linenos">675</span></a><span class="sd">            float: The mean period in days.</span>
</span><span id="Stats-676"><a href="#Stats-676"><span class="linenos">676</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-677"><a href="#Stats-677"><span class="linenos">677</span></a>
</span><span id="Stats-678"><a href="#Stats-678"><span class="linenos">678</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Stats-679"><a href="#Stats-679"><span class="linenos">679</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats-680"><a href="#Stats-680"><span class="linenos">680</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="Stats-681"><a href="#Stats-681"><span class="linenos">681</span></a>
</span><span id="Stats-682"><a href="#Stats-682"><span class="linenos">682</span></a>
</span><span id="Stats-683"><a href="#Stats-683"><span class="linenos">683</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-684"><a href="#Stats-684"><span class="linenos">684</span></a>    <span class="k">def</span> <span class="nf">get_min_periods</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="Stats-685"><a href="#Stats-685"><span class="linenos">685</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-686"><a href="#Stats-686"><span class="linenos">686</span></a><span class="sd">        Get the minimum period between start and end times.</span>
</span><span id="Stats-687"><a href="#Stats-687"><span class="linenos">687</span></a>
</span><span id="Stats-688"><a href="#Stats-688"><span class="linenos">688</span></a><span class="sd">        Args:</span>
</span><span id="Stats-689"><a href="#Stats-689"><span class="linenos">689</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;start&#39;</span>
</span><span id="Stats-690"><a href="#Stats-690"><span class="linenos">690</span></a><span class="sd">                and &#39;end&#39; columns.</span>
</span><span id="Stats-691"><a href="#Stats-691"><span class="linenos">691</span></a>
</span><span id="Stats-692"><a href="#Stats-692"><span class="linenos">692</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-693"><a href="#Stats-693"><span class="linenos">693</span></a><span class="sd">            float: The minimum period in days.</span>
</span><span id="Stats-694"><a href="#Stats-694"><span class="linenos">694</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-695"><a href="#Stats-695"><span class="linenos">695</span></a>
</span><span id="Stats-696"><a href="#Stats-696"><span class="linenos">696</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Stats-697"><a href="#Stats-697"><span class="linenos">697</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats-698"><a href="#Stats-698"><span class="linenos">698</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="Stats-699"><a href="#Stats-699"><span class="linenos">699</span></a>
</span><span id="Stats-700"><a href="#Stats-700"><span class="linenos">700</span></a>
</span><span id="Stats-701"><a href="#Stats-701"><span class="linenos">701</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-702"><a href="#Stats-702"><span class="linenos">702</span></a>    <span class="k">def</span> <span class="nf">get_max_periods</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="Stats-703"><a href="#Stats-703"><span class="linenos">703</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-704"><a href="#Stats-704"><span class="linenos">704</span></a><span class="sd">        Get the maximum period between start and end times.</span>
</span><span id="Stats-705"><a href="#Stats-705"><span class="linenos">705</span></a>
</span><span id="Stats-706"><a href="#Stats-706"><span class="linenos">706</span></a><span class="sd">        Args:</span>
</span><span id="Stats-707"><a href="#Stats-707"><span class="linenos">707</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;start&#39;</span>
</span><span id="Stats-708"><a href="#Stats-708"><span class="linenos">708</span></a><span class="sd">                and &#39;end&#39; columns.</span>
</span><span id="Stats-709"><a href="#Stats-709"><span class="linenos">709</span></a>
</span><span id="Stats-710"><a href="#Stats-710"><span class="linenos">710</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-711"><a href="#Stats-711"><span class="linenos">711</span></a><span class="sd">            float: The maximum period in days.</span>
</span><span id="Stats-712"><a href="#Stats-712"><span class="linenos">712</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-713"><a href="#Stats-713"><span class="linenos">713</span></a>
</span><span id="Stats-714"><a href="#Stats-714"><span class="linenos">714</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Stats-715"><a href="#Stats-715"><span class="linenos">715</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats-716"><a href="#Stats-716"><span class="linenos">716</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="Stats-717"><a href="#Stats-717"><span class="linenos">717</span></a>
</span><span id="Stats-718"><a href="#Stats-718"><span class="linenos">718</span></a>
</span><span id="Stats-719"><a href="#Stats-719"><span class="linenos">719</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-720"><a href="#Stats-720"><span class="linenos">720</span></a>    <span class="k">def</span> <span class="nf">get_std_periods</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="Stats-721"><a href="#Stats-721"><span class="linenos">721</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-722"><a href="#Stats-722"><span class="linenos">722</span></a><span class="sd">        Get the std of period between start and end times.</span>
</span><span id="Stats-723"><a href="#Stats-723"><span class="linenos">723</span></a>
</span><span id="Stats-724"><a href="#Stats-724"><span class="linenos">724</span></a><span class="sd">        Args:</span>
</span><span id="Stats-725"><a href="#Stats-725"><span class="linenos">725</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;start&#39;</span>
</span><span id="Stats-726"><a href="#Stats-726"><span class="linenos">726</span></a><span class="sd">                and &#39;end&#39; columns.</span>
</span><span id="Stats-727"><a href="#Stats-727"><span class="linenos">727</span></a>
</span><span id="Stats-728"><a href="#Stats-728"><span class="linenos">728</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-729"><a href="#Stats-729"><span class="linenos">729</span></a><span class="sd">            float: The std period in days.</span>
</span><span id="Stats-730"><a href="#Stats-730"><span class="linenos">730</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-731"><a href="#Stats-731"><span class="linenos">731</span></a>
</span><span id="Stats-732"><a href="#Stats-732"><span class="linenos">732</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Stats-733"><a href="#Stats-733"><span class="linenos">733</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="Stats-734"><a href="#Stats-734"><span class="linenos">734</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats-735"><a href="#Stats-735"><span class="linenos">735</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="Stats-736"><a href="#Stats-736"><span class="linenos">736</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Stats-737"><a href="#Stats-737"><span class="linenos">737</span></a>            <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># type: ignore</span>
</span><span id="Stats-738"><a href="#Stats-738"><span class="linenos">738</span></a>
</span><span id="Stats-739"><a href="#Stats-739"><span class="linenos">739</span></a>
</span><span id="Stats-740"><a href="#Stats-740"><span class="linenos">740</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-741"><a href="#Stats-741"><span class="linenos">741</span></a>    <span class="k">def</span> <span class="nf">get_overall_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Stats-742"><a href="#Stats-742"><span class="linenos">742</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-743"><a href="#Stats-743"><span class="linenos">743</span></a><span class="sd">        Get the overall area covered by the trajectories.</span>
</span><span id="Stats-744"><a href="#Stats-744"><span class="linenos">744</span></a>
</span><span id="Stats-745"><a href="#Stats-745"><span class="linenos">745</span></a><span class="sd">        Args:</span>
</span><span id="Stats-746"><a href="#Stats-746"><span class="linenos">746</span></a><span class="sd">            data (TrajectoriesFrame): Input spatial data.</span>
</span><span id="Stats-747"><a href="#Stats-747"><span class="linenos">747</span></a>
</span><span id="Stats-748"><a href="#Stats-748"><span class="linenos">748</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-749"><a href="#Stats-749"><span class="linenos">749</span></a><span class="sd">            float: The overall area in hectares.</span>
</span><span id="Stats-750"><a href="#Stats-750"><span class="linenos">750</span></a>
</span><span id="Stats-751"><a href="#Stats-751"><span class="linenos">751</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-752"><a href="#Stats-752"><span class="linenos">752</span></a>
</span><span id="Stats-753"><a href="#Stats-753"><span class="linenos">753</span></a>        <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="Stats-754"><a href="#Stats-754"><span class="linenos">754</span></a>
</span><span id="Stats-755"><a href="#Stats-755"><span class="linenos">755</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Stats-756"><a href="#Stats-756"><span class="linenos">756</span></a>
</span><span id="Stats-757"><a href="#Stats-757"><span class="linenos">757</span></a>
</span><span id="Stats-758"><a href="#Stats-758"><span class="linenos">758</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-759"><a href="#Stats-759"><span class="linenos">759</span></a>    <span class="k">def</span> <span class="nf">get_mean_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Stats-760"><a href="#Stats-760"><span class="linenos">760</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-761"><a href="#Stats-761"><span class="linenos">761</span></a><span class="sd">        Get the mean area covered by trajectories per user.</span>
</span><span id="Stats-762"><a href="#Stats-762"><span class="linenos">762</span></a>
</span><span id="Stats-763"><a href="#Stats-763"><span class="linenos">763</span></a><span class="sd">        Args:</span>
</span><span id="Stats-764"><a href="#Stats-764"><span class="linenos">764</span></a><span class="sd">            data (TrajectoriesFrame): Input data.</span>
</span><span id="Stats-765"><a href="#Stats-765"><span class="linenos">765</span></a>
</span><span id="Stats-766"><a href="#Stats-766"><span class="linenos">766</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-767"><a href="#Stats-767"><span class="linenos">767</span></a><span class="sd">            float: The mean area in hectares.</span>
</span><span id="Stats-768"><a href="#Stats-768"><span class="linenos">768</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-769"><a href="#Stats-769"><span class="linenos">769</span></a>
</span><span id="Stats-770"><a href="#Stats-770"><span class="linenos">770</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="Stats-771"><a href="#Stats-771"><span class="linenos">771</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stats-772"><a href="#Stats-772"><span class="linenos">772</span></a>        <span class="k">for</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
</span><span id="Stats-773"><a href="#Stats-773"><span class="linenos">773</span></a>            <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="Stats-774"><a href="#Stats-774"><span class="linenos">774</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">)</span>
</span><span id="Stats-775"><a href="#Stats-775"><span class="linenos">775</span></a>
</span><span id="Stats-776"><a href="#Stats-776"><span class="linenos">776</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Stats-777"><a href="#Stats-777"><span class="linenos">777</span></a>
</span><span id="Stats-778"><a href="#Stats-778"><span class="linenos">778</span></a>
</span><span id="Stats-779"><a href="#Stats-779"><span class="linenos">779</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-780"><a href="#Stats-780"><span class="linenos">780</span></a>    <span class="k">def</span> <span class="nf">get_min_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Stats-781"><a href="#Stats-781"><span class="linenos">781</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-782"><a href="#Stats-782"><span class="linenos">782</span></a><span class="sd">        Get the min area covered by trajectories per user.</span>
</span><span id="Stats-783"><a href="#Stats-783"><span class="linenos">783</span></a>
</span><span id="Stats-784"><a href="#Stats-784"><span class="linenos">784</span></a><span class="sd">        Args:</span>
</span><span id="Stats-785"><a href="#Stats-785"><span class="linenos">785</span></a><span class="sd">            data (TrajectoriesFrame): Input data.</span>
</span><span id="Stats-786"><a href="#Stats-786"><span class="linenos">786</span></a>
</span><span id="Stats-787"><a href="#Stats-787"><span class="linenos">787</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-788"><a href="#Stats-788"><span class="linenos">788</span></a><span class="sd">            float: The min area in hectares.</span>
</span><span id="Stats-789"><a href="#Stats-789"><span class="linenos">789</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-790"><a href="#Stats-790"><span class="linenos">790</span></a>
</span><span id="Stats-791"><a href="#Stats-791"><span class="linenos">791</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="Stats-792"><a href="#Stats-792"><span class="linenos">792</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stats-793"><a href="#Stats-793"><span class="linenos">793</span></a>        <span class="k">for</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
</span><span id="Stats-794"><a href="#Stats-794"><span class="linenos">794</span></a>            <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="Stats-795"><a href="#Stats-795"><span class="linenos">795</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">)</span>
</span><span id="Stats-796"><a href="#Stats-796"><span class="linenos">796</span></a>
</span><span id="Stats-797"><a href="#Stats-797"><span class="linenos">797</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Stats-798"><a href="#Stats-798"><span class="linenos">798</span></a>
</span><span id="Stats-799"><a href="#Stats-799"><span class="linenos">799</span></a>
</span><span id="Stats-800"><a href="#Stats-800"><span class="linenos">800</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-801"><a href="#Stats-801"><span class="linenos">801</span></a>    <span class="k">def</span> <span class="nf">get_max_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Stats-802"><a href="#Stats-802"><span class="linenos">802</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-803"><a href="#Stats-803"><span class="linenos">803</span></a><span class="sd">        Get the max area covered by trajectories per user.</span>
</span><span id="Stats-804"><a href="#Stats-804"><span class="linenos">804</span></a>
</span><span id="Stats-805"><a href="#Stats-805"><span class="linenos">805</span></a><span class="sd">        Args:</span>
</span><span id="Stats-806"><a href="#Stats-806"><span class="linenos">806</span></a><span class="sd">            data (TrajectoriesFrame): Input data.</span>
</span><span id="Stats-807"><a href="#Stats-807"><span class="linenos">807</span></a>
</span><span id="Stats-808"><a href="#Stats-808"><span class="linenos">808</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-809"><a href="#Stats-809"><span class="linenos">809</span></a><span class="sd">            float: The max area in hectares.</span>
</span><span id="Stats-810"><a href="#Stats-810"><span class="linenos">810</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-811"><a href="#Stats-811"><span class="linenos">811</span></a>
</span><span id="Stats-812"><a href="#Stats-812"><span class="linenos">812</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="Stats-813"><a href="#Stats-813"><span class="linenos">813</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stats-814"><a href="#Stats-814"><span class="linenos">814</span></a>        <span class="k">for</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
</span><span id="Stats-815"><a href="#Stats-815"><span class="linenos">815</span></a>            <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="Stats-816"><a href="#Stats-816"><span class="linenos">816</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">)</span>
</span><span id="Stats-817"><a href="#Stats-817"><span class="linenos">817</span></a>
</span><span id="Stats-818"><a href="#Stats-818"><span class="linenos">818</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Stats-819"><a href="#Stats-819"><span class="linenos">819</span></a>
</span><span id="Stats-820"><a href="#Stats-820"><span class="linenos">820</span></a>
</span><span id="Stats-821"><a href="#Stats-821"><span class="linenos">821</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats-822"><a href="#Stats-822"><span class="linenos">822</span></a>    <span class="k">def</span> <span class="nf">get_std_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Stats-823"><a href="#Stats-823"><span class="linenos">823</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats-824"><a href="#Stats-824"><span class="linenos">824</span></a><span class="sd">        Get the std of area covered by trajectories per user.</span>
</span><span id="Stats-825"><a href="#Stats-825"><span class="linenos">825</span></a>
</span><span id="Stats-826"><a href="#Stats-826"><span class="linenos">826</span></a><span class="sd">        Args:</span>
</span><span id="Stats-827"><a href="#Stats-827"><span class="linenos">827</span></a><span class="sd">            data (TrajectoriesFrame): Input data.</span>
</span><span id="Stats-828"><a href="#Stats-828"><span class="linenos">828</span></a>
</span><span id="Stats-829"><a href="#Stats-829"><span class="linenos">829</span></a><span class="sd">        Returns:</span>
</span><span id="Stats-830"><a href="#Stats-830"><span class="linenos">830</span></a><span class="sd">            float: The std of area in hectares.</span>
</span><span id="Stats-831"><a href="#Stats-831"><span class="linenos">831</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats-832"><a href="#Stats-832"><span class="linenos">832</span></a>
</span><span id="Stats-833"><a href="#Stats-833"><span class="linenos">833</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="Stats-834"><a href="#Stats-834"><span class="linenos">834</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stats-835"><a href="#Stats-835"><span class="linenos">835</span></a>        <span class="k">for</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
</span><span id="Stats-836"><a href="#Stats-836"><span class="linenos">836</span></a>            <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="Stats-837"><a href="#Stats-837"><span class="linenos">837</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">)</span>
</span><span id="Stats-838"><a href="#Stats-838"><span class="linenos">838</span></a>
</span><span id="Stats-839"><a href="#Stats-839"><span class="linenos">839</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Stats-840"><a href="#Stats-840"><span class="linenos">840</span></a>            <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Stats-841"><a href="#Stats-841"><span class="linenos">841</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Stats-842"><a href="#Stats-842"><span class="linenos">842</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>A utility class for calculating various statistics and metrics
from a TrajectoriesFrame.</p>
</div>


                            <div id="Stats.get_animals_no" class="classattr">
                                        <input id="Stats.get_animals_no-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_animals_no</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="Stats.get_animals_no-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_animals_no"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_animals_no-491"><a href="#Stats.get_animals_no-491"><span class="linenos">491</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_animals_no-492"><a href="#Stats.get_animals_no-492"><span class="linenos">492</span></a>    <span class="k">def</span> <span class="nf">get_animals_no</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Stats.get_animals_no-493"><a href="#Stats.get_animals_no-493"><span class="linenos">493</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_animals_no-494"><a href="#Stats.get_animals_no-494"><span class="linenos">494</span></a><span class="sd">        Get the total number of unique animals in the dataset.</span>
</span><span id="Stats.get_animals_no-495"><a href="#Stats.get_animals_no-495"><span class="linenos">495</span></a>
</span><span id="Stats.get_animals_no-496"><a href="#Stats.get_animals_no-496"><span class="linenos">496</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_animals_no-497"><a href="#Stats.get_animals_no-497"><span class="linenos">497</span></a><span class="sd">            data (TrajectoriesFrame): Input data with animal trajectories.</span>
</span><span id="Stats.get_animals_no-498"><a href="#Stats.get_animals_no-498"><span class="linenos">498</span></a>
</span><span id="Stats.get_animals_no-499"><a href="#Stats.get_animals_no-499"><span class="linenos">499</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_animals_no-500"><a href="#Stats.get_animals_no-500"><span class="linenos">500</span></a><span class="sd">            int: The number of unique animals.</span>
</span><span id="Stats.get_animals_no-501"><a href="#Stats.get_animals_no-501"><span class="linenos">501</span></a>
</span><span id="Stats.get_animals_no-502"><a href="#Stats.get_animals_no-502"><span class="linenos">502</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_animals_no-503"><a href="#Stats.get_animals_no-503"><span class="linenos">503</span></a>
</span><span id="Stats.get_animals_no-504"><a href="#Stats.get_animals_no-504"><span class="linenos">504</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get_users</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Get the total number of unique animals in the dataset.</p>

<p>Args:
    data (TrajectoriesFrame): Input data with animal trajectories.</p>

<p>Returns:
    int: The number of unique animals.</p>
</div>


                            </div>
                            <div id="Stats.get_period" class="classattr">
                                        <input id="Stats.get_period-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_period</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">tslibs</span><span class="o">.</span><span class="n">timedeltas</span><span class="o">.</span><span class="n">Timedelta</span>:</span></span>

                <label class="view-source-button" for="Stats.get_period-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_period"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_period-507"><a href="#Stats.get_period-507"><span class="linenos">507</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_period-508"><a href="#Stats.get_period-508"><span class="linenos">508</span></a>    <span class="k">def</span> <span class="nf">get_period</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="Stats.get_period-509"><a href="#Stats.get_period-509"><span class="linenos">509</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_period-510"><a href="#Stats.get_period-510"><span class="linenos">510</span></a><span class="sd">        Get the total observation period of the dataset.</span>
</span><span id="Stats.get_period-511"><a href="#Stats.get_period-511"><span class="linenos">511</span></a>
</span><span id="Stats.get_period-512"><a href="#Stats.get_period-512"><span class="linenos">512</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_period-513"><a href="#Stats.get_period-513"><span class="linenos">513</span></a><span class="sd">            data (TrajectoriesFrame): Input data containing</span>
</span><span id="Stats.get_period-514"><a href="#Stats.get_period-514"><span class="linenos">514</span></a><span class="sd">                &#39;start&#39; and &#39;end&#39; columns.</span>
</span><span id="Stats.get_period-515"><a href="#Stats.get_period-515"><span class="linenos">515</span></a>
</span><span id="Stats.get_period-516"><a href="#Stats.get_period-516"><span class="linenos">516</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_period-517"><a href="#Stats.get_period-517"><span class="linenos">517</span></a><span class="sd">            pd.Timedelta: The duration between the earliest start</span>
</span><span id="Stats.get_period-518"><a href="#Stats.get_period-518"><span class="linenos">518</span></a><span class="sd">                and the latest end.</span>
</span><span id="Stats.get_period-519"><a href="#Stats.get_period-519"><span class="linenos">519</span></a>
</span><span id="Stats.get_period-520"><a href="#Stats.get_period-520"><span class="linenos">520</span></a><span class="sd">        Raises:</span>
</span><span id="Stats.get_period-521"><a href="#Stats.get_period-521"><span class="linenos">521</span></a><span class="sd">            KeyError: If columns &#39;start&#39; or &#39;end&#39; are missing</span>
</span><span id="Stats.get_period-522"><a href="#Stats.get_period-522"><span class="linenos">522</span></a><span class="sd">                in the dataset.</span>
</span><span id="Stats.get_period-523"><a href="#Stats.get_period-523"><span class="linenos">523</span></a><span class="sd">            ValueError: If columns &#39;start&#39; or &#39;end&#39; contain</span>
</span><span id="Stats.get_period-524"><a href="#Stats.get_period-524"><span class="linenos">524</span></a><span class="sd">                invalid datetime values.</span>
</span><span id="Stats.get_period-525"><a href="#Stats.get_period-525"><span class="linenos">525</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_period-526"><a href="#Stats.get_period-526"><span class="linenos">526</span></a>
</span><span id="Stats.get_period-527"><a href="#Stats.get_period-527"><span class="linenos">527</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Stats.get_period-528"><a href="#Stats.get_period-528"><span class="linenos">528</span></a>            <span class="n">min_start</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats.get_period-529"><a href="#Stats.get_period-529"><span class="linenos">529</span></a>            <span class="n">max_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="Stats.get_period-530"><a href="#Stats.get_period-530"><span class="linenos">530</span></a>        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Stats.get_period-531"><a href="#Stats.get_period-531"><span class="linenos">531</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid datetime format: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Stats.get_period-532"><a href="#Stats.get_period-532"><span class="linenos">532</span></a>
</span><span id="Stats.get_period-533"><a href="#Stats.get_period-533"><span class="linenos">533</span></a>        <span class="k">return</span> <span class="n">max_end</span> <span class="o">-</span> <span class="n">min_start</span>
</span></pre></div>


            <div class="docstring"><p>Get the total observation period of the dataset.</p>

<p>Args:
    data (TrajectoriesFrame): Input data containing
        'start' and 'end' columns.</p>

<p>Returns:
    pd.Timedelta: The duration between the earliest start
        and the latest end.</p>

<p>Raises:
    KeyError: If columns 'start' or 'end' are missing
        in the dataset.
    ValueError: If columns 'start' or 'end' contain
        invalid datetime values.</p>
</div>


                            </div>
                            <div id="Stats.get_min_labels_no_after_filtration" class="classattr">
                                        <input id="Stats.get_min_labels_no_after_filtration-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_min_labels_no_after_filtration</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span>:</span></span>

                <label class="view-source-button" for="Stats.get_min_labels_no_after_filtration-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_min_labels_no_after_filtration"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_min_labels_no_after_filtration-536"><a href="#Stats.get_min_labels_no_after_filtration-536"><span class="linenos">536</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_min_labels_no_after_filtration-537"><a href="#Stats.get_min_labels_no_after_filtration-537"><span class="linenos">537</span></a>    <span class="k">def</span> <span class="nf">get_min_labels_no_after_filtration</span><span class="p">(</span>
</span><span id="Stats.get_min_labels_no_after_filtration-538"><a href="#Stats.get_min_labels_no_after_filtration-538"><span class="linenos">538</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span>
</span><span id="Stats.get_min_labels_no_after_filtration-539"><a href="#Stats.get_min_labels_no_after_filtration-539"><span class="linenos">539</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="Stats.get_min_labels_no_after_filtration-540"><a href="#Stats.get_min_labels_no_after_filtration-540"><span class="linenos">540</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_min_labels_no_after_filtration-541"><a href="#Stats.get_min_labels_no_after_filtration-541"><span class="linenos">541</span></a><span class="sd">        Get the users with the minimum number of unique labels</span>
</span><span id="Stats.get_min_labels_no_after_filtration-542"><a href="#Stats.get_min_labels_no_after_filtration-542"><span class="linenos">542</span></a><span class="sd">        after filtration.</span>
</span><span id="Stats.get_min_labels_no_after_filtration-543"><a href="#Stats.get_min_labels_no_after_filtration-543"><span class="linenos">543</span></a>
</span><span id="Stats.get_min_labels_no_after_filtration-544"><a href="#Stats.get_min_labels_no_after_filtration-544"><span class="linenos">544</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_min_labels_no_after_filtration-545"><a href="#Stats.get_min_labels_no_after_filtration-545"><span class="linenos">545</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;user_id&#39;</span>
</span><span id="Stats.get_min_labels_no_after_filtration-546"><a href="#Stats.get_min_labels_no_after_filtration-546"><span class="linenos">546</span></a><span class="sd">                and &#39;labels&#39; columns.</span>
</span><span id="Stats.get_min_labels_no_after_filtration-547"><a href="#Stats.get_min_labels_no_after_filtration-547"><span class="linenos">547</span></a>
</span><span id="Stats.get_min_labels_no_after_filtration-548"><a href="#Stats.get_min_labels_no_after_filtration-548"><span class="linenos">548</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_min_labels_no_after_filtration-549"><a href="#Stats.get_min_labels_no_after_filtration-549"><span class="linenos">549</span></a><span class="sd">            pd.Series: Users with the minimum unique label count.</span>
</span><span id="Stats.get_min_labels_no_after_filtration-550"><a href="#Stats.get_min_labels_no_after_filtration-550"><span class="linenos">550</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_min_labels_no_after_filtration-551"><a href="#Stats.get_min_labels_no_after_filtration-551"><span class="linenos">551</span></a>
</span><span id="Stats.get_min_labels_no_after_filtration-552"><a href="#Stats.get_min_labels_no_after_filtration-552"><span class="linenos">552</span></a>        <span class="n">unique_label_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</span><span id="Stats.get_min_labels_no_after_filtration-553"><a href="#Stats.get_min_labels_no_after_filtration-553"><span class="linenos">553</span></a>        <span class="n">min_unique_label_count</span> <span class="o">=</span> <span class="n">unique_label_counts</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats.get_min_labels_no_after_filtration-554"><a href="#Stats.get_min_labels_no_after_filtration-554"><span class="linenos">554</span></a>
</span><span id="Stats.get_min_labels_no_after_filtration-555"><a href="#Stats.get_min_labels_no_after_filtration-555"><span class="linenos">555</span></a>        <span class="k">return</span> <span class="n">unique_label_counts</span><span class="p">[</span>
</span><span id="Stats.get_min_labels_no_after_filtration-556"><a href="#Stats.get_min_labels_no_after_filtration-556"><span class="linenos">556</span></a>            <span class="n">unique_label_counts</span> <span class="o">==</span> <span class="n">min_unique_label_count</span>
</span><span id="Stats.get_min_labels_no_after_filtration-557"><a href="#Stats.get_min_labels_no_after_filtration-557"><span class="linenos">557</span></a>        <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get the users with the minimum number of unique labels
after filtration.</p>

<p>Args:
    data (TrajectoriesFrame): Input data with 'user_id'
        and 'labels' columns.</p>

<p>Returns:
    pd.Series: Users with the minimum unique label count.</p>
</div>


                            </div>
                            <div id="Stats.get_mean_labels_no_after_filtration" class="classattr">
                                        <input id="Stats.get_mean_labels_no_after_filtration-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_mean_labels_no_after_filtration</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="Stats.get_mean_labels_no_after_filtration-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_mean_labels_no_after_filtration"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_mean_labels_no_after_filtration-560"><a href="#Stats.get_mean_labels_no_after_filtration-560"><span class="linenos">560</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_mean_labels_no_after_filtration-561"><a href="#Stats.get_mean_labels_no_after_filtration-561"><span class="linenos">561</span></a>    <span class="k">def</span> <span class="nf">get_mean_labels_no_after_filtration</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Stats.get_mean_labels_no_after_filtration-562"><a href="#Stats.get_mean_labels_no_after_filtration-562"><span class="linenos">562</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_mean_labels_no_after_filtration-563"><a href="#Stats.get_mean_labels_no_after_filtration-563"><span class="linenos">563</span></a><span class="sd">        Get the users mean number of unique labels</span>
</span><span id="Stats.get_mean_labels_no_after_filtration-564"><a href="#Stats.get_mean_labels_no_after_filtration-564"><span class="linenos">564</span></a><span class="sd">        after filtration.</span>
</span><span id="Stats.get_mean_labels_no_after_filtration-565"><a href="#Stats.get_mean_labels_no_after_filtration-565"><span class="linenos">565</span></a>
</span><span id="Stats.get_mean_labels_no_after_filtration-566"><a href="#Stats.get_mean_labels_no_after_filtration-566"><span class="linenos">566</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_mean_labels_no_after_filtration-567"><a href="#Stats.get_mean_labels_no_after_filtration-567"><span class="linenos">567</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;user_id&#39;</span>
</span><span id="Stats.get_mean_labels_no_after_filtration-568"><a href="#Stats.get_mean_labels_no_after_filtration-568"><span class="linenos">568</span></a><span class="sd">                and &#39;labels&#39; columns.</span>
</span><span id="Stats.get_mean_labels_no_after_filtration-569"><a href="#Stats.get_mean_labels_no_after_filtration-569"><span class="linenos">569</span></a>
</span><span id="Stats.get_mean_labels_no_after_filtration-570"><a href="#Stats.get_mean_labels_no_after_filtration-570"><span class="linenos">570</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_mean_labels_no_after_filtration-571"><a href="#Stats.get_mean_labels_no_after_filtration-571"><span class="linenos">571</span></a><span class="sd">            int: Users mean no. unique label count.</span>
</span><span id="Stats.get_mean_labels_no_after_filtration-572"><a href="#Stats.get_mean_labels_no_after_filtration-572"><span class="linenos">572</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_mean_labels_no_after_filtration-573"><a href="#Stats.get_mean_labels_no_after_filtration-573"><span class="linenos">573</span></a>
</span><span id="Stats.get_mean_labels_no_after_filtration-574"><a href="#Stats.get_mean_labels_no_after_filtration-574"><span class="linenos">574</span></a>        <span class="n">unique_label_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</span><span id="Stats.get_mean_labels_no_after_filtration-575"><a href="#Stats.get_mean_labels_no_after_filtration-575"><span class="linenos">575</span></a>        <span class="n">mean_unique_label_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">unique_label_counts</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</span><span id="Stats.get_mean_labels_no_after_filtration-576"><a href="#Stats.get_mean_labels_no_after_filtration-576"><span class="linenos">576</span></a>
</span><span id="Stats.get_mean_labels_no_after_filtration-577"><a href="#Stats.get_mean_labels_no_after_filtration-577"><span class="linenos">577</span></a>        <span class="k">return</span> <span class="n">mean_unique_label_count</span>
</span></pre></div>


            <div class="docstring"><p>Get the users mean number of unique labels
after filtration.</p>

<p>Args:
    data (TrajectoriesFrame): Input data with 'user_id'
        and 'labels' columns.</p>

<p>Returns:
    int: Users mean no. unique label count.</p>
</div>


                            </div>
                            <div id="Stats.get_std_labels_no_after_filtration" class="classattr">
                                        <input id="Stats.get_std_labels_no_after_filtration-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_std_labels_no_after_filtration</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="Stats.get_std_labels_no_after_filtration-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_std_labels_no_after_filtration"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_std_labels_no_after_filtration-580"><a href="#Stats.get_std_labels_no_after_filtration-580"><span class="linenos">580</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_std_labels_no_after_filtration-581"><a href="#Stats.get_std_labels_no_after_filtration-581"><span class="linenos">581</span></a>    <span class="k">def</span> <span class="nf">get_std_labels_no_after_filtration</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Stats.get_std_labels_no_after_filtration-582"><a href="#Stats.get_std_labels_no_after_filtration-582"><span class="linenos">582</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_std_labels_no_after_filtration-583"><a href="#Stats.get_std_labels_no_after_filtration-583"><span class="linenos">583</span></a><span class="sd">        Get the users std of unique labels</span>
</span><span id="Stats.get_std_labels_no_after_filtration-584"><a href="#Stats.get_std_labels_no_after_filtration-584"><span class="linenos">584</span></a><span class="sd">        after filtration.</span>
</span><span id="Stats.get_std_labels_no_after_filtration-585"><a href="#Stats.get_std_labels_no_after_filtration-585"><span class="linenos">585</span></a>
</span><span id="Stats.get_std_labels_no_after_filtration-586"><a href="#Stats.get_std_labels_no_after_filtration-586"><span class="linenos">586</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_std_labels_no_after_filtration-587"><a href="#Stats.get_std_labels_no_after_filtration-587"><span class="linenos">587</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;user_id&#39;</span>
</span><span id="Stats.get_std_labels_no_after_filtration-588"><a href="#Stats.get_std_labels_no_after_filtration-588"><span class="linenos">588</span></a><span class="sd">                and &#39;labels&#39; columns.</span>
</span><span id="Stats.get_std_labels_no_after_filtration-589"><a href="#Stats.get_std_labels_no_after_filtration-589"><span class="linenos">589</span></a>
</span><span id="Stats.get_std_labels_no_after_filtration-590"><a href="#Stats.get_std_labels_no_after_filtration-590"><span class="linenos">590</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_std_labels_no_after_filtration-591"><a href="#Stats.get_std_labels_no_after_filtration-591"><span class="linenos">591</span></a><span class="sd">            int: Users mean no. unique label count.</span>
</span><span id="Stats.get_std_labels_no_after_filtration-592"><a href="#Stats.get_std_labels_no_after_filtration-592"><span class="linenos">592</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_std_labels_no_after_filtration-593"><a href="#Stats.get_std_labels_no_after_filtration-593"><span class="linenos">593</span></a>
</span><span id="Stats.get_std_labels_no_after_filtration-594"><a href="#Stats.get_std_labels_no_after_filtration-594"><span class="linenos">594</span></a>        <span class="n">unique_label_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</span><span id="Stats.get_std_labels_no_after_filtration-595"><a href="#Stats.get_std_labels_no_after_filtration-595"><span class="linenos">595</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Stats.get_std_labels_no_after_filtration-596"><a href="#Stats.get_std_labels_no_after_filtration-596"><span class="linenos">596</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">unique_label_counts</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>  <span class="c1"># type: ignore</span>
</span><span id="Stats.get_std_labels_no_after_filtration-597"><a href="#Stats.get_std_labels_no_after_filtration-597"><span class="linenos">597</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Stats.get_std_labels_no_after_filtration-598"><a href="#Stats.get_std_labels_no_after_filtration-598"><span class="linenos">598</span></a>            <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># type: ignore</span>
</span></pre></div>


            <div class="docstring"><p>Get the users std of unique labels
after filtration.</p>

<p>Args:
    data (TrajectoriesFrame): Input data with 'user_id'
        and 'labels' columns.</p>

<p>Returns:
    int: Users mean no. unique label count.</p>
</div>


                            </div>
                            <div id="Stats.get_min_records_no_before_filtration" class="classattr">
                                        <input id="Stats.get_min_records_no_before_filtration-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_min_records_no_before_filtration</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span>:</span></span>

                <label class="view-source-button" for="Stats.get_min_records_no_before_filtration-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_min_records_no_before_filtration"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_min_records_no_before_filtration-601"><a href="#Stats.get_min_records_no_before_filtration-601"><span class="linenos">601</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_min_records_no_before_filtration-602"><a href="#Stats.get_min_records_no_before_filtration-602"><span class="linenos">602</span></a>    <span class="k">def</span> <span class="nf">get_min_records_no_before_filtration</span><span class="p">(</span>
</span><span id="Stats.get_min_records_no_before_filtration-603"><a href="#Stats.get_min_records_no_before_filtration-603"><span class="linenos">603</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span>
</span><span id="Stats.get_min_records_no_before_filtration-604"><a href="#Stats.get_min_records_no_before_filtration-604"><span class="linenos">604</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="Stats.get_min_records_no_before_filtration-605"><a href="#Stats.get_min_records_no_before_filtration-605"><span class="linenos">605</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_min_records_no_before_filtration-606"><a href="#Stats.get_min_records_no_before_filtration-606"><span class="linenos">606</span></a><span class="sd">        Get the animals with the minimum number of records</span>
</span><span id="Stats.get_min_records_no_before_filtration-607"><a href="#Stats.get_min_records_no_before_filtration-607"><span class="linenos">607</span></a><span class="sd">        before filtration.</span>
</span><span id="Stats.get_min_records_no_before_filtration-608"><a href="#Stats.get_min_records_no_before_filtration-608"><span class="linenos">608</span></a>
</span><span id="Stats.get_min_records_no_before_filtration-609"><a href="#Stats.get_min_records_no_before_filtration-609"><span class="linenos">609</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_min_records_no_before_filtration-610"><a href="#Stats.get_min_records_no_before_filtration-610"><span class="linenos">610</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;animal_id&#39;</span>
</span><span id="Stats.get_min_records_no_before_filtration-611"><a href="#Stats.get_min_records_no_before_filtration-611"><span class="linenos">611</span></a><span class="sd">                and &#39;time&#39; columns.</span>
</span><span id="Stats.get_min_records_no_before_filtration-612"><a href="#Stats.get_min_records_no_before_filtration-612"><span class="linenos">612</span></a>
</span><span id="Stats.get_min_records_no_before_filtration-613"><a href="#Stats.get_min_records_no_before_filtration-613"><span class="linenos">613</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_min_records_no_before_filtration-614"><a href="#Stats.get_min_records_no_before_filtration-614"><span class="linenos">614</span></a><span class="sd">            pd.Series: Animals with the minimum number of records.</span>
</span><span id="Stats.get_min_records_no_before_filtration-615"><a href="#Stats.get_min_records_no_before_filtration-615"><span class="linenos">615</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_min_records_no_before_filtration-616"><a href="#Stats.get_min_records_no_before_filtration-616"><span class="linenos">616</span></a>
</span><span id="Stats.get_min_records_no_before_filtration-617"><a href="#Stats.get_min_records_no_before_filtration-617"><span class="linenos">617</span></a>        <span class="n">records_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span><span id="Stats.get_min_records_no_before_filtration-618"><a href="#Stats.get_min_records_no_before_filtration-618"><span class="linenos">618</span></a>        <span class="n">min_label_count</span> <span class="o">=</span> <span class="n">records_counts</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats.get_min_records_no_before_filtration-619"><a href="#Stats.get_min_records_no_before_filtration-619"><span class="linenos">619</span></a>
</span><span id="Stats.get_min_records_no_before_filtration-620"><a href="#Stats.get_min_records_no_before_filtration-620"><span class="linenos">620</span></a>        <span class="k">return</span> <span class="n">records_counts</span><span class="p">[</span><span class="n">records_counts</span> <span class="o">==</span> <span class="n">min_label_count</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get the animals with the minimum number of records
before filtration.</p>

<p>Args:
    data (TrajectoriesFrame): Input data with 'animal_id'
        and 'time' columns.</p>

<p>Returns:
    pd.Series: Animals with the minimum number of records.</p>
</div>


                            </div>
                            <div id="Stats.get_mean_records_no_before_filtration" class="classattr">
                                        <input id="Stats.get_mean_records_no_before_filtration-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_mean_records_no_before_filtration</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="Stats.get_mean_records_no_before_filtration-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_mean_records_no_before_filtration"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_mean_records_no_before_filtration-623"><a href="#Stats.get_mean_records_no_before_filtration-623"><span class="linenos">623</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_mean_records_no_before_filtration-624"><a href="#Stats.get_mean_records_no_before_filtration-624"><span class="linenos">624</span></a>    <span class="k">def</span> <span class="nf">get_mean_records_no_before_filtration</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Stats.get_mean_records_no_before_filtration-625"><a href="#Stats.get_mean_records_no_before_filtration-625"><span class="linenos">625</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_mean_records_no_before_filtration-626"><a href="#Stats.get_mean_records_no_before_filtration-626"><span class="linenos">626</span></a><span class="sd">        Get the mean number of records</span>
</span><span id="Stats.get_mean_records_no_before_filtration-627"><a href="#Stats.get_mean_records_no_before_filtration-627"><span class="linenos">627</span></a><span class="sd">        before filtration.</span>
</span><span id="Stats.get_mean_records_no_before_filtration-628"><a href="#Stats.get_mean_records_no_before_filtration-628"><span class="linenos">628</span></a>
</span><span id="Stats.get_mean_records_no_before_filtration-629"><a href="#Stats.get_mean_records_no_before_filtration-629"><span class="linenos">629</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_mean_records_no_before_filtration-630"><a href="#Stats.get_mean_records_no_before_filtration-630"><span class="linenos">630</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;animal_id&#39;</span>
</span><span id="Stats.get_mean_records_no_before_filtration-631"><a href="#Stats.get_mean_records_no_before_filtration-631"><span class="linenos">631</span></a><span class="sd">                and &#39;time&#39; columns.</span>
</span><span id="Stats.get_mean_records_no_before_filtration-632"><a href="#Stats.get_mean_records_no_before_filtration-632"><span class="linenos">632</span></a>
</span><span id="Stats.get_mean_records_no_before_filtration-633"><a href="#Stats.get_mean_records_no_before_filtration-633"><span class="linenos">633</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_mean_records_no_before_filtration-634"><a href="#Stats.get_mean_records_no_before_filtration-634"><span class="linenos">634</span></a><span class="sd">            int: mean number of records.</span>
</span><span id="Stats.get_mean_records_no_before_filtration-635"><a href="#Stats.get_mean_records_no_before_filtration-635"><span class="linenos">635</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_mean_records_no_before_filtration-636"><a href="#Stats.get_mean_records_no_before_filtration-636"><span class="linenos">636</span></a>
</span><span id="Stats.get_mean_records_no_before_filtration-637"><a href="#Stats.get_mean_records_no_before_filtration-637"><span class="linenos">637</span></a>        <span class="n">records_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span><span id="Stats.get_mean_records_no_before_filtration-638"><a href="#Stats.get_mean_records_no_before_filtration-638"><span class="linenos">638</span></a>        <span class="n">mean_label_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">records_counts</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</span><span id="Stats.get_mean_records_no_before_filtration-639"><a href="#Stats.get_mean_records_no_before_filtration-639"><span class="linenos">639</span></a>
</span><span id="Stats.get_mean_records_no_before_filtration-640"><a href="#Stats.get_mean_records_no_before_filtration-640"><span class="linenos">640</span></a>        <span class="k">return</span> <span class="n">mean_label_count</span>
</span></pre></div>


            <div class="docstring"><p>Get the mean number of records
before filtration.</p>

<p>Args:
    data (TrajectoriesFrame): Input data with 'animal_id'
        and 'time' columns.</p>

<p>Returns:
    int: mean number of records.</p>
</div>


                            </div>
                            <div id="Stats.get_std_records_no_before_filtration" class="classattr">
                                        <input id="Stats.get_std_records_no_before_filtration-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_std_records_no_before_filtration</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="Stats.get_std_records_no_before_filtration-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_std_records_no_before_filtration"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_std_records_no_before_filtration-643"><a href="#Stats.get_std_records_no_before_filtration-643"><span class="linenos">643</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_std_records_no_before_filtration-644"><a href="#Stats.get_std_records_no_before_filtration-644"><span class="linenos">644</span></a>    <span class="k">def</span> <span class="nf">get_std_records_no_before_filtration</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Stats.get_std_records_no_before_filtration-645"><a href="#Stats.get_std_records_no_before_filtration-645"><span class="linenos">645</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_std_records_no_before_filtration-646"><a href="#Stats.get_std_records_no_before_filtration-646"><span class="linenos">646</span></a><span class="sd">        Get the mean number of records</span>
</span><span id="Stats.get_std_records_no_before_filtration-647"><a href="#Stats.get_std_records_no_before_filtration-647"><span class="linenos">647</span></a><span class="sd">        before filtration.</span>
</span><span id="Stats.get_std_records_no_before_filtration-648"><a href="#Stats.get_std_records_no_before_filtration-648"><span class="linenos">648</span></a>
</span><span id="Stats.get_std_records_no_before_filtration-649"><a href="#Stats.get_std_records_no_before_filtration-649"><span class="linenos">649</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_std_records_no_before_filtration-650"><a href="#Stats.get_std_records_no_before_filtration-650"><span class="linenos">650</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;animal_id&#39;</span>
</span><span id="Stats.get_std_records_no_before_filtration-651"><a href="#Stats.get_std_records_no_before_filtration-651"><span class="linenos">651</span></a><span class="sd">                and &#39;time&#39; columns.</span>
</span><span id="Stats.get_std_records_no_before_filtration-652"><a href="#Stats.get_std_records_no_before_filtration-652"><span class="linenos">652</span></a>
</span><span id="Stats.get_std_records_no_before_filtration-653"><a href="#Stats.get_std_records_no_before_filtration-653"><span class="linenos">653</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_std_records_no_before_filtration-654"><a href="#Stats.get_std_records_no_before_filtration-654"><span class="linenos">654</span></a><span class="sd">            int: mean number of records.</span>
</span><span id="Stats.get_std_records_no_before_filtration-655"><a href="#Stats.get_std_records_no_before_filtration-655"><span class="linenos">655</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_std_records_no_before_filtration-656"><a href="#Stats.get_std_records_no_before_filtration-656"><span class="linenos">656</span></a>
</span><span id="Stats.get_std_records_no_before_filtration-657"><a href="#Stats.get_std_records_no_before_filtration-657"><span class="linenos">657</span></a>        <span class="n">records_counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span><span id="Stats.get_std_records_no_before_filtration-658"><a href="#Stats.get_std_records_no_before_filtration-658"><span class="linenos">658</span></a>
</span><span id="Stats.get_std_records_no_before_filtration-659"><a href="#Stats.get_std_records_no_before_filtration-659"><span class="linenos">659</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Stats.get_std_records_no_before_filtration-660"><a href="#Stats.get_std_records_no_before_filtration-660"><span class="linenos">660</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">records_counts</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>  <span class="c1"># type: ignore</span>
</span><span id="Stats.get_std_records_no_before_filtration-661"><a href="#Stats.get_std_records_no_before_filtration-661"><span class="linenos">661</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Stats.get_std_records_no_before_filtration-662"><a href="#Stats.get_std_records_no_before_filtration-662"><span class="linenos">662</span></a>            <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># type: ignore</span>
</span></pre></div>


            <div class="docstring"><p>Get the mean number of records
before filtration.</p>

<p>Args:
    data (TrajectoriesFrame): Input data with 'animal_id'
        and 'time' columns.</p>

<p>Returns:
    int: mean number of records.</p>
</div>


                            </div>
                            <div id="Stats.get_mean_periods" class="classattr">
                                        <input id="Stats.get_mean_periods-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_mean_periods</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">tslibs</span><span class="o">.</span><span class="n">timedeltas</span><span class="o">.</span><span class="n">Timedelta</span>:</span></span>

                <label class="view-source-button" for="Stats.get_mean_periods-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_mean_periods"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_mean_periods-665"><a href="#Stats.get_mean_periods-665"><span class="linenos">665</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_mean_periods-666"><a href="#Stats.get_mean_periods-666"><span class="linenos">666</span></a>    <span class="k">def</span> <span class="nf">get_mean_periods</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="Stats.get_mean_periods-667"><a href="#Stats.get_mean_periods-667"><span class="linenos">667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_mean_periods-668"><a href="#Stats.get_mean_periods-668"><span class="linenos">668</span></a><span class="sd">        Get the mean period between start and end times.</span>
</span><span id="Stats.get_mean_periods-669"><a href="#Stats.get_mean_periods-669"><span class="linenos">669</span></a>
</span><span id="Stats.get_mean_periods-670"><a href="#Stats.get_mean_periods-670"><span class="linenos">670</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_mean_periods-671"><a href="#Stats.get_mean_periods-671"><span class="linenos">671</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;start&#39;</span>
</span><span id="Stats.get_mean_periods-672"><a href="#Stats.get_mean_periods-672"><span class="linenos">672</span></a><span class="sd">                and &#39;end&#39; columns.</span>
</span><span id="Stats.get_mean_periods-673"><a href="#Stats.get_mean_periods-673"><span class="linenos">673</span></a>
</span><span id="Stats.get_mean_periods-674"><a href="#Stats.get_mean_periods-674"><span class="linenos">674</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_mean_periods-675"><a href="#Stats.get_mean_periods-675"><span class="linenos">675</span></a><span class="sd">            float: The mean period in days.</span>
</span><span id="Stats.get_mean_periods-676"><a href="#Stats.get_mean_periods-676"><span class="linenos">676</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_mean_periods-677"><a href="#Stats.get_mean_periods-677"><span class="linenos">677</span></a>
</span><span id="Stats.get_mean_periods-678"><a href="#Stats.get_mean_periods-678"><span class="linenos">678</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Stats.get_mean_periods-679"><a href="#Stats.get_mean_periods-679"><span class="linenos">679</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats.get_mean_periods-680"><a href="#Stats.get_mean_periods-680"><span class="linenos">680</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span></pre></div>


            <div class="docstring"><p>Get the mean period between start and end times.</p>

<p>Args:
    data (TrajectoriesFrame): Input data with 'start'
        and 'end' columns.</p>

<p>Returns:
    float: The mean period in days.</p>
</div>


                            </div>
                            <div id="Stats.get_min_periods" class="classattr">
                                        <input id="Stats.get_min_periods-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_min_periods</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">tslibs</span><span class="o">.</span><span class="n">timedeltas</span><span class="o">.</span><span class="n">Timedelta</span>:</span></span>

                <label class="view-source-button" for="Stats.get_min_periods-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_min_periods"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_min_periods-683"><a href="#Stats.get_min_periods-683"><span class="linenos">683</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_min_periods-684"><a href="#Stats.get_min_periods-684"><span class="linenos">684</span></a>    <span class="k">def</span> <span class="nf">get_min_periods</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="Stats.get_min_periods-685"><a href="#Stats.get_min_periods-685"><span class="linenos">685</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_min_periods-686"><a href="#Stats.get_min_periods-686"><span class="linenos">686</span></a><span class="sd">        Get the minimum period between start and end times.</span>
</span><span id="Stats.get_min_periods-687"><a href="#Stats.get_min_periods-687"><span class="linenos">687</span></a>
</span><span id="Stats.get_min_periods-688"><a href="#Stats.get_min_periods-688"><span class="linenos">688</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_min_periods-689"><a href="#Stats.get_min_periods-689"><span class="linenos">689</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;start&#39;</span>
</span><span id="Stats.get_min_periods-690"><a href="#Stats.get_min_periods-690"><span class="linenos">690</span></a><span class="sd">                and &#39;end&#39; columns.</span>
</span><span id="Stats.get_min_periods-691"><a href="#Stats.get_min_periods-691"><span class="linenos">691</span></a>
</span><span id="Stats.get_min_periods-692"><a href="#Stats.get_min_periods-692"><span class="linenos">692</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_min_periods-693"><a href="#Stats.get_min_periods-693"><span class="linenos">693</span></a><span class="sd">            float: The minimum period in days.</span>
</span><span id="Stats.get_min_periods-694"><a href="#Stats.get_min_periods-694"><span class="linenos">694</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_min_periods-695"><a href="#Stats.get_min_periods-695"><span class="linenos">695</span></a>
</span><span id="Stats.get_min_periods-696"><a href="#Stats.get_min_periods-696"><span class="linenos">696</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Stats.get_min_periods-697"><a href="#Stats.get_min_periods-697"><span class="linenos">697</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats.get_min_periods-698"><a href="#Stats.get_min_periods-698"><span class="linenos">698</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span></pre></div>


            <div class="docstring"><p>Get the minimum period between start and end times.</p>

<p>Args:
    data (TrajectoriesFrame): Input data with 'start'
        and 'end' columns.</p>

<p>Returns:
    float: The minimum period in days.</p>
</div>


                            </div>
                            <div id="Stats.get_max_periods" class="classattr">
                                        <input id="Stats.get_max_periods-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_max_periods</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">tslibs</span><span class="o">.</span><span class="n">timedeltas</span><span class="o">.</span><span class="n">Timedelta</span>:</span></span>

                <label class="view-source-button" for="Stats.get_max_periods-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_max_periods"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_max_periods-701"><a href="#Stats.get_max_periods-701"><span class="linenos">701</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_max_periods-702"><a href="#Stats.get_max_periods-702"><span class="linenos">702</span></a>    <span class="k">def</span> <span class="nf">get_max_periods</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="Stats.get_max_periods-703"><a href="#Stats.get_max_periods-703"><span class="linenos">703</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_max_periods-704"><a href="#Stats.get_max_periods-704"><span class="linenos">704</span></a><span class="sd">        Get the maximum period between start and end times.</span>
</span><span id="Stats.get_max_periods-705"><a href="#Stats.get_max_periods-705"><span class="linenos">705</span></a>
</span><span id="Stats.get_max_periods-706"><a href="#Stats.get_max_periods-706"><span class="linenos">706</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_max_periods-707"><a href="#Stats.get_max_periods-707"><span class="linenos">707</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;start&#39;</span>
</span><span id="Stats.get_max_periods-708"><a href="#Stats.get_max_periods-708"><span class="linenos">708</span></a><span class="sd">                and &#39;end&#39; columns.</span>
</span><span id="Stats.get_max_periods-709"><a href="#Stats.get_max_periods-709"><span class="linenos">709</span></a>
</span><span id="Stats.get_max_periods-710"><a href="#Stats.get_max_periods-710"><span class="linenos">710</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_max_periods-711"><a href="#Stats.get_max_periods-711"><span class="linenos">711</span></a><span class="sd">            float: The maximum period in days.</span>
</span><span id="Stats.get_max_periods-712"><a href="#Stats.get_max_periods-712"><span class="linenos">712</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_max_periods-713"><a href="#Stats.get_max_periods-713"><span class="linenos">713</span></a>
</span><span id="Stats.get_max_periods-714"><a href="#Stats.get_max_periods-714"><span class="linenos">714</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Stats.get_max_periods-715"><a href="#Stats.get_max_periods-715"><span class="linenos">715</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats.get_max_periods-716"><a href="#Stats.get_max_periods-716"><span class="linenos">716</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span></pre></div>


            <div class="docstring"><p>Get the maximum period between start and end times.</p>

<p>Args:
    data (TrajectoriesFrame): Input data with 'start'
        and 'end' columns.</p>

<p>Returns:
    float: The maximum period in days.</p>
</div>


                            </div>
                            <div id="Stats.get_std_periods" class="classattr">
                                        <input id="Stats.get_std_periods-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_std_periods</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">tslibs</span><span class="o">.</span><span class="n">timedeltas</span><span class="o">.</span><span class="n">Timedelta</span>:</span></span>

                <label class="view-source-button" for="Stats.get_std_periods-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_std_periods"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_std_periods-719"><a href="#Stats.get_std_periods-719"><span class="linenos">719</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_std_periods-720"><a href="#Stats.get_std_periods-720"><span class="linenos">720</span></a>    <span class="k">def</span> <span class="nf">get_std_periods</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">:</span>
</span><span id="Stats.get_std_periods-721"><a href="#Stats.get_std_periods-721"><span class="linenos">721</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_std_periods-722"><a href="#Stats.get_std_periods-722"><span class="linenos">722</span></a><span class="sd">        Get the std of period between start and end times.</span>
</span><span id="Stats.get_std_periods-723"><a href="#Stats.get_std_periods-723"><span class="linenos">723</span></a>
</span><span id="Stats.get_std_periods-724"><a href="#Stats.get_std_periods-724"><span class="linenos">724</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_std_periods-725"><a href="#Stats.get_std_periods-725"><span class="linenos">725</span></a><span class="sd">            data (TrajectoriesFrame): Input data with &#39;start&#39;</span>
</span><span id="Stats.get_std_periods-726"><a href="#Stats.get_std_periods-726"><span class="linenos">726</span></a><span class="sd">                and &#39;end&#39; columns.</span>
</span><span id="Stats.get_std_periods-727"><a href="#Stats.get_std_periods-727"><span class="linenos">727</span></a>
</span><span id="Stats.get_std_periods-728"><a href="#Stats.get_std_periods-728"><span class="linenos">728</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_std_periods-729"><a href="#Stats.get_std_periods-729"><span class="linenos">729</span></a><span class="sd">            float: The std period in days.</span>
</span><span id="Stats.get_std_periods-730"><a href="#Stats.get_std_periods-730"><span class="linenos">730</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_std_periods-731"><a href="#Stats.get_std_periods-731"><span class="linenos">731</span></a>
</span><span id="Stats.get_std_periods-732"><a href="#Stats.get_std_periods-732"><span class="linenos">732</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Stats.get_std_periods-733"><a href="#Stats.get_std_periods-733"><span class="linenos">733</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="Stats.get_std_periods-734"><a href="#Stats.get_std_periods-734"><span class="linenos">734</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Stats.get_std_periods-735"><a href="#Stats.get_std_periods-735"><span class="linenos">735</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="Stats.get_std_periods-736"><a href="#Stats.get_std_periods-736"><span class="linenos">736</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Stats.get_std_periods-737"><a href="#Stats.get_std_periods-737"><span class="linenos">737</span></a>            <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># type: ignore</span>
</span></pre></div>


            <div class="docstring"><p>Get the std of period between start and end times.</p>

<p>Args:
    data (TrajectoriesFrame): Input data with 'start'
        and 'end' columns.</p>

<p>Returns:
    float: The std period in days.</p>
</div>


                            </div>
                            <div id="Stats.get_overall_area" class="classattr">
                                        <input id="Stats.get_overall_area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_overall_area</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Stats.get_overall_area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_overall_area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_overall_area-740"><a href="#Stats.get_overall_area-740"><span class="linenos">740</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_overall_area-741"><a href="#Stats.get_overall_area-741"><span class="linenos">741</span></a>    <span class="k">def</span> <span class="nf">get_overall_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Stats.get_overall_area-742"><a href="#Stats.get_overall_area-742"><span class="linenos">742</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_overall_area-743"><a href="#Stats.get_overall_area-743"><span class="linenos">743</span></a><span class="sd">        Get the overall area covered by the trajectories.</span>
</span><span id="Stats.get_overall_area-744"><a href="#Stats.get_overall_area-744"><span class="linenos">744</span></a>
</span><span id="Stats.get_overall_area-745"><a href="#Stats.get_overall_area-745"><span class="linenos">745</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_overall_area-746"><a href="#Stats.get_overall_area-746"><span class="linenos">746</span></a><span class="sd">            data (TrajectoriesFrame): Input spatial data.</span>
</span><span id="Stats.get_overall_area-747"><a href="#Stats.get_overall_area-747"><span class="linenos">747</span></a>
</span><span id="Stats.get_overall_area-748"><a href="#Stats.get_overall_area-748"><span class="linenos">748</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_overall_area-749"><a href="#Stats.get_overall_area-749"><span class="linenos">749</span></a><span class="sd">            float: The overall area in hectares.</span>
</span><span id="Stats.get_overall_area-750"><a href="#Stats.get_overall_area-750"><span class="linenos">750</span></a>
</span><span id="Stats.get_overall_area-751"><a href="#Stats.get_overall_area-751"><span class="linenos">751</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_overall_area-752"><a href="#Stats.get_overall_area-752"><span class="linenos">752</span></a>
</span><span id="Stats.get_overall_area-753"><a href="#Stats.get_overall_area-753"><span class="linenos">753</span></a>        <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="Stats.get_overall_area-754"><a href="#Stats.get_overall_area-754"><span class="linenos">754</span></a>
</span><span id="Stats.get_overall_area-755"><a href="#Stats.get_overall_area-755"><span class="linenos">755</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the overall area covered by the trajectories.</p>

<p>Args:
    data (TrajectoriesFrame): Input spatial data.</p>

<p>Returns:
    float: The overall area in hectares.</p>
</div>


                            </div>
                            <div id="Stats.get_mean_area" class="classattr">
                                        <input id="Stats.get_mean_area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_mean_area</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Stats.get_mean_area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_mean_area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_mean_area-758"><a href="#Stats.get_mean_area-758"><span class="linenos">758</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_mean_area-759"><a href="#Stats.get_mean_area-759"><span class="linenos">759</span></a>    <span class="k">def</span> <span class="nf">get_mean_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Stats.get_mean_area-760"><a href="#Stats.get_mean_area-760"><span class="linenos">760</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_mean_area-761"><a href="#Stats.get_mean_area-761"><span class="linenos">761</span></a><span class="sd">        Get the mean area covered by trajectories per user.</span>
</span><span id="Stats.get_mean_area-762"><a href="#Stats.get_mean_area-762"><span class="linenos">762</span></a>
</span><span id="Stats.get_mean_area-763"><a href="#Stats.get_mean_area-763"><span class="linenos">763</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_mean_area-764"><a href="#Stats.get_mean_area-764"><span class="linenos">764</span></a><span class="sd">            data (TrajectoriesFrame): Input data.</span>
</span><span id="Stats.get_mean_area-765"><a href="#Stats.get_mean_area-765"><span class="linenos">765</span></a>
</span><span id="Stats.get_mean_area-766"><a href="#Stats.get_mean_area-766"><span class="linenos">766</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_mean_area-767"><a href="#Stats.get_mean_area-767"><span class="linenos">767</span></a><span class="sd">            float: The mean area in hectares.</span>
</span><span id="Stats.get_mean_area-768"><a href="#Stats.get_mean_area-768"><span class="linenos">768</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_mean_area-769"><a href="#Stats.get_mean_area-769"><span class="linenos">769</span></a>
</span><span id="Stats.get_mean_area-770"><a href="#Stats.get_mean_area-770"><span class="linenos">770</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="Stats.get_mean_area-771"><a href="#Stats.get_mean_area-771"><span class="linenos">771</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stats.get_mean_area-772"><a href="#Stats.get_mean_area-772"><span class="linenos">772</span></a>        <span class="k">for</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
</span><span id="Stats.get_mean_area-773"><a href="#Stats.get_mean_area-773"><span class="linenos">773</span></a>            <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="Stats.get_mean_area-774"><a href="#Stats.get_mean_area-774"><span class="linenos">774</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">)</span>
</span><span id="Stats.get_mean_area-775"><a href="#Stats.get_mean_area-775"><span class="linenos">775</span></a>
</span><span id="Stats.get_mean_area-776"><a href="#Stats.get_mean_area-776"><span class="linenos">776</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the mean area covered by trajectories per user.</p>

<p>Args:
    data (TrajectoriesFrame): Input data.</p>

<p>Returns:
    float: The mean area in hectares.</p>
</div>


                            </div>
                            <div id="Stats.get_min_area" class="classattr">
                                        <input id="Stats.get_min_area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_min_area</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Stats.get_min_area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_min_area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_min_area-779"><a href="#Stats.get_min_area-779"><span class="linenos">779</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_min_area-780"><a href="#Stats.get_min_area-780"><span class="linenos">780</span></a>    <span class="k">def</span> <span class="nf">get_min_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Stats.get_min_area-781"><a href="#Stats.get_min_area-781"><span class="linenos">781</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_min_area-782"><a href="#Stats.get_min_area-782"><span class="linenos">782</span></a><span class="sd">        Get the min area covered by trajectories per user.</span>
</span><span id="Stats.get_min_area-783"><a href="#Stats.get_min_area-783"><span class="linenos">783</span></a>
</span><span id="Stats.get_min_area-784"><a href="#Stats.get_min_area-784"><span class="linenos">784</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_min_area-785"><a href="#Stats.get_min_area-785"><span class="linenos">785</span></a><span class="sd">            data (TrajectoriesFrame): Input data.</span>
</span><span id="Stats.get_min_area-786"><a href="#Stats.get_min_area-786"><span class="linenos">786</span></a>
</span><span id="Stats.get_min_area-787"><a href="#Stats.get_min_area-787"><span class="linenos">787</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_min_area-788"><a href="#Stats.get_min_area-788"><span class="linenos">788</span></a><span class="sd">            float: The min area in hectares.</span>
</span><span id="Stats.get_min_area-789"><a href="#Stats.get_min_area-789"><span class="linenos">789</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_min_area-790"><a href="#Stats.get_min_area-790"><span class="linenos">790</span></a>
</span><span id="Stats.get_min_area-791"><a href="#Stats.get_min_area-791"><span class="linenos">791</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="Stats.get_min_area-792"><a href="#Stats.get_min_area-792"><span class="linenos">792</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stats.get_min_area-793"><a href="#Stats.get_min_area-793"><span class="linenos">793</span></a>        <span class="k">for</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
</span><span id="Stats.get_min_area-794"><a href="#Stats.get_min_area-794"><span class="linenos">794</span></a>            <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="Stats.get_min_area-795"><a href="#Stats.get_min_area-795"><span class="linenos">795</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">)</span>
</span><span id="Stats.get_min_area-796"><a href="#Stats.get_min_area-796"><span class="linenos">796</span></a>
</span><span id="Stats.get_min_area-797"><a href="#Stats.get_min_area-797"><span class="linenos">797</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the min area covered by trajectories per user.</p>

<p>Args:
    data (TrajectoriesFrame): Input data.</p>

<p>Returns:
    float: The min area in hectares.</p>
</div>


                            </div>
                            <div id="Stats.get_max_area" class="classattr">
                                        <input id="Stats.get_max_area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_max_area</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Stats.get_max_area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_max_area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_max_area-800"><a href="#Stats.get_max_area-800"><span class="linenos">800</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_max_area-801"><a href="#Stats.get_max_area-801"><span class="linenos">801</span></a>    <span class="k">def</span> <span class="nf">get_max_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Stats.get_max_area-802"><a href="#Stats.get_max_area-802"><span class="linenos">802</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_max_area-803"><a href="#Stats.get_max_area-803"><span class="linenos">803</span></a><span class="sd">        Get the max area covered by trajectories per user.</span>
</span><span id="Stats.get_max_area-804"><a href="#Stats.get_max_area-804"><span class="linenos">804</span></a>
</span><span id="Stats.get_max_area-805"><a href="#Stats.get_max_area-805"><span class="linenos">805</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_max_area-806"><a href="#Stats.get_max_area-806"><span class="linenos">806</span></a><span class="sd">            data (TrajectoriesFrame): Input data.</span>
</span><span id="Stats.get_max_area-807"><a href="#Stats.get_max_area-807"><span class="linenos">807</span></a>
</span><span id="Stats.get_max_area-808"><a href="#Stats.get_max_area-808"><span class="linenos">808</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_max_area-809"><a href="#Stats.get_max_area-809"><span class="linenos">809</span></a><span class="sd">            float: The max area in hectares.</span>
</span><span id="Stats.get_max_area-810"><a href="#Stats.get_max_area-810"><span class="linenos">810</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_max_area-811"><a href="#Stats.get_max_area-811"><span class="linenos">811</span></a>
</span><span id="Stats.get_max_area-812"><a href="#Stats.get_max_area-812"><span class="linenos">812</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="Stats.get_max_area-813"><a href="#Stats.get_max_area-813"><span class="linenos">813</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stats.get_max_area-814"><a href="#Stats.get_max_area-814"><span class="linenos">814</span></a>        <span class="k">for</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
</span><span id="Stats.get_max_area-815"><a href="#Stats.get_max_area-815"><span class="linenos">815</span></a>            <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="Stats.get_max_area-816"><a href="#Stats.get_max_area-816"><span class="linenos">816</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">)</span>
</span><span id="Stats.get_max_area-817"><a href="#Stats.get_max_area-817"><span class="linenos">817</span></a>
</span><span id="Stats.get_max_area-818"><a href="#Stats.get_max_area-818"><span class="linenos">818</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the max area covered by trajectories per user.</p>

<p>Args:
    data (TrajectoriesFrame): Input data.</p>

<p>Returns:
    float: The max area in hectares.</p>
</div>


                            </div>
                            <div id="Stats.get_std_area" class="classattr">
                                        <input id="Stats.get_std_area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_std_area</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Stats.get_std_area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stats.get_std_area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stats.get_std_area-821"><a href="#Stats.get_std_area-821"><span class="linenos">821</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stats.get_std_area-822"><a href="#Stats.get_std_area-822"><span class="linenos">822</span></a>    <span class="k">def</span> <span class="nf">get_std_area</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Stats.get_std_area-823"><a href="#Stats.get_std_area-823"><span class="linenos">823</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stats.get_std_area-824"><a href="#Stats.get_std_area-824"><span class="linenos">824</span></a><span class="sd">        Get the std of area covered by trajectories per user.</span>
</span><span id="Stats.get_std_area-825"><a href="#Stats.get_std_area-825"><span class="linenos">825</span></a>
</span><span id="Stats.get_std_area-826"><a href="#Stats.get_std_area-826"><span class="linenos">826</span></a><span class="sd">        Args:</span>
</span><span id="Stats.get_std_area-827"><a href="#Stats.get_std_area-827"><span class="linenos">827</span></a><span class="sd">            data (TrajectoriesFrame): Input data.</span>
</span><span id="Stats.get_std_area-828"><a href="#Stats.get_std_area-828"><span class="linenos">828</span></a>
</span><span id="Stats.get_std_area-829"><a href="#Stats.get_std_area-829"><span class="linenos">829</span></a><span class="sd">        Returns:</span>
</span><span id="Stats.get_std_area-830"><a href="#Stats.get_std_area-830"><span class="linenos">830</span></a><span class="sd">            float: The std of area in hectares.</span>
</span><span id="Stats.get_std_area-831"><a href="#Stats.get_std_area-831"><span class="linenos">831</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stats.get_std_area-832"><a href="#Stats.get_std_area-832"><span class="linenos">832</span></a>
</span><span id="Stats.get_std_area-833"><a href="#Stats.get_std_area-833"><span class="linenos">833</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="Stats.get_std_area-834"><a href="#Stats.get_std_area-834"><span class="linenos">834</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stats.get_std_area-835"><a href="#Stats.get_std_area-835"><span class="linenos">835</span></a>        <span class="k">for</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
</span><span id="Stats.get_std_area-836"><a href="#Stats.get_std_area-836"><span class="linenos">836</span></a>            <span class="n">convex_hull</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
</span><span id="Stats.get_std_area-837"><a href="#Stats.get_std_area-837"><span class="linenos">837</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convex_hull</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">)</span>
</span><span id="Stats.get_std_area-838"><a href="#Stats.get_std_area-838"><span class="linenos">838</span></a>
</span><span id="Stats.get_std_area-839"><a href="#Stats.get_std_area-839"><span class="linenos">839</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Stats.get_std_area-840"><a href="#Stats.get_std_area-840"><span class="linenos">840</span></a>            <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Stats.get_std_area-841"><a href="#Stats.get_std_area-841"><span class="linenos">841</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Stats.get_std_area-842"><a href="#Stats.get_std_area-842"><span class="linenos">842</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>Get the std of area covered by trajectories per user.</p>

<p>Args:
    data (TrajectoriesFrame): Input data.</p>

<p>Returns:
    float: The std of area in hectares.</p>
</div>


                            </div>
                </section>
                <section id="DataSetStats">
                            <input id="DataSetStats-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DataSetStats</span>:

                <label class="view-source-button" for="DataSetStats-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataSetStats"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataSetStats-846"><a href="#DataSetStats-846"><span class="linenos">846</span></a><span class="k">class</span> <span class="nc">DataSetStats</span><span class="p">:</span>
</span><span id="DataSetStats-847"><a href="#DataSetStats-847"><span class="linenos">847</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataSetStats-848"><a href="#DataSetStats-848"><span class="linenos">848</span></a><span class="sd">    A class for managing dataset statistics, storing various statistical</span>
</span><span id="DataSetStats-849"><a href="#DataSetStats-849"><span class="linenos">849</span></a><span class="sd">    measures, and saving them into a structured DataFrame.</span>
</span><span id="DataSetStats-850"><a href="#DataSetStats-850"><span class="linenos">850</span></a>
</span><span id="DataSetStats-851"><a href="#DataSetStats-851"><span class="linenos">851</span></a><span class="sd">    Attributes:</span>
</span><span id="DataSetStats-852"><a href="#DataSetStats-852"><span class="linenos">852</span></a><span class="sd">        output_dir (str): Directory to save the dataset statistics.</span>
</span><span id="DataSetStats-853"><a href="#DataSetStats-853"><span class="linenos">853</span></a><span class="sd">        record (dict): A dictionary to store temporary statistics</span>
</span><span id="DataSetStats-854"><a href="#DataSetStats-854"><span class="linenos">854</span></a><span class="sd">            before adding them to the dataset.</span>
</span><span id="DataSetStats-855"><a href="#DataSetStats-855"><span class="linenos">855</span></a><span class="sd">        stats_set (pd.DataFrame): A DataFrame containing all the</span>
</span><span id="DataSetStats-856"><a href="#DataSetStats-856"><span class="linenos">856</span></a><span class="sd">            statistics collected for different datasets.</span>
</span><span id="DataSetStats-857"><a href="#DataSetStats-857"><span class="linenos">857</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DataSetStats-858"><a href="#DataSetStats-858"><span class="linenos">858</span></a>
</span><span id="DataSetStats-859"><a href="#DataSetStats-859"><span class="linenos">859</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataSetStats-860"><a href="#DataSetStats-860"><span class="linenos">860</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataSetStats-861"><a href="#DataSetStats-861"><span class="linenos">861</span></a><span class="sd">        Initializes the DataSetStats class.</span>
</span><span id="DataSetStats-862"><a href="#DataSetStats-862"><span class="linenos">862</span></a>
</span><span id="DataSetStats-863"><a href="#DataSetStats-863"><span class="linenos">863</span></a><span class="sd">        Args:</span>
</span><span id="DataSetStats-864"><a href="#DataSetStats-864"><span class="linenos">864</span></a><span class="sd">            output_dir (str): The directory where output files</span>
</span><span id="DataSetStats-865"><a href="#DataSetStats-865"><span class="linenos">865</span></a><span class="sd">                will be stored.</span>
</span><span id="DataSetStats-866"><a href="#DataSetStats-866"><span class="linenos">866</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataSetStats-867"><a href="#DataSetStats-867"><span class="linenos">867</span></a>
</span><span id="DataSetStats-868"><a href="#DataSetStats-868"><span class="linenos">868</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">output_dir</span>
</span><span id="DataSetStats-869"><a href="#DataSetStats-869"><span class="linenos">869</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">record</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DataSetStats-870"><a href="#DataSetStats-870"><span class="linenos">870</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_set</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="DataSetStats-871"><a href="#DataSetStats-871"><span class="linenos">871</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
</span><span id="DataSetStats-872"><a href="#DataSetStats-872"><span class="linenos">872</span></a>                <span class="s2">&quot;animal&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-873"><a href="#DataSetStats-873"><span class="linenos">873</span></a>                <span class="s2">&quot;animal_no&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-874"><a href="#DataSetStats-874"><span class="linenos">874</span></a>                <span class="s2">&quot;animal_after_filtration&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-875"><a href="#DataSetStats-875"><span class="linenos">875</span></a>                <span class="s2">&quot;time_period&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-876"><a href="#DataSetStats-876"><span class="linenos">876</span></a>                <span class="s2">&quot;min_label_no&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-877"><a href="#DataSetStats-877"><span class="linenos">877</span></a>                <span class="s2">&quot;mean_label_no&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-878"><a href="#DataSetStats-878"><span class="linenos">878</span></a>                <span class="s2">&quot;std_label_no&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-879"><a href="#DataSetStats-879"><span class="linenos">879</span></a>                <span class="s2">&quot;min_records&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-880"><a href="#DataSetStats-880"><span class="linenos">880</span></a>                <span class="s2">&quot;mean_records&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-881"><a href="#DataSetStats-881"><span class="linenos">881</span></a>                <span class="s2">&quot;std_records&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-882"><a href="#DataSetStats-882"><span class="linenos">882</span></a>                <span class="s2">&quot;avg_duration&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-883"><a href="#DataSetStats-883"><span class="linenos">883</span></a>                <span class="s2">&quot;std_duration&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-884"><a href="#DataSetStats-884"><span class="linenos">884</span></a>                <span class="s2">&quot;min_duration&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-885"><a href="#DataSetStats-885"><span class="linenos">885</span></a>                <span class="s2">&quot;max_duration&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-886"><a href="#DataSetStats-886"><span class="linenos">886</span></a>                <span class="s2">&quot;overall_set_area&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-887"><a href="#DataSetStats-887"><span class="linenos">887</span></a>                <span class="s2">&quot;average_set_area&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-888"><a href="#DataSetStats-888"><span class="linenos">888</span></a>                <span class="s2">&quot;min_area&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-889"><a href="#DataSetStats-889"><span class="linenos">889</span></a>                <span class="s2">&quot;max_area&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-890"><a href="#DataSetStats-890"><span class="linenos">890</span></a>                <span class="s2">&quot;std_area&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-891"><a href="#DataSetStats-891"><span class="linenos">891</span></a>                <span class="s2">&quot;visitation_frequency&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-892"><a href="#DataSetStats-892"><span class="linenos">892</span></a>                <span class="s2">&quot;visitation_frequency_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-893"><a href="#DataSetStats-893"><span class="linenos">893</span></a>                <span class="s2">&quot;distinct_locations_over_time&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-894"><a href="#DataSetStats-894"><span class="linenos">894</span></a>                <span class="s2">&quot;distinct_locations_over_time_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-895"><a href="#DataSetStats-895"><span class="linenos">895</span></a>                <span class="s2">&quot;jump_lengths_distribution&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-896"><a href="#DataSetStats-896"><span class="linenos">896</span></a>                <span class="s2">&quot;jump_lengths_distribution_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-897"><a href="#DataSetStats-897"><span class="linenos">897</span></a>                <span class="s2">&quot;waiting_times&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-898"><a href="#DataSetStats-898"><span class="linenos">898</span></a>                <span class="s2">&quot;waiting_times_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-899"><a href="#DataSetStats-899"><span class="linenos">899</span></a>                <span class="s2">&quot;msd_curve&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-900"><a href="#DataSetStats-900"><span class="linenos">900</span></a>                <span class="s2">&quot;msd_curve_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-901"><a href="#DataSetStats-901"><span class="linenos">901</span></a>                <span class="c1"># &quot;travel_times&quot;,</span>
</span><span id="DataSetStats-902"><a href="#DataSetStats-902"><span class="linenos">902</span></a>                <span class="c1"># &quot;travel_times_params&quot;,</span>
</span><span id="DataSetStats-903"><a href="#DataSetStats-903"><span class="linenos">903</span></a>                <span class="c1"># &quot;rog&quot;,</span>
</span><span id="DataSetStats-904"><a href="#DataSetStats-904"><span class="linenos">904</span></a>                <span class="c1"># &quot;rog_params&quot;,</span>
</span><span id="DataSetStats-905"><a href="#DataSetStats-905"><span class="linenos">905</span></a>                <span class="s2">&quot;rog_over_time&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-906"><a href="#DataSetStats-906"><span class="linenos">906</span></a>                <span class="s2">&quot;rog_over_time_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-907"><a href="#DataSetStats-907"><span class="linenos">907</span></a>                <span class="s2">&quot;msd_distribution&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-908"><a href="#DataSetStats-908"><span class="linenos">908</span></a>                <span class="s2">&quot;msd_distribution_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-909"><a href="#DataSetStats-909"><span class="linenos">909</span></a>                <span class="c1"># &quot;return_time_distribution&quot;,</span>
</span><span id="DataSetStats-910"><a href="#DataSetStats-910"><span class="linenos">910</span></a>                <span class="c1"># &quot;return_time_distribution_params&quot;,</span>
</span><span id="DataSetStats-911"><a href="#DataSetStats-911"><span class="linenos">911</span></a>                <span class="c1"># &quot;exploration_time&quot;,</span>
</span><span id="DataSetStats-912"><a href="#DataSetStats-912"><span class="linenos">912</span></a>                <span class="c1"># &quot;exploration_time_params&quot;,</span>
</span><span id="DataSetStats-913"><a href="#DataSetStats-913"><span class="linenos">913</span></a>                <span class="s2">&quot;rho&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-914"><a href="#DataSetStats-914"><span class="linenos">914</span></a>                <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="DataSetStats-915"><a href="#DataSetStats-915"><span class="linenos">915</span></a>            <span class="p">]</span>
</span><span id="DataSetStats-916"><a href="#DataSetStats-916"><span class="linenos">916</span></a>        <span class="p">)</span>
</span><span id="DataSetStats-917"><a href="#DataSetStats-917"><span class="linenos">917</span></a>
</span><span id="DataSetStats-918"><a href="#DataSetStats-918"><span class="linenos">918</span></a>
</span><span id="DataSetStats-919"><a href="#DataSetStats-919"><span class="linenos">919</span></a>    <span class="k">def</span> <span class="nf">add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataSetStats-920"><a href="#DataSetStats-920"><span class="linenos">920</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataSetStats-921"><a href="#DataSetStats-921"><span class="linenos">921</span></a><span class="sd">        Updates the record dictionary with new data.</span>
</span><span id="DataSetStats-922"><a href="#DataSetStats-922"><span class="linenos">922</span></a>
</span><span id="DataSetStats-923"><a href="#DataSetStats-923"><span class="linenos">923</span></a><span class="sd">        Args:</span>
</span><span id="DataSetStats-924"><a href="#DataSetStats-924"><span class="linenos">924</span></a><span class="sd">            data (dict): A dictionary containing key-value</span>
</span><span id="DataSetStats-925"><a href="#DataSetStats-925"><span class="linenos">925</span></a><span class="sd">                pairs of statistics to be added.</span>
</span><span id="DataSetStats-926"><a href="#DataSetStats-926"><span class="linenos">926</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataSetStats-927"><a href="#DataSetStats-927"><span class="linenos">927</span></a>
</span><span id="DataSetStats-928"><a href="#DataSetStats-928"><span class="linenos">928</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">record</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">data</span><span class="p">))</span>
</span><span id="DataSetStats-929"><a href="#DataSetStats-929"><span class="linenos">929</span></a>
</span><span id="DataSetStats-930"><a href="#DataSetStats-930"><span class="linenos">930</span></a>
</span><span id="DataSetStats-931"><a href="#DataSetStats-931"><span class="linenos">931</span></a>    <span class="k">def</span> <span class="nf">add_record</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataSetStats-932"><a href="#DataSetStats-932"><span class="linenos">932</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataSetStats-933"><a href="#DataSetStats-933"><span class="linenos">933</span></a><span class="sd">        Adds the current record to the stats_set DataFrame</span>
</span><span id="DataSetStats-934"><a href="#DataSetStats-934"><span class="linenos">934</span></a><span class="sd">        and resets the record dictionary.</span>
</span><span id="DataSetStats-935"><a href="#DataSetStats-935"><span class="linenos">935</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataSetStats-936"><a href="#DataSetStats-936"><span class="linenos">936</span></a>
</span><span id="DataSetStats-937"><a href="#DataSetStats-937"><span class="linenos">937</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_set</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span><span id="DataSetStats-938"><a href="#DataSetStats-938"><span class="linenos">938</span></a>            <span class="p">[</span>
</span><span id="DataSetStats-939"><a href="#DataSetStats-939"><span class="linenos">939</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stats_set</span><span class="p">,</span>
</span><span id="DataSetStats-940"><a href="#DataSetStats-940"><span class="linenos">940</span></a>                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">record</span><span class="p">])</span>
</span><span id="DataSetStats-941"><a href="#DataSetStats-941"><span class="linenos">941</span></a>            <span class="p">],</span>
</span><span id="DataSetStats-942"><a href="#DataSetStats-942"><span class="linenos">942</span></a>            <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="DataSetStats-943"><a href="#DataSetStats-943"><span class="linenos">943</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">record</span> <span class="o">=</span> <span class="p">{}</span>
</span></pre></div>


            <div class="docstring"><p>A class for managing dataset statistics, storing various statistical
measures, and saving them into a structured DataFrame.</p>

<p>Attributes:
    output_dir (str): Directory to save the dataset statistics.
    record (dict): A dictionary to store temporary statistics
        before adding them to the dataset.
    stats_set (pd.DataFrame): A DataFrame containing all the
        statistics collected for different datasets.</p>
</div>


                            <div id="DataSetStats.__init__" class="classattr">
                                        <input id="DataSetStats.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DataSetStats</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">output_dir</span></span>)</span>

                <label class="view-source-button" for="DataSetStats.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataSetStats.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataSetStats.__init__-859"><a href="#DataSetStats.__init__-859"><span class="linenos">859</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataSetStats.__init__-860"><a href="#DataSetStats.__init__-860"><span class="linenos">860</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataSetStats.__init__-861"><a href="#DataSetStats.__init__-861"><span class="linenos">861</span></a><span class="sd">        Initializes the DataSetStats class.</span>
</span><span id="DataSetStats.__init__-862"><a href="#DataSetStats.__init__-862"><span class="linenos">862</span></a>
</span><span id="DataSetStats.__init__-863"><a href="#DataSetStats.__init__-863"><span class="linenos">863</span></a><span class="sd">        Args:</span>
</span><span id="DataSetStats.__init__-864"><a href="#DataSetStats.__init__-864"><span class="linenos">864</span></a><span class="sd">            output_dir (str): The directory where output files</span>
</span><span id="DataSetStats.__init__-865"><a href="#DataSetStats.__init__-865"><span class="linenos">865</span></a><span class="sd">                will be stored.</span>
</span><span id="DataSetStats.__init__-866"><a href="#DataSetStats.__init__-866"><span class="linenos">866</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataSetStats.__init__-867"><a href="#DataSetStats.__init__-867"><span class="linenos">867</span></a>
</span><span id="DataSetStats.__init__-868"><a href="#DataSetStats.__init__-868"><span class="linenos">868</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">output_dir</span>
</span><span id="DataSetStats.__init__-869"><a href="#DataSetStats.__init__-869"><span class="linenos">869</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">record</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DataSetStats.__init__-870"><a href="#DataSetStats.__init__-870"><span class="linenos">870</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_set</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="DataSetStats.__init__-871"><a href="#DataSetStats.__init__-871"><span class="linenos">871</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
</span><span id="DataSetStats.__init__-872"><a href="#DataSetStats.__init__-872"><span class="linenos">872</span></a>                <span class="s2">&quot;animal&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-873"><a href="#DataSetStats.__init__-873"><span class="linenos">873</span></a>                <span class="s2">&quot;animal_no&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-874"><a href="#DataSetStats.__init__-874"><span class="linenos">874</span></a>                <span class="s2">&quot;animal_after_filtration&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-875"><a href="#DataSetStats.__init__-875"><span class="linenos">875</span></a>                <span class="s2">&quot;time_period&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-876"><a href="#DataSetStats.__init__-876"><span class="linenos">876</span></a>                <span class="s2">&quot;min_label_no&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-877"><a href="#DataSetStats.__init__-877"><span class="linenos">877</span></a>                <span class="s2">&quot;mean_label_no&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-878"><a href="#DataSetStats.__init__-878"><span class="linenos">878</span></a>                <span class="s2">&quot;std_label_no&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-879"><a href="#DataSetStats.__init__-879"><span class="linenos">879</span></a>                <span class="s2">&quot;min_records&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-880"><a href="#DataSetStats.__init__-880"><span class="linenos">880</span></a>                <span class="s2">&quot;mean_records&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-881"><a href="#DataSetStats.__init__-881"><span class="linenos">881</span></a>                <span class="s2">&quot;std_records&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-882"><a href="#DataSetStats.__init__-882"><span class="linenos">882</span></a>                <span class="s2">&quot;avg_duration&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-883"><a href="#DataSetStats.__init__-883"><span class="linenos">883</span></a>                <span class="s2">&quot;std_duration&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-884"><a href="#DataSetStats.__init__-884"><span class="linenos">884</span></a>                <span class="s2">&quot;min_duration&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-885"><a href="#DataSetStats.__init__-885"><span class="linenos">885</span></a>                <span class="s2">&quot;max_duration&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-886"><a href="#DataSetStats.__init__-886"><span class="linenos">886</span></a>                <span class="s2">&quot;overall_set_area&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-887"><a href="#DataSetStats.__init__-887"><span class="linenos">887</span></a>                <span class="s2">&quot;average_set_area&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-888"><a href="#DataSetStats.__init__-888"><span class="linenos">888</span></a>                <span class="s2">&quot;min_area&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-889"><a href="#DataSetStats.__init__-889"><span class="linenos">889</span></a>                <span class="s2">&quot;max_area&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-890"><a href="#DataSetStats.__init__-890"><span class="linenos">890</span></a>                <span class="s2">&quot;std_area&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-891"><a href="#DataSetStats.__init__-891"><span class="linenos">891</span></a>                <span class="s2">&quot;visitation_frequency&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-892"><a href="#DataSetStats.__init__-892"><span class="linenos">892</span></a>                <span class="s2">&quot;visitation_frequency_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-893"><a href="#DataSetStats.__init__-893"><span class="linenos">893</span></a>                <span class="s2">&quot;distinct_locations_over_time&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-894"><a href="#DataSetStats.__init__-894"><span class="linenos">894</span></a>                <span class="s2">&quot;distinct_locations_over_time_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-895"><a href="#DataSetStats.__init__-895"><span class="linenos">895</span></a>                <span class="s2">&quot;jump_lengths_distribution&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-896"><a href="#DataSetStats.__init__-896"><span class="linenos">896</span></a>                <span class="s2">&quot;jump_lengths_distribution_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-897"><a href="#DataSetStats.__init__-897"><span class="linenos">897</span></a>                <span class="s2">&quot;waiting_times&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-898"><a href="#DataSetStats.__init__-898"><span class="linenos">898</span></a>                <span class="s2">&quot;waiting_times_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-899"><a href="#DataSetStats.__init__-899"><span class="linenos">899</span></a>                <span class="s2">&quot;msd_curve&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-900"><a href="#DataSetStats.__init__-900"><span class="linenos">900</span></a>                <span class="s2">&quot;msd_curve_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-901"><a href="#DataSetStats.__init__-901"><span class="linenos">901</span></a>                <span class="c1"># &quot;travel_times&quot;,</span>
</span><span id="DataSetStats.__init__-902"><a href="#DataSetStats.__init__-902"><span class="linenos">902</span></a>                <span class="c1"># &quot;travel_times_params&quot;,</span>
</span><span id="DataSetStats.__init__-903"><a href="#DataSetStats.__init__-903"><span class="linenos">903</span></a>                <span class="c1"># &quot;rog&quot;,</span>
</span><span id="DataSetStats.__init__-904"><a href="#DataSetStats.__init__-904"><span class="linenos">904</span></a>                <span class="c1"># &quot;rog_params&quot;,</span>
</span><span id="DataSetStats.__init__-905"><a href="#DataSetStats.__init__-905"><span class="linenos">905</span></a>                <span class="s2">&quot;rog_over_time&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-906"><a href="#DataSetStats.__init__-906"><span class="linenos">906</span></a>                <span class="s2">&quot;rog_over_time_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-907"><a href="#DataSetStats.__init__-907"><span class="linenos">907</span></a>                <span class="s2">&quot;msd_distribution&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-908"><a href="#DataSetStats.__init__-908"><span class="linenos">908</span></a>                <span class="s2">&quot;msd_distribution_params&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-909"><a href="#DataSetStats.__init__-909"><span class="linenos">909</span></a>                <span class="c1"># &quot;return_time_distribution&quot;,</span>
</span><span id="DataSetStats.__init__-910"><a href="#DataSetStats.__init__-910"><span class="linenos">910</span></a>                <span class="c1"># &quot;return_time_distribution_params&quot;,</span>
</span><span id="DataSetStats.__init__-911"><a href="#DataSetStats.__init__-911"><span class="linenos">911</span></a>                <span class="c1"># &quot;exploration_time&quot;,</span>
</span><span id="DataSetStats.__init__-912"><a href="#DataSetStats.__init__-912"><span class="linenos">912</span></a>                <span class="c1"># &quot;exploration_time_params&quot;,</span>
</span><span id="DataSetStats.__init__-913"><a href="#DataSetStats.__init__-913"><span class="linenos">913</span></a>                <span class="s2">&quot;rho&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-914"><a href="#DataSetStats.__init__-914"><span class="linenos">914</span></a>                <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="DataSetStats.__init__-915"><a href="#DataSetStats.__init__-915"><span class="linenos">915</span></a>            <span class="p">]</span>
</span><span id="DataSetStats.__init__-916"><a href="#DataSetStats.__init__-916"><span class="linenos">916</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initializes the DataSetStats class.</p>

<p>Args:
    output_dir (str): The directory where output files
        will be stored.</p>
</div>


                            </div>
                            <div id="DataSetStats.output_dir" class="classattr">
                                <div class="attr variable">
            <span class="name">output_dir</span>

        
    </div>
    <a class="headerlink" href="#DataSetStats.output_dir"></a>
    
    

                            </div>
                            <div id="DataSetStats.record" class="classattr">
                                <div class="attr variable">
            <span class="name">record</span>

        
    </div>
    <a class="headerlink" href="#DataSetStats.record"></a>
    
    

                            </div>
                            <div id="DataSetStats.stats_set" class="classattr">
                                <div class="attr variable">
            <span class="name">stats_set</span>

        
    </div>
    <a class="headerlink" href="#DataSetStats.stats_set"></a>
    
    

                            </div>
                            <div id="DataSetStats.add_data" class="classattr">
                                        <input id="DataSetStats.add_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="nb">dict</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DataSetStats.add_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataSetStats.add_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataSetStats.add_data-919"><a href="#DataSetStats.add_data-919"><span class="linenos">919</span></a>    <span class="k">def</span> <span class="nf">add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataSetStats.add_data-920"><a href="#DataSetStats.add_data-920"><span class="linenos">920</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataSetStats.add_data-921"><a href="#DataSetStats.add_data-921"><span class="linenos">921</span></a><span class="sd">        Updates the record dictionary with new data.</span>
</span><span id="DataSetStats.add_data-922"><a href="#DataSetStats.add_data-922"><span class="linenos">922</span></a>
</span><span id="DataSetStats.add_data-923"><a href="#DataSetStats.add_data-923"><span class="linenos">923</span></a><span class="sd">        Args:</span>
</span><span id="DataSetStats.add_data-924"><a href="#DataSetStats.add_data-924"><span class="linenos">924</span></a><span class="sd">            data (dict): A dictionary containing key-value</span>
</span><span id="DataSetStats.add_data-925"><a href="#DataSetStats.add_data-925"><span class="linenos">925</span></a><span class="sd">                pairs of statistics to be added.</span>
</span><span id="DataSetStats.add_data-926"><a href="#DataSetStats.add_data-926"><span class="linenos">926</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataSetStats.add_data-927"><a href="#DataSetStats.add_data-927"><span class="linenos">927</span></a>
</span><span id="DataSetStats.add_data-928"><a href="#DataSetStats.add_data-928"><span class="linenos">928</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">record</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">data</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Updates the record dictionary with new data.</p>

<p>Args:
    data (dict): A dictionary containing key-value
        pairs of statistics to be added.</p>
</div>


                            </div>
                            <div id="DataSetStats.add_record" class="classattr">
                                        <input id="DataSetStats.add_record-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_record</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DataSetStats.add_record-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataSetStats.add_record"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataSetStats.add_record-931"><a href="#DataSetStats.add_record-931"><span class="linenos">931</span></a>    <span class="k">def</span> <span class="nf">add_record</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataSetStats.add_record-932"><a href="#DataSetStats.add_record-932"><span class="linenos">932</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataSetStats.add_record-933"><a href="#DataSetStats.add_record-933"><span class="linenos">933</span></a><span class="sd">        Adds the current record to the stats_set DataFrame</span>
</span><span id="DataSetStats.add_record-934"><a href="#DataSetStats.add_record-934"><span class="linenos">934</span></a><span class="sd">        and resets the record dictionary.</span>
</span><span id="DataSetStats.add_record-935"><a href="#DataSetStats.add_record-935"><span class="linenos">935</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataSetStats.add_record-936"><a href="#DataSetStats.add_record-936"><span class="linenos">936</span></a>
</span><span id="DataSetStats.add_record-937"><a href="#DataSetStats.add_record-937"><span class="linenos">937</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_set</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span><span id="DataSetStats.add_record-938"><a href="#DataSetStats.add_record-938"><span class="linenos">938</span></a>            <span class="p">[</span>
</span><span id="DataSetStats.add_record-939"><a href="#DataSetStats.add_record-939"><span class="linenos">939</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stats_set</span><span class="p">,</span>
</span><span id="DataSetStats.add_record-940"><a href="#DataSetStats.add_record-940"><span class="linenos">940</span></a>                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">record</span><span class="p">])</span>
</span><span id="DataSetStats.add_record-941"><a href="#DataSetStats.add_record-941"><span class="linenos">941</span></a>            <span class="p">],</span>
</span><span id="DataSetStats.add_record-942"><a href="#DataSetStats.add_record-942"><span class="linenos">942</span></a>            <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="DataSetStats.add_record-943"><a href="#DataSetStats.add_record-943"><span class="linenos">943</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">record</span> <span class="o">=</span> <span class="p">{}</span>
</span></pre></div>


            <div class="docstring"><p>Adds the current record to the stats_set DataFrame
and resets the record dictionary.</p>
</div>


                            </div>
                </section>
                <section id="Prepocessing">
                            <input id="Prepocessing-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Prepocessing</span>:

                <label class="view-source-button" for="Prepocessing-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Prepocessing"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Prepocessing-947"><a href="#Prepocessing-947"><span class="linenos"> 947</span></a><span class="k">class</span> <span class="nc">Prepocessing</span><span class="p">:</span>
</span><span id="Prepocessing-948"><a href="#Prepocessing-948"><span class="linenos"> 948</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing-949"><a href="#Prepocessing-949"><span class="linenos"> 949</span></a><span class="sd">    A class containing static methods for preprocessing animal</span>
</span><span id="Prepocessing-950"><a href="#Prepocessing-950"><span class="linenos"> 950</span></a><span class="sd">    trajectory data.</span>
</span><span id="Prepocessing-951"><a href="#Prepocessing-951"><span class="linenos"> 951</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Prepocessing-952"><a href="#Prepocessing-952"><span class="linenos"> 952</span></a>
</span><span id="Prepocessing-953"><a href="#Prepocessing-953"><span class="linenos"> 953</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Prepocessing-954"><a href="#Prepocessing-954"><span class="linenos"> 954</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing-955"><a href="#Prepocessing-955"><span class="linenos"> 955</span></a><span class="sd">        Initializes the Prepocessing class.</span>
</span><span id="Prepocessing-956"><a href="#Prepocessing-956"><span class="linenos"> 956</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing-957"><a href="#Prepocessing-957"><span class="linenos"> 957</span></a>        <span class="k">pass</span>
</span><span id="Prepocessing-958"><a href="#Prepocessing-958"><span class="linenos"> 958</span></a>
</span><span id="Prepocessing-959"><a href="#Prepocessing-959"><span class="linenos"> 959</span></a>
</span><span id="Prepocessing-960"><a href="#Prepocessing-960"><span class="linenos"> 960</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Prepocessing-961"><a href="#Prepocessing-961"><span class="linenos"> 961</span></a>    <span class="k">def</span> <span class="nf">get_mean_points</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="Prepocessing-962"><a href="#Prepocessing-962"><span class="linenos"> 962</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing-963"><a href="#Prepocessing-963"><span class="linenos"> 963</span></a><span class="sd">        Computes the mean latitude and longitude for each label.</span>
</span><span id="Prepocessing-964"><a href="#Prepocessing-964"><span class="linenos"> 964</span></a>
</span><span id="Prepocessing-965"><a href="#Prepocessing-965"><span class="linenos"> 965</span></a><span class="sd">        Args:</span>
</span><span id="Prepocessing-966"><a href="#Prepocessing-966"><span class="linenos"> 966</span></a><span class="sd">            data (TrajectoriesFrame): The trajectory dataset.</span>
</span><span id="Prepocessing-967"><a href="#Prepocessing-967"><span class="linenos"> 967</span></a>
</span><span id="Prepocessing-968"><a href="#Prepocessing-968"><span class="linenos"> 968</span></a><span class="sd">        Returns:</span>
</span><span id="Prepocessing-969"><a href="#Prepocessing-969"><span class="linenos"> 969</span></a><span class="sd">            TrajectoriesFrame: A new dataset with averaged locations</span>
</span><span id="Prepocessing-970"><a href="#Prepocessing-970"><span class="linenos"> 970</span></a><span class="sd">                per label.</span>
</span><span id="Prepocessing-971"><a href="#Prepocessing-971"><span class="linenos"> 971</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing-972"><a href="#Prepocessing-972"><span class="linenos"> 972</span></a>
</span><span id="Prepocessing-973"><a href="#Prepocessing-973"><span class="linenos"> 973</span></a>        <span class="n">basic_df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="Prepocessing-974"><a href="#Prepocessing-974"><span class="linenos"> 974</span></a>        <span class="n">geometry_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="Prepocessing-975"><a href="#Prepocessing-975"><span class="linenos"> 975</span></a>        <span class="k">for</span> <span class="n">an_id</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
</span><span id="Prepocessing-976"><a href="#Prepocessing-976"><span class="linenos"> 976</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</span><span id="Prepocessing-977"><a href="#Prepocessing-977"><span class="linenos"> 977</span></a>        <span class="p">):</span>
</span><span id="Prepocessing-978"><a href="#Prepocessing-978"><span class="linenos"> 978</span></a>            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">basic_df</span><span class="p">[</span><span class="n">basic_df</span><span class="p">[</span><span class="s2">&quot;user_id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">an_id</span><span class="p">]</span>
</span><span id="Prepocessing-979"><a href="#Prepocessing-979"><span class="linenos"> 979</span></a>            <span class="n">lables_pack</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</span><span id="Prepocessing-980"><a href="#Prepocessing-980"><span class="linenos"> 980</span></a>
</span><span id="Prepocessing-981"><a href="#Prepocessing-981"><span class="linenos"> 981</span></a>            <span class="k">for</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="n">lables_pack</span><span class="p">:</span>
</span><span id="Prepocessing-982"><a href="#Prepocessing-982"><span class="linenos"> 982</span></a>                <span class="n">label_df</span> <span class="o">=</span> <span class="n">filtered_df</span><span class="p">[</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lbl</span><span class="p">]</span>
</span><span id="Prepocessing-983"><a href="#Prepocessing-983"><span class="linenos"> 983</span></a>                <span class="n">label_df</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_df</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="Prepocessing-984"><a href="#Prepocessing-984"><span class="linenos"> 984</span></a>                <span class="n">label_df</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_df</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="Prepocessing-985"><a href="#Prepocessing-985"><span class="linenos"> 985</span></a>                <span class="n">label_df</span> <span class="o">=</span> <span class="n">label_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="Prepocessing-986"><a href="#Prepocessing-986"><span class="linenos"> 986</span></a>
</span><span id="Prepocessing-987"><a href="#Prepocessing-987"><span class="linenos"> 987</span></a>                <span class="n">geometry_df</span> <span class="o">=</span> <span class="n">geometry_df</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span>
</span><span id="Prepocessing-988"><a href="#Prepocessing-988"><span class="linenos"> 988</span></a>                    <span class="n">label_df</span><span class="p">[[</span><span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">]],</span>
</span><span id="Prepocessing-989"><a href="#Prepocessing-989"><span class="linenos"> 989</span></a>                    <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Prepocessing-990"><a href="#Prepocessing-990"><span class="linenos"> 990</span></a>                <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Prepocessing-991"><a href="#Prepocessing-991"><span class="linenos"> 991</span></a>
</span><span id="Prepocessing-992"><a href="#Prepocessing-992"><span class="linenos"> 992</span></a>                <span class="c1"># geometry_df = pd.concat([geometry_df, label_df], ignore_index=True)</span>
</span><span id="Prepocessing-993"><a href="#Prepocessing-993"><span class="linenos"> 993</span></a>
</span><span id="Prepocessing-994"><a href="#Prepocessing-994"><span class="linenos"> 994</span></a>        <span class="k">return</span> <span class="n">TrajectoriesFrame</span><span class="p">(</span>
</span><span id="Prepocessing-995"><a href="#Prepocessing-995"><span class="linenos"> 995</span></a>            <span class="n">geometry_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</span><span id="Prepocessing-996"><a href="#Prepocessing-996"><span class="linenos"> 996</span></a>            <span class="p">)</span>
</span><span id="Prepocessing-997"><a href="#Prepocessing-997"><span class="linenos"> 997</span></a>
</span><span id="Prepocessing-998"><a href="#Prepocessing-998"><span class="linenos"> 998</span></a>
</span><span id="Prepocessing-999"><a href="#Prepocessing-999"><span class="linenos"> 999</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Prepocessing-1000"><a href="#Prepocessing-1000"><span class="linenos">1000</span></a>    <span class="k">def</span> <span class="nf">set_start_stop_time</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="Prepocessing-1001"><a href="#Prepocessing-1001"><span class="linenos">1001</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing-1002"><a href="#Prepocessing-1002"><span class="linenos">1002</span></a><span class="sd">        Sets the start and stop time for each trajectory point.</span>
</span><span id="Prepocessing-1003"><a href="#Prepocessing-1003"><span class="linenos">1003</span></a>
</span><span id="Prepocessing-1004"><a href="#Prepocessing-1004"><span class="linenos">1004</span></a><span class="sd">        Args:</span>
</span><span id="Prepocessing-1005"><a href="#Prepocessing-1005"><span class="linenos">1005</span></a><span class="sd">            data (TrajectoriesFrame): The input trajectory dataset.</span>
</span><span id="Prepocessing-1006"><a href="#Prepocessing-1006"><span class="linenos">1006</span></a>
</span><span id="Prepocessing-1007"><a href="#Prepocessing-1007"><span class="linenos">1007</span></a><span class="sd">        Returns:</span>
</span><span id="Prepocessing-1008"><a href="#Prepocessing-1008"><span class="linenos">1008</span></a><span class="sd">            TrajectoriesFrame: A dataset with added start and stop times.</span>
</span><span id="Prepocessing-1009"><a href="#Prepocessing-1009"><span class="linenos">1009</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing-1010"><a href="#Prepocessing-1010"><span class="linenos">1010</span></a>
</span><span id="Prepocessing-1011"><a href="#Prepocessing-1011"><span class="linenos">1011</span></a>        <span class="n">compressed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="Prepocessing-1012"><a href="#Prepocessing-1012"><span class="linenos">1012</span></a>            <span class="n">start_end</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span>
</span><span id="Prepocessing-1013"><a href="#Prepocessing-1013"><span class="linenos">1013</span></a>                <span class="p">[</span>
</span><span id="Prepocessing-1014"><a href="#Prepocessing-1014"><span class="linenos">1014</span></a>                    <span class="s2">&quot;user_id&quot;</span><span class="p">,</span>
</span><span id="Prepocessing-1015"><a href="#Prepocessing-1015"><span class="linenos">1015</span></a>                    <span class="s2">&quot;datetime&quot;</span><span class="p">,</span>
</span><span id="Prepocessing-1016"><a href="#Prepocessing-1016"><span class="linenos">1016</span></a>                    <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
</span><span id="Prepocessing-1017"><a href="#Prepocessing-1017"><span class="linenos">1017</span></a>                    <span class="s2">&quot;lat&quot;</span><span class="p">,</span>
</span><span id="Prepocessing-1018"><a href="#Prepocessing-1018"><span class="linenos">1018</span></a>                    <span class="s2">&quot;lon&quot;</span><span class="p">,</span>
</span><span id="Prepocessing-1019"><a href="#Prepocessing-1019"><span class="linenos">1019</span></a>                    <span class="s2">&quot;date&quot;</span><span class="p">,</span>
</span><span id="Prepocessing-1020"><a href="#Prepocessing-1020"><span class="linenos">1020</span></a>                    <span class="s2">&quot;start&quot;</span><span class="p">,</span>
</span><span id="Prepocessing-1021"><a href="#Prepocessing-1021"><span class="linenos">1021</span></a>                    <span class="s2">&quot;end&quot;</span>
</span><span id="Prepocessing-1022"><a href="#Prepocessing-1022"><span class="linenos">1022</span></a>                <span class="p">]</span>
</span><span id="Prepocessing-1023"><a href="#Prepocessing-1023"><span class="linenos">1023</span></a>            <span class="p">]</span>
</span><span id="Prepocessing-1024"><a href="#Prepocessing-1024"><span class="linenos">1024</span></a>        <span class="p">)</span>
</span><span id="Prepocessing-1025"><a href="#Prepocessing-1025"><span class="linenos">1025</span></a>
</span><span id="Prepocessing-1026"><a href="#Prepocessing-1026"><span class="linenos">1026</span></a>        <span class="k">return</span> <span class="n">TrajectoriesFrame</span><span class="p">(</span>
</span><span id="Prepocessing-1027"><a href="#Prepocessing-1027"><span class="linenos">1027</span></a>            <span class="n">compressed</span><span class="p">,</span>
</span><span id="Prepocessing-1028"><a href="#Prepocessing-1028"><span class="linenos">1028</span></a>            <span class="p">{</span>
</span><span id="Prepocessing-1029"><a href="#Prepocessing-1029"><span class="linenos">1029</span></a>                <span class="s2">&quot;names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;animal_id&quot;</span><span class="p">],</span>
</span><span id="Prepocessing-1030"><a href="#Prepocessing-1030"><span class="linenos">1030</span></a>                <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="n">const</span><span class="o">.</span><span class="n">ELLIPSOIDAL_CRS</span><span class="p">,</span>
</span><span id="Prepocessing-1031"><a href="#Prepocessing-1031"><span class="linenos">1031</span></a>            <span class="p">},</span>
</span><span id="Prepocessing-1032"><a href="#Prepocessing-1032"><span class="linenos">1032</span></a>        <span class="p">)</span>
</span><span id="Prepocessing-1033"><a href="#Prepocessing-1033"><span class="linenos">1033</span></a>
</span><span id="Prepocessing-1034"><a href="#Prepocessing-1034"><span class="linenos">1034</span></a>
</span><span id="Prepocessing-1035"><a href="#Prepocessing-1035"><span class="linenos">1035</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Prepocessing-1036"><a href="#Prepocessing-1036"><span class="linenos">1036</span></a>    <span class="k">def</span> <span class="nf">set_crs</span><span class="p">(</span>
</span><span id="Prepocessing-1037"><a href="#Prepocessing-1037"><span class="linenos">1037</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span>
</span><span id="Prepocessing-1038"><a href="#Prepocessing-1038"><span class="linenos">1038</span></a>        <span class="n">base_csr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">ELLIPSOIDAL_CRS</span><span class="p">,</span>
</span><span id="Prepocessing-1039"><a href="#Prepocessing-1039"><span class="linenos">1039</span></a>        <span class="n">target_crs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">CARTESIAN_CRS</span><span class="p">,</span>
</span><span id="Prepocessing-1040"><a href="#Prepocessing-1040"><span class="linenos">1040</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="Prepocessing-1041"><a href="#Prepocessing-1041"><span class="linenos">1041</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing-1042"><a href="#Prepocessing-1042"><span class="linenos">1042</span></a><span class="sd">        Converts the coordinate reference system (CRS) of the dataset.</span>
</span><span id="Prepocessing-1043"><a href="#Prepocessing-1043"><span class="linenos">1043</span></a>
</span><span id="Prepocessing-1044"><a href="#Prepocessing-1044"><span class="linenos">1044</span></a><span class="sd">        Args:</span>
</span><span id="Prepocessing-1045"><a href="#Prepocessing-1045"><span class="linenos">1045</span></a><span class="sd">            data (TrajectoriesFrame): The input dataset.</span>
</span><span id="Prepocessing-1046"><a href="#Prepocessing-1046"><span class="linenos">1046</span></a><span class="sd">            base_csr (int): The current CRS of the dataset.</span>
</span><span id="Prepocessing-1047"><a href="#Prepocessing-1047"><span class="linenos">1047</span></a><span class="sd">            target_crs (int): The target CRS to convert to.</span>
</span><span id="Prepocessing-1048"><a href="#Prepocessing-1048"><span class="linenos">1048</span></a>
</span><span id="Prepocessing-1049"><a href="#Prepocessing-1049"><span class="linenos">1049</span></a><span class="sd">        Returns:</span>
</span><span id="Prepocessing-1050"><a href="#Prepocessing-1050"><span class="linenos">1050</span></a><span class="sd">            TrajectoriesFrame: The dataset with the transformed CRS.</span>
</span><span id="Prepocessing-1051"><a href="#Prepocessing-1051"><span class="linenos">1051</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing-1052"><a href="#Prepocessing-1052"><span class="linenos">1052</span></a>
</span><span id="Prepocessing-1053"><a href="#Prepocessing-1053"><span class="linenos">1053</span></a>        <span class="n">data_frame</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">base_csr</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Prepocessing-1054"><a href="#Prepocessing-1054"><span class="linenos">1054</span></a>
</span><span id="Prepocessing-1055"><a href="#Prepocessing-1055"><span class="linenos">1055</span></a>        <span class="k">return</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">target_crs</span><span class="p">)</span>
</span><span id="Prepocessing-1056"><a href="#Prepocessing-1056"><span class="linenos">1056</span></a>
</span><span id="Prepocessing-1057"><a href="#Prepocessing-1057"><span class="linenos">1057</span></a>
</span><span id="Prepocessing-1058"><a href="#Prepocessing-1058"><span class="linenos">1058</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Prepocessing-1059"><a href="#Prepocessing-1059"><span class="linenos">1059</span></a>    <span class="k">def</span> <span class="nf">filter_by_min_number</span><span class="p">(</span>
</span><span id="Prepocessing-1060"><a href="#Prepocessing-1060"><span class="linenos">1060</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span> <span class="n">min_labels_no</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">MIN_LABEL_NO</span>
</span><span id="Prepocessing-1061"><a href="#Prepocessing-1061"><span class="linenos">1061</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="Prepocessing-1062"><a href="#Prepocessing-1062"><span class="linenos">1062</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing-1063"><a href="#Prepocessing-1063"><span class="linenos">1063</span></a><span class="sd">        Filters data to include only individuals with a minimum</span>
</span><span id="Prepocessing-1064"><a href="#Prepocessing-1064"><span class="linenos">1064</span></a><span class="sd">        number of labels.</span>
</span><span id="Prepocessing-1065"><a href="#Prepocessing-1065"><span class="linenos">1065</span></a>
</span><span id="Prepocessing-1066"><a href="#Prepocessing-1066"><span class="linenos">1066</span></a><span class="sd">        Args:</span>
</span><span id="Prepocessing-1067"><a href="#Prepocessing-1067"><span class="linenos">1067</span></a><span class="sd">            data (TrajectoriesFrame): The input trajectory dataset.</span>
</span><span id="Prepocessing-1068"><a href="#Prepocessing-1068"><span class="linenos">1068</span></a><span class="sd">            min_labels_no (int): The minimum number of labels required.</span>
</span><span id="Prepocessing-1069"><a href="#Prepocessing-1069"><span class="linenos">1069</span></a>
</span><span id="Prepocessing-1070"><a href="#Prepocessing-1070"><span class="linenos">1070</span></a><span class="sd">        Returns:</span>
</span><span id="Prepocessing-1071"><a href="#Prepocessing-1071"><span class="linenos">1071</span></a><span class="sd">            TrajectoriesFrame: The filtered dataset.</span>
</span><span id="Prepocessing-1072"><a href="#Prepocessing-1072"><span class="linenos">1072</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing-1073"><a href="#Prepocessing-1073"><span class="linenos">1073</span></a>
</span><span id="Prepocessing-1074"><a href="#Prepocessing-1074"><span class="linenos">1074</span></a>        <span class="n">data_without_nans</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="Prepocessing-1075"><a href="#Prepocessing-1075"><span class="linenos">1075</span></a>        <span class="n">distinct_locations</span> <span class="o">=</span> <span class="n">num_of_distinct_locations</span><span class="p">(</span><span class="n">data_without_nans</span><span class="p">)</span>
</span><span id="Prepocessing-1076"><a href="#Prepocessing-1076"><span class="linenos">1076</span></a>
</span><span id="Prepocessing-1077"><a href="#Prepocessing-1077"><span class="linenos">1077</span></a>        <span class="k">return</span> <span class="n">TrajectoriesFrame</span><span class="p">(</span>
</span><span id="Prepocessing-1078"><a href="#Prepocessing-1078"><span class="linenos">1078</span></a>            <span class="n">data_without_nans</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="Prepocessing-1079"><a href="#Prepocessing-1079"><span class="linenos">1079</span></a>                <span class="n">distinct_locations</span><span class="p">[</span><span class="n">distinct_locations</span> <span class="o">&gt;</span> <span class="n">min_labels_no</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</span><span id="Prepocessing-1080"><a href="#Prepocessing-1080"><span class="linenos">1080</span></a>            <span class="p">]</span>
</span><span id="Prepocessing-1081"><a href="#Prepocessing-1081"><span class="linenos">1081</span></a>        <span class="p">)</span>
</span><span id="Prepocessing-1082"><a href="#Prepocessing-1082"><span class="linenos">1082</span></a>
</span><span id="Prepocessing-1083"><a href="#Prepocessing-1083"><span class="linenos">1083</span></a>
</span><span id="Prepocessing-1084"><a href="#Prepocessing-1084"><span class="linenos">1084</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Prepocessing-1085"><a href="#Prepocessing-1085"><span class="linenos">1085</span></a>    <span class="k">def</span> <span class="nf">filter_by_quartiles</span><span class="p">(</span>
</span><span id="Prepocessing-1086"><a href="#Prepocessing-1086"><span class="linenos">1086</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span> <span class="n">quartile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">QUARTILE</span>
</span><span id="Prepocessing-1087"><a href="#Prepocessing-1087"><span class="linenos">1087</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="Prepocessing-1088"><a href="#Prepocessing-1088"><span class="linenos">1088</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing-1089"><a href="#Prepocessing-1089"><span class="linenos">1089</span></a><span class="sd">        Filters data based on quartile values of distinct locations.</span>
</span><span id="Prepocessing-1090"><a href="#Prepocessing-1090"><span class="linenos">1090</span></a>
</span><span id="Prepocessing-1091"><a href="#Prepocessing-1091"><span class="linenos">1091</span></a><span class="sd">        Args:</span>
</span><span id="Prepocessing-1092"><a href="#Prepocessing-1092"><span class="linenos">1092</span></a><span class="sd">            data (TrajectoriesFrame): The input dataset.</span>
</span><span id="Prepocessing-1093"><a href="#Prepocessing-1093"><span class="linenos">1093</span></a><span class="sd">            quartile (float): The quartile value (must be 0.25, 0.5, or 0.75).</span>
</span><span id="Prepocessing-1094"><a href="#Prepocessing-1094"><span class="linenos">1094</span></a>
</span><span id="Prepocessing-1095"><a href="#Prepocessing-1095"><span class="linenos">1095</span></a><span class="sd">        Returns:</span>
</span><span id="Prepocessing-1096"><a href="#Prepocessing-1096"><span class="linenos">1096</span></a><span class="sd">            TrajectoriesFrame: The filtered dataset.</span>
</span><span id="Prepocessing-1097"><a href="#Prepocessing-1097"><span class="linenos">1097</span></a>
</span><span id="Prepocessing-1098"><a href="#Prepocessing-1098"><span class="linenos">1098</span></a><span class="sd">        Raises:</span>
</span><span id="Prepocessing-1099"><a href="#Prepocessing-1099"><span class="linenos">1099</span></a><span class="sd">            ValueError: If the provided quartile value is not one of</span>
</span><span id="Prepocessing-1100"><a href="#Prepocessing-1100"><span class="linenos">1100</span></a><span class="sd">                the allowed values.</span>
</span><span id="Prepocessing-1101"><a href="#Prepocessing-1101"><span class="linenos">1101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing-1102"><a href="#Prepocessing-1102"><span class="linenos">1102</span></a>
</span><span id="Prepocessing-1103"><a href="#Prepocessing-1103"><span class="linenos">1103</span></a>        <span class="n">allowed_quartiles</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">}</span>
</span><span id="Prepocessing-1104"><a href="#Prepocessing-1104"><span class="linenos">1104</span></a>        <span class="k">if</span> <span class="n">quartile</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_quartiles</span><span class="p">:</span>
</span><span id="Prepocessing-1105"><a href="#Prepocessing-1105"><span class="linenos">1105</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Prepocessing-1106"><a href="#Prepocessing-1106"><span class="linenos">1106</span></a>                <span class="sa">f</span><span class="s2">&quot;Invalid quartile value: </span><span class="si">{</span><span class="n">quartile</span><span class="si">}</span><span class="s2">. &quot;</span>
</span><span id="Prepocessing-1107"><a href="#Prepocessing-1107"><span class="linenos">1107</span></a>                <span class="sa">f</span><span class="s2">&quot;Allowed values are </span><span class="si">{</span><span class="n">allowed_quartiles</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="Prepocessing-1108"><a href="#Prepocessing-1108"><span class="linenos">1108</span></a>            <span class="p">)</span>
</span><span id="Prepocessing-1109"><a href="#Prepocessing-1109"><span class="linenos">1109</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Prepocessing-1110"><a href="#Prepocessing-1110"><span class="linenos">1110</span></a>            <span class="n">data_without_nans</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="Prepocessing-1111"><a href="#Prepocessing-1111"><span class="linenos">1111</span></a>            <span class="n">distinct_locations</span> <span class="o">=</span> <span class="n">num_of_distinct_locations</span><span class="p">(</span><span class="n">data_without_nans</span><span class="p">)</span>
</span><span id="Prepocessing-1112"><a href="#Prepocessing-1112"><span class="linenos">1112</span></a>            <span class="n">quartile_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">distinct_locations</span><span class="p">,</span> <span class="n">quartile</span><span class="p">)</span>
</span><span id="Prepocessing-1113"><a href="#Prepocessing-1113"><span class="linenos">1113</span></a>
</span><span id="Prepocessing-1114"><a href="#Prepocessing-1114"><span class="linenos">1114</span></a>            <span class="k">if</span> <span class="n">quartile_value</span> <span class="o">&lt;</span> <span class="n">const</span><span class="o">.</span><span class="n">MIN_QUARTILE_VALUE</span><span class="p">:</span>
</span><span id="Prepocessing-1115"><a href="#Prepocessing-1115"><span class="linenos">1115</span></a>                <span class="n">quartile_value</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">MIN_QUARTILE_VALUE</span>
</span><span id="Prepocessing-1116"><a href="#Prepocessing-1116"><span class="linenos">1116</span></a>
</span><span id="Prepocessing-1117"><a href="#Prepocessing-1117"><span class="linenos">1117</span></a>            <span class="k">return</span> <span class="n">TrajectoriesFrame</span><span class="p">(</span>
</span><span id="Prepocessing-1118"><a href="#Prepocessing-1118"><span class="linenos">1118</span></a>                <span class="n">data_without_nans</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="Prepocessing-1119"><a href="#Prepocessing-1119"><span class="linenos">1119</span></a>                    <span class="n">distinct_locations</span><span class="p">[</span><span class="n">distinct_locations</span> <span class="o">&gt;</span> <span class="n">quartile_value</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</span><span id="Prepocessing-1120"><a href="#Prepocessing-1120"><span class="linenos">1120</span></a>                <span class="p">]</span>
</span><span id="Prepocessing-1121"><a href="#Prepocessing-1121"><span class="linenos">1121</span></a>            <span class="p">)</span>
</span><span id="Prepocessing-1122"><a href="#Prepocessing-1122"><span class="linenos">1122</span></a>
</span><span id="Prepocessing-1123"><a href="#Prepocessing-1123"><span class="linenos">1123</span></a>
</span><span id="Prepocessing-1124"><a href="#Prepocessing-1124"><span class="linenos">1124</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Prepocessing-1125"><a href="#Prepocessing-1125"><span class="linenos">1125</span></a>    <span class="k">def</span> <span class="nf">filing_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Prepocessing-1126"><a href="#Prepocessing-1126"><span class="linenos">1126</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing-1127"><a href="#Prepocessing-1127"><span class="linenos">1127</span></a><span class="sd">        Processes trajectory data to fill missing values by selecting</span>
</span><span id="Prepocessing-1128"><a href="#Prepocessing-1128"><span class="linenos">1128</span></a><span class="sd">        the most visited location.</span>
</span><span id="Prepocessing-1129"><a href="#Prepocessing-1129"><span class="linenos">1129</span></a>
</span><span id="Prepocessing-1130"><a href="#Prepocessing-1130"><span class="linenos">1130</span></a><span class="sd">        Args:</span>
</span><span id="Prepocessing-1131"><a href="#Prepocessing-1131"><span class="linenos">1131</span></a><span class="sd">            data (pd.DataFrame): The input trajectory dataset.</span>
</span><span id="Prepocessing-1132"><a href="#Prepocessing-1132"><span class="linenos">1132</span></a>
</span><span id="Prepocessing-1133"><a href="#Prepocessing-1133"><span class="linenos">1133</span></a><span class="sd">        Returns:</span>
</span><span id="Prepocessing-1134"><a href="#Prepocessing-1134"><span class="linenos">1134</span></a><span class="sd">            pd.DataFrame: A processed dataset with missing values filled.</span>
</span><span id="Prepocessing-1135"><a href="#Prepocessing-1135"><span class="linenos">1135</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing-1136"><a href="#Prepocessing-1136"><span class="linenos">1136</span></a>
</span><span id="Prepocessing-1137"><a href="#Prepocessing-1137"><span class="linenos">1137</span></a>        <span class="k">def</span> <span class="nf">longest_visited_row</span><span class="p">(</span><span class="n">groupa</span><span class="p">):</span>
</span><span id="Prepocessing-1138"><a href="#Prepocessing-1138"><span class="linenos">1138</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing-1139"><a href="#Prepocessing-1139"><span class="linenos">1139</span></a><span class="sd">            Returns the row where the individual spent the longest</span>
</span><span id="Prepocessing-1140"><a href="#Prepocessing-1140"><span class="linenos">1140</span></a><span class="sd">            time in an interval.</span>
</span><span id="Prepocessing-1141"><a href="#Prepocessing-1141"><span class="linenos">1141</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="Prepocessing-1142"><a href="#Prepocessing-1142"><span class="linenos">1142</span></a>
</span><span id="Prepocessing-1143"><a href="#Prepocessing-1143"><span class="linenos">1143</span></a>            <span class="k">if</span> <span class="n">groupa</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="Prepocessing-1144"><a href="#Prepocessing-1144"><span class="linenos">1144</span></a>                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="Prepocessing-1145"><a href="#Prepocessing-1145"><span class="linenos">1145</span></a>
</span><span id="Prepocessing-1146"><a href="#Prepocessing-1146"><span class="linenos">1146</span></a>            <span class="n">max_label</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Prepocessing-1147"><a href="#Prepocessing-1147"><span class="linenos">1147</span></a>                <span class="n">groupa</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">)[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
</span><span id="Prepocessing-1148"><a href="#Prepocessing-1148"><span class="linenos">1148</span></a>            <span class="p">)</span>
</span><span id="Prepocessing-1149"><a href="#Prepocessing-1149"><span class="linenos">1149</span></a>            <span class="n">row</span> <span class="o">=</span> <span class="n">groupa</span><span class="p">[</span><span class="n">groupa</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_label</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Prepocessing-1150"><a href="#Prepocessing-1150"><span class="linenos">1150</span></a>
</span><span id="Prepocessing-1151"><a href="#Prepocessing-1151"><span class="linenos">1151</span></a>            <span class="k">return</span> <span class="n">row</span><span class="o">.</span><span class="n">T</span>
</span><span id="Prepocessing-1152"><a href="#Prepocessing-1152"><span class="linenos">1152</span></a>
</span><span id="Prepocessing-1153"><a href="#Prepocessing-1153"><span class="linenos">1153</span></a>
</span><span id="Prepocessing-1154"><a href="#Prepocessing-1154"><span class="linenos">1154</span></a>        <span class="n">to_conca</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Prepocessing-1155"><a href="#Prepocessing-1155"><span class="linenos">1155</span></a>        <span class="k">for</span> <span class="n">uid</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Prepocessing-1156"><a href="#Prepocessing-1156"><span class="linenos">1156</span></a>            <span class="n">group</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span>
</span><span id="Prepocessing-1157"><a href="#Prepocessing-1157"><span class="linenos">1157</span></a>                <span class="o">~</span><span class="n">group</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
</span><span id="Prepocessing-1158"><a href="#Prepocessing-1158"><span class="linenos">1158</span></a>            <span class="p">]</span>
</span><span id="Prepocessing-1159"><a href="#Prepocessing-1159"><span class="linenos">1159</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Prepocessing-1160"><a href="#Prepocessing-1160"><span class="linenos">1160</span></a>                <span class="k">continue</span>
</span><span id="Prepocessing-1161"><a href="#Prepocessing-1161"><span class="linenos">1161</span></a>            <span class="n">group</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="Prepocessing-1162"><a href="#Prepocessing-1162"><span class="linenos">1162</span></a>                <span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
</span><span id="Prepocessing-1163"><a href="#Prepocessing-1163"><span class="linenos">1163</span></a>            <span class="p">)</span>
</span><span id="Prepocessing-1164"><a href="#Prepocessing-1164"><span class="linenos">1164</span></a>            <span class="n">group</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Prepocessing-1165"><a href="#Prepocessing-1165"><span class="linenos">1165</span></a>                <span class="n">group</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">group</span><span class="o">.</span><span class="n">index</span>
</span><span id="Prepocessing-1166"><a href="#Prepocessing-1166"><span class="linenos">1166</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</span><span id="Prepocessing-1167"><a href="#Prepocessing-1167"><span class="linenos">1167</span></a>            <span class="n">group</span><span class="p">[</span><span class="s2">&quot;next&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">labels</span> <span class="o">!=</span> <span class="n">group</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>
</span><span id="Prepocessing-1168"><a href="#Prepocessing-1168"><span class="linenos">1168</span></a>            <span class="n">group</span><span class="p">[</span><span class="s2">&quot;moved&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</span><span id="Prepocessing-1169"><a href="#Prepocessing-1169"><span class="linenos">1169</span></a>            <span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;moved&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span><span id="Prepocessing-1170"><a href="#Prepocessing-1170"><span class="linenos">1170</span></a>            <span class="n">group</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>
</span><span id="Prepocessing-1171"><a href="#Prepocessing-1171"><span class="linenos">1171</span></a>
</span><span id="Prepocessing-1172"><a href="#Prepocessing-1172"><span class="linenos">1172</span></a>            <span class="n">group_resampled</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1h&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">longest_visited_row</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</span><span id="Prepocessing-1173"><a href="#Prepocessing-1173"><span class="linenos">1173</span></a>            <span class="k">if</span> <span class="n">group_resampled</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Prepocessing-1174"><a href="#Prepocessing-1174"><span class="linenos">1174</span></a>                <span class="n">group_resampled</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1h&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">longest_visited_row</span><span class="p">)</span>
</span><span id="Prepocessing-1175"><a href="#Prepocessing-1175"><span class="linenos">1175</span></a>            <span class="n">group_resampled</span> <span class="o">=</span> <span class="n">group_resampled</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1h&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="Prepocessing-1176"><a href="#Prepocessing-1176"><span class="linenos">1176</span></a>            <span class="n">group_resampled</span> <span class="o">=</span> <span class="n">group_resampled</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span><span class="o">.</span><span class="n">bfill</span><span class="p">()</span>
</span><span id="Prepocessing-1177"><a href="#Prepocessing-1177"><span class="linenos">1177</span></a>
</span><span id="Prepocessing-1178"><a href="#Prepocessing-1178"><span class="linenos">1178</span></a>            <span class="n">to_conca</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_resampled</span>
</span><span id="Prepocessing-1179"><a href="#Prepocessing-1179"><span class="linenos">1179</span></a>
</span><span id="Prepocessing-1180"><a href="#Prepocessing-1180"><span class="linenos">1180</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">to_conca</span><span class="p">))</span>
</span><span id="Prepocessing-1181"><a href="#Prepocessing-1181"><span class="linenos">1181</span></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;is_new&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="Prepocessing-1182"><a href="#Prepocessing-1182"><span class="linenos">1182</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">~</span><span class="n">x</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
</span><span id="Prepocessing-1183"><a href="#Prepocessing-1183"><span class="linenos">1183</span></a>        <span class="p">)</span>
</span><span id="Prepocessing-1184"><a href="#Prepocessing-1184"><span class="linenos">1184</span></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;new_sum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Prepocessing-1185"><a href="#Prepocessing-1185"><span class="linenos">1185</span></a>            <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">is_new</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Prepocessing-1186"><a href="#Prepocessing-1186"><span class="linenos">1186</span></a>        <span class="p">)</span>
</span><span id="Prepocessing-1187"><a href="#Prepocessing-1187"><span class="linenos">1187</span></a>
</span><span id="Prepocessing-1188"><a href="#Prepocessing-1188"><span class="linenos">1188</span></a>        <span class="k">return</span> <span class="n">df</span>
</span></pre></div>


            <div class="docstring"><p>A class containing static methods for preprocessing animal
trajectory data.</p>
</div>


                            <div id="Prepocessing.__init__" class="classattr">
                                        <input id="Prepocessing.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Prepocessing</span><span class="signature pdoc-code condensed">()</span>

                <label class="view-source-button" for="Prepocessing.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Prepocessing.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Prepocessing.__init__-953"><a href="#Prepocessing.__init__-953"><span class="linenos">953</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Prepocessing.__init__-954"><a href="#Prepocessing.__init__-954"><span class="linenos">954</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing.__init__-955"><a href="#Prepocessing.__init__-955"><span class="linenos">955</span></a><span class="sd">        Initializes the Prepocessing class.</span>
</span><span id="Prepocessing.__init__-956"><a href="#Prepocessing.__init__-956"><span class="linenos">956</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing.__init__-957"><a href="#Prepocessing.__init__-957"><span class="linenos">957</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Initializes the Prepocessing class.</p>
</div>


                            </div>
                            <div id="Prepocessing.get_mean_points" class="classattr">
                                        <input id="Prepocessing.get_mean_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_mean_points</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span>:</span></span>

                <label class="view-source-button" for="Prepocessing.get_mean_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Prepocessing.get_mean_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Prepocessing.get_mean_points-960"><a href="#Prepocessing.get_mean_points-960"><span class="linenos">960</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Prepocessing.get_mean_points-961"><a href="#Prepocessing.get_mean_points-961"><span class="linenos">961</span></a>    <span class="k">def</span> <span class="nf">get_mean_points</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="Prepocessing.get_mean_points-962"><a href="#Prepocessing.get_mean_points-962"><span class="linenos">962</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing.get_mean_points-963"><a href="#Prepocessing.get_mean_points-963"><span class="linenos">963</span></a><span class="sd">        Computes the mean latitude and longitude for each label.</span>
</span><span id="Prepocessing.get_mean_points-964"><a href="#Prepocessing.get_mean_points-964"><span class="linenos">964</span></a>
</span><span id="Prepocessing.get_mean_points-965"><a href="#Prepocessing.get_mean_points-965"><span class="linenos">965</span></a><span class="sd">        Args:</span>
</span><span id="Prepocessing.get_mean_points-966"><a href="#Prepocessing.get_mean_points-966"><span class="linenos">966</span></a><span class="sd">            data (TrajectoriesFrame): The trajectory dataset.</span>
</span><span id="Prepocessing.get_mean_points-967"><a href="#Prepocessing.get_mean_points-967"><span class="linenos">967</span></a>
</span><span id="Prepocessing.get_mean_points-968"><a href="#Prepocessing.get_mean_points-968"><span class="linenos">968</span></a><span class="sd">        Returns:</span>
</span><span id="Prepocessing.get_mean_points-969"><a href="#Prepocessing.get_mean_points-969"><span class="linenos">969</span></a><span class="sd">            TrajectoriesFrame: A new dataset with averaged locations</span>
</span><span id="Prepocessing.get_mean_points-970"><a href="#Prepocessing.get_mean_points-970"><span class="linenos">970</span></a><span class="sd">                per label.</span>
</span><span id="Prepocessing.get_mean_points-971"><a href="#Prepocessing.get_mean_points-971"><span class="linenos">971</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing.get_mean_points-972"><a href="#Prepocessing.get_mean_points-972"><span class="linenos">972</span></a>
</span><span id="Prepocessing.get_mean_points-973"><a href="#Prepocessing.get_mean_points-973"><span class="linenos">973</span></a>        <span class="n">basic_df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="Prepocessing.get_mean_points-974"><a href="#Prepocessing.get_mean_points-974"><span class="linenos">974</span></a>        <span class="n">geometry_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="Prepocessing.get_mean_points-975"><a href="#Prepocessing.get_mean_points-975"><span class="linenos">975</span></a>        <span class="k">for</span> <span class="n">an_id</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
</span><span id="Prepocessing.get_mean_points-976"><a href="#Prepocessing.get_mean_points-976"><span class="linenos">976</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</span><span id="Prepocessing.get_mean_points-977"><a href="#Prepocessing.get_mean_points-977"><span class="linenos">977</span></a>        <span class="p">):</span>
</span><span id="Prepocessing.get_mean_points-978"><a href="#Prepocessing.get_mean_points-978"><span class="linenos">978</span></a>            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">basic_df</span><span class="p">[</span><span class="n">basic_df</span><span class="p">[</span><span class="s2">&quot;user_id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">an_id</span><span class="p">]</span>
</span><span id="Prepocessing.get_mean_points-979"><a href="#Prepocessing.get_mean_points-979"><span class="linenos">979</span></a>            <span class="n">lables_pack</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</span><span id="Prepocessing.get_mean_points-980"><a href="#Prepocessing.get_mean_points-980"><span class="linenos">980</span></a>
</span><span id="Prepocessing.get_mean_points-981"><a href="#Prepocessing.get_mean_points-981"><span class="linenos">981</span></a>            <span class="k">for</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="n">lables_pack</span><span class="p">:</span>
</span><span id="Prepocessing.get_mean_points-982"><a href="#Prepocessing.get_mean_points-982"><span class="linenos">982</span></a>                <span class="n">label_df</span> <span class="o">=</span> <span class="n">filtered_df</span><span class="p">[</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lbl</span><span class="p">]</span>
</span><span id="Prepocessing.get_mean_points-983"><a href="#Prepocessing.get_mean_points-983"><span class="linenos">983</span></a>                <span class="n">label_df</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_df</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="Prepocessing.get_mean_points-984"><a href="#Prepocessing.get_mean_points-984"><span class="linenos">984</span></a>                <span class="n">label_df</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_df</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="Prepocessing.get_mean_points-985"><a href="#Prepocessing.get_mean_points-985"><span class="linenos">985</span></a>                <span class="n">label_df</span> <span class="o">=</span> <span class="n">label_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="Prepocessing.get_mean_points-986"><a href="#Prepocessing.get_mean_points-986"><span class="linenos">986</span></a>
</span><span id="Prepocessing.get_mean_points-987"><a href="#Prepocessing.get_mean_points-987"><span class="linenos">987</span></a>                <span class="n">geometry_df</span> <span class="o">=</span> <span class="n">geometry_df</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span>
</span><span id="Prepocessing.get_mean_points-988"><a href="#Prepocessing.get_mean_points-988"><span class="linenos">988</span></a>                    <span class="n">label_df</span><span class="p">[[</span><span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">]],</span>
</span><span id="Prepocessing.get_mean_points-989"><a href="#Prepocessing.get_mean_points-989"><span class="linenos">989</span></a>                    <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Prepocessing.get_mean_points-990"><a href="#Prepocessing.get_mean_points-990"><span class="linenos">990</span></a>                <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Prepocessing.get_mean_points-991"><a href="#Prepocessing.get_mean_points-991"><span class="linenos">991</span></a>
</span><span id="Prepocessing.get_mean_points-992"><a href="#Prepocessing.get_mean_points-992"><span class="linenos">992</span></a>                <span class="c1"># geometry_df = pd.concat([geometry_df, label_df], ignore_index=True)</span>
</span><span id="Prepocessing.get_mean_points-993"><a href="#Prepocessing.get_mean_points-993"><span class="linenos">993</span></a>
</span><span id="Prepocessing.get_mean_points-994"><a href="#Prepocessing.get_mean_points-994"><span class="linenos">994</span></a>        <span class="k">return</span> <span class="n">TrajectoriesFrame</span><span class="p">(</span>
</span><span id="Prepocessing.get_mean_points-995"><a href="#Prepocessing.get_mean_points-995"><span class="linenos">995</span></a>            <span class="n">geometry_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</span><span id="Prepocessing.get_mean_points-996"><a href="#Prepocessing.get_mean_points-996"><span class="linenos">996</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes the mean latitude and longitude for each label.</p>

<p>Args:
    data (TrajectoriesFrame): The trajectory dataset.</p>

<p>Returns:
    TrajectoriesFrame: A new dataset with averaged locations
        per label.</p>
</div>


                            </div>
                            <div id="Prepocessing.set_start_stop_time" class="classattr">
                                        <input id="Prepocessing.set_start_stop_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">set_start_stop_time</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span></span><span class="return-annotation">) -> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span>:</span></span>

                <label class="view-source-button" for="Prepocessing.set_start_stop_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Prepocessing.set_start_stop_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Prepocessing.set_start_stop_time-999"><a href="#Prepocessing.set_start_stop_time-999"><span class="linenos"> 999</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Prepocessing.set_start_stop_time-1000"><a href="#Prepocessing.set_start_stop_time-1000"><span class="linenos">1000</span></a>    <span class="k">def</span> <span class="nf">set_start_stop_time</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="Prepocessing.set_start_stop_time-1001"><a href="#Prepocessing.set_start_stop_time-1001"><span class="linenos">1001</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing.set_start_stop_time-1002"><a href="#Prepocessing.set_start_stop_time-1002"><span class="linenos">1002</span></a><span class="sd">        Sets the start and stop time for each trajectory point.</span>
</span><span id="Prepocessing.set_start_stop_time-1003"><a href="#Prepocessing.set_start_stop_time-1003"><span class="linenos">1003</span></a>
</span><span id="Prepocessing.set_start_stop_time-1004"><a href="#Prepocessing.set_start_stop_time-1004"><span class="linenos">1004</span></a><span class="sd">        Args:</span>
</span><span id="Prepocessing.set_start_stop_time-1005"><a href="#Prepocessing.set_start_stop_time-1005"><span class="linenos">1005</span></a><span class="sd">            data (TrajectoriesFrame): The input trajectory dataset.</span>
</span><span id="Prepocessing.set_start_stop_time-1006"><a href="#Prepocessing.set_start_stop_time-1006"><span class="linenos">1006</span></a>
</span><span id="Prepocessing.set_start_stop_time-1007"><a href="#Prepocessing.set_start_stop_time-1007"><span class="linenos">1007</span></a><span class="sd">        Returns:</span>
</span><span id="Prepocessing.set_start_stop_time-1008"><a href="#Prepocessing.set_start_stop_time-1008"><span class="linenos">1008</span></a><span class="sd">            TrajectoriesFrame: A dataset with added start and stop times.</span>
</span><span id="Prepocessing.set_start_stop_time-1009"><a href="#Prepocessing.set_start_stop_time-1009"><span class="linenos">1009</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing.set_start_stop_time-1010"><a href="#Prepocessing.set_start_stop_time-1010"><span class="linenos">1010</span></a>
</span><span id="Prepocessing.set_start_stop_time-1011"><a href="#Prepocessing.set_start_stop_time-1011"><span class="linenos">1011</span></a>        <span class="n">compressed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="Prepocessing.set_start_stop_time-1012"><a href="#Prepocessing.set_start_stop_time-1012"><span class="linenos">1012</span></a>            <span class="n">start_end</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span>
</span><span id="Prepocessing.set_start_stop_time-1013"><a href="#Prepocessing.set_start_stop_time-1013"><span class="linenos">1013</span></a>                <span class="p">[</span>
</span><span id="Prepocessing.set_start_stop_time-1014"><a href="#Prepocessing.set_start_stop_time-1014"><span class="linenos">1014</span></a>                    <span class="s2">&quot;user_id&quot;</span><span class="p">,</span>
</span><span id="Prepocessing.set_start_stop_time-1015"><a href="#Prepocessing.set_start_stop_time-1015"><span class="linenos">1015</span></a>                    <span class="s2">&quot;datetime&quot;</span><span class="p">,</span>
</span><span id="Prepocessing.set_start_stop_time-1016"><a href="#Prepocessing.set_start_stop_time-1016"><span class="linenos">1016</span></a>                    <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
</span><span id="Prepocessing.set_start_stop_time-1017"><a href="#Prepocessing.set_start_stop_time-1017"><span class="linenos">1017</span></a>                    <span class="s2">&quot;lat&quot;</span><span class="p">,</span>
</span><span id="Prepocessing.set_start_stop_time-1018"><a href="#Prepocessing.set_start_stop_time-1018"><span class="linenos">1018</span></a>                    <span class="s2">&quot;lon&quot;</span><span class="p">,</span>
</span><span id="Prepocessing.set_start_stop_time-1019"><a href="#Prepocessing.set_start_stop_time-1019"><span class="linenos">1019</span></a>                    <span class="s2">&quot;date&quot;</span><span class="p">,</span>
</span><span id="Prepocessing.set_start_stop_time-1020"><a href="#Prepocessing.set_start_stop_time-1020"><span class="linenos">1020</span></a>                    <span class="s2">&quot;start&quot;</span><span class="p">,</span>
</span><span id="Prepocessing.set_start_stop_time-1021"><a href="#Prepocessing.set_start_stop_time-1021"><span class="linenos">1021</span></a>                    <span class="s2">&quot;end&quot;</span>
</span><span id="Prepocessing.set_start_stop_time-1022"><a href="#Prepocessing.set_start_stop_time-1022"><span class="linenos">1022</span></a>                <span class="p">]</span>
</span><span id="Prepocessing.set_start_stop_time-1023"><a href="#Prepocessing.set_start_stop_time-1023"><span class="linenos">1023</span></a>            <span class="p">]</span>
</span><span id="Prepocessing.set_start_stop_time-1024"><a href="#Prepocessing.set_start_stop_time-1024"><span class="linenos">1024</span></a>        <span class="p">)</span>
</span><span id="Prepocessing.set_start_stop_time-1025"><a href="#Prepocessing.set_start_stop_time-1025"><span class="linenos">1025</span></a>
</span><span id="Prepocessing.set_start_stop_time-1026"><a href="#Prepocessing.set_start_stop_time-1026"><span class="linenos">1026</span></a>        <span class="k">return</span> <span class="n">TrajectoriesFrame</span><span class="p">(</span>
</span><span id="Prepocessing.set_start_stop_time-1027"><a href="#Prepocessing.set_start_stop_time-1027"><span class="linenos">1027</span></a>            <span class="n">compressed</span><span class="p">,</span>
</span><span id="Prepocessing.set_start_stop_time-1028"><a href="#Prepocessing.set_start_stop_time-1028"><span class="linenos">1028</span></a>            <span class="p">{</span>
</span><span id="Prepocessing.set_start_stop_time-1029"><a href="#Prepocessing.set_start_stop_time-1029"><span class="linenos">1029</span></a>                <span class="s2">&quot;names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;animal_id&quot;</span><span class="p">],</span>
</span><span id="Prepocessing.set_start_stop_time-1030"><a href="#Prepocessing.set_start_stop_time-1030"><span class="linenos">1030</span></a>                <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="n">const</span><span class="o">.</span><span class="n">ELLIPSOIDAL_CRS</span><span class="p">,</span>
</span><span id="Prepocessing.set_start_stop_time-1031"><a href="#Prepocessing.set_start_stop_time-1031"><span class="linenos">1031</span></a>            <span class="p">},</span>
</span><span id="Prepocessing.set_start_stop_time-1032"><a href="#Prepocessing.set_start_stop_time-1032"><span class="linenos">1032</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Sets the start and stop time for each trajectory point.</p>

<p>Args:
    data (TrajectoriesFrame): The input trajectory dataset.</p>

<p>Returns:
    TrajectoriesFrame: A dataset with added start and stop times.</p>
</div>


                            </div>
                            <div id="Prepocessing.set_crs" class="classattr">
                                        <input id="Prepocessing.set_crs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">set_crs</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span>,</span><span class="param">	<span class="n">base_csr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4326</span>,</span><span class="param">	<span class="n">target_crs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3857</span></span><span class="return-annotation">) -> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span>:</span></span>

                <label class="view-source-button" for="Prepocessing.set_crs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Prepocessing.set_crs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Prepocessing.set_crs-1035"><a href="#Prepocessing.set_crs-1035"><span class="linenos">1035</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Prepocessing.set_crs-1036"><a href="#Prepocessing.set_crs-1036"><span class="linenos">1036</span></a>    <span class="k">def</span> <span class="nf">set_crs</span><span class="p">(</span>
</span><span id="Prepocessing.set_crs-1037"><a href="#Prepocessing.set_crs-1037"><span class="linenos">1037</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span>
</span><span id="Prepocessing.set_crs-1038"><a href="#Prepocessing.set_crs-1038"><span class="linenos">1038</span></a>        <span class="n">base_csr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">ELLIPSOIDAL_CRS</span><span class="p">,</span>
</span><span id="Prepocessing.set_crs-1039"><a href="#Prepocessing.set_crs-1039"><span class="linenos">1039</span></a>        <span class="n">target_crs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">CARTESIAN_CRS</span><span class="p">,</span>
</span><span id="Prepocessing.set_crs-1040"><a href="#Prepocessing.set_crs-1040"><span class="linenos">1040</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="Prepocessing.set_crs-1041"><a href="#Prepocessing.set_crs-1041"><span class="linenos">1041</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing.set_crs-1042"><a href="#Prepocessing.set_crs-1042"><span class="linenos">1042</span></a><span class="sd">        Converts the coordinate reference system (CRS) of the dataset.</span>
</span><span id="Prepocessing.set_crs-1043"><a href="#Prepocessing.set_crs-1043"><span class="linenos">1043</span></a>
</span><span id="Prepocessing.set_crs-1044"><a href="#Prepocessing.set_crs-1044"><span class="linenos">1044</span></a><span class="sd">        Args:</span>
</span><span id="Prepocessing.set_crs-1045"><a href="#Prepocessing.set_crs-1045"><span class="linenos">1045</span></a><span class="sd">            data (TrajectoriesFrame): The input dataset.</span>
</span><span id="Prepocessing.set_crs-1046"><a href="#Prepocessing.set_crs-1046"><span class="linenos">1046</span></a><span class="sd">            base_csr (int): The current CRS of the dataset.</span>
</span><span id="Prepocessing.set_crs-1047"><a href="#Prepocessing.set_crs-1047"><span class="linenos">1047</span></a><span class="sd">            target_crs (int): The target CRS to convert to.</span>
</span><span id="Prepocessing.set_crs-1048"><a href="#Prepocessing.set_crs-1048"><span class="linenos">1048</span></a>
</span><span id="Prepocessing.set_crs-1049"><a href="#Prepocessing.set_crs-1049"><span class="linenos">1049</span></a><span class="sd">        Returns:</span>
</span><span id="Prepocessing.set_crs-1050"><a href="#Prepocessing.set_crs-1050"><span class="linenos">1050</span></a><span class="sd">            TrajectoriesFrame: The dataset with the transformed CRS.</span>
</span><span id="Prepocessing.set_crs-1051"><a href="#Prepocessing.set_crs-1051"><span class="linenos">1051</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing.set_crs-1052"><a href="#Prepocessing.set_crs-1052"><span class="linenos">1052</span></a>
</span><span id="Prepocessing.set_crs-1053"><a href="#Prepocessing.set_crs-1053"><span class="linenos">1053</span></a>        <span class="n">data_frame</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">base_csr</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Prepocessing.set_crs-1054"><a href="#Prepocessing.set_crs-1054"><span class="linenos">1054</span></a>
</span><span id="Prepocessing.set_crs-1055"><a href="#Prepocessing.set_crs-1055"><span class="linenos">1055</span></a>        <span class="k">return</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">target_crs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts the coordinate reference system (CRS) of the dataset.</p>

<p>Args:
    data (TrajectoriesFrame): The input dataset.
    base_csr (int): The current CRS of the dataset.
    target_crs (int): The target CRS to convert to.</p>

<p>Returns:
    TrajectoriesFrame: The dataset with the transformed CRS.</p>
</div>


                            </div>
                            <div id="Prepocessing.filter_by_min_number" class="classattr">
                                        <input id="Prepocessing.filter_by_min_number-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">filter_by_min_number</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span>,</span><span class="param">	<span class="n">min_labels_no</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span></span><span class="return-annotation">) -> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span>:</span></span>

                <label class="view-source-button" for="Prepocessing.filter_by_min_number-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Prepocessing.filter_by_min_number"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Prepocessing.filter_by_min_number-1058"><a href="#Prepocessing.filter_by_min_number-1058"><span class="linenos">1058</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Prepocessing.filter_by_min_number-1059"><a href="#Prepocessing.filter_by_min_number-1059"><span class="linenos">1059</span></a>    <span class="k">def</span> <span class="nf">filter_by_min_number</span><span class="p">(</span>
</span><span id="Prepocessing.filter_by_min_number-1060"><a href="#Prepocessing.filter_by_min_number-1060"><span class="linenos">1060</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span> <span class="n">min_labels_no</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">MIN_LABEL_NO</span>
</span><span id="Prepocessing.filter_by_min_number-1061"><a href="#Prepocessing.filter_by_min_number-1061"><span class="linenos">1061</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="Prepocessing.filter_by_min_number-1062"><a href="#Prepocessing.filter_by_min_number-1062"><span class="linenos">1062</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing.filter_by_min_number-1063"><a href="#Prepocessing.filter_by_min_number-1063"><span class="linenos">1063</span></a><span class="sd">        Filters data to include only individuals with a minimum</span>
</span><span id="Prepocessing.filter_by_min_number-1064"><a href="#Prepocessing.filter_by_min_number-1064"><span class="linenos">1064</span></a><span class="sd">        number of labels.</span>
</span><span id="Prepocessing.filter_by_min_number-1065"><a href="#Prepocessing.filter_by_min_number-1065"><span class="linenos">1065</span></a>
</span><span id="Prepocessing.filter_by_min_number-1066"><a href="#Prepocessing.filter_by_min_number-1066"><span class="linenos">1066</span></a><span class="sd">        Args:</span>
</span><span id="Prepocessing.filter_by_min_number-1067"><a href="#Prepocessing.filter_by_min_number-1067"><span class="linenos">1067</span></a><span class="sd">            data (TrajectoriesFrame): The input trajectory dataset.</span>
</span><span id="Prepocessing.filter_by_min_number-1068"><a href="#Prepocessing.filter_by_min_number-1068"><span class="linenos">1068</span></a><span class="sd">            min_labels_no (int): The minimum number of labels required.</span>
</span><span id="Prepocessing.filter_by_min_number-1069"><a href="#Prepocessing.filter_by_min_number-1069"><span class="linenos">1069</span></a>
</span><span id="Prepocessing.filter_by_min_number-1070"><a href="#Prepocessing.filter_by_min_number-1070"><span class="linenos">1070</span></a><span class="sd">        Returns:</span>
</span><span id="Prepocessing.filter_by_min_number-1071"><a href="#Prepocessing.filter_by_min_number-1071"><span class="linenos">1071</span></a><span class="sd">            TrajectoriesFrame: The filtered dataset.</span>
</span><span id="Prepocessing.filter_by_min_number-1072"><a href="#Prepocessing.filter_by_min_number-1072"><span class="linenos">1072</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing.filter_by_min_number-1073"><a href="#Prepocessing.filter_by_min_number-1073"><span class="linenos">1073</span></a>
</span><span id="Prepocessing.filter_by_min_number-1074"><a href="#Prepocessing.filter_by_min_number-1074"><span class="linenos">1074</span></a>        <span class="n">data_without_nans</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="Prepocessing.filter_by_min_number-1075"><a href="#Prepocessing.filter_by_min_number-1075"><span class="linenos">1075</span></a>        <span class="n">distinct_locations</span> <span class="o">=</span> <span class="n">num_of_distinct_locations</span><span class="p">(</span><span class="n">data_without_nans</span><span class="p">)</span>
</span><span id="Prepocessing.filter_by_min_number-1076"><a href="#Prepocessing.filter_by_min_number-1076"><span class="linenos">1076</span></a>
</span><span id="Prepocessing.filter_by_min_number-1077"><a href="#Prepocessing.filter_by_min_number-1077"><span class="linenos">1077</span></a>        <span class="k">return</span> <span class="n">TrajectoriesFrame</span><span class="p">(</span>
</span><span id="Prepocessing.filter_by_min_number-1078"><a href="#Prepocessing.filter_by_min_number-1078"><span class="linenos">1078</span></a>            <span class="n">data_without_nans</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="Prepocessing.filter_by_min_number-1079"><a href="#Prepocessing.filter_by_min_number-1079"><span class="linenos">1079</span></a>                <span class="n">distinct_locations</span><span class="p">[</span><span class="n">distinct_locations</span> <span class="o">&gt;</span> <span class="n">min_labels_no</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</span><span id="Prepocessing.filter_by_min_number-1080"><a href="#Prepocessing.filter_by_min_number-1080"><span class="linenos">1080</span></a>            <span class="p">]</span>
</span><span id="Prepocessing.filter_by_min_number-1081"><a href="#Prepocessing.filter_by_min_number-1081"><span class="linenos">1081</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Filters data to include only individuals with a minimum
number of labels.</p>

<p>Args:
    data (TrajectoriesFrame): The input trajectory dataset.
    min_labels_no (int): The minimum number of labels required.</p>

<p>Returns:
    TrajectoriesFrame: The filtered dataset.</p>
</div>


                            </div>
                            <div id="Prepocessing.filter_by_quartiles" class="classattr">
                                        <input id="Prepocessing.filter_by_quartiles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">filter_by_quartiles</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span>,</span><span class="param">	<span class="n">quartile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span></span><span class="return-annotation">) -> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span>:</span></span>

                <label class="view-source-button" for="Prepocessing.filter_by_quartiles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Prepocessing.filter_by_quartiles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Prepocessing.filter_by_quartiles-1084"><a href="#Prepocessing.filter_by_quartiles-1084"><span class="linenos">1084</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Prepocessing.filter_by_quartiles-1085"><a href="#Prepocessing.filter_by_quartiles-1085"><span class="linenos">1085</span></a>    <span class="k">def</span> <span class="nf">filter_by_quartiles</span><span class="p">(</span>
</span><span id="Prepocessing.filter_by_quartiles-1086"><a href="#Prepocessing.filter_by_quartiles-1086"><span class="linenos">1086</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span> <span class="n">quartile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">QUARTILE</span>
</span><span id="Prepocessing.filter_by_quartiles-1087"><a href="#Prepocessing.filter_by_quartiles-1087"><span class="linenos">1087</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="Prepocessing.filter_by_quartiles-1088"><a href="#Prepocessing.filter_by_quartiles-1088"><span class="linenos">1088</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing.filter_by_quartiles-1089"><a href="#Prepocessing.filter_by_quartiles-1089"><span class="linenos">1089</span></a><span class="sd">        Filters data based on quartile values of distinct locations.</span>
</span><span id="Prepocessing.filter_by_quartiles-1090"><a href="#Prepocessing.filter_by_quartiles-1090"><span class="linenos">1090</span></a>
</span><span id="Prepocessing.filter_by_quartiles-1091"><a href="#Prepocessing.filter_by_quartiles-1091"><span class="linenos">1091</span></a><span class="sd">        Args:</span>
</span><span id="Prepocessing.filter_by_quartiles-1092"><a href="#Prepocessing.filter_by_quartiles-1092"><span class="linenos">1092</span></a><span class="sd">            data (TrajectoriesFrame): The input dataset.</span>
</span><span id="Prepocessing.filter_by_quartiles-1093"><a href="#Prepocessing.filter_by_quartiles-1093"><span class="linenos">1093</span></a><span class="sd">            quartile (float): The quartile value (must be 0.25, 0.5, or 0.75).</span>
</span><span id="Prepocessing.filter_by_quartiles-1094"><a href="#Prepocessing.filter_by_quartiles-1094"><span class="linenos">1094</span></a>
</span><span id="Prepocessing.filter_by_quartiles-1095"><a href="#Prepocessing.filter_by_quartiles-1095"><span class="linenos">1095</span></a><span class="sd">        Returns:</span>
</span><span id="Prepocessing.filter_by_quartiles-1096"><a href="#Prepocessing.filter_by_quartiles-1096"><span class="linenos">1096</span></a><span class="sd">            TrajectoriesFrame: The filtered dataset.</span>
</span><span id="Prepocessing.filter_by_quartiles-1097"><a href="#Prepocessing.filter_by_quartiles-1097"><span class="linenos">1097</span></a>
</span><span id="Prepocessing.filter_by_quartiles-1098"><a href="#Prepocessing.filter_by_quartiles-1098"><span class="linenos">1098</span></a><span class="sd">        Raises:</span>
</span><span id="Prepocessing.filter_by_quartiles-1099"><a href="#Prepocessing.filter_by_quartiles-1099"><span class="linenos">1099</span></a><span class="sd">            ValueError: If the provided quartile value is not one of</span>
</span><span id="Prepocessing.filter_by_quartiles-1100"><a href="#Prepocessing.filter_by_quartiles-1100"><span class="linenos">1100</span></a><span class="sd">                the allowed values.</span>
</span><span id="Prepocessing.filter_by_quartiles-1101"><a href="#Prepocessing.filter_by_quartiles-1101"><span class="linenos">1101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing.filter_by_quartiles-1102"><a href="#Prepocessing.filter_by_quartiles-1102"><span class="linenos">1102</span></a>
</span><span id="Prepocessing.filter_by_quartiles-1103"><a href="#Prepocessing.filter_by_quartiles-1103"><span class="linenos">1103</span></a>        <span class="n">allowed_quartiles</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">}</span>
</span><span id="Prepocessing.filter_by_quartiles-1104"><a href="#Prepocessing.filter_by_quartiles-1104"><span class="linenos">1104</span></a>        <span class="k">if</span> <span class="n">quartile</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_quartiles</span><span class="p">:</span>
</span><span id="Prepocessing.filter_by_quartiles-1105"><a href="#Prepocessing.filter_by_quartiles-1105"><span class="linenos">1105</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Prepocessing.filter_by_quartiles-1106"><a href="#Prepocessing.filter_by_quartiles-1106"><span class="linenos">1106</span></a>                <span class="sa">f</span><span class="s2">&quot;Invalid quartile value: </span><span class="si">{</span><span class="n">quartile</span><span class="si">}</span><span class="s2">. &quot;</span>
</span><span id="Prepocessing.filter_by_quartiles-1107"><a href="#Prepocessing.filter_by_quartiles-1107"><span class="linenos">1107</span></a>                <span class="sa">f</span><span class="s2">&quot;Allowed values are </span><span class="si">{</span><span class="n">allowed_quartiles</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="Prepocessing.filter_by_quartiles-1108"><a href="#Prepocessing.filter_by_quartiles-1108"><span class="linenos">1108</span></a>            <span class="p">)</span>
</span><span id="Prepocessing.filter_by_quartiles-1109"><a href="#Prepocessing.filter_by_quartiles-1109"><span class="linenos">1109</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Prepocessing.filter_by_quartiles-1110"><a href="#Prepocessing.filter_by_quartiles-1110"><span class="linenos">1110</span></a>            <span class="n">data_without_nans</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="Prepocessing.filter_by_quartiles-1111"><a href="#Prepocessing.filter_by_quartiles-1111"><span class="linenos">1111</span></a>            <span class="n">distinct_locations</span> <span class="o">=</span> <span class="n">num_of_distinct_locations</span><span class="p">(</span><span class="n">data_without_nans</span><span class="p">)</span>
</span><span id="Prepocessing.filter_by_quartiles-1112"><a href="#Prepocessing.filter_by_quartiles-1112"><span class="linenos">1112</span></a>            <span class="n">quartile_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">distinct_locations</span><span class="p">,</span> <span class="n">quartile</span><span class="p">)</span>
</span><span id="Prepocessing.filter_by_quartiles-1113"><a href="#Prepocessing.filter_by_quartiles-1113"><span class="linenos">1113</span></a>
</span><span id="Prepocessing.filter_by_quartiles-1114"><a href="#Prepocessing.filter_by_quartiles-1114"><span class="linenos">1114</span></a>            <span class="k">if</span> <span class="n">quartile_value</span> <span class="o">&lt;</span> <span class="n">const</span><span class="o">.</span><span class="n">MIN_QUARTILE_VALUE</span><span class="p">:</span>
</span><span id="Prepocessing.filter_by_quartiles-1115"><a href="#Prepocessing.filter_by_quartiles-1115"><span class="linenos">1115</span></a>                <span class="n">quartile_value</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">MIN_QUARTILE_VALUE</span>
</span><span id="Prepocessing.filter_by_quartiles-1116"><a href="#Prepocessing.filter_by_quartiles-1116"><span class="linenos">1116</span></a>
</span><span id="Prepocessing.filter_by_quartiles-1117"><a href="#Prepocessing.filter_by_quartiles-1117"><span class="linenos">1117</span></a>            <span class="k">return</span> <span class="n">TrajectoriesFrame</span><span class="p">(</span>
</span><span id="Prepocessing.filter_by_quartiles-1118"><a href="#Prepocessing.filter_by_quartiles-1118"><span class="linenos">1118</span></a>                <span class="n">data_without_nans</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="Prepocessing.filter_by_quartiles-1119"><a href="#Prepocessing.filter_by_quartiles-1119"><span class="linenos">1119</span></a>                    <span class="n">distinct_locations</span><span class="p">[</span><span class="n">distinct_locations</span> <span class="o">&gt;</span> <span class="n">quartile_value</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</span><span id="Prepocessing.filter_by_quartiles-1120"><a href="#Prepocessing.filter_by_quartiles-1120"><span class="linenos">1120</span></a>                <span class="p">]</span>
</span><span id="Prepocessing.filter_by_quartiles-1121"><a href="#Prepocessing.filter_by_quartiles-1121"><span class="linenos">1121</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Filters data based on quartile values of distinct locations.</p>

<p>Args:
    data (TrajectoriesFrame): The input dataset.
    quartile (float): The quartile value (must be 0.25, 0.5, or 0.75).</p>

<p>Returns:
    TrajectoriesFrame: The filtered dataset.</p>

<p>Raises:
    ValueError: If the provided quartile value is not one of
        the allowed values.</p>
</div>


                            </div>
                            <div id="Prepocessing.filing_data" class="classattr">
                                        <input id="Prepocessing.filing_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">filing_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="Prepocessing.filing_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Prepocessing.filing_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Prepocessing.filing_data-1124"><a href="#Prepocessing.filing_data-1124"><span class="linenos">1124</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Prepocessing.filing_data-1125"><a href="#Prepocessing.filing_data-1125"><span class="linenos">1125</span></a>    <span class="k">def</span> <span class="nf">filing_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Prepocessing.filing_data-1126"><a href="#Prepocessing.filing_data-1126"><span class="linenos">1126</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing.filing_data-1127"><a href="#Prepocessing.filing_data-1127"><span class="linenos">1127</span></a><span class="sd">        Processes trajectory data to fill missing values by selecting</span>
</span><span id="Prepocessing.filing_data-1128"><a href="#Prepocessing.filing_data-1128"><span class="linenos">1128</span></a><span class="sd">        the most visited location.</span>
</span><span id="Prepocessing.filing_data-1129"><a href="#Prepocessing.filing_data-1129"><span class="linenos">1129</span></a>
</span><span id="Prepocessing.filing_data-1130"><a href="#Prepocessing.filing_data-1130"><span class="linenos">1130</span></a><span class="sd">        Args:</span>
</span><span id="Prepocessing.filing_data-1131"><a href="#Prepocessing.filing_data-1131"><span class="linenos">1131</span></a><span class="sd">            data (pd.DataFrame): The input trajectory dataset.</span>
</span><span id="Prepocessing.filing_data-1132"><a href="#Prepocessing.filing_data-1132"><span class="linenos">1132</span></a>
</span><span id="Prepocessing.filing_data-1133"><a href="#Prepocessing.filing_data-1133"><span class="linenos">1133</span></a><span class="sd">        Returns:</span>
</span><span id="Prepocessing.filing_data-1134"><a href="#Prepocessing.filing_data-1134"><span class="linenos">1134</span></a><span class="sd">            pd.DataFrame: A processed dataset with missing values filled.</span>
</span><span id="Prepocessing.filing_data-1135"><a href="#Prepocessing.filing_data-1135"><span class="linenos">1135</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Prepocessing.filing_data-1136"><a href="#Prepocessing.filing_data-1136"><span class="linenos">1136</span></a>
</span><span id="Prepocessing.filing_data-1137"><a href="#Prepocessing.filing_data-1137"><span class="linenos">1137</span></a>        <span class="k">def</span> <span class="nf">longest_visited_row</span><span class="p">(</span><span class="n">groupa</span><span class="p">):</span>
</span><span id="Prepocessing.filing_data-1138"><a href="#Prepocessing.filing_data-1138"><span class="linenos">1138</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Prepocessing.filing_data-1139"><a href="#Prepocessing.filing_data-1139"><span class="linenos">1139</span></a><span class="sd">            Returns the row where the individual spent the longest</span>
</span><span id="Prepocessing.filing_data-1140"><a href="#Prepocessing.filing_data-1140"><span class="linenos">1140</span></a><span class="sd">            time in an interval.</span>
</span><span id="Prepocessing.filing_data-1141"><a href="#Prepocessing.filing_data-1141"><span class="linenos">1141</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="Prepocessing.filing_data-1142"><a href="#Prepocessing.filing_data-1142"><span class="linenos">1142</span></a>
</span><span id="Prepocessing.filing_data-1143"><a href="#Prepocessing.filing_data-1143"><span class="linenos">1143</span></a>            <span class="k">if</span> <span class="n">groupa</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="Prepocessing.filing_data-1144"><a href="#Prepocessing.filing_data-1144"><span class="linenos">1144</span></a>                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="Prepocessing.filing_data-1145"><a href="#Prepocessing.filing_data-1145"><span class="linenos">1145</span></a>
</span><span id="Prepocessing.filing_data-1146"><a href="#Prepocessing.filing_data-1146"><span class="linenos">1146</span></a>            <span class="n">max_label</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Prepocessing.filing_data-1147"><a href="#Prepocessing.filing_data-1147"><span class="linenos">1147</span></a>                <span class="n">groupa</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">)[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
</span><span id="Prepocessing.filing_data-1148"><a href="#Prepocessing.filing_data-1148"><span class="linenos">1148</span></a>            <span class="p">)</span>
</span><span id="Prepocessing.filing_data-1149"><a href="#Prepocessing.filing_data-1149"><span class="linenos">1149</span></a>            <span class="n">row</span> <span class="o">=</span> <span class="n">groupa</span><span class="p">[</span><span class="n">groupa</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_label</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Prepocessing.filing_data-1150"><a href="#Prepocessing.filing_data-1150"><span class="linenos">1150</span></a>
</span><span id="Prepocessing.filing_data-1151"><a href="#Prepocessing.filing_data-1151"><span class="linenos">1151</span></a>            <span class="k">return</span> <span class="n">row</span><span class="o">.</span><span class="n">T</span>
</span><span id="Prepocessing.filing_data-1152"><a href="#Prepocessing.filing_data-1152"><span class="linenos">1152</span></a>
</span><span id="Prepocessing.filing_data-1153"><a href="#Prepocessing.filing_data-1153"><span class="linenos">1153</span></a>
</span><span id="Prepocessing.filing_data-1154"><a href="#Prepocessing.filing_data-1154"><span class="linenos">1154</span></a>        <span class="n">to_conca</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Prepocessing.filing_data-1155"><a href="#Prepocessing.filing_data-1155"><span class="linenos">1155</span></a>        <span class="k">for</span> <span class="n">uid</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Prepocessing.filing_data-1156"><a href="#Prepocessing.filing_data-1156"><span class="linenos">1156</span></a>            <span class="n">group</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span>
</span><span id="Prepocessing.filing_data-1157"><a href="#Prepocessing.filing_data-1157"><span class="linenos">1157</span></a>                <span class="o">~</span><span class="n">group</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
</span><span id="Prepocessing.filing_data-1158"><a href="#Prepocessing.filing_data-1158"><span class="linenos">1158</span></a>            <span class="p">]</span>
</span><span id="Prepocessing.filing_data-1159"><a href="#Prepocessing.filing_data-1159"><span class="linenos">1159</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Prepocessing.filing_data-1160"><a href="#Prepocessing.filing_data-1160"><span class="linenos">1160</span></a>                <span class="k">continue</span>
</span><span id="Prepocessing.filing_data-1161"><a href="#Prepocessing.filing_data-1161"><span class="linenos">1161</span></a>            <span class="n">group</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="Prepocessing.filing_data-1162"><a href="#Prepocessing.filing_data-1162"><span class="linenos">1162</span></a>                <span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
</span><span id="Prepocessing.filing_data-1163"><a href="#Prepocessing.filing_data-1163"><span class="linenos">1163</span></a>            <span class="p">)</span>
</span><span id="Prepocessing.filing_data-1164"><a href="#Prepocessing.filing_data-1164"><span class="linenos">1164</span></a>            <span class="n">group</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Prepocessing.filing_data-1165"><a href="#Prepocessing.filing_data-1165"><span class="linenos">1165</span></a>                <span class="n">group</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">group</span><span class="o">.</span><span class="n">index</span>
</span><span id="Prepocessing.filing_data-1166"><a href="#Prepocessing.filing_data-1166"><span class="linenos">1166</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</span><span id="Prepocessing.filing_data-1167"><a href="#Prepocessing.filing_data-1167"><span class="linenos">1167</span></a>            <span class="n">group</span><span class="p">[</span><span class="s2">&quot;next&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">labels</span> <span class="o">!=</span> <span class="n">group</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>
</span><span id="Prepocessing.filing_data-1168"><a href="#Prepocessing.filing_data-1168"><span class="linenos">1168</span></a>            <span class="n">group</span><span class="p">[</span><span class="s2">&quot;moved&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</span><span id="Prepocessing.filing_data-1169"><a href="#Prepocessing.filing_data-1169"><span class="linenos">1169</span></a>            <span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;moved&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span><span id="Prepocessing.filing_data-1170"><a href="#Prepocessing.filing_data-1170"><span class="linenos">1170</span></a>            <span class="n">group</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>
</span><span id="Prepocessing.filing_data-1171"><a href="#Prepocessing.filing_data-1171"><span class="linenos">1171</span></a>
</span><span id="Prepocessing.filing_data-1172"><a href="#Prepocessing.filing_data-1172"><span class="linenos">1172</span></a>            <span class="n">group_resampled</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1h&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">longest_visited_row</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</span><span id="Prepocessing.filing_data-1173"><a href="#Prepocessing.filing_data-1173"><span class="linenos">1173</span></a>            <span class="k">if</span> <span class="n">group_resampled</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Prepocessing.filing_data-1174"><a href="#Prepocessing.filing_data-1174"><span class="linenos">1174</span></a>                <span class="n">group_resampled</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1h&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">longest_visited_row</span><span class="p">)</span>
</span><span id="Prepocessing.filing_data-1175"><a href="#Prepocessing.filing_data-1175"><span class="linenos">1175</span></a>            <span class="n">group_resampled</span> <span class="o">=</span> <span class="n">group_resampled</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1h&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="Prepocessing.filing_data-1176"><a href="#Prepocessing.filing_data-1176"><span class="linenos">1176</span></a>            <span class="n">group_resampled</span> <span class="o">=</span> <span class="n">group_resampled</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span><span class="o">.</span><span class="n">bfill</span><span class="p">()</span>
</span><span id="Prepocessing.filing_data-1177"><a href="#Prepocessing.filing_data-1177"><span class="linenos">1177</span></a>
</span><span id="Prepocessing.filing_data-1178"><a href="#Prepocessing.filing_data-1178"><span class="linenos">1178</span></a>            <span class="n">to_conca</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_resampled</span>
</span><span id="Prepocessing.filing_data-1179"><a href="#Prepocessing.filing_data-1179"><span class="linenos">1179</span></a>
</span><span id="Prepocessing.filing_data-1180"><a href="#Prepocessing.filing_data-1180"><span class="linenos">1180</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">to_conca</span><span class="p">))</span>
</span><span id="Prepocessing.filing_data-1181"><a href="#Prepocessing.filing_data-1181"><span class="linenos">1181</span></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;is_new&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="Prepocessing.filing_data-1182"><a href="#Prepocessing.filing_data-1182"><span class="linenos">1182</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">~</span><span class="n">x</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
</span><span id="Prepocessing.filing_data-1183"><a href="#Prepocessing.filing_data-1183"><span class="linenos">1183</span></a>        <span class="p">)</span>
</span><span id="Prepocessing.filing_data-1184"><a href="#Prepocessing.filing_data-1184"><span class="linenos">1184</span></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;new_sum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Prepocessing.filing_data-1185"><a href="#Prepocessing.filing_data-1185"><span class="linenos">1185</span></a>            <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">is_new</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Prepocessing.filing_data-1186"><a href="#Prepocessing.filing_data-1186"><span class="linenos">1186</span></a>        <span class="p">)</span>
</span><span id="Prepocessing.filing_data-1187"><a href="#Prepocessing.filing_data-1187"><span class="linenos">1187</span></a>
</span><span id="Prepocessing.filing_data-1188"><a href="#Prepocessing.filing_data-1188"><span class="linenos">1188</span></a>        <span class="k">return</span> <span class="n">df</span>
</span></pre></div>


            <div class="docstring"><p>Processes trajectory data to fill missing values by selecting
the most visited location.</p>

<p>Args:
    data (pd.DataFrame): The input trajectory dataset.</p>

<p>Returns:
    pd.DataFrame: A processed dataset with missing values filled.</p>
</div>


                            </div>
                </section>
                <section id="Flexation">
                            <input id="Flexation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Flexation</span>:

                <label class="view-source-button" for="Flexation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Flexation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Flexation-1192"><a href="#Flexation-1192"><span class="linenos">1192</span></a><span class="k">class</span> <span class="nc">Flexation</span><span class="p">:</span>
</span><span id="Flexation-1193"><a href="#Flexation-1193"><span class="linenos">1193</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Flexation-1194"><a href="#Flexation-1194"><span class="linenos">1194</span></a><span class="sd">    A class used for identifying and fitting statistical distributions to</span>
</span><span id="Flexation-1195"><a href="#Flexation-1195"><span class="linenos">1195</span></a><span class="sd">    segmented data based on flexation points.</span>
</span><span id="Flexation-1196"><a href="#Flexation-1196"><span class="linenos">1196</span></a>
</span><span id="Flexation-1197"><a href="#Flexation-1197"><span class="linenos">1197</span></a><span class="sd">    Flexation points are identified using the PELT (Pruned Exact Linear Time)</span>
</span><span id="Flexation-1198"><a href="#Flexation-1198"><span class="linenos">1198</span></a><span class="sd">    change point detection algorithm. Once flexation points are detected,</span>
</span><span id="Flexation-1199"><a href="#Flexation-1199"><span class="linenos">1199</span></a><span class="sd">    the data is split into left and right segments, and statistical models</span>
</span><span id="Flexation-1200"><a href="#Flexation-1200"><span class="linenos">1200</span></a><span class="sd">    are fitted to each segment. The goodness of fit is evaluated using</span>
</span><span id="Flexation-1201"><a href="#Flexation-1201"><span class="linenos">1201</span></a><span class="sd">    the Wasserstein distance between the empirical density and the fitted</span>
</span><span id="Flexation-1202"><a href="#Flexation-1202"><span class="linenos">1202</span></a><span class="sd">    model.</span>
</span><span id="Flexation-1203"><a href="#Flexation-1203"><span class="linenos">1203</span></a>
</span><span id="Flexation-1204"><a href="#Flexation-1204"><span class="linenos">1204</span></a><span class="sd">    Attributes:</span>
</span><span id="Flexation-1205"><a href="#Flexation-1205"><span class="linenos">1205</span></a><span class="sd">    -----------</span>
</span><span id="Flexation-1206"><a href="#Flexation-1206"><span class="linenos">1206</span></a><span class="sd">    None</span>
</span><span id="Flexation-1207"><a href="#Flexation-1207"><span class="linenos">1207</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Flexation-1208"><a href="#Flexation-1208"><span class="linenos">1208</span></a>
</span><span id="Flexation-1209"><a href="#Flexation-1209"><span class="linenos">1209</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Flexation-1210"><a href="#Flexation-1210"><span class="linenos">1210</span></a>        <span class="k">pass</span>
</span><span id="Flexation-1211"><a href="#Flexation-1211"><span class="linenos">1211</span></a>
</span><span id="Flexation-1212"><a href="#Flexation-1212"><span class="linenos">1212</span></a>
</span><span id="Flexation-1213"><a href="#Flexation-1213"><span class="linenos">1213</span></a>    <span class="k">def</span> <span class="nf">_calculate_penalty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Flexation-1214"><a href="#Flexation-1214"><span class="linenos">1214</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Flexation-1215"><a href="#Flexation-1215"><span class="linenos">1215</span></a><span class="sd">        Calculates a penalty value based on the dataset size</span>
</span><span id="Flexation-1216"><a href="#Flexation-1216"><span class="linenos">1216</span></a><span class="sd">        and predefined sensitivity settings.</span>
</span><span id="Flexation-1217"><a href="#Flexation-1217"><span class="linenos">1217</span></a>
</span><span id="Flexation-1218"><a href="#Flexation-1218"><span class="linenos">1218</span></a><span class="sd">        The penalty is determined using logarithmic scaling and</span>
</span><span id="Flexation-1219"><a href="#Flexation-1219"><span class="linenos">1219</span></a><span class="sd">        depends on the sensitivity level set</span>
</span><span id="Flexation-1220"><a href="#Flexation-1220"><span class="linenos">1220</span></a><span class="sd">        in `const.FLEXATION_POINTS_SENSITIVITY`.</span>
</span><span id="Flexation-1221"><a href="#Flexation-1221"><span class="linenos">1221</span></a>
</span><span id="Flexation-1222"><a href="#Flexation-1222"><span class="linenos">1222</span></a><span class="sd">        Parameters:</span>
</span><span id="Flexation-1223"><a href="#Flexation-1223"><span class="linenos">1223</span></a><span class="sd">        -----------</span>
</span><span id="Flexation-1224"><a href="#Flexation-1224"><span class="linenos">1224</span></a><span class="sd">        data : ndarray</span>
</span><span id="Flexation-1225"><a href="#Flexation-1225"><span class="linenos">1225</span></a><span class="sd">            The numerical dataset for which the penalty is calculated.</span>
</span><span id="Flexation-1226"><a href="#Flexation-1226"><span class="linenos">1226</span></a>
</span><span id="Flexation-1227"><a href="#Flexation-1227"><span class="linenos">1227</span></a><span class="sd">        Returns:</span>
</span><span id="Flexation-1228"><a href="#Flexation-1228"><span class="linenos">1228</span></a><span class="sd">        --------</span>
</span><span id="Flexation-1229"><a href="#Flexation-1229"><span class="linenos">1229</span></a><span class="sd">        float</span>
</span><span id="Flexation-1230"><a href="#Flexation-1230"><span class="linenos">1230</span></a><span class="sd">            The computed penalty value based on the selected</span>
</span><span id="Flexation-1231"><a href="#Flexation-1231"><span class="linenos">1231</span></a><span class="sd">                sensitivity level.</span>
</span><span id="Flexation-1232"><a href="#Flexation-1232"><span class="linenos">1232</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Flexation-1233"><a href="#Flexation-1233"><span class="linenos">1233</span></a>        <span class="k">if</span> <span class="n">const</span><span class="o">.</span><span class="n">FLEXATION_POINTS_SENSITIVITY</span> <span class="o">==</span> <span class="s2">&quot;Low&quot;</span><span class="p">:</span>
</span><span id="Flexation-1234"><a href="#Flexation-1234"><span class="linenos">1234</span></a>            <span class="k">return</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</span><span id="Flexation-1235"><a href="#Flexation-1235"><span class="linenos">1235</span></a>        <span class="k">elif</span> <span class="n">const</span><span class="o">.</span><span class="n">FLEXATION_POINTS_SENSITIVITY</span> <span class="o">==</span> <span class="s2">&quot;Medium&quot;</span><span class="p">:</span>
</span><span id="Flexation-1236"><a href="#Flexation-1236"><span class="linenos">1236</span></a>            <span class="k">return</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</span><span id="Flexation-1237"><a href="#Flexation-1237"><span class="linenos">1237</span></a>        <span class="k">elif</span> <span class="n">const</span><span class="o">.</span><span class="n">FLEXATION_POINTS_SENSITIVITY</span> <span class="o">==</span> <span class="s2">&quot;High&quot;</span><span class="p">:</span>
</span><span id="Flexation-1238"><a href="#Flexation-1238"><span class="linenos">1238</span></a>            <span class="k">return</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</span><span id="Flexation-1239"><a href="#Flexation-1239"><span class="linenos">1239</span></a>
</span><span id="Flexation-1240"><a href="#Flexation-1240"><span class="linenos">1240</span></a>
</span><span id="Flexation-1241"><a href="#Flexation-1241"><span class="linenos">1241</span></a>    <span class="k">def</span> <span class="nf">_calc_main_model_wasser</span><span class="p">(</span>
</span><span id="Flexation-1242"><a href="#Flexation-1242"><span class="linenos">1242</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">model_obj</span><span class="p">:</span> <span class="n">distfit</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">flexation_point</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Flexation-1243"><a href="#Flexation-1243"><span class="linenos">1243</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Flexation-1244"><a href="#Flexation-1244"><span class="linenos">1244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Flexation-1245"><a href="#Flexation-1245"><span class="linenos">1245</span></a><span class="sd">        Calculates the Wasserstein distance between the empirical density</span>
</span><span id="Flexation-1246"><a href="#Flexation-1246"><span class="linenos">1246</span></a><span class="sd">        and the fitted model for data split at a given flexation point.</span>
</span><span id="Flexation-1247"><a href="#Flexation-1247"><span class="linenos">1247</span></a>
</span><span id="Flexation-1248"><a href="#Flexation-1248"><span class="linenos">1248</span></a><span class="sd">        Parameters:</span>
</span><span id="Flexation-1249"><a href="#Flexation-1249"><span class="linenos">1249</span></a><span class="sd">        -----------</span>
</span><span id="Flexation-1250"><a href="#Flexation-1250"><span class="linenos">1250</span></a><span class="sd">        model_obj : distfit</span>
</span><span id="Flexation-1251"><a href="#Flexation-1251"><span class="linenos">1251</span></a><span class="sd">            A fitted distfit model object used for density estimation.</span>
</span><span id="Flexation-1252"><a href="#Flexation-1252"><span class="linenos">1252</span></a><span class="sd">        data : ndarray</span>
</span><span id="Flexation-1253"><a href="#Flexation-1253"><span class="linenos">1253</span></a><span class="sd">            The numerical dataset to be analyzed.</span>
</span><span id="Flexation-1254"><a href="#Flexation-1254"><span class="linenos">1254</span></a><span class="sd">        flexation_point : int</span>
</span><span id="Flexation-1255"><a href="#Flexation-1255"><span class="linenos">1255</span></a><span class="sd">            The point at which the data is split into left and right subsets.</span>
</span><span id="Flexation-1256"><a href="#Flexation-1256"><span class="linenos">1256</span></a>
</span><span id="Flexation-1257"><a href="#Flexation-1257"><span class="linenos">1257</span></a><span class="sd">        Returns:</span>
</span><span id="Flexation-1258"><a href="#Flexation-1258"><span class="linenos">1258</span></a><span class="sd">        --------</span>
</span><span id="Flexation-1259"><a href="#Flexation-1259"><span class="linenos">1259</span></a><span class="sd">        float</span>
</span><span id="Flexation-1260"><a href="#Flexation-1260"><span class="linenos">1260</span></a><span class="sd">            The Wasserstein distance between the empirical and model densities.</span>
</span><span id="Flexation-1261"><a href="#Flexation-1261"><span class="linenos">1261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Flexation-1262"><a href="#Flexation-1262"><span class="linenos">1262</span></a>
</span><span id="Flexation-1263"><a href="#Flexation-1263"><span class="linenos">1263</span></a>        <span class="n">left_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="n">flexation_point</span><span class="p">]</span>
</span><span id="Flexation-1264"><a href="#Flexation-1264"><span class="linenos">1264</span></a>        <span class="n">right_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="n">flexation_point</span><span class="p">]</span>
</span><span id="Flexation-1265"><a href="#Flexation-1265"><span class="linenos">1265</span></a>
</span><span id="Flexation-1266"><a href="#Flexation-1266"><span class="linenos">1266</span></a>        <span class="n">main_dfit</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">()</span>
</span><span id="Flexation-1267"><a href="#Flexation-1267"><span class="linenos">1267</span></a>
</span><span id="Flexation-1268"><a href="#Flexation-1268"><span class="linenos">1268</span></a>        <span class="n">left_main_bins</span><span class="p">,</span> <span class="n">left_main_empiric_density</span> <span class="o">=</span> <span class="n">main_dfit</span><span class="o">.</span><span class="n">density</span><span class="p">(</span>
</span><span id="Flexation-1269"><a href="#Flexation-1269"><span class="linenos">1269</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">left_set</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">left_set</span><span class="p">)</span>
</span><span id="Flexation-1270"><a href="#Flexation-1270"><span class="linenos">1270</span></a>        <span class="p">)</span>
</span><span id="Flexation-1271"><a href="#Flexation-1271"><span class="linenos">1271</span></a>        <span class="n">right_main_bins</span><span class="p">,</span> <span class="n">right_main_empiric_density</span> <span class="o">=</span> <span class="n">main_dfit</span><span class="o">.</span><span class="n">density</span><span class="p">(</span>
</span><span id="Flexation-1272"><a href="#Flexation-1272"><span class="linenos">1272</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">right_set</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">right_set</span><span class="p">)</span>
</span><span id="Flexation-1273"><a href="#Flexation-1273"><span class="linenos">1273</span></a>        <span class="p">)</span>
</span><span id="Flexation-1274"><a href="#Flexation-1274"><span class="linenos">1274</span></a>
</span><span id="Flexation-1275"><a href="#Flexation-1275"><span class="linenos">1275</span></a>        <span class="n">left_main_model_density</span> <span class="o">=</span> <span class="n">model_obj</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">left_main_bins</span><span class="p">)</span>
</span><span id="Flexation-1276"><a href="#Flexation-1276"><span class="linenos">1276</span></a>        <span class="n">right_main_model_density</span> <span class="o">=</span> <span class="n">model_obj</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">right_main_bins</span><span class="p">)</span>
</span><span id="Flexation-1277"><a href="#Flexation-1277"><span class="linenos">1277</span></a>
</span><span id="Flexation-1278"><a href="#Flexation-1278"><span class="linenos">1278</span></a>        <span class="n">empiric_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="Flexation-1279"><a href="#Flexation-1279"><span class="linenos">1279</span></a>            <span class="p">(</span><span class="n">left_main_empiric_density</span><span class="p">,</span> <span class="n">right_main_empiric_density</span><span class="p">)</span>
</span><span id="Flexation-1280"><a href="#Flexation-1280"><span class="linenos">1280</span></a>        <span class="p">)</span>
</span><span id="Flexation-1281"><a href="#Flexation-1281"><span class="linenos">1281</span></a>        <span class="n">model_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="Flexation-1282"><a href="#Flexation-1282"><span class="linenos">1282</span></a>            <span class="p">(</span><span class="n">left_main_model_density</span><span class="p">,</span> <span class="n">right_main_model_density</span><span class="p">)</span>
</span><span id="Flexation-1283"><a href="#Flexation-1283"><span class="linenos">1283</span></a>        <span class="p">)</span>
</span><span id="Flexation-1284"><a href="#Flexation-1284"><span class="linenos">1284</span></a>
</span><span id="Flexation-1285"><a href="#Flexation-1285"><span class="linenos">1285</span></a>        <span class="k">return</span> <span class="n">wasserstein_distance</span><span class="p">(</span><span class="n">empiric_density</span><span class="p">,</span> <span class="n">model_density</span><span class="p">)</span>
</span><span id="Flexation-1286"><a href="#Flexation-1286"><span class="linenos">1286</span></a>
</span><span id="Flexation-1287"><a href="#Flexation-1287"><span class="linenos">1287</span></a>
</span><span id="Flexation-1288"><a href="#Flexation-1288"><span class="linenos">1288</span></a>    <span class="k">def</span> <span class="nf">_fit_mixed_models</span><span class="p">(</span>
</span><span id="Flexation-1289"><a href="#Flexation-1289"><span class="linenos">1289</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="Flexation-1290"><a href="#Flexation-1290"><span class="linenos">1290</span></a>            <span class="n">data</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
</span><span id="Flexation-1291"><a href="#Flexation-1291"><span class="linenos">1291</span></a>            <span class="n">flexation_points</span><span class="p">:</span> <span class="nb">list</span>
</span><span id="Flexation-1292"><a href="#Flexation-1292"><span class="linenos">1292</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Flexation-1293"><a href="#Flexation-1293"><span class="linenos">1293</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Flexation-1294"><a href="#Flexation-1294"><span class="linenos">1294</span></a><span class="sd">        Fits statistical distributions to data segments split at given</span>
</span><span id="Flexation-1295"><a href="#Flexation-1295"><span class="linenos">1295</span></a><span class="sd">        flexation points and evaluates their goodness of fit using</span>
</span><span id="Flexation-1296"><a href="#Flexation-1296"><span class="linenos">1296</span></a><span class="sd">        the Wasserstein distance metric.</span>
</span><span id="Flexation-1297"><a href="#Flexation-1297"><span class="linenos">1297</span></a>
</span><span id="Flexation-1298"><a href="#Flexation-1298"><span class="linenos">1298</span></a><span class="sd">        Parameters:</span>
</span><span id="Flexation-1299"><a href="#Flexation-1299"><span class="linenos">1299</span></a><span class="sd">        -----------</span>
</span><span id="Flexation-1300"><a href="#Flexation-1300"><span class="linenos">1300</span></a><span class="sd">        data : ndarray</span>
</span><span id="Flexation-1301"><a href="#Flexation-1301"><span class="linenos">1301</span></a><span class="sd">            The numerical dataset to be analyzed.</span>
</span><span id="Flexation-1302"><a href="#Flexation-1302"><span class="linenos">1302</span></a><span class="sd">        flexation_points : list</span>
</span><span id="Flexation-1303"><a href="#Flexation-1303"><span class="linenos">1303</span></a><span class="sd">            A list of points at which the data is split into left</span>
</span><span id="Flexation-1304"><a href="#Flexation-1304"><span class="linenos">1304</span></a><span class="sd">                and right subsets.</span>
</span><span id="Flexation-1305"><a href="#Flexation-1305"><span class="linenos">1305</span></a>
</span><span id="Flexation-1306"><a href="#Flexation-1306"><span class="linenos">1306</span></a><span class="sd">        Returns:</span>
</span><span id="Flexation-1307"><a href="#Flexation-1307"><span class="linenos">1307</span></a><span class="sd">        --------</span>
</span><span id="Flexation-1308"><a href="#Flexation-1308"><span class="linenos">1308</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Flexation-1309"><a href="#Flexation-1309"><span class="linenos">1309</span></a><span class="sd">            A DataFrame containing:</span>
</span><span id="Flexation-1310"><a href="#Flexation-1310"><span class="linenos">1310</span></a><span class="sd">            - &#39;point&#39;: The flexation point.</span>
</span><span id="Flexation-1311"><a href="#Flexation-1311"><span class="linenos">1311</span></a><span class="sd">            - &#39;left_model&#39;: Best-fitted distribution name for the left subset.</span>
</span><span id="Flexation-1312"><a href="#Flexation-1312"><span class="linenos">1312</span></a><span class="sd">            - &#39;left_score&#39;: Fit score of the left model from distfit.</span>
</span><span id="Flexation-1313"><a href="#Flexation-1313"><span class="linenos">1313</span></a><span class="sd">            - &#39;left_score_calc&#39;: Calculated Wasserstein distance for</span>
</span><span id="Flexation-1314"><a href="#Flexation-1314"><span class="linenos">1314</span></a><span class="sd">                the left subset.</span>
</span><span id="Flexation-1315"><a href="#Flexation-1315"><span class="linenos">1315</span></a><span class="sd">            - &#39;right_model&#39;: Best-fitted distribution name for</span>
</span><span id="Flexation-1316"><a href="#Flexation-1316"><span class="linenos">1316</span></a><span class="sd">                the right subset.</span>
</span><span id="Flexation-1317"><a href="#Flexation-1317"><span class="linenos">1317</span></a><span class="sd">            - &#39;right_score&#39;: Fit score of the right model from distfit.</span>
</span><span id="Flexation-1318"><a href="#Flexation-1318"><span class="linenos">1318</span></a><span class="sd">            - &#39;right_score_calc&#39;: Calculated Wasserstein distance for</span>
</span><span id="Flexation-1319"><a href="#Flexation-1319"><span class="linenos">1319</span></a><span class="sd">                the right subset.</span>
</span><span id="Flexation-1320"><a href="#Flexation-1320"><span class="linenos">1320</span></a><span class="sd">            - &#39;overall_score&#39;: Combined Wasserstein distance score</span>
</span><span id="Flexation-1321"><a href="#Flexation-1321"><span class="linenos">1321</span></a><span class="sd">                for the entire dataset.</span>
</span><span id="Flexation-1322"><a href="#Flexation-1322"><span class="linenos">1322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Flexation-1323"><a href="#Flexation-1323"><span class="linenos">1323</span></a>
</span><span id="Flexation-1324"><a href="#Flexation-1324"><span class="linenos">1324</span></a>        <span class="n">fitting_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="Flexation-1325"><a href="#Flexation-1325"><span class="linenos">1325</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
</span><span id="Flexation-1326"><a href="#Flexation-1326"><span class="linenos">1326</span></a>                <span class="s2">&quot;point&quot;</span><span class="p">,</span>
</span><span id="Flexation-1327"><a href="#Flexation-1327"><span class="linenos">1327</span></a>                <span class="s2">&quot;left_model&quot;</span><span class="p">,</span>
</span><span id="Flexation-1328"><a href="#Flexation-1328"><span class="linenos">1328</span></a>                <span class="s2">&quot;left_score&quot;</span><span class="p">,</span>
</span><span id="Flexation-1329"><a href="#Flexation-1329"><span class="linenos">1329</span></a>                <span class="s2">&quot;left_score_calc&quot;</span><span class="p">,</span>
</span><span id="Flexation-1330"><a href="#Flexation-1330"><span class="linenos">1330</span></a>                <span class="s2">&quot;right_model&quot;</span><span class="p">,</span>
</span><span id="Flexation-1331"><a href="#Flexation-1331"><span class="linenos">1331</span></a>                <span class="s2">&quot;right_score&quot;</span><span class="p">,</span>
</span><span id="Flexation-1332"><a href="#Flexation-1332"><span class="linenos">1332</span></a>                <span class="s2">&quot;right_score_calc&quot;</span><span class="p">,</span>
</span><span id="Flexation-1333"><a href="#Flexation-1333"><span class="linenos">1333</span></a>                <span class="s2">&quot;overall_score&quot;</span><span class="p">,</span>
</span><span id="Flexation-1334"><a href="#Flexation-1334"><span class="linenos">1334</span></a>            <span class="p">]</span>
</span><span id="Flexation-1335"><a href="#Flexation-1335"><span class="linenos">1335</span></a>        <span class="p">)</span>
</span><span id="Flexation-1336"><a href="#Flexation-1336"><span class="linenos">1336</span></a>
</span><span id="Flexation-1337"><a href="#Flexation-1337"><span class="linenos">1337</span></a>        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">flexation_points</span><span class="p">:</span>
</span><span id="Flexation-1338"><a href="#Flexation-1338"><span class="linenos">1338</span></a>            <span class="n">left_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="n">point</span><span class="p">]</span>
</span><span id="Flexation-1339"><a href="#Flexation-1339"><span class="linenos">1339</span></a>            <span class="n">right_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="n">point</span><span class="p">]</span>
</span><span id="Flexation-1340"><a href="#Flexation-1340"><span class="linenos">1340</span></a>
</span><span id="Flexation-1341"><a href="#Flexation-1341"><span class="linenos">1341</span></a>            <span class="k">if</span> <span class="n">left_set</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">right_set</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># FIXME:</span>
</span><span id="Flexation-1342"><a href="#Flexation-1342"><span class="linenos">1342</span></a>                <span class="n">left_model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="Flexation-1343"><a href="#Flexation-1343"><span class="linenos">1343</span></a>                    <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="Flexation-1344"><a href="#Flexation-1344"><span class="linenos">1344</span></a>                        <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="Flexation-1345"><a href="#Flexation-1345"><span class="linenos">1345</span></a>                        <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="Flexation-1346"><a href="#Flexation-1346"><span class="linenos">1346</span></a>                        <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="Flexation-1347"><a href="#Flexation-1347"><span class="linenos">1347</span></a>                        <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="Flexation-1348"><a href="#Flexation-1348"><span class="linenos">1348</span></a>                        <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="Flexation-1349"><a href="#Flexation-1349"><span class="linenos">1349</span></a>                        <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="Flexation-1350"><a href="#Flexation-1350"><span class="linenos">1350</span></a>                        <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="Flexation-1351"><a href="#Flexation-1351"><span class="linenos">1351</span></a>                        <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="Flexation-1352"><a href="#Flexation-1352"><span class="linenos">1352</span></a>                        <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="Flexation-1353"><a href="#Flexation-1353"><span class="linenos">1353</span></a>                        <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="Flexation-1354"><a href="#Flexation-1354"><span class="linenos">1354</span></a>                        <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="Flexation-1355"><a href="#Flexation-1355"><span class="linenos">1355</span></a>                        <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="Flexation-1356"><a href="#Flexation-1356"><span class="linenos">1356</span></a>                        <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="Flexation-1357"><a href="#Flexation-1357"><span class="linenos">1357</span></a>                        <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="Flexation-1358"><a href="#Flexation-1358"><span class="linenos">1358</span></a>                        <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="Flexation-1359"><a href="#Flexation-1359"><span class="linenos">1359</span></a>                    <span class="p">],</span>
</span><span id="Flexation-1360"><a href="#Flexation-1360"><span class="linenos">1360</span></a>                    <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="Flexation-1361"><a href="#Flexation-1361"><span class="linenos">1361</span></a>                <span class="p">)</span>
</span><span id="Flexation-1362"><a href="#Flexation-1362"><span class="linenos">1362</span></a>                <span class="n">right_model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="Flexation-1363"><a href="#Flexation-1363"><span class="linenos">1363</span></a>                    <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="Flexation-1364"><a href="#Flexation-1364"><span class="linenos">1364</span></a>                        <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="Flexation-1365"><a href="#Flexation-1365"><span class="linenos">1365</span></a>                        <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="Flexation-1366"><a href="#Flexation-1366"><span class="linenos">1366</span></a>                        <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="Flexation-1367"><a href="#Flexation-1367"><span class="linenos">1367</span></a>                        <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="Flexation-1368"><a href="#Flexation-1368"><span class="linenos">1368</span></a>                        <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="Flexation-1369"><a href="#Flexation-1369"><span class="linenos">1369</span></a>                        <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="Flexation-1370"><a href="#Flexation-1370"><span class="linenos">1370</span></a>                        <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="Flexation-1371"><a href="#Flexation-1371"><span class="linenos">1371</span></a>                        <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="Flexation-1372"><a href="#Flexation-1372"><span class="linenos">1372</span></a>                        <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="Flexation-1373"><a href="#Flexation-1373"><span class="linenos">1373</span></a>                        <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="Flexation-1374"><a href="#Flexation-1374"><span class="linenos">1374</span></a>                        <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="Flexation-1375"><a href="#Flexation-1375"><span class="linenos">1375</span></a>                        <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="Flexation-1376"><a href="#Flexation-1376"><span class="linenos">1376</span></a>                        <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="Flexation-1377"><a href="#Flexation-1377"><span class="linenos">1377</span></a>                        <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="Flexation-1378"><a href="#Flexation-1378"><span class="linenos">1378</span></a>                        <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="Flexation-1379"><a href="#Flexation-1379"><span class="linenos">1379</span></a>                    <span class="p">],</span>
</span><span id="Flexation-1380"><a href="#Flexation-1380"><span class="linenos">1380</span></a>                    <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="Flexation-1381"><a href="#Flexation-1381"><span class="linenos">1381</span></a>                <span class="p">)</span>
</span><span id="Flexation-1382"><a href="#Flexation-1382"><span class="linenos">1382</span></a>
</span><span id="Flexation-1383"><a href="#Flexation-1383"><span class="linenos">1383</span></a>                <span class="n">left_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">left_set</span><span class="p">)</span>
</span><span id="Flexation-1384"><a href="#Flexation-1384"><span class="linenos">1384</span></a>                <span class="n">right_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">right_set</span><span class="p">)</span>
</span><span id="Flexation-1385"><a href="#Flexation-1385"><span class="linenos">1385</span></a>
</span><span id="Flexation-1386"><a href="#Flexation-1386"><span class="linenos">1386</span></a>                <span class="n">left_dfit</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">()</span>
</span><span id="Flexation-1387"><a href="#Flexation-1387"><span class="linenos">1387</span></a>                <span class="n">left_bins</span><span class="p">,</span> <span class="n">left_empiric_density</span> <span class="o">=</span> <span class="n">left_dfit</span><span class="o">.</span><span class="n">density</span><span class="p">(</span>
</span><span id="Flexation-1388"><a href="#Flexation-1388"><span class="linenos">1388</span></a>                    <span class="n">X</span><span class="o">=</span><span class="n">left_set</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">left_set</span><span class="p">)</span>
</span><span id="Flexation-1389"><a href="#Flexation-1389"><span class="linenos">1389</span></a>                <span class="p">)</span>
</span><span id="Flexation-1390"><a href="#Flexation-1390"><span class="linenos">1390</span></a>                <span class="n">left_model_density</span> <span class="o">=</span> <span class="n">left_model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">left_bins</span><span class="p">)</span>
</span><span id="Flexation-1391"><a href="#Flexation-1391"><span class="linenos">1391</span></a>
</span><span id="Flexation-1392"><a href="#Flexation-1392"><span class="linenos">1392</span></a>                <span class="n">right_dfit</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">()</span>
</span><span id="Flexation-1393"><a href="#Flexation-1393"><span class="linenos">1393</span></a>                <span class="n">right_bins</span><span class="p">,</span> <span class="n">right_empiric_density</span> <span class="o">=</span> <span class="n">right_dfit</span><span class="o">.</span><span class="n">density</span><span class="p">(</span>
</span><span id="Flexation-1394"><a href="#Flexation-1394"><span class="linenos">1394</span></a>                    <span class="n">X</span><span class="o">=</span><span class="n">right_set</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">right_set</span><span class="p">)</span>
</span><span id="Flexation-1395"><a href="#Flexation-1395"><span class="linenos">1395</span></a>                <span class="p">)</span>
</span><span id="Flexation-1396"><a href="#Flexation-1396"><span class="linenos">1396</span></a>                <span class="n">right_model_density</span> <span class="o">=</span> <span class="n">right_model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">right_bins</span><span class="p">)</span>
</span><span id="Flexation-1397"><a href="#Flexation-1397"><span class="linenos">1397</span></a>
</span><span id="Flexation-1398"><a href="#Flexation-1398"><span class="linenos">1398</span></a>                <span class="n">left_score_calc</span> <span class="o">=</span> <span class="n">wasserstein_distance</span><span class="p">(</span>
</span><span id="Flexation-1399"><a href="#Flexation-1399"><span class="linenos">1399</span></a>                    <span class="n">left_empiric_density</span><span class="p">,</span> <span class="n">left_model_density</span>
</span><span id="Flexation-1400"><a href="#Flexation-1400"><span class="linenos">1400</span></a>                <span class="p">)</span>
</span><span id="Flexation-1401"><a href="#Flexation-1401"><span class="linenos">1401</span></a>                <span class="n">right_score_calc</span> <span class="o">=</span> <span class="n">wasserstein_distance</span><span class="p">(</span>
</span><span id="Flexation-1402"><a href="#Flexation-1402"><span class="linenos">1402</span></a>                    <span class="n">right_empiric_density</span><span class="p">,</span> <span class="n">right_model_density</span>
</span><span id="Flexation-1403"><a href="#Flexation-1403"><span class="linenos">1403</span></a>                <span class="p">)</span>
</span><span id="Flexation-1404"><a href="#Flexation-1404"><span class="linenos">1404</span></a>
</span><span id="Flexation-1405"><a href="#Flexation-1405"><span class="linenos">1405</span></a>                <span class="n">empiric_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="Flexation-1406"><a href="#Flexation-1406"><span class="linenos">1406</span></a>                    <span class="p">(</span><span class="n">left_empiric_density</span><span class="p">,</span> <span class="n">right_empiric_density</span><span class="p">)</span>
</span><span id="Flexation-1407"><a href="#Flexation-1407"><span class="linenos">1407</span></a>                <span class="p">)</span>
</span><span id="Flexation-1408"><a href="#Flexation-1408"><span class="linenos">1408</span></a>                <span class="n">model_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="Flexation-1409"><a href="#Flexation-1409"><span class="linenos">1409</span></a>                    <span class="p">(</span><span class="n">left_model_density</span><span class="p">,</span> <span class="n">right_model_density</span><span class="p">)</span>
</span><span id="Flexation-1410"><a href="#Flexation-1410"><span class="linenos">1410</span></a>                <span class="p">)</span>
</span><span id="Flexation-1411"><a href="#Flexation-1411"><span class="linenos">1411</span></a>
</span><span id="Flexation-1412"><a href="#Flexation-1412"><span class="linenos">1412</span></a>                <span class="n">overall_score</span> <span class="o">=</span> <span class="n">wasserstein_distance</span><span class="p">(</span><span class="n">empiric_density</span><span class="p">,</span> <span class="n">model_density</span><span class="p">)</span>
</span><span id="Flexation-1413"><a href="#Flexation-1413"><span class="linenos">1413</span></a>
</span><span id="Flexation-1414"><a href="#Flexation-1414"><span class="linenos">1414</span></a>                <span class="n">fitting_results</span> <span class="o">=</span> <span class="n">fitting_results</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span>
</span><span id="Flexation-1415"><a href="#Flexation-1415"><span class="linenos">1415</span></a>                    <span class="p">{</span>
</span><span id="Flexation-1416"><a href="#Flexation-1416"><span class="linenos">1416</span></a>                        <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="n">point</span><span class="p">,</span>  <span class="c1"># flexation point</span>
</span><span id="Flexation-1417"><a href="#Flexation-1417"><span class="linenos">1417</span></a>                        <span class="s2">&quot;left_model&quot;</span><span class="p">:</span> <span class="n">left_model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>  <span class="c1"># left model name</span>
</span><span id="Flexation-1418"><a href="#Flexation-1418"><span class="linenos">1418</span></a>                        <span class="s2">&quot;left_score&quot;</span><span class="p">:</span> <span class="n">left_model</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">)[</span>
</span><span id="Flexation-1419"><a href="#Flexation-1419"><span class="linenos">1419</span></a>                            <span class="s2">&quot;score&quot;</span>
</span><span id="Flexation-1420"><a href="#Flexation-1420"><span class="linenos">1420</span></a>                        <span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span>
</span><span id="Flexation-1421"><a href="#Flexation-1421"><span class="linenos">1421</span></a>                            <span class="mi">0</span>
</span><span id="Flexation-1422"><a href="#Flexation-1422"><span class="linenos">1422</span></a>                        <span class="p">],</span>  <span class="c1"># left model score from distfit</span>
</span><span id="Flexation-1423"><a href="#Flexation-1423"><span class="linenos">1423</span></a>                        <span class="s2">&quot;left_score_calc&quot;</span><span class="p">:</span> <span class="n">left_score_calc</span><span class="p">,</span>  <span class="c1"># left model score from our calc</span>
</span><span id="Flexation-1424"><a href="#Flexation-1424"><span class="linenos">1424</span></a>                        <span class="s2">&quot;right_model&quot;</span><span class="p">:</span> <span class="n">right_model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>  <span class="c1"># right model name</span>
</span><span id="Flexation-1425"><a href="#Flexation-1425"><span class="linenos">1425</span></a>                        <span class="s2">&quot;right_score&quot;</span><span class="p">:</span> <span class="n">right_model</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">)[</span>  <span class="c1"># type: ignore</span>
</span><span id="Flexation-1426"><a href="#Flexation-1426"><span class="linenos">1426</span></a>                            <span class="s2">&quot;score&quot;</span>
</span><span id="Flexation-1427"><a href="#Flexation-1427"><span class="linenos">1427</span></a>                        <span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span>
</span><span id="Flexation-1428"><a href="#Flexation-1428"><span class="linenos">1428</span></a>                            <span class="mi">0</span>
</span><span id="Flexation-1429"><a href="#Flexation-1429"><span class="linenos">1429</span></a>                        <span class="p">],</span>  <span class="c1"># right model score from distfit</span>
</span><span id="Flexation-1430"><a href="#Flexation-1430"><span class="linenos">1430</span></a>                        <span class="s2">&quot;right_score_calc&quot;</span><span class="p">:</span> <span class="n">right_score_calc</span><span class="p">,</span>  <span class="c1"># right model score from our calc</span>
</span><span id="Flexation-1431"><a href="#Flexation-1431"><span class="linenos">1431</span></a>                        <span class="s2">&quot;overall_score&quot;</span><span class="p">:</span> <span class="n">overall_score</span><span class="p">,</span>  <span class="c1"># wasserstein calculated for mix-distribution approach</span>
</span><span id="Flexation-1432"><a href="#Flexation-1432"><span class="linenos">1432</span></a>                    <span class="p">},</span>
</span><span id="Flexation-1433"><a href="#Flexation-1433"><span class="linenos">1433</span></a>                    <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Flexation-1434"><a href="#Flexation-1434"><span class="linenos">1434</span></a>                <span class="p">)</span>
</span><span id="Flexation-1435"><a href="#Flexation-1435"><span class="linenos">1435</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Flexation-1436"><a href="#Flexation-1436"><span class="linenos">1436</span></a>                <span class="k">pass</span>
</span><span id="Flexation-1437"><a href="#Flexation-1437"><span class="linenos">1437</span></a>
</span><span id="Flexation-1438"><a href="#Flexation-1438"><span class="linenos">1438</span></a>        <span class="k">return</span> <span class="n">fitting_results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;right_score&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Flexation-1439"><a href="#Flexation-1439"><span class="linenos">1439</span></a>
</span><span id="Flexation-1440"><a href="#Flexation-1440"><span class="linenos">1440</span></a>
</span><span id="Flexation-1441"><a href="#Flexation-1441"><span class="linenos">1441</span></a>    <span class="k">def</span> <span class="nf">_find_flexation_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="Flexation-1442"><a href="#Flexation-1442"><span class="linenos">1442</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Flexation-1443"><a href="#Flexation-1443"><span class="linenos">1443</span></a><span class="sd">        Identifies flexation points in the given dataset using the</span>
</span><span id="Flexation-1444"><a href="#Flexation-1444"><span class="linenos">1444</span></a><span class="sd">        PELT (Pruned Exact Linear Time) change point detection algorithm.</span>
</span><span id="Flexation-1445"><a href="#Flexation-1445"><span class="linenos">1445</span></a>
</span><span id="Flexation-1446"><a href="#Flexation-1446"><span class="linenos">1446</span></a><span class="sd">        The function applies the Pelt model with an &quot;rbf&quot; cost</span>
</span><span id="Flexation-1447"><a href="#Flexation-1447"><span class="linenos">1447</span></a><span class="sd">        function to detect significant changes in the data distribution.</span>
</span><span id="Flexation-1448"><a href="#Flexation-1448"><span class="linenos">1448</span></a><span class="sd">        A penalty value is used to control the sensitivity of change detection,</span>
</span><span id="Flexation-1449"><a href="#Flexation-1449"><span class="linenos">1449</span></a><span class="sd">        which is calculated using `_calculate_penalty`.</span>
</span><span id="Flexation-1450"><a href="#Flexation-1450"><span class="linenos">1450</span></a>
</span><span id="Flexation-1451"><a href="#Flexation-1451"><span class="linenos">1451</span></a><span class="sd">        Parameters:</span>
</span><span id="Flexation-1452"><a href="#Flexation-1452"><span class="linenos">1452</span></a><span class="sd">        -----------</span>
</span><span id="Flexation-1453"><a href="#Flexation-1453"><span class="linenos">1453</span></a><span class="sd">        data : ndarray</span>
</span><span id="Flexation-1454"><a href="#Flexation-1454"><span class="linenos">1454</span></a><span class="sd">            The numerical dataset in which flexation points (change points)</span>
</span><span id="Flexation-1455"><a href="#Flexation-1455"><span class="linenos">1455</span></a><span class="sd">                are to be found.</span>
</span><span id="Flexation-1456"><a href="#Flexation-1456"><span class="linenos">1456</span></a>
</span><span id="Flexation-1457"><a href="#Flexation-1457"><span class="linenos">1457</span></a><span class="sd">        Returns:</span>
</span><span id="Flexation-1458"><a href="#Flexation-1458"><span class="linenos">1458</span></a><span class="sd">        --------</span>
</span><span id="Flexation-1459"><a href="#Flexation-1459"><span class="linenos">1459</span></a><span class="sd">        list</span>
</span><span id="Flexation-1460"><a href="#Flexation-1460"><span class="linenos">1460</span></a><span class="sd">            A list of detected flexation points, represented as values</span>
</span><span id="Flexation-1461"><a href="#Flexation-1461"><span class="linenos">1461</span></a><span class="sd">                from the dataset.</span>
</span><span id="Flexation-1462"><a href="#Flexation-1462"><span class="linenos">1462</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Flexation-1463"><a href="#Flexation-1463"><span class="linenos">1463</span></a>
</span><span id="Flexation-1464"><a href="#Flexation-1464"><span class="linenos">1464</span></a>        <span class="n">penalty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_penalty</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Flexation-1465"><a href="#Flexation-1465"><span class="linenos">1465</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">rpt</span><span class="o">.</span><span class="n">Pelt</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;rbf&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Flexation-1466"><a href="#Flexation-1466"><span class="linenos">1466</span></a>        <span class="n">break_points_indx</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pen</span><span class="o">=</span><span class="n">penalty</span><span class="p">)</span>
</span><span id="Flexation-1467"><a href="#Flexation-1467"><span class="linenos">1467</span></a>
</span><span id="Flexation-1468"><a href="#Flexation-1468"><span class="linenos">1468</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">break_points_indx</span><span class="p">]</span>
</span><span id="Flexation-1469"><a href="#Flexation-1469"><span class="linenos">1469</span></a>
</span><span id="Flexation-1470"><a href="#Flexation-1470"><span class="linenos">1470</span></a>
</span><span id="Flexation-1471"><a href="#Flexation-1471"><span class="linenos">1471</span></a>    <span class="k">def</span> <span class="nf">find_distributions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">distfit</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">):</span>
</span><span id="Flexation-1472"><a href="#Flexation-1472"><span class="linenos">1472</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Flexation-1473"><a href="#Flexation-1473"><span class="linenos">1473</span></a><span class="sd">        Identifies the best-fitting distributions for segmented parts of the</span>
</span><span id="Flexation-1474"><a href="#Flexation-1474"><span class="linenos">1474</span></a><span class="sd">        dataset based on flexation points.</span>
</span><span id="Flexation-1475"><a href="#Flexation-1475"><span class="linenos">1475</span></a>
</span><span id="Flexation-1476"><a href="#Flexation-1476"><span class="linenos">1476</span></a><span class="sd">        The function detects flexation points in the data, evaluates fitting</span>
</span><span id="Flexation-1477"><a href="#Flexation-1477"><span class="linenos">1477</span></a><span class="sd">        scores, and compares the segmented model&#39;s performance to the main</span>
</span><span id="Flexation-1478"><a href="#Flexation-1478"><span class="linenos">1478</span></a><span class="sd">        model. If a segmented approach improves the fit, it returns the left</span>
</span><span id="Flexation-1479"><a href="#Flexation-1479"><span class="linenos">1479</span></a><span class="sd">        and right distributions along with their respective datasets.</span>
</span><span id="Flexation-1480"><a href="#Flexation-1480"><span class="linenos">1480</span></a>
</span><span id="Flexation-1481"><a href="#Flexation-1481"><span class="linenos">1481</span></a><span class="sd">        Parameters:</span>
</span><span id="Flexation-1482"><a href="#Flexation-1482"><span class="linenos">1482</span></a><span class="sd">        -----------</span>
</span><span id="Flexation-1483"><a href="#Flexation-1483"><span class="linenos">1483</span></a><span class="sd">        model : distfit</span>
</span><span id="Flexation-1484"><a href="#Flexation-1484"><span class="linenos">1484</span></a><span class="sd">            A pre-fitted `distfit` model used as a reference for comparison.</span>
</span><span id="Flexation-1485"><a href="#Flexation-1485"><span class="linenos">1485</span></a><span class="sd">        data : ndarray</span>
</span><span id="Flexation-1486"><a href="#Flexation-1486"><span class="linenos">1486</span></a><span class="sd">            The numerical dataset for which distributions</span>
</span><span id="Flexation-1487"><a href="#Flexation-1487"><span class="linenos">1487</span></a><span class="sd">                are to be identified.</span>
</span><span id="Flexation-1488"><a href="#Flexation-1488"><span class="linenos">1488</span></a>
</span><span id="Flexation-1489"><a href="#Flexation-1489"><span class="linenos">1489</span></a><span class="sd">        Returns:</span>
</span><span id="Flexation-1490"><a href="#Flexation-1490"><span class="linenos">1490</span></a><span class="sd">        --------</span>
</span><span id="Flexation-1491"><a href="#Flexation-1491"><span class="linenos">1491</span></a><span class="sd">        tuple or None</span>
</span><span id="Flexation-1492"><a href="#Flexation-1492"><span class="linenos">1492</span></a><span class="sd">            - If segmentation improves the model fit, returns</span>
</span><span id="Flexation-1493"><a href="#Flexation-1493"><span class="linenos">1493</span></a><span class="sd">                a tuple containing:</span>
</span><span id="Flexation-1494"><a href="#Flexation-1494"><span class="linenos">1494</span></a><span class="sd">                - left_model (distfit): The best-fitting distribution</span>
</span><span id="Flexation-1495"><a href="#Flexation-1495"><span class="linenos">1495</span></a><span class="sd">                    for the left segment.</span>
</span><span id="Flexation-1496"><a href="#Flexation-1496"><span class="linenos">1496</span></a><span class="sd">                - right_model (distfit): The best-fitting distribution</span>
</span><span id="Flexation-1497"><a href="#Flexation-1497"><span class="linenos">1497</span></a><span class="sd">                    for the right segment.</span>
</span><span id="Flexation-1498"><a href="#Flexation-1498"><span class="linenos">1498</span></a><span class="sd">                - left_set (ndarray): The left segment of the data.</span>
</span><span id="Flexation-1499"><a href="#Flexation-1499"><span class="linenos">1499</span></a><span class="sd">                - right_set (ndarray): The right segment of the data.</span>
</span><span id="Flexation-1500"><a href="#Flexation-1500"><span class="linenos">1500</span></a><span class="sd">                - best_point (float): The chosen flexation point that</span>
</span><span id="Flexation-1501"><a href="#Flexation-1501"><span class="linenos">1501</span></a><span class="sd">                    defines segmentation.</span>
</span><span id="Flexation-1502"><a href="#Flexation-1502"><span class="linenos">1502</span></a><span class="sd">            - If no improvement is found, returns `None`.</span>
</span><span id="Flexation-1503"><a href="#Flexation-1503"><span class="linenos">1503</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Flexation-1504"><a href="#Flexation-1504"><span class="linenos">1504</span></a>
</span><span id="Flexation-1505"><a href="#Flexation-1505"><span class="linenos">1505</span></a>        <span class="n">flexation_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_flexation_points</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Flexation-1506"><a href="#Flexation-1506"><span class="linenos">1506</span></a>        <span class="n">fitting_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_mixed_models</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">flexation_points</span><span class="p">)</span>
</span><span id="Flexation-1507"><a href="#Flexation-1507"><span class="linenos">1507</span></a>        <span class="k">if</span> <span class="n">fitting_results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Flexation-1508"><a href="#Flexation-1508"><span class="linenos">1508</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Flexation-1509"><a href="#Flexation-1509"><span class="linenos">1509</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Flexation-1510"><a href="#Flexation-1510"><span class="linenos">1510</span></a>            <span class="n">fitting_score</span> <span class="o">=</span> <span class="n">fitting_results</span><span class="p">[</span><span class="s2">&quot;right_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Flexation-1511"><a href="#Flexation-1511"><span class="linenos">1511</span></a>            <span class="n">best_point</span> <span class="o">=</span> <span class="n">fitting_results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;point&quot;</span><span class="p">]</span>
</span><span id="Flexation-1512"><a href="#Flexation-1512"><span class="linenos">1512</span></a>
</span><span id="Flexation-1513"><a href="#Flexation-1513"><span class="linenos">1513</span></a>            <span class="n">main_model_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_main_model_wasser</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">best_point</span><span class="p">)</span>
</span><span id="Flexation-1514"><a href="#Flexation-1514"><span class="linenos">1514</span></a>
</span><span id="Flexation-1515"><a href="#Flexation-1515"><span class="linenos">1515</span></a>            <span class="k">if</span> <span class="n">main_model_score</span> <span class="o">-</span> <span class="n">fitting_score</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Flexation-1516"><a href="#Flexation-1516"><span class="linenos">1516</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Flexation-1517"><a href="#Flexation-1517"><span class="linenos">1517</span></a>            <span class="k">if</span> <span class="n">main_model_score</span> <span class="o">-</span> <span class="n">fitting_score</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Flexation-1518"><a href="#Flexation-1518"><span class="linenos">1518</span></a>                <span class="n">left_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="n">best_point</span><span class="p">]</span>
</span><span id="Flexation-1519"><a href="#Flexation-1519"><span class="linenos">1519</span></a>                <span class="n">right_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="n">best_point</span><span class="p">]</span>
</span><span id="Flexation-1520"><a href="#Flexation-1520"><span class="linenos">1520</span></a>
</span><span id="Flexation-1521"><a href="#Flexation-1521"><span class="linenos">1521</span></a>                <span class="n">left_model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="Flexation-1522"><a href="#Flexation-1522"><span class="linenos">1522</span></a>                    <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="Flexation-1523"><a href="#Flexation-1523"><span class="linenos">1523</span></a>                        <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="Flexation-1524"><a href="#Flexation-1524"><span class="linenos">1524</span></a>                        <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="Flexation-1525"><a href="#Flexation-1525"><span class="linenos">1525</span></a>                        <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="Flexation-1526"><a href="#Flexation-1526"><span class="linenos">1526</span></a>                        <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="Flexation-1527"><a href="#Flexation-1527"><span class="linenos">1527</span></a>                        <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="Flexation-1528"><a href="#Flexation-1528"><span class="linenos">1528</span></a>                        <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="Flexation-1529"><a href="#Flexation-1529"><span class="linenos">1529</span></a>                        <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="Flexation-1530"><a href="#Flexation-1530"><span class="linenos">1530</span></a>                        <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="Flexation-1531"><a href="#Flexation-1531"><span class="linenos">1531</span></a>                        <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="Flexation-1532"><a href="#Flexation-1532"><span class="linenos">1532</span></a>                        <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="Flexation-1533"><a href="#Flexation-1533"><span class="linenos">1533</span></a>                        <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="Flexation-1534"><a href="#Flexation-1534"><span class="linenos">1534</span></a>                        <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="Flexation-1535"><a href="#Flexation-1535"><span class="linenos">1535</span></a>                        <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="Flexation-1536"><a href="#Flexation-1536"><span class="linenos">1536</span></a>                        <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="Flexation-1537"><a href="#Flexation-1537"><span class="linenos">1537</span></a>                        <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="Flexation-1538"><a href="#Flexation-1538"><span class="linenos">1538</span></a>                    <span class="p">],</span>
</span><span id="Flexation-1539"><a href="#Flexation-1539"><span class="linenos">1539</span></a>                    <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="Flexation-1540"><a href="#Flexation-1540"><span class="linenos">1540</span></a>                <span class="p">)</span>
</span><span id="Flexation-1541"><a href="#Flexation-1541"><span class="linenos">1541</span></a>                <span class="n">right_model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="Flexation-1542"><a href="#Flexation-1542"><span class="linenos">1542</span></a>                    <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="Flexation-1543"><a href="#Flexation-1543"><span class="linenos">1543</span></a>                        <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="Flexation-1544"><a href="#Flexation-1544"><span class="linenos">1544</span></a>                        <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="Flexation-1545"><a href="#Flexation-1545"><span class="linenos">1545</span></a>                        <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="Flexation-1546"><a href="#Flexation-1546"><span class="linenos">1546</span></a>                        <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="Flexation-1547"><a href="#Flexation-1547"><span class="linenos">1547</span></a>                        <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="Flexation-1548"><a href="#Flexation-1548"><span class="linenos">1548</span></a>                        <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="Flexation-1549"><a href="#Flexation-1549"><span class="linenos">1549</span></a>                        <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="Flexation-1550"><a href="#Flexation-1550"><span class="linenos">1550</span></a>                        <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="Flexation-1551"><a href="#Flexation-1551"><span class="linenos">1551</span></a>                        <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="Flexation-1552"><a href="#Flexation-1552"><span class="linenos">1552</span></a>                        <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="Flexation-1553"><a href="#Flexation-1553"><span class="linenos">1553</span></a>                        <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="Flexation-1554"><a href="#Flexation-1554"><span class="linenos">1554</span></a>                        <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="Flexation-1555"><a href="#Flexation-1555"><span class="linenos">1555</span></a>                        <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="Flexation-1556"><a href="#Flexation-1556"><span class="linenos">1556</span></a>                        <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="Flexation-1557"><a href="#Flexation-1557"><span class="linenos">1557</span></a>                        <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="Flexation-1558"><a href="#Flexation-1558"><span class="linenos">1558</span></a>                    <span class="p">],</span>
</span><span id="Flexation-1559"><a href="#Flexation-1559"><span class="linenos">1559</span></a>                    <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="Flexation-1560"><a href="#Flexation-1560"><span class="linenos">1560</span></a>                <span class="p">)</span>
</span><span id="Flexation-1561"><a href="#Flexation-1561"><span class="linenos">1561</span></a>
</span><span id="Flexation-1562"><a href="#Flexation-1562"><span class="linenos">1562</span></a>                <span class="n">left_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">left_set</span><span class="p">)</span>
</span><span id="Flexation-1563"><a href="#Flexation-1563"><span class="linenos">1563</span></a>                <span class="n">right_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">right_set</span><span class="p">)</span>
</span><span id="Flexation-1564"><a href="#Flexation-1564"><span class="linenos">1564</span></a>
</span><span id="Flexation-1565"><a href="#Flexation-1565"><span class="linenos">1565</span></a>                <span class="k">return</span> <span class="n">left_model</span><span class="p">,</span> <span class="n">right_model</span><span class="p">,</span> <span class="n">left_set</span><span class="p">,</span> <span class="n">right_set</span><span class="p">,</span> <span class="n">best_point</span>
</span></pre></div>


            <div class="docstring"><p>A class used for identifying and fitting statistical distributions to
segmented data based on flexation points.</p>

<p>Flexation points are identified using the PELT (Pruned Exact Linear Time)
change point detection algorithm. Once flexation points are detected,
the data is split into left and right segments, and statistical models
are fitted to each segment. The goodness of fit is evaluated using
the Wasserstein distance between the empirical density and the fitted
model.</p>

<h2 id="attributes">Attributes:</h2>

<p>None</p>
</div>


                            <div id="Flexation.find_distributions" class="classattr">
                                        <input id="Flexation.find_distributions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">find_distributions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span><span class="p">:</span> <span class="n">distfit</span><span class="o">.</span><span class="n">distfit</span><span class="o">.</span><span class="n">distfit</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Flexation.find_distributions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Flexation.find_distributions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Flexation.find_distributions-1471"><a href="#Flexation.find_distributions-1471"><span class="linenos">1471</span></a>    <span class="k">def</span> <span class="nf">find_distributions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">distfit</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">):</span>
</span><span id="Flexation.find_distributions-1472"><a href="#Flexation.find_distributions-1472"><span class="linenos">1472</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Flexation.find_distributions-1473"><a href="#Flexation.find_distributions-1473"><span class="linenos">1473</span></a><span class="sd">        Identifies the best-fitting distributions for segmented parts of the</span>
</span><span id="Flexation.find_distributions-1474"><a href="#Flexation.find_distributions-1474"><span class="linenos">1474</span></a><span class="sd">        dataset based on flexation points.</span>
</span><span id="Flexation.find_distributions-1475"><a href="#Flexation.find_distributions-1475"><span class="linenos">1475</span></a>
</span><span id="Flexation.find_distributions-1476"><a href="#Flexation.find_distributions-1476"><span class="linenos">1476</span></a><span class="sd">        The function detects flexation points in the data, evaluates fitting</span>
</span><span id="Flexation.find_distributions-1477"><a href="#Flexation.find_distributions-1477"><span class="linenos">1477</span></a><span class="sd">        scores, and compares the segmented model&#39;s performance to the main</span>
</span><span id="Flexation.find_distributions-1478"><a href="#Flexation.find_distributions-1478"><span class="linenos">1478</span></a><span class="sd">        model. If a segmented approach improves the fit, it returns the left</span>
</span><span id="Flexation.find_distributions-1479"><a href="#Flexation.find_distributions-1479"><span class="linenos">1479</span></a><span class="sd">        and right distributions along with their respective datasets.</span>
</span><span id="Flexation.find_distributions-1480"><a href="#Flexation.find_distributions-1480"><span class="linenos">1480</span></a>
</span><span id="Flexation.find_distributions-1481"><a href="#Flexation.find_distributions-1481"><span class="linenos">1481</span></a><span class="sd">        Parameters:</span>
</span><span id="Flexation.find_distributions-1482"><a href="#Flexation.find_distributions-1482"><span class="linenos">1482</span></a><span class="sd">        -----------</span>
</span><span id="Flexation.find_distributions-1483"><a href="#Flexation.find_distributions-1483"><span class="linenos">1483</span></a><span class="sd">        model : distfit</span>
</span><span id="Flexation.find_distributions-1484"><a href="#Flexation.find_distributions-1484"><span class="linenos">1484</span></a><span class="sd">            A pre-fitted `distfit` model used as a reference for comparison.</span>
</span><span id="Flexation.find_distributions-1485"><a href="#Flexation.find_distributions-1485"><span class="linenos">1485</span></a><span class="sd">        data : ndarray</span>
</span><span id="Flexation.find_distributions-1486"><a href="#Flexation.find_distributions-1486"><span class="linenos">1486</span></a><span class="sd">            The numerical dataset for which distributions</span>
</span><span id="Flexation.find_distributions-1487"><a href="#Flexation.find_distributions-1487"><span class="linenos">1487</span></a><span class="sd">                are to be identified.</span>
</span><span id="Flexation.find_distributions-1488"><a href="#Flexation.find_distributions-1488"><span class="linenos">1488</span></a>
</span><span id="Flexation.find_distributions-1489"><a href="#Flexation.find_distributions-1489"><span class="linenos">1489</span></a><span class="sd">        Returns:</span>
</span><span id="Flexation.find_distributions-1490"><a href="#Flexation.find_distributions-1490"><span class="linenos">1490</span></a><span class="sd">        --------</span>
</span><span id="Flexation.find_distributions-1491"><a href="#Flexation.find_distributions-1491"><span class="linenos">1491</span></a><span class="sd">        tuple or None</span>
</span><span id="Flexation.find_distributions-1492"><a href="#Flexation.find_distributions-1492"><span class="linenos">1492</span></a><span class="sd">            - If segmentation improves the model fit, returns</span>
</span><span id="Flexation.find_distributions-1493"><a href="#Flexation.find_distributions-1493"><span class="linenos">1493</span></a><span class="sd">                a tuple containing:</span>
</span><span id="Flexation.find_distributions-1494"><a href="#Flexation.find_distributions-1494"><span class="linenos">1494</span></a><span class="sd">                - left_model (distfit): The best-fitting distribution</span>
</span><span id="Flexation.find_distributions-1495"><a href="#Flexation.find_distributions-1495"><span class="linenos">1495</span></a><span class="sd">                    for the left segment.</span>
</span><span id="Flexation.find_distributions-1496"><a href="#Flexation.find_distributions-1496"><span class="linenos">1496</span></a><span class="sd">                - right_model (distfit): The best-fitting distribution</span>
</span><span id="Flexation.find_distributions-1497"><a href="#Flexation.find_distributions-1497"><span class="linenos">1497</span></a><span class="sd">                    for the right segment.</span>
</span><span id="Flexation.find_distributions-1498"><a href="#Flexation.find_distributions-1498"><span class="linenos">1498</span></a><span class="sd">                - left_set (ndarray): The left segment of the data.</span>
</span><span id="Flexation.find_distributions-1499"><a href="#Flexation.find_distributions-1499"><span class="linenos">1499</span></a><span class="sd">                - right_set (ndarray): The right segment of the data.</span>
</span><span id="Flexation.find_distributions-1500"><a href="#Flexation.find_distributions-1500"><span class="linenos">1500</span></a><span class="sd">                - best_point (float): The chosen flexation point that</span>
</span><span id="Flexation.find_distributions-1501"><a href="#Flexation.find_distributions-1501"><span class="linenos">1501</span></a><span class="sd">                    defines segmentation.</span>
</span><span id="Flexation.find_distributions-1502"><a href="#Flexation.find_distributions-1502"><span class="linenos">1502</span></a><span class="sd">            - If no improvement is found, returns `None`.</span>
</span><span id="Flexation.find_distributions-1503"><a href="#Flexation.find_distributions-1503"><span class="linenos">1503</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Flexation.find_distributions-1504"><a href="#Flexation.find_distributions-1504"><span class="linenos">1504</span></a>
</span><span id="Flexation.find_distributions-1505"><a href="#Flexation.find_distributions-1505"><span class="linenos">1505</span></a>        <span class="n">flexation_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_flexation_points</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Flexation.find_distributions-1506"><a href="#Flexation.find_distributions-1506"><span class="linenos">1506</span></a>        <span class="n">fitting_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_mixed_models</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">flexation_points</span><span class="p">)</span>
</span><span id="Flexation.find_distributions-1507"><a href="#Flexation.find_distributions-1507"><span class="linenos">1507</span></a>        <span class="k">if</span> <span class="n">fitting_results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Flexation.find_distributions-1508"><a href="#Flexation.find_distributions-1508"><span class="linenos">1508</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Flexation.find_distributions-1509"><a href="#Flexation.find_distributions-1509"><span class="linenos">1509</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Flexation.find_distributions-1510"><a href="#Flexation.find_distributions-1510"><span class="linenos">1510</span></a>            <span class="n">fitting_score</span> <span class="o">=</span> <span class="n">fitting_results</span><span class="p">[</span><span class="s2">&quot;right_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Flexation.find_distributions-1511"><a href="#Flexation.find_distributions-1511"><span class="linenos">1511</span></a>            <span class="n">best_point</span> <span class="o">=</span> <span class="n">fitting_results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;point&quot;</span><span class="p">]</span>
</span><span id="Flexation.find_distributions-1512"><a href="#Flexation.find_distributions-1512"><span class="linenos">1512</span></a>
</span><span id="Flexation.find_distributions-1513"><a href="#Flexation.find_distributions-1513"><span class="linenos">1513</span></a>            <span class="n">main_model_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_main_model_wasser</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">best_point</span><span class="p">)</span>
</span><span id="Flexation.find_distributions-1514"><a href="#Flexation.find_distributions-1514"><span class="linenos">1514</span></a>
</span><span id="Flexation.find_distributions-1515"><a href="#Flexation.find_distributions-1515"><span class="linenos">1515</span></a>            <span class="k">if</span> <span class="n">main_model_score</span> <span class="o">-</span> <span class="n">fitting_score</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Flexation.find_distributions-1516"><a href="#Flexation.find_distributions-1516"><span class="linenos">1516</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Flexation.find_distributions-1517"><a href="#Flexation.find_distributions-1517"><span class="linenos">1517</span></a>            <span class="k">if</span> <span class="n">main_model_score</span> <span class="o">-</span> <span class="n">fitting_score</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Flexation.find_distributions-1518"><a href="#Flexation.find_distributions-1518"><span class="linenos">1518</span></a>                <span class="n">left_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="n">best_point</span><span class="p">]</span>
</span><span id="Flexation.find_distributions-1519"><a href="#Flexation.find_distributions-1519"><span class="linenos">1519</span></a>                <span class="n">right_set</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="n">best_point</span><span class="p">]</span>
</span><span id="Flexation.find_distributions-1520"><a href="#Flexation.find_distributions-1520"><span class="linenos">1520</span></a>
</span><span id="Flexation.find_distributions-1521"><a href="#Flexation.find_distributions-1521"><span class="linenos">1521</span></a>                <span class="n">left_model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="Flexation.find_distributions-1522"><a href="#Flexation.find_distributions-1522"><span class="linenos">1522</span></a>                    <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="Flexation.find_distributions-1523"><a href="#Flexation.find_distributions-1523"><span class="linenos">1523</span></a>                        <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1524"><a href="#Flexation.find_distributions-1524"><span class="linenos">1524</span></a>                        <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1525"><a href="#Flexation.find_distributions-1525"><span class="linenos">1525</span></a>                        <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1526"><a href="#Flexation.find_distributions-1526"><span class="linenos">1526</span></a>                        <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1527"><a href="#Flexation.find_distributions-1527"><span class="linenos">1527</span></a>                        <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1528"><a href="#Flexation.find_distributions-1528"><span class="linenos">1528</span></a>                        <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1529"><a href="#Flexation.find_distributions-1529"><span class="linenos">1529</span></a>                        <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1530"><a href="#Flexation.find_distributions-1530"><span class="linenos">1530</span></a>                        <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1531"><a href="#Flexation.find_distributions-1531"><span class="linenos">1531</span></a>                        <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1532"><a href="#Flexation.find_distributions-1532"><span class="linenos">1532</span></a>                        <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1533"><a href="#Flexation.find_distributions-1533"><span class="linenos">1533</span></a>                        <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1534"><a href="#Flexation.find_distributions-1534"><span class="linenos">1534</span></a>                        <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1535"><a href="#Flexation.find_distributions-1535"><span class="linenos">1535</span></a>                        <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1536"><a href="#Flexation.find_distributions-1536"><span class="linenos">1536</span></a>                        <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1537"><a href="#Flexation.find_distributions-1537"><span class="linenos">1537</span></a>                        <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1538"><a href="#Flexation.find_distributions-1538"><span class="linenos">1538</span></a>                    <span class="p">],</span>
</span><span id="Flexation.find_distributions-1539"><a href="#Flexation.find_distributions-1539"><span class="linenos">1539</span></a>                    <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1540"><a href="#Flexation.find_distributions-1540"><span class="linenos">1540</span></a>                <span class="p">)</span>
</span><span id="Flexation.find_distributions-1541"><a href="#Flexation.find_distributions-1541"><span class="linenos">1541</span></a>                <span class="n">right_model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="Flexation.find_distributions-1542"><a href="#Flexation.find_distributions-1542"><span class="linenos">1542</span></a>                    <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="Flexation.find_distributions-1543"><a href="#Flexation.find_distributions-1543"><span class="linenos">1543</span></a>                        <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1544"><a href="#Flexation.find_distributions-1544"><span class="linenos">1544</span></a>                        <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1545"><a href="#Flexation.find_distributions-1545"><span class="linenos">1545</span></a>                        <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1546"><a href="#Flexation.find_distributions-1546"><span class="linenos">1546</span></a>                        <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1547"><a href="#Flexation.find_distributions-1547"><span class="linenos">1547</span></a>                        <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1548"><a href="#Flexation.find_distributions-1548"><span class="linenos">1548</span></a>                        <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1549"><a href="#Flexation.find_distributions-1549"><span class="linenos">1549</span></a>                        <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1550"><a href="#Flexation.find_distributions-1550"><span class="linenos">1550</span></a>                        <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1551"><a href="#Flexation.find_distributions-1551"><span class="linenos">1551</span></a>                        <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1552"><a href="#Flexation.find_distributions-1552"><span class="linenos">1552</span></a>                        <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1553"><a href="#Flexation.find_distributions-1553"><span class="linenos">1553</span></a>                        <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1554"><a href="#Flexation.find_distributions-1554"><span class="linenos">1554</span></a>                        <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1555"><a href="#Flexation.find_distributions-1555"><span class="linenos">1555</span></a>                        <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1556"><a href="#Flexation.find_distributions-1556"><span class="linenos">1556</span></a>                        <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1557"><a href="#Flexation.find_distributions-1557"><span class="linenos">1557</span></a>                        <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1558"><a href="#Flexation.find_distributions-1558"><span class="linenos">1558</span></a>                    <span class="p">],</span>
</span><span id="Flexation.find_distributions-1559"><a href="#Flexation.find_distributions-1559"><span class="linenos">1559</span></a>                    <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="Flexation.find_distributions-1560"><a href="#Flexation.find_distributions-1560"><span class="linenos">1560</span></a>                <span class="p">)</span>
</span><span id="Flexation.find_distributions-1561"><a href="#Flexation.find_distributions-1561"><span class="linenos">1561</span></a>
</span><span id="Flexation.find_distributions-1562"><a href="#Flexation.find_distributions-1562"><span class="linenos">1562</span></a>                <span class="n">left_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">left_set</span><span class="p">)</span>
</span><span id="Flexation.find_distributions-1563"><a href="#Flexation.find_distributions-1563"><span class="linenos">1563</span></a>                <span class="n">right_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">right_set</span><span class="p">)</span>
</span><span id="Flexation.find_distributions-1564"><a href="#Flexation.find_distributions-1564"><span class="linenos">1564</span></a>
</span><span id="Flexation.find_distributions-1565"><a href="#Flexation.find_distributions-1565"><span class="linenos">1565</span></a>                <span class="k">return</span> <span class="n">left_model</span><span class="p">,</span> <span class="n">right_model</span><span class="p">,</span> <span class="n">left_set</span><span class="p">,</span> <span class="n">right_set</span><span class="p">,</span> <span class="n">best_point</span>
</span></pre></div>


            <div class="docstring"><p>Identifies the best-fitting distributions for segmented parts of the
dataset based on flexation points.</p>

<p>The function detects flexation points in the data, evaluates fitting
scores, and compares the segmented model's performance to the main
model. If a segmented approach improves the fit, it returns the left
and right distributions along with their respective datasets.</p>

<h2 id="parameters">Parameters:</h2>

<p>model : distfit
    A pre-fitted <code>distfit</code> model used as a reference for comparison.
data : ndarray
    The numerical dataset for which distributions
        are to be identified.</p>

<h2 id="returns">Returns:</h2>

<p>tuple or None
    - If segmentation improves the model fit, returns
        a tuple containing:
        - left_model (distfit): The best-fitting distribution
            for the left segment.
        - right_model (distfit): The best-fitting distribution
            for the right segment.
        - left_set (ndarray): The left segment of the data.
        - right_set (ndarray): The right segment of the data.
        - best_point (float): The chosen flexation point that
            defines segmentation.
    - If no improvement is found, returns <code>None</code>.</p>
</div>


                            </div>
                </section>
                <section id="Laws">
                            <input id="Laws-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Laws</span>:

                <label class="view-source-button" for="Laws-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws-1569"><a href="#Laws-1569"><span class="linenos">1569</span></a><span class="k">class</span> <span class="nc">Laws</span><span class="p">:</span>
</span><span id="Laws-1570"><a href="#Laws-1570"><span class="linenos">1570</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-1571"><a href="#Laws-1571"><span class="linenos">1571</span></a><span class="sd">    A class for handling statistical data analysis and generating</span>
</span><span id="Laws-1572"><a href="#Laws-1572"><span class="linenos">1572</span></a><span class="sd">    reports in PDF format.</span>
</span><span id="Laws-1573"><a href="#Laws-1573"><span class="linenos">1573</span></a>
</span><span id="Laws-1574"><a href="#Laws-1574"><span class="linenos">1574</span></a><span class="sd">    This class takes in a dataset, performs statistical analysis,</span>
</span><span id="Laws-1575"><a href="#Laws-1575"><span class="linenos">1575</span></a><span class="sd">    applies curve fitting techniques, and generates a PDF report</span>
</span><span id="Laws-1576"><a href="#Laws-1576"><span class="linenos">1576</span></a><span class="sd">    summarizing the results.</span>
</span><span id="Laws-1577"><a href="#Laws-1577"><span class="linenos">1577</span></a>
</span><span id="Laws-1578"><a href="#Laws-1578"><span class="linenos">1578</span></a><span class="sd">    Parameters:</span>
</span><span id="Laws-1579"><a href="#Laws-1579"><span class="linenos">1579</span></a><span class="sd">    -----------</span>
</span><span id="Laws-1580"><a href="#Laws-1580"><span class="linenos">1580</span></a><span class="sd">    pdf_object : FPDF</span>
</span><span id="Laws-1581"><a href="#Laws-1581"><span class="linenos">1581</span></a><span class="sd">        An instance of the `FPDF` class used for generating the</span>
</span><span id="Laws-1582"><a href="#Laws-1582"><span class="linenos">1582</span></a><span class="sd">            PDF report.</span>
</span><span id="Laws-1583"><a href="#Laws-1583"><span class="linenos">1583</span></a><span class="sd">    stats_frame : DataSetStats</span>
</span><span id="Laws-1584"><a href="#Laws-1584"><span class="linenos">1584</span></a><span class="sd">        An instance of `DataSetStats` containing statistical</span>
</span><span id="Laws-1585"><a href="#Laws-1585"><span class="linenos">1585</span></a><span class="sd">            information about the dataset.</span>
</span><span id="Laws-1586"><a href="#Laws-1586"><span class="linenos">1586</span></a><span class="sd">    output_path : str</span>
</span><span id="Laws-1587"><a href="#Laws-1587"><span class="linenos">1587</span></a><span class="sd">        The file path where the generated PDF report will be saved.</span>
</span><span id="Laws-1588"><a href="#Laws-1588"><span class="linenos">1588</span></a>
</span><span id="Laws-1589"><a href="#Laws-1589"><span class="linenos">1589</span></a><span class="sd">    Attributes:</span>
</span><span id="Laws-1590"><a href="#Laws-1590"><span class="linenos">1590</span></a><span class="sd">    -----------</span>
</span><span id="Laws-1591"><a href="#Laws-1591"><span class="linenos">1591</span></a><span class="sd">    pdf_object : FPDF</span>
</span><span id="Laws-1592"><a href="#Laws-1592"><span class="linenos">1592</span></a><span class="sd">        The PDF object used for report generation.</span>
</span><span id="Laws-1593"><a href="#Laws-1593"><span class="linenos">1593</span></a><span class="sd">    output_path : str</span>
</span><span id="Laws-1594"><a href="#Laws-1594"><span class="linenos">1594</span></a><span class="sd">        The location where the final report will be stored.</span>
</span><span id="Laws-1595"><a href="#Laws-1595"><span class="linenos">1595</span></a><span class="sd">    stats_frame : DataSetStats</span>
</span><span id="Laws-1596"><a href="#Laws-1596"><span class="linenos">1596</span></a><span class="sd">        The dataset statistics object containing calculated metrics.</span>
</span><span id="Laws-1597"><a href="#Laws-1597"><span class="linenos">1597</span></a><span class="sd">    curve_fitting : DistributionFitingTools</span>
</span><span id="Laws-1598"><a href="#Laws-1598"><span class="linenos">1598</span></a><span class="sd">        A toolset for fitting distributions to the dataset.</span>
</span><span id="Laws-1599"><a href="#Laws-1599"><span class="linenos">1599</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Laws-1600"><a href="#Laws-1600"><span class="linenos">1600</span></a>
</span><span id="Laws-1601"><a href="#Laws-1601"><span class="linenos">1601</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Laws-1602"><a href="#Laws-1602"><span class="linenos">1602</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="Laws-1603"><a href="#Laws-1603"><span class="linenos">1603</span></a>            <span class="n">pdf_object</span><span class="p">:</span> <span class="n">FPDF</span><span class="p">,</span>
</span><span id="Laws-1604"><a href="#Laws-1604"><span class="linenos">1604</span></a>            <span class="n">stats_frame</span><span class="p">:</span> <span class="n">DataSetStats</span><span class="p">,</span>
</span><span id="Laws-1605"><a href="#Laws-1605"><span class="linenos">1605</span></a>            <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="Laws-1606"><a href="#Laws-1606"><span class="linenos">1606</span></a>        <span class="p">):</span>
</span><span id="Laws-1607"><a href="#Laws-1607"><span class="linenos">1607</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-1608"><a href="#Laws-1608"><span class="linenos">1608</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-1609"><a href="#Laws-1609"><span class="linenos">1609</span></a><span class="sd">        -----------</span>
</span><span id="Laws-1610"><a href="#Laws-1610"><span class="linenos">1610</span></a><span class="sd">        pdf_object : FPDF</span>
</span><span id="Laws-1611"><a href="#Laws-1611"><span class="linenos">1611</span></a><span class="sd">            An instance of the `FPDF` class used for generating the</span>
</span><span id="Laws-1612"><a href="#Laws-1612"><span class="linenos">1612</span></a><span class="sd">                PDF report.</span>
</span><span id="Laws-1613"><a href="#Laws-1613"><span class="linenos">1613</span></a><span class="sd">        stats_frame : DataSetStats</span>
</span><span id="Laws-1614"><a href="#Laws-1614"><span class="linenos">1614</span></a><span class="sd">            An instance of `DataSetStats` containing statistical</span>
</span><span id="Laws-1615"><a href="#Laws-1615"><span class="linenos">1615</span></a><span class="sd">                information about the dataset.</span>
</span><span id="Laws-1616"><a href="#Laws-1616"><span class="linenos">1616</span></a><span class="sd">        output_path : str</span>
</span><span id="Laws-1617"><a href="#Laws-1617"><span class="linenos">1617</span></a><span class="sd">            The file path where the generated PDF report will be saved.</span>
</span><span id="Laws-1618"><a href="#Laws-1618"><span class="linenos">1618</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-1619"><a href="#Laws-1619"><span class="linenos">1619</span></a>
</span><span id="Laws-1620"><a href="#Laws-1620"><span class="linenos">1620</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span> <span class="o">=</span> <span class="n">pdf_object</span>
</span><span id="Laws-1621"><a href="#Laws-1621"><span class="linenos">1621</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span> <span class="o">=</span> <span class="n">output_path</span>
</span><span id="Laws-1622"><a href="#Laws-1622"><span class="linenos">1622</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span> <span class="o">=</span> <span class="n">stats_frame</span>
</span><span id="Laws-1623"><a href="#Laws-1623"><span class="linenos">1623</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">curve_fitting</span> <span class="o">=</span> <span class="n">DistributionFitingTools</span><span class="p">()</span>
</span><span id="Laws-1624"><a href="#Laws-1624"><span class="linenos">1624</span></a>
</span><span id="Laws-1625"><a href="#Laws-1625"><span class="linenos">1625</span></a>    <span class="k">def</span> <span class="nf">_add_pdf_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">txt_to_add</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Laws-1626"><a href="#Laws-1626"><span class="linenos">1626</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-1627"><a href="#Laws-1627"><span class="linenos">1627</span></a><span class="sd">        Add a single line of text to the PDF.</span>
</span><span id="Laws-1628"><a href="#Laws-1628"><span class="linenos">1628</span></a>
</span><span id="Laws-1629"><a href="#Laws-1629"><span class="linenos">1629</span></a><span class="sd">        Parameters</span>
</span><span id="Laws-1630"><a href="#Laws-1630"><span class="linenos">1630</span></a><span class="sd">        ----------</span>
</span><span id="Laws-1631"><a href="#Laws-1631"><span class="linenos">1631</span></a><span class="sd">        txt_to_add : str</span>
</span><span id="Laws-1632"><a href="#Laws-1632"><span class="linenos">1632</span></a><span class="sd">            Text to be added to the PDF document.</span>
</span><span id="Laws-1633"><a href="#Laws-1633"><span class="linenos">1633</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-1634"><a href="#Laws-1634"><span class="linenos">1634</span></a>
</span><span id="Laws-1635"><a href="#Laws-1635"><span class="linenos">1635</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">txt_to_add</span><span class="p">,</span> <span class="n">ln</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">)</span>
</span><span id="Laws-1636"><a href="#Laws-1636"><span class="linenos">1636</span></a>
</span><span id="Laws-1637"><a href="#Laws-1637"><span class="linenos">1637</span></a>
</span><span id="Laws-1638"><a href="#Laws-1638"><span class="linenos">1638</span></a>    <span class="k">def</span> <span class="nf">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws-1639"><a href="#Laws-1639"><span class="linenos">1639</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Laws-1640"><a href="#Laws-1640"><span class="linenos">1640</span></a>        <span class="n">plot_obj</span><span class="p">:</span> <span class="n">BytesIO</span><span class="p">,</span>
</span><span id="Laws-1641"><a href="#Laws-1641"><span class="linenos">1641</span></a>        <span class="n">image_width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Laws-1642"><a href="#Laws-1642"><span class="linenos">1642</span></a>        <span class="n">image_height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Laws-1643"><a href="#Laws-1643"><span class="linenos">1643</span></a>        <span class="n">x_position</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="Laws-1644"><a href="#Laws-1644"><span class="linenos">1644</span></a>        <span class="n">y_position</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Laws-1645"><a href="#Laws-1645"><span class="linenos">1645</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Laws-1646"><a href="#Laws-1646"><span class="linenos">1646</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-1647"><a href="#Laws-1647"><span class="linenos">1647</span></a><span class="sd">        Add a plot to the PDF.</span>
</span><span id="Laws-1648"><a href="#Laws-1648"><span class="linenos">1648</span></a>
</span><span id="Laws-1649"><a href="#Laws-1649"><span class="linenos">1649</span></a><span class="sd">        Parameters</span>
</span><span id="Laws-1650"><a href="#Laws-1650"><span class="linenos">1650</span></a><span class="sd">        ----------</span>
</span><span id="Laws-1651"><a href="#Laws-1651"><span class="linenos">1651</span></a><span class="sd">        plot_obj : BytesIO</span>
</span><span id="Laws-1652"><a href="#Laws-1652"><span class="linenos">1652</span></a><span class="sd">            A BytesIO object containing the plot image.</span>
</span><span id="Laws-1653"><a href="#Laws-1653"><span class="linenos">1653</span></a><span class="sd">        image_width : int</span>
</span><span id="Laws-1654"><a href="#Laws-1654"><span class="linenos">1654</span></a><span class="sd">            Width of the plot in the PDF.</span>
</span><span id="Laws-1655"><a href="#Laws-1655"><span class="linenos">1655</span></a><span class="sd">        image_height : int</span>
</span><span id="Laws-1656"><a href="#Laws-1656"><span class="linenos">1656</span></a><span class="sd">            Height of the plot in the PDF.</span>
</span><span id="Laws-1657"><a href="#Laws-1657"><span class="linenos">1657</span></a><span class="sd">        x_position : int, optional</span>
</span><span id="Laws-1658"><a href="#Laws-1658"><span class="linenos">1658</span></a><span class="sd">            X-coordinate position of the plot, by default 10.</span>
</span><span id="Laws-1659"><a href="#Laws-1659"><span class="linenos">1659</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-1660"><a href="#Laws-1660"><span class="linenos">1660</span></a>
</span><span id="Laws-1661"><a href="#Laws-1661"><span class="linenos">1661</span></a>        <span class="k">if</span> <span class="n">y_position</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Laws-1662"><a href="#Laws-1662"><span class="linenos">1662</span></a>            <span class="n">y_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span>
</span><span id="Laws-1663"><a href="#Laws-1663"><span class="linenos">1663</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Laws-1664"><a href="#Laws-1664"><span class="linenos">1664</span></a>            <span class="n">y_position</span> <span class="o">=</span> <span class="n">y_position</span>
</span><span id="Laws-1665"><a href="#Laws-1665"><span class="linenos">1665</span></a>
</span><span id="Laws-1666"><a href="#Laws-1666"><span class="linenos">1666</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Laws-1667"><a href="#Laws-1667"><span class="linenos">1667</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">image</span><span class="p">(</span>
</span><span id="Laws-1668"><a href="#Laws-1668"><span class="linenos">1668</span></a>                <span class="n">plot_obj</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x_position</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_position</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">image_width</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">image_height</span>
</span><span id="Laws-1669"><a href="#Laws-1669"><span class="linenos">1669</span></a>            <span class="p">)</span>
</span><span id="Laws-1670"><a href="#Laws-1670"><span class="linenos">1670</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_y</span><span class="p">(</span><span class="n">y_position</span> <span class="o">+</span> <span class="n">image_height</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="Laws-1671"><a href="#Laws-1671"><span class="linenos">1671</span></a>            <span class="n">plot_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Laws-1672"><a href="#Laws-1672"><span class="linenos">1672</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Laws-1673"><a href="#Laws-1673"><span class="linenos">1673</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to add plot to PDF: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws-1674"><a href="#Laws-1674"><span class="linenos">1674</span></a>
</span><span id="Laws-1675"><a href="#Laws-1675"><span class="linenos">1675</span></a>
</span><span id="Laws-1676"><a href="#Laws-1676"><span class="linenos">1676</span></a>    <span class="k">def</span> <span class="nf">_add_pdf_curves_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Laws-1677"><a href="#Laws-1677"><span class="linenos">1677</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-1678"><a href="#Laws-1678"><span class="linenos">1678</span></a><span class="sd">        Adds a table to the PDF summarizing fitted curve parameters.</span>
</span><span id="Laws-1679"><a href="#Laws-1679"><span class="linenos">1679</span></a>
</span><span id="Laws-1680"><a href="#Laws-1680"><span class="linenos">1680</span></a><span class="sd">        The table includes curve names, their weights, and parameters.</span>
</span><span id="Laws-1681"><a href="#Laws-1681"><span class="linenos">1681</span></a>
</span><span id="Laws-1682"><a href="#Laws-1682"><span class="linenos">1682</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-1683"><a href="#Laws-1683"><span class="linenos">1683</span></a><span class="sd">        -----------</span>
</span><span id="Laws-1684"><a href="#Laws-1684"><span class="linenos">1684</span></a><span class="sd">        data : pd.DataFrame</span>
</span><span id="Laws-1685"><a href="#Laws-1685"><span class="linenos">1685</span></a><span class="sd">            A DataFrame containing the curve fitting results with columns:</span>
</span><span id="Laws-1686"><a href="#Laws-1686"><span class="linenos">1686</span></a><span class="sd">            - &quot;curve&quot; (str): Name of the fitted curve.</span>
</span><span id="Laws-1687"><a href="#Laws-1687"><span class="linenos">1687</span></a><span class="sd">            - &quot;weight&quot; (float): Weight assigned to the curve.</span>
</span><span id="Laws-1688"><a href="#Laws-1688"><span class="linenos">1688</span></a><span class="sd">            - &quot;param1&quot; (float): First parameter of the curve.</span>
</span><span id="Laws-1689"><a href="#Laws-1689"><span class="linenos">1689</span></a><span class="sd">            - &quot;param2&quot; (float): Second parameter of the curve.</span>
</span><span id="Laws-1690"><a href="#Laws-1690"><span class="linenos">1690</span></a><span class="sd">        x_offset : int, optional</span>
</span><span id="Laws-1691"><a href="#Laws-1691"><span class="linenos">1691</span></a><span class="sd">            The horizontal offset for table placement in the PDF</span>
</span><span id="Laws-1692"><a href="#Laws-1692"><span class="linenos">1692</span></a><span class="sd">                (default is 10).</span>
</span><span id="Laws-1693"><a href="#Laws-1693"><span class="linenos">1693</span></a><span class="sd">        y_offset : int, optional</span>
</span><span id="Laws-1694"><a href="#Laws-1694"><span class="linenos">1694</span></a><span class="sd">            The vertical offset for table placement. If None,</span>
</span><span id="Laws-1695"><a href="#Laws-1695"><span class="linenos">1695</span></a><span class="sd">                it uses the current Y position.</span>
</span><span id="Laws-1696"><a href="#Laws-1696"><span class="linenos">1696</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-1697"><a href="#Laws-1697"><span class="linenos">1697</span></a>
</span><span id="Laws-1698"><a href="#Laws-1698"><span class="linenos">1698</span></a>        <span class="k">if</span> <span class="n">y_offset</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Laws-1699"><a href="#Laws-1699"><span class="linenos">1699</span></a>            <span class="n">y_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span>
</span><span id="Laws-1700"><a href="#Laws-1700"><span class="linenos">1700</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Laws-1701"><a href="#Laws-1701"><span class="linenos">1701</span></a>            <span class="n">y_offset</span> <span class="o">=</span> <span class="n">y_offset</span>
</span><span id="Laws-1702"><a href="#Laws-1702"><span class="linenos">1702</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">)</span>
</span><span id="Laws-1703"><a href="#Laws-1703"><span class="linenos">1703</span></a>
</span><span id="Laws-1704"><a href="#Laws-1704"><span class="linenos">1704</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws-1705"><a href="#Laws-1705"><span class="linenos">1705</span></a>        <span class="n">col_width</span> <span class="o">=</span> <span class="mi">25</span>
</span><span id="Laws-1706"><a href="#Laws-1706"><span class="linenos">1706</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span><span id="Laws-1707"><a href="#Laws-1707"><span class="linenos">1707</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Curve&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1708"><a href="#Laws-1708"><span class="linenos">1708</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Weight&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1709"><a href="#Laws-1709"><span class="linenos">1709</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Param 1&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1710"><a href="#Laws-1710"><span class="linenos">1710</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Param 2&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1711"><a href="#Laws-1711"><span class="linenos">1711</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="Laws-1712"><a href="#Laws-1712"><span class="linenos">1712</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span><span id="Laws-1713"><a href="#Laws-1713"><span class="linenos">1713</span></a>
</span><span id="Laws-1714"><a href="#Laws-1714"><span class="linenos">1714</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Laws-1715"><a href="#Laws-1715"><span class="linenos">1715</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">],</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1716"><a href="#Laws-1716"><span class="linenos">1716</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="Laws-1717"><a href="#Laws-1717"><span class="linenos">1717</span></a>                <span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="Laws-1718"><a href="#Laws-1718"><span class="linenos">1718</span></a>            <span class="p">)</span>
</span><span id="Laws-1719"><a href="#Laws-1719"><span class="linenos">1719</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="Laws-1720"><a href="#Laws-1720"><span class="linenos">1720</span></a>                <span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="Laws-1721"><a href="#Laws-1721"><span class="linenos">1721</span></a>            <span class="p">)</span>
</span><span id="Laws-1722"><a href="#Laws-1722"><span class="linenos">1722</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="Laws-1723"><a href="#Laws-1723"><span class="linenos">1723</span></a>                <span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="Laws-1724"><a href="#Laws-1724"><span class="linenos">1724</span></a>            <span class="p">)</span>
</span><span id="Laws-1725"><a href="#Laws-1725"><span class="linenos">1725</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="Laws-1726"><a href="#Laws-1726"><span class="linenos">1726</span></a>
</span><span id="Laws-1727"><a href="#Laws-1727"><span class="linenos">1727</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
</span><span id="Laws-1728"><a href="#Laws-1728"><span class="linenos">1728</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Laws-1729"><a href="#Laws-1729"><span class="linenos">1729</span></a>
</span><span id="Laws-1730"><a href="#Laws-1730"><span class="linenos">1730</span></a>
</span><span id="Laws-1731"><a href="#Laws-1731"><span class="linenos">1731</span></a>    <span class="k">def</span> <span class="nf">_add_pdf_msd_split_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">x_offset</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Laws-1732"><a href="#Laws-1732"><span class="linenos">1732</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-1733"><a href="#Laws-1733"><span class="linenos">1733</span></a><span class="sd">        Adds a table to the PDF displaying MSD split analysis.</span>
</span><span id="Laws-1734"><a href="#Laws-1734"><span class="linenos">1734</span></a>
</span><span id="Laws-1735"><a href="#Laws-1735"><span class="linenos">1735</span></a><span class="sd">        The table includes ranges of Radius of Gyration (RoG)</span>
</span><span id="Laws-1736"><a href="#Laws-1736"><span class="linenos">1736</span></a><span class="sd">        and associated curve parameters.</span>
</span><span id="Laws-1737"><a href="#Laws-1737"><span class="linenos">1737</span></a>
</span><span id="Laws-1738"><a href="#Laws-1738"><span class="linenos">1738</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-1739"><a href="#Laws-1739"><span class="linenos">1739</span></a><span class="sd">        -----------</span>
</span><span id="Laws-1740"><a href="#Laws-1740"><span class="linenos">1740</span></a><span class="sd">        data : pd.DataFrame</span>
</span><span id="Laws-1741"><a href="#Laws-1741"><span class="linenos">1741</span></a><span class="sd">            A DataFrame containing MSD split results with columns:</span>
</span><span id="Laws-1742"><a href="#Laws-1742"><span class="linenos">1742</span></a><span class="sd">            - &quot;RoG range [km]&quot; (str): The range of RoG values.</span>
</span><span id="Laws-1743"><a href="#Laws-1743"><span class="linenos">1743</span></a><span class="sd">            - &quot;curve&quot; (str): Name of the fitted curve.</span>
</span><span id="Laws-1744"><a href="#Laws-1744"><span class="linenos">1744</span></a><span class="sd">            - &quot;param1&quot; (float): First parameter of the curve.</span>
</span><span id="Laws-1745"><a href="#Laws-1745"><span class="linenos">1745</span></a><span class="sd">            - &quot;param2&quot; (float): Second parameter of the curve.</span>
</span><span id="Laws-1746"><a href="#Laws-1746"><span class="linenos">1746</span></a><span class="sd">        x_offset : int, optional</span>
</span><span id="Laws-1747"><a href="#Laws-1747"><span class="linenos">1747</span></a><span class="sd">            The horizontal offset for table placement in the</span>
</span><span id="Laws-1748"><a href="#Laws-1748"><span class="linenos">1748</span></a><span class="sd">                PDF (default is 10).</span>
</span><span id="Laws-1749"><a href="#Laws-1749"><span class="linenos">1749</span></a><span class="sd">        y_offset : int, optional</span>
</span><span id="Laws-1750"><a href="#Laws-1750"><span class="linenos">1750</span></a><span class="sd">            The vertical offset for table placement.</span>
</span><span id="Laws-1751"><a href="#Laws-1751"><span class="linenos">1751</span></a><span class="sd">                If None, it uses the current Y position.</span>
</span><span id="Laws-1752"><a href="#Laws-1752"><span class="linenos">1752</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-1753"><a href="#Laws-1753"><span class="linenos">1753</span></a>
</span><span id="Laws-1754"><a href="#Laws-1754"><span class="linenos">1754</span></a>        <span class="k">if</span> <span class="n">y_offset</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Laws-1755"><a href="#Laws-1755"><span class="linenos">1755</span></a>            <span class="n">y_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span>
</span><span id="Laws-1756"><a href="#Laws-1756"><span class="linenos">1756</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Laws-1757"><a href="#Laws-1757"><span class="linenos">1757</span></a>            <span class="n">y_offset</span> <span class="o">=</span> <span class="n">y_offset</span>
</span><span id="Laws-1758"><a href="#Laws-1758"><span class="linenos">1758</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">)</span>
</span><span id="Laws-1759"><a href="#Laws-1759"><span class="linenos">1759</span></a>
</span><span id="Laws-1760"><a href="#Laws-1760"><span class="linenos">1760</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws-1761"><a href="#Laws-1761"><span class="linenos">1761</span></a>        <span class="n">col_width</span> <span class="o">=</span> <span class="mi">25</span>
</span><span id="Laws-1762"><a href="#Laws-1762"><span class="linenos">1762</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span><span id="Laws-1763"><a href="#Laws-1763"><span class="linenos">1763</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;RoG range [km]&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1764"><a href="#Laws-1764"><span class="linenos">1764</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Curve&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1765"><a href="#Laws-1765"><span class="linenos">1765</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Param 1&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1766"><a href="#Laws-1766"><span class="linenos">1766</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Param 2&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1767"><a href="#Laws-1767"><span class="linenos">1767</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="Laws-1768"><a href="#Laws-1768"><span class="linenos">1768</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span><span id="Laws-1769"><a href="#Laws-1769"><span class="linenos">1769</span></a>
</span><span id="Laws-1770"><a href="#Laws-1770"><span class="linenos">1770</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Laws-1771"><a href="#Laws-1771"><span class="linenos">1771</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="Laws-1772"><a href="#Laws-1772"><span class="linenos">1772</span></a>                <span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;RoG range [km]&quot;</span><span class="p">],</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="Laws-1773"><a href="#Laws-1773"><span class="linenos">1773</span></a>            <span class="p">)</span>
</span><span id="Laws-1774"><a href="#Laws-1774"><span class="linenos">1774</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">],</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1775"><a href="#Laws-1775"><span class="linenos">1775</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="Laws-1776"><a href="#Laws-1776"><span class="linenos">1776</span></a>                <span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="Laws-1777"><a href="#Laws-1777"><span class="linenos">1777</span></a>            <span class="p">)</span>
</span><span id="Laws-1778"><a href="#Laws-1778"><span class="linenos">1778</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="Laws-1779"><a href="#Laws-1779"><span class="linenos">1779</span></a>                <span class="n">col_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="Laws-1780"><a href="#Laws-1780"><span class="linenos">1780</span></a>            <span class="p">)</span>
</span><span id="Laws-1781"><a href="#Laws-1781"><span class="linenos">1781</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="Laws-1782"><a href="#Laws-1782"><span class="linenos">1782</span></a>
</span><span id="Laws-1783"><a href="#Laws-1783"><span class="linenos">1783</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">col_width</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
</span><span id="Laws-1784"><a href="#Laws-1784"><span class="linenos">1784</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Laws-1785"><a href="#Laws-1785"><span class="linenos">1785</span></a>
</span><span id="Laws-1786"><a href="#Laws-1786"><span class="linenos">1786</span></a>
</span><span id="Laws-1787"><a href="#Laws-1787"><span class="linenos">1787</span></a>    <span class="k">def</span> <span class="nf">_add_pdf_distribution_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="Laws-1788"><a href="#Laws-1788"><span class="linenos">1788</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-1789"><a href="#Laws-1789"><span class="linenos">1789</span></a><span class="sd">        Adds a table to the PDF displaying distribution fitting results.</span>
</span><span id="Laws-1790"><a href="#Laws-1790"><span class="linenos">1790</span></a>
</span><span id="Laws-1791"><a href="#Laws-1791"><span class="linenos">1791</span></a><span class="sd">        The table includes distribution names, scores, and fitted parameters.</span>
</span><span id="Laws-1792"><a href="#Laws-1792"><span class="linenos">1792</span></a>
</span><span id="Laws-1793"><a href="#Laws-1793"><span class="linenos">1793</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-1794"><a href="#Laws-1794"><span class="linenos">1794</span></a><span class="sd">        -----------</span>
</span><span id="Laws-1795"><a href="#Laws-1795"><span class="linenos">1795</span></a><span class="sd">        data : pd.DataFrame</span>
</span><span id="Laws-1796"><a href="#Laws-1796"><span class="linenos">1796</span></a><span class="sd">            A DataFrame containing distribution fitting results with columns:</span>
</span><span id="Laws-1797"><a href="#Laws-1797"><span class="linenos">1797</span></a><span class="sd">            - &quot;name&quot; (str): Name of the fitted distribution.</span>
</span><span id="Laws-1798"><a href="#Laws-1798"><span class="linenos">1798</span></a><span class="sd">            - &quot;score&quot; (float): Score associated with the fitted distribution.</span>
</span><span id="Laws-1799"><a href="#Laws-1799"><span class="linenos">1799</span></a><span class="sd">            - &quot;params&quot; (tuple of float): Fitted parameters for</span>
</span><span id="Laws-1800"><a href="#Laws-1800"><span class="linenos">1800</span></a><span class="sd">                the distribution.</span>
</span><span id="Laws-1801"><a href="#Laws-1801"><span class="linenos">1801</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-1802"><a href="#Laws-1802"><span class="linenos">1802</span></a>
</span><span id="Laws-1803"><a href="#Laws-1803"><span class="linenos">1803</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span><span id="Laws-1804"><a href="#Laws-1804"><span class="linenos">1804</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Distribution&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1805"><a href="#Laws-1805"><span class="linenos">1805</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Score&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1806"><a href="#Laws-1806"><span class="linenos">1806</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Params&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1807"><a href="#Laws-1807"><span class="linenos">1807</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</span><span id="Laws-1808"><a href="#Laws-1808"><span class="linenos">1808</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="Laws-1809"><a href="#Laws-1809"><span class="linenos">1809</span></a>
</span><span id="Laws-1810"><a href="#Laws-1810"><span class="linenos">1810</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Laws-1811"><a href="#Laws-1811"><span class="linenos">1811</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Laws-1812"><a href="#Laws-1812"><span class="linenos">1812</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</span><span id="Laws-1813"><a href="#Laws-1813"><span class="linenos">1813</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="Laws-1814"><a href="#Laws-1814"><span class="linenos">1814</span></a>                    <span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;score&quot;</span><span class="p">],</span> <span class="mi">15</span><span class="p">)),</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="Laws-1815"><a href="#Laws-1815"><span class="linenos">1815</span></a>                <span class="p">)</span>
</span><span id="Laws-1816"><a href="#Laws-1816"><span class="linenos">1816</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="Laws-1817"><a href="#Laws-1817"><span class="linenos">1817</span></a>                    <span class="mi">100</span><span class="p">,</span>
</span><span id="Laws-1818"><a href="#Laws-1818"><span class="linenos">1818</span></a>                    <span class="mi">3</span><span class="p">,</span>
</span><span id="Laws-1819"><a href="#Laws-1819"><span class="linenos">1819</span></a>                    <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]))</span>
</span><span id="Laws-1820"><a href="#Laws-1820"><span class="linenos">1820</span></a>                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="Laws-1821"><a href="#Laws-1821"><span class="linenos">1821</span></a>                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="Laws-1822"><a href="#Laws-1822"><span class="linenos">1822</span></a>                    <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Laws-1823"><a href="#Laws-1823"><span class="linenos">1823</span></a>                    <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>
</span><span id="Laws-1824"><a href="#Laws-1824"><span class="linenos">1824</span></a>                <span class="p">)</span>
</span><span id="Laws-1825"><a href="#Laws-1825"><span class="linenos">1825</span></a>                <span class="c1"># self.pdf_object.cell(40, 5, str(row[&quot;params&quot;]), border=1, align=&quot;C&quot;)</span>
</span><span id="Laws-1826"><a href="#Laws-1826"><span class="linenos">1826</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="Laws-1827"><a href="#Laws-1827"><span class="linenos">1827</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="Laws-1828"><a href="#Laws-1828"><span class="linenos">1828</span></a>                <span class="k">pass</span>
</span><span id="Laws-1829"><a href="#Laws-1829"><span class="linenos">1829</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">185</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
</span><span id="Laws-1830"><a href="#Laws-1830"><span class="linenos">1830</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Laws-1831"><a href="#Laws-1831"><span class="linenos">1831</span></a>
</span><span id="Laws-1832"><a href="#Laws-1832"><span class="linenos">1832</span></a>
</span><span id="Laws-1833"><a href="#Laws-1833"><span class="linenos">1833</span></a>    <span class="k">def</span> <span class="nf">_plot_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func_name</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">exp_y_pred</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Laws-1834"><a href="#Laws-1834"><span class="linenos">1834</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-1835"><a href="#Laws-1835"><span class="linenos">1835</span></a><span class="sd">        Plots a fitted curve along with the original data</span>
</span><span id="Laws-1836"><a href="#Laws-1836"><span class="linenos">1836</span></a><span class="sd">        and saves it as a PNG file.</span>
</span><span id="Laws-1837"><a href="#Laws-1837"><span class="linenos">1837</span></a>
</span><span id="Laws-1838"><a href="#Laws-1838"><span class="linenos">1838</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-1839"><a href="#Laws-1839"><span class="linenos">1839</span></a><span class="sd">        -----------</span>
</span><span id="Laws-1840"><a href="#Laws-1840"><span class="linenos">1840</span></a><span class="sd">        func_name : str</span>
</span><span id="Laws-1841"><a href="#Laws-1841"><span class="linenos">1841</span></a><span class="sd">            The name of the function, used for saving the file.</span>
</span><span id="Laws-1842"><a href="#Laws-1842"><span class="linenos">1842</span></a><span class="sd">        plot_data : pd.Series or pd.DataFrame</span>
</span><span id="Laws-1843"><a href="#Laws-1843"><span class="linenos">1843</span></a><span class="sd">            The original data points to be plotted as scatter points.</span>
</span><span id="Laws-1844"><a href="#Laws-1844"><span class="linenos">1844</span></a><span class="sd">        y_pred : np.ndarray</span>
</span><span id="Laws-1845"><a href="#Laws-1845"><span class="linenos">1845</span></a><span class="sd">            The predicted values for the fitted curve.</span>
</span><span id="Laws-1846"><a href="#Laws-1846"><span class="linenos">1846</span></a><span class="sd">        labels : list of str</span>
</span><span id="Laws-1847"><a href="#Laws-1847"><span class="linenos">1847</span></a><span class="sd">            A list containing x-axis and y-axis labels.</span>
</span><span id="Laws-1848"><a href="#Laws-1848"><span class="linenos">1848</span></a><span class="sd">        exp_y_pred : np.ndarray, optional</span>
</span><span id="Laws-1849"><a href="#Laws-1849"><span class="linenos">1849</span></a><span class="sd">            If provided, an additional exponential curve is plotted.</span>
</span><span id="Laws-1850"><a href="#Laws-1850"><span class="linenos">1850</span></a>
</span><span id="Laws-1851"><a href="#Laws-1851"><span class="linenos">1851</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-1852"><a href="#Laws-1852"><span class="linenos">1852</span></a><span class="sd">        --------</span>
</span><span id="Laws-1853"><a href="#Laws-1853"><span class="linenos">1853</span></a><span class="sd">        BytesIO</span>
</span><span id="Laws-1854"><a href="#Laws-1854"><span class="linenos">1854</span></a><span class="sd">            A buffer containing the saved image.</span>
</span><span id="Laws-1855"><a href="#Laws-1855"><span class="linenos">1855</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-1856"><a href="#Laws-1856"><span class="linenos">1856</span></a>
</span><span id="Laws-1857"><a href="#Laws-1857"><span class="linenos">1857</span></a>        <span class="n">buffer</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Laws-1858"><a href="#Laws-1858"><span class="linenos">1858</span></a>
</span><span id="Laws-1859"><a href="#Laws-1859"><span class="linenos">1859</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</span><span id="Laws-1860"><a href="#Laws-1860"><span class="linenos">1860</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
</span><span id="Laws-1861"><a href="#Laws-1861"><span class="linenos">1861</span></a>
</span><span id="Laws-1862"><a href="#Laws-1862"><span class="linenos">1862</span></a>        <span class="k">if</span> <span class="n">exp_y_pred</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">exp_y_pred</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Laws-1863"><a href="#Laws-1863"><span class="linenos">1863</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Sigmoid&quot;</span><span class="p">)</span>
</span><span id="Laws-1864"><a href="#Laws-1864"><span class="linenos">1864</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="Laws-1865"><a href="#Laws-1865"><span class="linenos">1865</span></a>                <span class="n">plot_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">exp_y_pred</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Expon neg&quot;</span>
</span><span id="Laws-1866"><a href="#Laws-1866"><span class="linenos">1866</span></a>            <span class="p">)</span>
</span><span id="Laws-1867"><a href="#Laws-1867"><span class="linenos">1867</span></a>
</span><span id="Laws-1868"><a href="#Laws-1868"><span class="linenos">1868</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Laws-1869"><a href="#Laws-1869"><span class="linenos">1869</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="Laws-1870"><a href="#Laws-1870"><span class="linenos">1870</span></a>                <span class="n">plot_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fitted curve&quot;</span>
</span><span id="Laws-1871"><a href="#Laws-1871"><span class="linenos">1871</span></a>            <span class="p">)</span>
</span><span id="Laws-1872"><a href="#Laws-1872"><span class="linenos">1872</span></a>
</span><span id="Laws-1873"><a href="#Laws-1873"><span class="linenos">1873</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">plot_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Data&quot;</span><span class="p">)</span>
</span><span id="Laws-1874"><a href="#Laws-1874"><span class="linenos">1874</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</span><span id="Laws-1875"><a href="#Laws-1875"><span class="linenos">1875</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</span><span id="Laws-1876"><a href="#Laws-1876"><span class="linenos">1876</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="Laws-1877"><a href="#Laws-1877"><span class="linenos">1877</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="Laws-1878"><a href="#Laws-1878"><span class="linenos">1878</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="Laws-1879"><a href="#Laws-1879"><span class="linenos">1879</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="Laws-1880"><a href="#Laws-1880"><span class="linenos">1880</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</span><span id="Laws-1881"><a href="#Laws-1881"><span class="linenos">1881</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="Laws-1882"><a href="#Laws-1882"><span class="linenos">1882</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws-1883"><a href="#Laws-1883"><span class="linenos">1883</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="Laws-1884"><a href="#Laws-1884"><span class="linenos">1884</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span>
</span><span id="Laws-1885"><a href="#Laws-1885"><span class="linenos">1885</span></a>            <span class="p">)</span>
</span><span id="Laws-1886"><a href="#Laws-1886"><span class="linenos">1886</span></a>        <span class="p">)</span>
</span><span id="Laws-1887"><a href="#Laws-1887"><span class="linenos">1887</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="Laws-1888"><a href="#Laws-1888"><span class="linenos">1888</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Laws-1889"><a href="#Laws-1889"><span class="linenos">1889</span></a>        <span class="n">buffer</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Laws-1890"><a href="#Laws-1890"><span class="linenos">1890</span></a>
</span><span id="Laws-1891"><a href="#Laws-1891"><span class="linenos">1891</span></a>        <span class="k">return</span> <span class="n">buffer</span>
</span><span id="Laws-1892"><a href="#Laws-1892"><span class="linenos">1892</span></a>
</span><span id="Laws-1893"><a href="#Laws-1893"><span class="linenos">1893</span></a>
</span><span id="Laws-1894"><a href="#Laws-1894"><span class="linenos">1894</span></a>    <span class="k">def</span> <span class="nf">_plot_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">measure_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Values&quot;</span><span class="p">):</span>
</span><span id="Laws-1895"><a href="#Laws-1895"><span class="linenos">1895</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-1896"><a href="#Laws-1896"><span class="linenos">1896</span></a><span class="sd">        Plots a histogram of values and a fitted probability distribution model.</span>
</span><span id="Laws-1897"><a href="#Laws-1897"><span class="linenos">1897</span></a>
</span><span id="Laws-1898"><a href="#Laws-1898"><span class="linenos">1898</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-1899"><a href="#Laws-1899"><span class="linenos">1899</span></a><span class="sd">        -----------</span>
</span><span id="Laws-1900"><a href="#Laws-1900"><span class="linenos">1900</span></a><span class="sd">        model : distfit</span>
</span><span id="Laws-1901"><a href="#Laws-1901"><span class="linenos">1901</span></a><span class="sd">            A fitted distribution model.</span>
</span><span id="Laws-1902"><a href="#Laws-1902"><span class="linenos">1902</span></a><span class="sd">        values : np.ndarray</span>
</span><span id="Laws-1903"><a href="#Laws-1903"><span class="linenos">1903</span></a><span class="sd">            The dataset values to be plotted.</span>
</span><span id="Laws-1904"><a href="#Laws-1904"><span class="linenos">1904</span></a><span class="sd">        measure_type : str, optional</span>
</span><span id="Laws-1905"><a href="#Laws-1905"><span class="linenos">1905</span></a><span class="sd">            The type of measure for labeling the x-axis (default is &quot;Values&quot;).</span>
</span><span id="Laws-1906"><a href="#Laws-1906"><span class="linenos">1906</span></a>
</span><span id="Laws-1907"><a href="#Laws-1907"><span class="linenos">1907</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-1908"><a href="#Laws-1908"><span class="linenos">1908</span></a><span class="sd">        --------</span>
</span><span id="Laws-1909"><a href="#Laws-1909"><span class="linenos">1909</span></a><span class="sd">        tuple (BytesIO, BytesIO)</span>
</span><span id="Laws-1910"><a href="#Laws-1910"><span class="linenos">1910</span></a><span class="sd">            Buffers containing the saved histogram and fitted model plots.</span>
</span><span id="Laws-1911"><a href="#Laws-1911"><span class="linenos">1911</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-1912"><a href="#Laws-1912"><span class="linenos">1912</span></a>
</span><span id="Laws-1913"><a href="#Laws-1913"><span class="linenos">1913</span></a>        <span class="n">buffer_plot_distribution</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Laws-1914"><a href="#Laws-1914"><span class="linenos">1914</span></a>        <span class="n">buffer_plot_model</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Laws-1915"><a href="#Laws-1915"><span class="linenos">1915</span></a>
</span><span id="Laws-1916"><a href="#Laws-1916"><span class="linenos">1916</span></a>        <span class="n">measure_type</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Laws-1917"><a href="#Laws-1917"><span class="linenos">1917</span></a>            <span class="n">measure_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;distribution&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws-1918"><a href="#Laws-1918"><span class="linenos">1918</span></a>        <span class="p">)</span>
</span><span id="Laws-1919"><a href="#Laws-1919"><span class="linenos">1919</span></a>
</span><span id="Laws-1920"><a href="#Laws-1920"><span class="linenos">1920</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</span><span id="Laws-1921"><a href="#Laws-1921"><span class="linenos">1921</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Laws-1922"><a href="#Laws-1922"><span class="linenos">1922</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Laws-1923"><a href="#Laws-1923"><span class="linenos">1923</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">measure_type</span><span class="p">)</span>
</span><span id="Laws-1924"><a href="#Laws-1924"><span class="linenos">1924</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Values&quot;</span><span class="p">)</span>
</span><span id="Laws-1925"><a href="#Laws-1925"><span class="linenos">1925</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</span><span id="Laws-1926"><a href="#Laws-1926"><span class="linenos">1926</span></a>
</span><span id="Laws-1927"><a href="#Laws-1927"><span class="linenos">1927</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="Laws-1928"><a href="#Laws-1928"><span class="linenos">1928</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws-1929"><a href="#Laws-1929"><span class="linenos">1929</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="Laws-1930"><a href="#Laws-1930"><span class="linenos">1930</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">measure_type</span><span class="si">}</span><span class="s2">_distribution.png&quot;</span><span class="p">,</span>
</span><span id="Laws-1931"><a href="#Laws-1931"><span class="linenos">1931</span></a>            <span class="p">)</span>
</span><span id="Laws-1932"><a href="#Laws-1932"><span class="linenos">1932</span></a>        <span class="p">)</span>
</span><span id="Laws-1933"><a href="#Laws-1933"><span class="linenos">1933</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer_plot_distribution</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="Laws-1934"><a href="#Laws-1934"><span class="linenos">1934</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Laws-1935"><a href="#Laws-1935"><span class="linenos">1935</span></a>        <span class="n">buffer_plot_distribution</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Laws-1936"><a href="#Laws-1936"><span class="linenos">1936</span></a>
</span><span id="Laws-1937"><a href="#Laws-1937"><span class="linenos">1937</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Laws-1938"><a href="#Laws-1938"><span class="linenos">1938</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="Laws-1939"><a href="#Laws-1939"><span class="linenos">1939</span></a>            <span class="n">pdf_properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;linestyle&quot;</span><span class="p">:</span> <span class="s2">&quot;--&quot;</span><span class="p">},</span>
</span><span id="Laws-1940"><a href="#Laws-1940"><span class="linenos">1940</span></a>            <span class="n">bar_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Laws-1941"><a href="#Laws-1941"><span class="linenos">1941</span></a>            <span class="n">cii_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Laws-1942"><a href="#Laws-1942"><span class="linenos">1942</span></a>            <span class="n">emp_properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="s2">&quot;o&quot;</span><span class="p">},</span>
</span><span id="Laws-1943"><a href="#Laws-1943"><span class="linenos">1943</span></a>            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
</span><span id="Laws-1944"><a href="#Laws-1944"><span class="linenos">1944</span></a>        <span class="p">)</span>
</span><span id="Laws-1945"><a href="#Laws-1945"><span class="linenos">1945</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">measure_type</span><span class="p">)</span>
</span><span id="Laws-1946"><a href="#Laws-1946"><span class="linenos">1946</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</span><span id="Laws-1947"><a href="#Laws-1947"><span class="linenos">1947</span></a>
</span><span id="Laws-1948"><a href="#Laws-1948"><span class="linenos">1948</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="Laws-1949"><a href="#Laws-1949"><span class="linenos">1949</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws-1950"><a href="#Laws-1950"><span class="linenos">1950</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="Laws-1951"><a href="#Laws-1951"><span class="linenos">1951</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">measure_type</span><span class="si">}</span><span class="s2">_model_distribution.png&quot;</span><span class="p">,</span>
</span><span id="Laws-1952"><a href="#Laws-1952"><span class="linenos">1952</span></a>            <span class="p">)</span>
</span><span id="Laws-1953"><a href="#Laws-1953"><span class="linenos">1953</span></a>        <span class="p">)</span>
</span><span id="Laws-1954"><a href="#Laws-1954"><span class="linenos">1954</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer_plot_model</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="Laws-1955"><a href="#Laws-1955"><span class="linenos">1955</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Laws-1956"><a href="#Laws-1956"><span class="linenos">1956</span></a>        <span class="n">buffer_plot_model</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Laws-1957"><a href="#Laws-1957"><span class="linenos">1957</span></a>
</span><span id="Laws-1958"><a href="#Laws-1958"><span class="linenos">1958</span></a>        <span class="k">return</span> <span class="n">buffer_plot_distribution</span><span class="p">,</span> <span class="n">buffer_plot_model</span>
</span><span id="Laws-1959"><a href="#Laws-1959"><span class="linenos">1959</span></a>
</span><span id="Laws-1960"><a href="#Laws-1960"><span class="linenos">1960</span></a>
</span><span id="Laws-1961"><a href="#Laws-1961"><span class="linenos">1961</span></a>    <span class="k">def</span> <span class="nf">_plot_double_distribution</span><span class="p">(</span>
</span><span id="Laws-1962"><a href="#Laws-1962"><span class="linenos">1962</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Laws-1963"><a href="#Laws-1963"><span class="linenos">1963</span></a>        <span class="n">left_model</span><span class="p">,</span>
</span><span id="Laws-1964"><a href="#Laws-1964"><span class="linenos">1964</span></a>        <span class="n">right_model</span><span class="p">,</span>
</span><span id="Laws-1965"><a href="#Laws-1965"><span class="linenos">1965</span></a>        <span class="n">left_values</span><span class="p">,</span>
</span><span id="Laws-1966"><a href="#Laws-1966"><span class="linenos">1966</span></a>        <span class="n">right_values</span><span class="p">,</span>
</span><span id="Laws-1967"><a href="#Laws-1967"><span class="linenos">1967</span></a>        <span class="n">flexation_point</span><span class="p">,</span>
</span><span id="Laws-1968"><a href="#Laws-1968"><span class="linenos">1968</span></a>        <span class="n">measure_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Values&quot;</span><span class="p">,</span>
</span><span id="Laws-1969"><a href="#Laws-1969"><span class="linenos">1969</span></a>    <span class="p">):</span>
</span><span id="Laws-1970"><a href="#Laws-1970"><span class="linenos">1970</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-1971"><a href="#Laws-1971"><span class="linenos">1971</span></a><span class="sd">        Plots and saves histograms for two subsets of data</span>
</span><span id="Laws-1972"><a href="#Laws-1972"><span class="linenos">1972</span></a><span class="sd">        and their fitted distribution models.</span>
</span><span id="Laws-1973"><a href="#Laws-1973"><span class="linenos">1973</span></a>
</span><span id="Laws-1974"><a href="#Laws-1974"><span class="linenos">1974</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-1975"><a href="#Laws-1975"><span class="linenos">1975</span></a><span class="sd">        -----------</span>
</span><span id="Laws-1976"><a href="#Laws-1976"><span class="linenos">1976</span></a><span class="sd">        left_model : distfit</span>
</span><span id="Laws-1977"><a href="#Laws-1977"><span class="linenos">1977</span></a><span class="sd">            A fitted distribution model for the left subset.</span>
</span><span id="Laws-1978"><a href="#Laws-1978"><span class="linenos">1978</span></a><span class="sd">        right_model : distfit</span>
</span><span id="Laws-1979"><a href="#Laws-1979"><span class="linenos">1979</span></a><span class="sd">            A fitted distribution model for the right subset.</span>
</span><span id="Laws-1980"><a href="#Laws-1980"><span class="linenos">1980</span></a><span class="sd">        left_values : np.ndarray</span>
</span><span id="Laws-1981"><a href="#Laws-1981"><span class="linenos">1981</span></a><span class="sd">            The left subset of data values.</span>
</span><span id="Laws-1982"><a href="#Laws-1982"><span class="linenos">1982</span></a><span class="sd">        right_values : np.ndarray</span>
</span><span id="Laws-1983"><a href="#Laws-1983"><span class="linenos">1983</span></a><span class="sd">            The right subset of data values.</span>
</span><span id="Laws-1984"><a href="#Laws-1984"><span class="linenos">1984</span></a><span class="sd">        flexation_point : float</span>
</span><span id="Laws-1985"><a href="#Laws-1985"><span class="linenos">1985</span></a><span class="sd">            The point at which the data was split.</span>
</span><span id="Laws-1986"><a href="#Laws-1986"><span class="linenos">1986</span></a><span class="sd">        measure_type : str, optional</span>
</span><span id="Laws-1987"><a href="#Laws-1987"><span class="linenos">1987</span></a><span class="sd">            The type of measure for labeling the x-axis</span>
</span><span id="Laws-1988"><a href="#Laws-1988"><span class="linenos">1988</span></a><span class="sd">                (default is &quot;Values&quot;).</span>
</span><span id="Laws-1989"><a href="#Laws-1989"><span class="linenos">1989</span></a>
</span><span id="Laws-1990"><a href="#Laws-1990"><span class="linenos">1990</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-1991"><a href="#Laws-1991"><span class="linenos">1991</span></a><span class="sd">        --------</span>
</span><span id="Laws-1992"><a href="#Laws-1992"><span class="linenos">1992</span></a><span class="sd">        tuple (BytesIO, BytesIO)</span>
</span><span id="Laws-1993"><a href="#Laws-1993"><span class="linenos">1993</span></a><span class="sd">            Buffers containing the saved histograms and model plots.</span>
</span><span id="Laws-1994"><a href="#Laws-1994"><span class="linenos">1994</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-1995"><a href="#Laws-1995"><span class="linenos">1995</span></a>
</span><span id="Laws-1996"><a href="#Laws-1996"><span class="linenos">1996</span></a>        <span class="n">measure_type</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Laws-1997"><a href="#Laws-1997"><span class="linenos">1997</span></a>            <span class="n">measure_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;distribution&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws-1998"><a href="#Laws-1998"><span class="linenos">1998</span></a>        <span class="p">)</span>
</span><span id="Laws-1999"><a href="#Laws-1999"><span class="linenos">1999</span></a>
</span><span id="Laws-2000"><a href="#Laws-2000"><span class="linenos">2000</span></a>        <span class="n">buffer_plot_distribution</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Laws-2001"><a href="#Laws-2001"><span class="linenos">2001</span></a>        <span class="n">buffer_plot_model</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Laws-2002"><a href="#Laws-2002"><span class="linenos">2002</span></a>
</span><span id="Laws-2003"><a href="#Laws-2003"><span class="linenos">2003</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</span><span id="Laws-2004"><a href="#Laws-2004"><span class="linenos">2004</span></a>
</span><span id="Laws-2005"><a href="#Laws-2005"><span class="linenos">2005</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Laws-2006"><a href="#Laws-2006"><span class="linenos">2006</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
</span><span id="Laws-2007"><a href="#Laws-2007"><span class="linenos">2007</span></a>            <span class="n">left_values</span><span class="p">,</span>
</span><span id="Laws-2008"><a href="#Laws-2008"><span class="linenos">2008</span></a>            <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
</span><span id="Laws-2009"><a href="#Laws-2009"><span class="linenos">2009</span></a>            <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Laws-2010"><a href="#Laws-2010"><span class="linenos">2010</span></a>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Left Set&quot;</span><span class="p">,</span>
</span><span id="Laws-2011"><a href="#Laws-2011"><span class="linenos">2011</span></a>            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span>
</span><span id="Laws-2012"><a href="#Laws-2012"><span class="linenos">2012</span></a>        <span class="p">)</span>
</span><span id="Laws-2013"><a href="#Laws-2013"><span class="linenos">2013</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
</span><span id="Laws-2014"><a href="#Laws-2014"><span class="linenos">2014</span></a>            <span class="n">right_values</span><span class="p">,</span>
</span><span id="Laws-2015"><a href="#Laws-2015"><span class="linenos">2015</span></a>            <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
</span><span id="Laws-2016"><a href="#Laws-2016"><span class="linenos">2016</span></a>            <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Laws-2017"><a href="#Laws-2017"><span class="linenos">2017</span></a>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Right Set&quot;</span><span class="p">,</span>
</span><span id="Laws-2018"><a href="#Laws-2018"><span class="linenos">2018</span></a>            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span>
</span><span id="Laws-2019"><a href="#Laws-2019"><span class="linenos">2019</span></a>        <span class="p">)</span>
</span><span id="Laws-2020"><a href="#Laws-2020"><span class="linenos">2020</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</span><span id="Laws-2021"><a href="#Laws-2021"><span class="linenos">2021</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">measure_type</span><span class="p">)</span>
</span><span id="Laws-2022"><a href="#Laws-2022"><span class="linenos">2022</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Values&quot;</span><span class="p">)</span>
</span><span id="Laws-2023"><a href="#Laws-2023"><span class="linenos">2023</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="Laws-2024"><a href="#Laws-2024"><span class="linenos">2024</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws-2025"><a href="#Laws-2025"><span class="linenos">2025</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="Laws-2026"><a href="#Laws-2026"><span class="linenos">2026</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">measure_type</span><span class="si">}</span><span class="s2">_distribution_with_flexation_point_</span><span class="si">{</span><span class="n">flexation_point</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span>
</span><span id="Laws-2027"><a href="#Laws-2027"><span class="linenos">2027</span></a>            <span class="p">)</span>
</span><span id="Laws-2028"><a href="#Laws-2028"><span class="linenos">2028</span></a>        <span class="p">)</span>
</span><span id="Laws-2029"><a href="#Laws-2029"><span class="linenos">2029</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer_plot_distribution</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="Laws-2030"><a href="#Laws-2030"><span class="linenos">2030</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Laws-2031"><a href="#Laws-2031"><span class="linenos">2031</span></a>        <span class="n">buffer_plot_distribution</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Laws-2032"><a href="#Laws-2032"><span class="linenos">2032</span></a>
</span><span id="Laws-2033"><a href="#Laws-2033"><span class="linenos">2033</span></a>        <span class="n">left_model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="Laws-2034"><a href="#Laws-2034"><span class="linenos">2034</span></a>            <span class="n">pdf_properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;linestyle&quot;</span><span class="p">:</span> <span class="s2">&quot;--&quot;</span><span class="p">},</span>
</span><span id="Laws-2035"><a href="#Laws-2035"><span class="linenos">2035</span></a>            <span class="n">bar_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Laws-2036"><a href="#Laws-2036"><span class="linenos">2036</span></a>            <span class="n">cii_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Laws-2037"><a href="#Laws-2037"><span class="linenos">2037</span></a>            <span class="n">emp_properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="s2">&quot;o&quot;</span><span class="p">},</span>
</span><span id="Laws-2038"><a href="#Laws-2038"><span class="linenos">2038</span></a>            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
</span><span id="Laws-2039"><a href="#Laws-2039"><span class="linenos">2039</span></a>        <span class="p">)</span>
</span><span id="Laws-2040"><a href="#Laws-2040"><span class="linenos">2040</span></a>
</span><span id="Laws-2041"><a href="#Laws-2041"><span class="linenos">2041</span></a>        <span class="n">right_model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="Laws-2042"><a href="#Laws-2042"><span class="linenos">2042</span></a>            <span class="n">pdf_properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;linestyle&quot;</span><span class="p">:</span> <span class="s2">&quot;--&quot;</span><span class="p">},</span>
</span><span id="Laws-2043"><a href="#Laws-2043"><span class="linenos">2043</span></a>            <span class="n">bar_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Laws-2044"><a href="#Laws-2044"><span class="linenos">2044</span></a>            <span class="n">cii_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Laws-2045"><a href="#Laws-2045"><span class="linenos">2045</span></a>            <span class="n">emp_properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="s2">&quot;o&quot;</span><span class="p">},</span>
</span><span id="Laws-2046"><a href="#Laws-2046"><span class="linenos">2046</span></a>            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
</span><span id="Laws-2047"><a href="#Laws-2047"><span class="linenos">2047</span></a>        <span class="p">)</span>
</span><span id="Laws-2048"><a href="#Laws-2048"><span class="linenos">2048</span></a>
</span><span id="Laws-2049"><a href="#Laws-2049"><span class="linenos">2049</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="Laws-2050"><a href="#Laws-2050"><span class="linenos">2050</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="Laws-2051"><a href="#Laws-2051"><span class="linenos">2051</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</span><span id="Laws-2052"><a href="#Laws-2052"><span class="linenos">2052</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="Laws-2053"><a href="#Laws-2053"><span class="linenos">2053</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws-2054"><a href="#Laws-2054"><span class="linenos">2054</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="Laws-2055"><a href="#Laws-2055"><span class="linenos">2055</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">measure_type</span><span class="si">}</span><span class="s2">_model_distribution_with_flexation_point_</span><span class="si">{</span><span class="n">flexation_point</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span>
</span><span id="Laws-2056"><a href="#Laws-2056"><span class="linenos">2056</span></a>            <span class="p">)</span>
</span><span id="Laws-2057"><a href="#Laws-2057"><span class="linenos">2057</span></a>        <span class="p">)</span>
</span><span id="Laws-2058"><a href="#Laws-2058"><span class="linenos">2058</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer_plot_model</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="Laws-2059"><a href="#Laws-2059"><span class="linenos">2059</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Laws-2060"><a href="#Laws-2060"><span class="linenos">2060</span></a>        <span class="n">buffer_plot_model</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Laws-2061"><a href="#Laws-2061"><span class="linenos">2061</span></a>
</span><span id="Laws-2062"><a href="#Laws-2062"><span class="linenos">2062</span></a>        <span class="k">return</span> <span class="n">buffer_plot_distribution</span><span class="p">,</span> <span class="n">buffer_plot_model</span>
</span><span id="Laws-2063"><a href="#Laws-2063"><span class="linenos">2063</span></a>
</span><span id="Laws-2064"><a href="#Laws-2064"><span class="linenos">2064</span></a>
</span><span id="Laws-2065"><a href="#Laws-2065"><span class="linenos">2065</span></a>    <span class="k">def</span> <span class="nf">_plot_P_new</span><span class="p">(</span>
</span><span id="Laws-2066"><a href="#Laws-2066"><span class="linenos">2066</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">rho_est</span><span class="p">,</span> <span class="n">gamma_est</span><span class="p">,</span> <span class="n">DeltaS</span><span class="p">,</span> <span class="n">S_mid</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span>
</span><span id="Laws-2067"><a href="#Laws-2067"><span class="linenos">2067</span></a>    <span class="p">):</span>
</span><span id="Laws-2068"><a href="#Laws-2068"><span class="linenos">2068</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2069"><a href="#Laws-2069"><span class="linenos">2069</span></a><span class="sd">        Plots and saves two figures:</span>
</span><span id="Laws-2070"><a href="#Laws-2070"><span class="linenos">2070</span></a><span class="sd">        1. A comparison between estimated and reference probability functions.</span>
</span><span id="Laws-2071"><a href="#Laws-2071"><span class="linenos">2071</span></a><span class="sd">        2. A log-log plot of S vs. S with a fitted regression line.</span>
</span><span id="Laws-2072"><a href="#Laws-2072"><span class="linenos">2072</span></a>
</span><span id="Laws-2073"><a href="#Laws-2073"><span class="linenos">2073</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2074"><a href="#Laws-2074"><span class="linenos">2074</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2075"><a href="#Laws-2075"><span class="linenos">2075</span></a><span class="sd">        rho_est : float</span>
</span><span id="Laws-2076"><a href="#Laws-2076"><span class="linenos">2076</span></a><span class="sd">            Estimated scaling factor for P_new.</span>
</span><span id="Laws-2077"><a href="#Laws-2077"><span class="linenos">2077</span></a><span class="sd">        gamma_est : float</span>
</span><span id="Laws-2078"><a href="#Laws-2078"><span class="linenos">2078</span></a><span class="sd">            Estimated exponent for P_new.</span>
</span><span id="Laws-2079"><a href="#Laws-2079"><span class="linenos">2079</span></a><span class="sd">        DeltaS : np.ndarray</span>
</span><span id="Laws-2080"><a href="#Laws-2080"><span class="linenos">2080</span></a><span class="sd">            Change in S values for log-log regression.</span>
</span><span id="Laws-2081"><a href="#Laws-2081"><span class="linenos">2081</span></a><span class="sd">        S_mid : np.ndarray</span>
</span><span id="Laws-2082"><a href="#Laws-2082"><span class="linenos">2082</span></a><span class="sd">            Midpoints of S values for log-log regression.</span>
</span><span id="Laws-2083"><a href="#Laws-2083"><span class="linenos">2083</span></a><span class="sd">        intercept : float</span>
</span><span id="Laws-2084"><a href="#Laws-2084"><span class="linenos">2084</span></a><span class="sd">            Intercept of the fitted regression line in log-log plot.</span>
</span><span id="Laws-2085"><a href="#Laws-2085"><span class="linenos">2085</span></a><span class="sd">        slope : float</span>
</span><span id="Laws-2086"><a href="#Laws-2086"><span class="linenos">2086</span></a><span class="sd">            Slope of the fitted regression line in log-log plot.</span>
</span><span id="Laws-2087"><a href="#Laws-2087"><span class="linenos">2087</span></a><span class="sd">        nrows : int</span>
</span><span id="Laws-2088"><a href="#Laws-2088"><span class="linenos">2088</span></a><span class="sd">            Number of time steps for P_new estimation.</span>
</span><span id="Laws-2089"><a href="#Laws-2089"><span class="linenos">2089</span></a><span class="sd">        n_data : int</span>
</span><span id="Laws-2090"><a href="#Laws-2090"><span class="linenos">2090</span></a><span class="sd">            Number of data points in the dataset.</span>
</span><span id="Laws-2091"><a href="#Laws-2091"><span class="linenos">2091</span></a>
</span><span id="Laws-2092"><a href="#Laws-2092"><span class="linenos">2092</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2093"><a href="#Laws-2093"><span class="linenos">2093</span></a><span class="sd">        --------</span>
</span><span id="Laws-2094"><a href="#Laws-2094"><span class="linenos">2094</span></a><span class="sd">        tuple (BytesIO, BytesIO)</span>
</span><span id="Laws-2095"><a href="#Laws-2095"><span class="linenos">2095</span></a><span class="sd">            Buffers containing the saved plots.</span>
</span><span id="Laws-2096"><a href="#Laws-2096"><span class="linenos">2096</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2097"><a href="#Laws-2097"><span class="linenos">2097</span></a>
</span><span id="Laws-2098"><a href="#Laws-2098"><span class="linenos">2098</span></a>        <span class="n">buffer1</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Laws-2099"><a href="#Laws-2099"><span class="linenos">2099</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</span><span id="Laws-2100"><a href="#Laws-2100"><span class="linenos">2100</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
</span><span id="Laws-2101"><a href="#Laws-2101"><span class="linenos">2101</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="Laws-2102"><a href="#Laws-2102"><span class="linenos">2102</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
</span><span id="Laws-2103"><a href="#Laws-2103"><span class="linenos">2103</span></a>            <span class="p">[</span><span class="n">rho_est</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">gamma_est</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)],</span>
</span><span id="Laws-2104"><a href="#Laws-2104"><span class="linenos">2104</span></a>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Estimated&quot;</span><span class="p">,</span>
</span><span id="Laws-2105"><a href="#Laws-2105"><span class="linenos">2105</span></a>            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span>
</span><span id="Laws-2106"><a href="#Laws-2106"><span class="linenos">2106</span></a>        <span class="p">)</span>
</span><span id="Laws-2107"><a href="#Laws-2107"><span class="linenos">2107</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="Laws-2108"><a href="#Laws-2108"><span class="linenos">2108</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
</span><span id="Laws-2109"><a href="#Laws-2109"><span class="linenos">2109</span></a>            <span class="p">[</span><span class="mf">0.6</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.21</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)],</span>
</span><span id="Laws-2110"><a href="#Laws-2110"><span class="linenos">2110</span></a>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Paper&quot;</span><span class="p">,</span>
</span><span id="Laws-2111"><a href="#Laws-2111"><span class="linenos">2111</span></a>            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
</span><span id="Laws-2112"><a href="#Laws-2112"><span class="linenos">2112</span></a>        <span class="p">)</span>
</span><span id="Laws-2113"><a href="#Laws-2113"><span class="linenos">2113</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="Laws-2114"><a href="#Laws-2114"><span class="linenos">2114</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time steps (n)&quot;</span><span class="p">)</span>
</span><span id="Laws-2115"><a href="#Laws-2115"><span class="linenos">2115</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;P_new (estimated vs. reference)&quot;</span><span class="p">)</span>
</span><span id="Laws-2116"><a href="#Laws-2116"><span class="linenos">2116</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparison of Estimated vs. Paper Model&quot;</span><span class="p">)</span>
</span><span id="Laws-2117"><a href="#Laws-2117"><span class="linenos">2117</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="Laws-2118"><a href="#Laws-2118"><span class="linenos">2118</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws-2119"><a href="#Laws-2119"><span class="linenos">2119</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="Laws-2120"><a href="#Laws-2120"><span class="linenos">2120</span></a>                <span class="s2">&quot;P new comparison of Estimated vs. Paper Model.png&quot;</span><span class="p">,</span>
</span><span id="Laws-2121"><a href="#Laws-2121"><span class="linenos">2121</span></a>            <span class="p">)</span>
</span><span id="Laws-2122"><a href="#Laws-2122"><span class="linenos">2122</span></a>        <span class="p">)</span>
</span><span id="Laws-2123"><a href="#Laws-2123"><span class="linenos">2123</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer1</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="Laws-2124"><a href="#Laws-2124"><span class="linenos">2124</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Laws-2125"><a href="#Laws-2125"><span class="linenos">2125</span></a>        <span class="n">buffer1</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Laws-2126"><a href="#Laws-2126"><span class="linenos">2126</span></a>
</span><span id="Laws-2127"><a href="#Laws-2127"><span class="linenos">2127</span></a>        <span class="n">buffer2</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Laws-2128"><a href="#Laws-2128"><span class="linenos">2128</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</span><span id="Laws-2129"><a href="#Laws-2129"><span class="linenos">2129</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
</span><span id="Laws-2130"><a href="#Laws-2130"><span class="linenos">2130</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="Laws-2131"><a href="#Laws-2131"><span class="linenos">2131</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">S_mid</span><span class="p">),</span>
</span><span id="Laws-2132"><a href="#Laws-2132"><span class="linenos">2132</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">DeltaS</span><span class="p">),</span>
</span><span id="Laws-2133"><a href="#Laws-2133"><span class="linenos">2133</span></a>            <span class="s2">&quot;o&quot;</span><span class="p">,</span>
</span><span id="Laws-2134"><a href="#Laws-2134"><span class="linenos">2134</span></a>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Data (log-log)&quot;</span><span class="p">,</span>
</span><span id="Laws-2135"><a href="#Laws-2135"><span class="linenos">2135</span></a>            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span>
</span><span id="Laws-2136"><a href="#Laws-2136"><span class="linenos">2136</span></a>        <span class="p">)</span>
</span><span id="Laws-2137"><a href="#Laws-2137"><span class="linenos">2137</span></a>        <span class="n">X_line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">S_mid</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">S_mid</span><span class="p">)),</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="Laws-2138"><a href="#Laws-2138"><span class="linenos">2138</span></a>        <span class="n">y_line</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">X_line</span>
</span><span id="Laws-2139"><a href="#Laws-2139"><span class="linenos">2139</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_line</span><span class="p">,</span> <span class="n">y_line</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="Laws-2140"><a href="#Laws-2140"><span class="linenos">2140</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;ln(S)&quot;</span><span class="p">)</span>
</span><span id="Laws-2141"><a href="#Laws-2141"><span class="linenos">2141</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;ln(S)&quot;</span><span class="p">)</span>
</span><span id="Laws-2142"><a href="#Laws-2142"><span class="linenos">2142</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;log(S) vs. log(S)&quot;</span><span class="p">)</span>
</span><span id="Laws-2143"><a href="#Laws-2143"><span class="linenos">2143</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="Laws-2144"><a href="#Laws-2144"><span class="linenos">2144</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="Laws-2145"><a href="#Laws-2145"><span class="linenos">2145</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws-2146"><a href="#Laws-2146"><span class="linenos">2146</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="Laws-2147"><a href="#Laws-2147"><span class="linenos">2147</span></a>                <span class="s2">&quot;P_loglog.png&quot;</span><span class="p">,</span>
</span><span id="Laws-2148"><a href="#Laws-2148"><span class="linenos">2148</span></a>            <span class="p">)</span>
</span><span id="Laws-2149"><a href="#Laws-2149"><span class="linenos">2149</span></a>        <span class="p">)</span>
</span><span id="Laws-2150"><a href="#Laws-2150"><span class="linenos">2150</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer2</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="Laws-2151"><a href="#Laws-2151"><span class="linenos">2151</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Laws-2152"><a href="#Laws-2152"><span class="linenos">2152</span></a>        <span class="n">buffer2</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Laws-2153"><a href="#Laws-2153"><span class="linenos">2153</span></a>
</span><span id="Laws-2154"><a href="#Laws-2154"><span class="linenos">2154</span></a>        <span class="k">return</span> <span class="n">buffer1</span><span class="p">,</span> <span class="n">buffer2</span>
</span><span id="Laws-2155"><a href="#Laws-2155"><span class="linenos">2155</span></a>
</span><span id="Laws-2156"><a href="#Laws-2156"><span class="linenos">2156</span></a>
</span><span id="Laws-2157"><a href="#Laws-2157"><span class="linenos">2157</span></a>    <span class="k">def</span> <span class="nf">log_curve_fitting_resluts</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Laws-2158"><a href="#Laws-2158"><span class="linenos">2158</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2159"><a href="#Laws-2159"><span class="linenos">2159</span></a><span class="sd">        A decorator that logs and saves curve fitting results</span>
</span><span id="Laws-2160"><a href="#Laws-2160"><span class="linenos">2160</span></a><span class="sd">        to a PDF report.</span>
</span><span id="Laws-2161"><a href="#Laws-2161"><span class="linenos">2161</span></a>
</span><span id="Laws-2162"><a href="#Laws-2162"><span class="linenos">2162</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="Laws-2163"><a href="#Laws-2163"><span class="linenos">2163</span></a><span class="sd">        - func_name (str): Name of the function.</span>
</span><span id="Laws-2164"><a href="#Laws-2164"><span class="linenos">2164</span></a><span class="sd">        - best_fit (str): Name of the best-fitting curve.</span>
</span><span id="Laws-2165"><a href="#Laws-2165"><span class="linenos">2165</span></a><span class="sd">        - param_frame (pd.DataFrame): DataFrame containing</span>
</span><span id="Laws-2166"><a href="#Laws-2166"><span class="linenos">2166</span></a><span class="sd">            curve parameters.</span>
</span><span id="Laws-2167"><a href="#Laws-2167"><span class="linenos">2167</span></a><span class="sd">        - plot_obj (BytesIO): The plot image object.</span>
</span><span id="Laws-2168"><a href="#Laws-2168"><span class="linenos">2168</span></a>
</span><span id="Laws-2169"><a href="#Laws-2169"><span class="linenos">2169</span></a><span class="sd">        The results are logged in `self.stats_frame`</span>
</span><span id="Laws-2170"><a href="#Laws-2170"><span class="linenos">2170</span></a><span class="sd">            and added to a PDF report.</span>
</span><span id="Laws-2171"><a href="#Laws-2171"><span class="linenos">2171</span></a>
</span><span id="Laws-2172"><a href="#Laws-2172"><span class="linenos">2172</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2173"><a href="#Laws-2173"><span class="linenos">2173</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2174"><a href="#Laws-2174"><span class="linenos">2174</span></a><span class="sd">        func : function</span>
</span><span id="Laws-2175"><a href="#Laws-2175"><span class="linenos">2175</span></a><span class="sd">            The function performing curve fitting.</span>
</span><span id="Laws-2176"><a href="#Laws-2176"><span class="linenos">2176</span></a>
</span><span id="Laws-2177"><a href="#Laws-2177"><span class="linenos">2177</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2178"><a href="#Laws-2178"><span class="linenos">2178</span></a><span class="sd">        --------</span>
</span><span id="Laws-2179"><a href="#Laws-2179"><span class="linenos">2179</span></a><span class="sd">        function</span>
</span><span id="Laws-2180"><a href="#Laws-2180"><span class="linenos">2180</span></a><span class="sd">            Wrapped function with additional logging and PDF output.</span>
</span><span id="Laws-2181"><a href="#Laws-2181"><span class="linenos">2181</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2182"><a href="#Laws-2182"><span class="linenos">2182</span></a>
</span><span id="Laws-2183"><a href="#Laws-2183"><span class="linenos">2183</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws-2184"><a href="#Laws-2184"><span class="linenos">2184</span></a>            <span class="n">func_name</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws-2185"><a href="#Laws-2185"><span class="linenos">2185</span></a>            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">param_frame</span><span class="p">[</span><span class="n">param_frame</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_fit</span><span class="p">]</span>
</span><span id="Laws-2186"><a href="#Laws-2186"><span class="linenos">2186</span></a>
</span><span id="Laws-2187"><a href="#Laws-2187"><span class="linenos">2187</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">func_name</span><span class="p">:</span> <span class="n">best_fit</span><span class="p">})</span>
</span><span id="Laws-2188"><a href="#Laws-2188"><span class="linenos">2188</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws-2189"><a href="#Laws-2189"><span class="linenos">2189</span></a>                <span class="p">{</span>
</span><span id="Laws-2190"><a href="#Laws-2190"><span class="linenos">2190</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">filtered_df</span><span class="p">[</span>
</span><span id="Laws-2191"><a href="#Laws-2191"><span class="linenos">2191</span></a>                        <span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">,</span> <span class="s2">&quot;param2&quot;</span><span class="p">]</span>
</span><span id="Laws-2192"><a href="#Laws-2192"><span class="linenos">2192</span></a>                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Laws-2193"><a href="#Laws-2193"><span class="linenos">2193</span></a>                <span class="p">}</span>
</span><span id="Laws-2194"><a href="#Laws-2194"><span class="linenos">2194</span></a>            <span class="p">)</span>
</span><span id="Laws-2195"><a href="#Laws-2195"><span class="linenos">2195</span></a>
</span><span id="Laws-2196"><a href="#Laws-2196"><span class="linenos">2196</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">func_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws-2197"><a href="#Laws-2197"><span class="linenos">2197</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws-2198"><a href="#Laws-2198"><span class="linenos">2198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws-2199"><a href="#Laws-2199"><span class="linenos">2199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws-2200"><a href="#Laws-2200"><span class="linenos">2200</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws-2201"><a href="#Laws-2201"><span class="linenos">2201</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws-2202"><a href="#Laws-2202"><span class="linenos">2202</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">best_fit</span><span class="si">}</span><span class="s1"> with Param 1: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">,&#39;</span>
</span><span id="Laws-2203"><a href="#Laws-2203"><span class="linenos">2203</span></a>                <span class="sa">f</span><span class="s1">&#39;Param 2: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws-2204"><a href="#Laws-2204"><span class="linenos">2204</span></a>            <span class="p">)</span>
</span><span id="Laws-2205"><a href="#Laws-2205"><span class="linenos">2205</span></a>
</span><span id="Laws-2206"><a href="#Laws-2206"><span class="linenos">2206</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws-2207"><a href="#Laws-2207"><span class="linenos">2207</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_curves_table</span><span class="p">(</span>
</span><span id="Laws-2208"><a href="#Laws-2208"><span class="linenos">2208</span></a>                <span class="n">param_frame</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="n">y_position_global</span> <span class="o">+</span> <span class="mi">13</span>
</span><span id="Laws-2209"><a href="#Laws-2209"><span class="linenos">2209</span></a>            <span class="p">)</span>
</span><span id="Laws-2210"><a href="#Laws-2210"><span class="linenos">2210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws-2211"><a href="#Laws-2211"><span class="linenos">2211</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj</span><span class="p">,</span>
</span><span id="Laws-2212"><a href="#Laws-2212"><span class="linenos">2212</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws-2213"><a href="#Laws-2213"><span class="linenos">2213</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws-2214"><a href="#Laws-2214"><span class="linenos">2214</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span>
</span><span id="Laws-2215"><a href="#Laws-2215"><span class="linenos">2215</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws-2216"><a href="#Laws-2216"><span class="linenos">2216</span></a>            <span class="p">)</span>
</span><span id="Laws-2217"><a href="#Laws-2217"><span class="linenos">2217</span></a>
</span><span id="Laws-2218"><a href="#Laws-2218"><span class="linenos">2218</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="Laws-2219"><a href="#Laws-2219"><span class="linenos">2219</span></a>
</span><span id="Laws-2220"><a href="#Laws-2220"><span class="linenos">2220</span></a>
</span><span id="Laws-2221"><a href="#Laws-2221"><span class="linenos">2221</span></a>    <span class="k">def</span> <span class="nf">log_distribution_fitting_resluts</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Laws-2222"><a href="#Laws-2222"><span class="linenos">2222</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2223"><a href="#Laws-2223"><span class="linenos">2223</span></a><span class="sd">        A decorator that logs and saves distribution fitting</span>
</span><span id="Laws-2224"><a href="#Laws-2224"><span class="linenos">2224</span></a><span class="sd">        results to a PDF report.</span>
</span><span id="Laws-2225"><a href="#Laws-2225"><span class="linenos">2225</span></a>
</span><span id="Laws-2226"><a href="#Laws-2226"><span class="linenos">2226</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="Laws-2227"><a href="#Laws-2227"><span class="linenos">2227</span></a><span class="sd">        - results[0] (str): The name of the fitted distribution.</span>
</span><span id="Laws-2228"><a href="#Laws-2228"><span class="linenos">2228</span></a><span class="sd">        - results[1] (distfit object): Fitted distribution model.</span>
</span><span id="Laws-2229"><a href="#Laws-2229"><span class="linenos">2229</span></a><span class="sd">        - results[2] (BytesIO): Distribution plot.</span>
</span><span id="Laws-2230"><a href="#Laws-2230"><span class="linenos">2230</span></a><span class="sd">        - results[3] (BytesIO): Model plot.</span>
</span><span id="Laws-2231"><a href="#Laws-2231"><span class="linenos">2231</span></a><span class="sd">        - results[4] (tuple, optional): If present, contains</span>
</span><span id="Laws-2232"><a href="#Laws-2232"><span class="linenos">2232</span></a><span class="sd">            information about a flexion point.</span>
</span><span id="Laws-2233"><a href="#Laws-2233"><span class="linenos">2233</span></a>
</span><span id="Laws-2234"><a href="#Laws-2234"><span class="linenos">2234</span></a><span class="sd">        If a flexion point is detected, it logs both left</span>
</span><span id="Laws-2235"><a href="#Laws-2235"><span class="linenos">2235</span></a><span class="sd">        and right distributions and plots them separately.</span>
</span><span id="Laws-2236"><a href="#Laws-2236"><span class="linenos">2236</span></a>
</span><span id="Laws-2237"><a href="#Laws-2237"><span class="linenos">2237</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2238"><a href="#Laws-2238"><span class="linenos">2238</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2239"><a href="#Laws-2239"><span class="linenos">2239</span></a><span class="sd">        func : function</span>
</span><span id="Laws-2240"><a href="#Laws-2240"><span class="linenos">2240</span></a><span class="sd">            The function performing distribution fitting.</span>
</span><span id="Laws-2241"><a href="#Laws-2241"><span class="linenos">2241</span></a>
</span><span id="Laws-2242"><a href="#Laws-2242"><span class="linenos">2242</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2243"><a href="#Laws-2243"><span class="linenos">2243</span></a><span class="sd">        --------</span>
</span><span id="Laws-2244"><a href="#Laws-2244"><span class="linenos">2244</span></a><span class="sd">        function</span>
</span><span id="Laws-2245"><a href="#Laws-2245"><span class="linenos">2245</span></a><span class="sd">            Wrapped function with additional logging and PDF output.</span>
</span><span id="Laws-2246"><a href="#Laws-2246"><span class="linenos">2246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2247"><a href="#Laws-2247"><span class="linenos">2247</span></a>
</span><span id="Laws-2248"><a href="#Laws-2248"><span class="linenos">2248</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws-2249"><a href="#Laws-2249"><span class="linenos">2249</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws-2250"><a href="#Laws-2250"><span class="linenos">2250</span></a>
</span><span id="Laws-2251"><a href="#Laws-2251"><span class="linenos">2251</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]})</span>
</span><span id="Laws-2252"><a href="#Laws-2252"><span class="linenos">2252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws-2253"><a href="#Laws-2253"><span class="linenos">2253</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]}</span>
</span><span id="Laws-2254"><a href="#Laws-2254"><span class="linenos">2254</span></a>            <span class="p">)</span>
</span><span id="Laws-2255"><a href="#Laws-2255"><span class="linenos">2255</span></a>
</span><span id="Laws-2256"><a href="#Laws-2256"><span class="linenos">2256</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws-2257"><a href="#Laws-2257"><span class="linenos">2257</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws-2258"><a href="#Laws-2258"><span class="linenos">2258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws-2259"><a href="#Laws-2259"><span class="linenos">2259</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws-2260"><a href="#Laws-2260"><span class="linenos">2260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws-2261"><a href="#Laws-2261"><span class="linenos">2261</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws-2262"><a href="#Laws-2262"><span class="linenos">2262</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws-2263"><a href="#Laws-2263"><span class="linenos">2263</span></a>            <span class="p">)</span>
</span><span id="Laws-2264"><a href="#Laws-2264"><span class="linenos">2264</span></a>
</span><span id="Laws-2265"><a href="#Laws-2265"><span class="linenos">2265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws-2266"><a href="#Laws-2266"><span class="linenos">2266</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws-2267"><a href="#Laws-2267"><span class="linenos">2267</span></a>            <span class="p">)</span>
</span><span id="Laws-2268"><a href="#Laws-2268"><span class="linenos">2268</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws-2269"><a href="#Laws-2269"><span class="linenos">2269</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws-2270"><a href="#Laws-2270"><span class="linenos">2270</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws-2271"><a href="#Laws-2271"><span class="linenos">2271</span></a>            <span class="p">)</span>
</span><span id="Laws-2272"><a href="#Laws-2272"><span class="linenos">2272</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws-2273"><a href="#Laws-2273"><span class="linenos">2273</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws-2274"><a href="#Laws-2274"><span class="linenos">2274</span></a>            <span class="p">)</span>
</span><span id="Laws-2275"><a href="#Laws-2275"><span class="linenos">2275</span></a>
</span><span id="Laws-2276"><a href="#Laws-2276"><span class="linenos">2276</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Laws-2277"><a href="#Laws-2277"><span class="linenos">2277</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws-2278"><a href="#Laws-2278"><span class="linenos">2278</span></a>                    <span class="sa">f</span><span class="s2">&quot;At point </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">, the flexion point of the distributions was found&quot;</span>
</span><span id="Laws-2279"><a href="#Laws-2279"><span class="linenos">2279</span></a>                <span class="p">)</span>
</span><span id="Laws-2280"><a href="#Laws-2280"><span class="linenos">2280</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws-2281"><a href="#Laws-2281"><span class="linenos">2281</span></a>                    <span class="sa">f</span><span class="s1">&#39;Left distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws-2282"><a href="#Laws-2282"><span class="linenos">2282</span></a>                <span class="p">)</span>
</span><span id="Laws-2283"><a href="#Laws-2283"><span class="linenos">2283</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws-2284"><a href="#Laws-2284"><span class="linenos">2284</span></a>                    <span class="sa">f</span><span class="s1">&#39;Right distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws-2285"><a href="#Laws-2285"><span class="linenos">2285</span></a>                <span class="p">)</span>
</span><span id="Laws-2286"><a href="#Laws-2286"><span class="linenos">2286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws-2287"><a href="#Laws-2287"><span class="linenos">2287</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws-2288"><a href="#Laws-2288"><span class="linenos">2288</span></a>                <span class="p">)</span>
</span><span id="Laws-2289"><a href="#Laws-2289"><span class="linenos">2289</span></a>                <span class="n">plot_distribution</span><span class="p">,</span> <span class="n">plot_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_double_distribution</span><span class="p">(</span>
</span><span id="Laws-2290"><a href="#Laws-2290"><span class="linenos">2290</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws-2291"><a href="#Laws-2291"><span class="linenos">2291</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
</span><span id="Laws-2292"><a href="#Laws-2292"><span class="linenos">2292</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
</span><span id="Laws-2293"><a href="#Laws-2293"><span class="linenos">2293</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
</span><span id="Laws-2294"><a href="#Laws-2294"><span class="linenos">2294</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
</span><span id="Laws-2295"><a href="#Laws-2295"><span class="linenos">2295</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws-2296"><a href="#Laws-2296"><span class="linenos">2296</span></a>                <span class="p">)</span>
</span><span id="Laws-2297"><a href="#Laws-2297"><span class="linenos">2297</span></a>                <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws-2298"><a href="#Laws-2298"><span class="linenos">2298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws-2299"><a href="#Laws-2299"><span class="linenos">2299</span></a>                    <span class="n">plot_distribution</span><span class="p">,</span>
</span><span id="Laws-2300"><a href="#Laws-2300"><span class="linenos">2300</span></a>                    <span class="mi">80</span><span class="p">,</span>
</span><span id="Laws-2301"><a href="#Laws-2301"><span class="linenos">2301</span></a>                    <span class="mi">60</span><span class="p">,</span>
</span><span id="Laws-2302"><a href="#Laws-2302"><span class="linenos">2302</span></a>                    <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Laws-2303"><a href="#Laws-2303"><span class="linenos">2303</span></a>                    <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws-2304"><a href="#Laws-2304"><span class="linenos">2304</span></a>                <span class="p">)</span>
</span><span id="Laws-2305"><a href="#Laws-2305"><span class="linenos">2305</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws-2306"><a href="#Laws-2306"><span class="linenos">2306</span></a>                    <span class="n">plot_models</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws-2307"><a href="#Laws-2307"><span class="linenos">2307</span></a>                <span class="p">)</span>
</span><span id="Laws-2308"><a href="#Laws-2308"><span class="linenos">2308</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span><span id="Laws-2309"><a href="#Laws-2309"><span class="linenos">2309</span></a>
</span><span id="Laws-2310"><a href="#Laws-2310"><span class="linenos">2310</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="Laws-2311"><a href="#Laws-2311"><span class="linenos">2311</span></a>
</span><span id="Laws-2312"><a href="#Laws-2312"><span class="linenos">2312</span></a>
</span><span id="Laws-2313"><a href="#Laws-2313"><span class="linenos">2313</span></a>    <span class="k">def</span> <span class="nf">log_pnew_estimation</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Laws-2314"><a href="#Laws-2314"><span class="linenos">2314</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2315"><a href="#Laws-2315"><span class="linenos">2315</span></a><span class="sd">        A decorator that logs and saves P_new estimation results</span>
</span><span id="Laws-2316"><a href="#Laws-2316"><span class="linenos">2316</span></a><span class="sd">        to a PDF report.</span>
</span><span id="Laws-2317"><a href="#Laws-2317"><span class="linenos">2317</span></a>
</span><span id="Laws-2318"><a href="#Laws-2318"><span class="linenos">2318</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="Laws-2319"><a href="#Laws-2319"><span class="linenos">2319</span></a><span class="sd">        - rho_est (float): Estimated rho parameter.</span>
</span><span id="Laws-2320"><a href="#Laws-2320"><span class="linenos">2320</span></a><span class="sd">        - gamma_est (float): Estimated gamma parameter.</span>
</span><span id="Laws-2321"><a href="#Laws-2321"><span class="linenos">2321</span></a><span class="sd">        - DeltaS (np.ndarray): Change in S values for log-log regression.</span>
</span><span id="Laws-2322"><a href="#Laws-2322"><span class="linenos">2322</span></a><span class="sd">        - S_mid (np.ndarray): Midpoints of S values for log-log regression.</span>
</span><span id="Laws-2323"><a href="#Laws-2323"><span class="linenos">2323</span></a><span class="sd">        - intercept (float): Intercept of the fitted regression line.</span>
</span><span id="Laws-2324"><a href="#Laws-2324"><span class="linenos">2324</span></a><span class="sd">        - slope (float): Slope of the fitted regression line.</span>
</span><span id="Laws-2325"><a href="#Laws-2325"><span class="linenos">2325</span></a><span class="sd">        - nrows (int): Number of time steps for estimation.</span>
</span><span id="Laws-2326"><a href="#Laws-2326"><span class="linenos">2326</span></a><span class="sd">        - n_data (int): Number of data points.</span>
</span><span id="Laws-2327"><a href="#Laws-2327"><span class="linenos">2327</span></a>
</span><span id="Laws-2328"><a href="#Laws-2328"><span class="linenos">2328</span></a><span class="sd">        The results are logged in `self.stats_frame`</span>
</span><span id="Laws-2329"><a href="#Laws-2329"><span class="linenos">2329</span></a><span class="sd">        and visualized in a PDF.</span>
</span><span id="Laws-2330"><a href="#Laws-2330"><span class="linenos">2330</span></a>
</span><span id="Laws-2331"><a href="#Laws-2331"><span class="linenos">2331</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2332"><a href="#Laws-2332"><span class="linenos">2332</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2333"><a href="#Laws-2333"><span class="linenos">2333</span></a><span class="sd">        func : function</span>
</span><span id="Laws-2334"><a href="#Laws-2334"><span class="linenos">2334</span></a><span class="sd">            The function performing P_new estimation.</span>
</span><span id="Laws-2335"><a href="#Laws-2335"><span class="linenos">2335</span></a>
</span><span id="Laws-2336"><a href="#Laws-2336"><span class="linenos">2336</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2337"><a href="#Laws-2337"><span class="linenos">2337</span></a><span class="sd">        --------</span>
</span><span id="Laws-2338"><a href="#Laws-2338"><span class="linenos">2338</span></a><span class="sd">        function</span>
</span><span id="Laws-2339"><a href="#Laws-2339"><span class="linenos">2339</span></a><span class="sd">            Wrapped function with additional logging and PDF output.</span>
</span><span id="Laws-2340"><a href="#Laws-2340"><span class="linenos">2340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2341"><a href="#Laws-2341"><span class="linenos">2341</span></a>
</span><span id="Laws-2342"><a href="#Laws-2342"><span class="linenos">2342</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws-2343"><a href="#Laws-2343"><span class="linenos">2343</span></a>            <span class="n">rho_est</span><span class="p">,</span> <span class="n">gamma_est</span><span class="p">,</span> <span class="n">DeltaS</span><span class="p">,</span> <span class="n">S_mid</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span>
</span><span id="Laws-2344"><a href="#Laws-2344"><span class="linenos">2344</span></a>                <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Laws-2345"><a href="#Laws-2345"><span class="linenos">2345</span></a>            <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws-2346"><a href="#Laws-2346"><span class="linenos">2346</span></a>
</span><span id="Laws-2347"><a href="#Laws-2347"><span class="linenos">2347</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;rho&quot;</span><span class="p">:</span> <span class="n">rho_est</span><span class="p">})</span>
</span><span id="Laws-2348"><a href="#Laws-2348"><span class="linenos">2348</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">gamma_est</span><span class="p">})</span>
</span><span id="Laws-2349"><a href="#Laws-2349"><span class="linenos">2349</span></a>
</span><span id="Laws-2350"><a href="#Laws-2350"><span class="linenos">2350</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws-2351"><a href="#Laws-2351"><span class="linenos">2351</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="s2">&quot;Pnew estimation&quot;</span><span class="p">)</span>
</span><span id="Laws-2352"><a href="#Laws-2352"><span class="linenos">2352</span></a>
</span><span id="Laws-2353"><a href="#Laws-2353"><span class="linenos">2353</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="Laws-2354"><a href="#Laws-2354"><span class="linenos">2354</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="Laws-2355"><a href="#Laws-2355"><span class="linenos">2355</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws-2356"><a href="#Laws-2356"><span class="linenos">2356</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;gamma  = </span><span class="si">{</span><span class="n">gamma_est</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws-2357"><a href="#Laws-2357"><span class="linenos">2357</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;rho  = </span><span class="si">{</span><span class="n">rho_est</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws-2358"><a href="#Laws-2358"><span class="linenos">2358</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws-2359"><a href="#Laws-2359"><span class="linenos">2359</span></a>            <span class="n">plot_obj1</span><span class="p">,</span> <span class="n">plot_obj2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_P_new</span><span class="p">(</span>
</span><span id="Laws-2360"><a href="#Laws-2360"><span class="linenos">2360</span></a>                <span class="n">rho_est</span><span class="p">,</span> <span class="n">gamma_est</span><span class="p">,</span> <span class="n">DeltaS</span><span class="p">,</span> <span class="n">S_mid</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span>
</span><span id="Laws-2361"><a href="#Laws-2361"><span class="linenos">2361</span></a>            <span class="p">)</span>
</span><span id="Laws-2362"><a href="#Laws-2362"><span class="linenos">2362</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws-2363"><a href="#Laws-2363"><span class="linenos">2363</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj1</span><span class="p">,</span>
</span><span id="Laws-2364"><a href="#Laws-2364"><span class="linenos">2364</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws-2365"><a href="#Laws-2365"><span class="linenos">2365</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws-2366"><a href="#Laws-2366"><span class="linenos">2366</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Laws-2367"><a href="#Laws-2367"><span class="linenos">2367</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws-2368"><a href="#Laws-2368"><span class="linenos">2368</span></a>            <span class="p">)</span>
</span><span id="Laws-2369"><a href="#Laws-2369"><span class="linenos">2369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws-2370"><a href="#Laws-2370"><span class="linenos">2370</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj2</span><span class="p">,</span>
</span><span id="Laws-2371"><a href="#Laws-2371"><span class="linenos">2371</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws-2372"><a href="#Laws-2372"><span class="linenos">2372</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws-2373"><a href="#Laws-2373"><span class="linenos">2373</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span>
</span><span id="Laws-2374"><a href="#Laws-2374"><span class="linenos">2374</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws-2375"><a href="#Laws-2375"><span class="linenos">2375</span></a>            <span class="p">)</span>
</span><span id="Laws-2376"><a href="#Laws-2376"><span class="linenos">2376</span></a>
</span><span id="Laws-2377"><a href="#Laws-2377"><span class="linenos">2377</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="Laws-2378"><a href="#Laws-2378"><span class="linenos">2378</span></a>
</span><span id="Laws-2379"><a href="#Laws-2379"><span class="linenos">2379</span></a>
</span><span id="Laws-2380"><a href="#Laws-2380"><span class="linenos">2380</span></a>    <span class="k">def</span> <span class="nf">log_msd_split</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Laws-2381"><a href="#Laws-2381"><span class="linenos">2381</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2382"><a href="#Laws-2382"><span class="linenos">2382</span></a><span class="sd">        A decorator that logs and saves MSD split results</span>
</span><span id="Laws-2383"><a href="#Laws-2383"><span class="linenos">2383</span></a><span class="sd">        to a PDF report.</span>
</span><span id="Laws-2384"><a href="#Laws-2384"><span class="linenos">2384</span></a>
</span><span id="Laws-2385"><a href="#Laws-2385"><span class="linenos">2385</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="Laws-2386"><a href="#Laws-2386"><span class="linenos">2386</span></a><span class="sd">        - msd_results (pd.DataFrame): MSD split results</span>
</span><span id="Laws-2387"><a href="#Laws-2387"><span class="linenos">2387</span></a><span class="sd">            including range and curve parameters.</span>
</span><span id="Laws-2388"><a href="#Laws-2388"><span class="linenos">2388</span></a><span class="sd">        - plot_obj (BytesIO): The plot image object.</span>
</span><span id="Laws-2389"><a href="#Laws-2389"><span class="linenos">2389</span></a>
</span><span id="Laws-2390"><a href="#Laws-2390"><span class="linenos">2390</span></a><span class="sd">        The results are stored in `self.stats_frame`</span>
</span><span id="Laws-2391"><a href="#Laws-2391"><span class="linenos">2391</span></a><span class="sd">        and included in a PDF report.</span>
</span><span id="Laws-2392"><a href="#Laws-2392"><span class="linenos">2392</span></a>
</span><span id="Laws-2393"><a href="#Laws-2393"><span class="linenos">2393</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2394"><a href="#Laws-2394"><span class="linenos">2394</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2395"><a href="#Laws-2395"><span class="linenos">2395</span></a><span class="sd">        func : function</span>
</span><span id="Laws-2396"><a href="#Laws-2396"><span class="linenos">2396</span></a><span class="sd">            The function performing MSD split analysis.</span>
</span><span id="Laws-2397"><a href="#Laws-2397"><span class="linenos">2397</span></a>
</span><span id="Laws-2398"><a href="#Laws-2398"><span class="linenos">2398</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2399"><a href="#Laws-2399"><span class="linenos">2399</span></a><span class="sd">        --------</span>
</span><span id="Laws-2400"><a href="#Laws-2400"><span class="linenos">2400</span></a><span class="sd">        function</span>
</span><span id="Laws-2401"><a href="#Laws-2401"><span class="linenos">2401</span></a><span class="sd">            Wrapped function with additional logging and PDF output.</span>
</span><span id="Laws-2402"><a href="#Laws-2402"><span class="linenos">2402</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2403"><a href="#Laws-2403"><span class="linenos">2403</span></a>
</span><span id="Laws-2404"><a href="#Laws-2404"><span class="linenos">2404</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws-2405"><a href="#Laws-2405"><span class="linenos">2405</span></a>            <span class="n">msd_results</span><span class="p">,</span> <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws-2406"><a href="#Laws-2406"><span class="linenos">2406</span></a>            <span class="n">msd_curve</span> <span class="o">=</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws-2407"><a href="#Laws-2407"><span class="linenos">2407</span></a>                <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;RoG range [km]&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span>
</span><span id="Laws-2408"><a href="#Laws-2408"><span class="linenos">2408</span></a>            <span class="p">)</span>
</span><span id="Laws-2409"><a href="#Laws-2409"><span class="linenos">2409</span></a>            <span class="n">msd_curve_params</span> <span class="o">=</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws-2410"><a href="#Laws-2410"><span class="linenos">2410</span></a>                <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;RoG range [km]&quot;</span><span class="p">]</span>
</span><span id="Laws-2411"><a href="#Laws-2411"><span class="linenos">2411</span></a>                <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
</span><span id="Laws-2412"><a href="#Laws-2412"><span class="linenos">2412</span></a>                <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span>
</span><span id="Laws-2413"><a href="#Laws-2413"><span class="linenos">2413</span></a>                <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</span><span id="Laws-2414"><a href="#Laws-2414"><span class="linenos">2414</span></a>                <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
</span><span id="Laws-2415"><a href="#Laws-2415"><span class="linenos">2415</span></a>                <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="Laws-2416"><a href="#Laws-2416"><span class="linenos">2416</span></a>                <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
</span><span id="Laws-2417"><a href="#Laws-2417"><span class="linenos">2417</span></a>                <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="Laws-2418"><a href="#Laws-2418"><span class="linenos">2418</span></a>            <span class="p">)</span>
</span><span id="Laws-2419"><a href="#Laws-2419"><span class="linenos">2419</span></a>
</span><span id="Laws-2420"><a href="#Laws-2420"><span class="linenos">2420</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;msd_curve&quot;</span><span class="p">:</span> <span class="n">msd_curve</span><span class="p">})</span>
</span><span id="Laws-2421"><a href="#Laws-2421"><span class="linenos">2421</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;msd_curve_params&quot;</span><span class="p">:</span> <span class="n">msd_curve_params</span><span class="p">})</span>
</span><span id="Laws-2422"><a href="#Laws-2422"><span class="linenos">2422</span></a>
</span><span id="Laws-2423"><a href="#Laws-2423"><span class="linenos">2423</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws-2424"><a href="#Laws-2424"><span class="linenos">2424</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="s2">&quot;MSD split&quot;</span><span class="p">)</span>
</span><span id="Laws-2425"><a href="#Laws-2425"><span class="linenos">2425</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws-2426"><a href="#Laws-2426"><span class="linenos">2426</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="Laws-2427"><a href="#Laws-2427"><span class="linenos">2427</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_msd_split_table</span><span class="p">(</span><span class="n">msd_results</span><span class="p">)</span>
</span><span id="Laws-2428"><a href="#Laws-2428"><span class="linenos">2428</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws-2429"><a href="#Laws-2429"><span class="linenos">2429</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj</span><span class="p">,</span>
</span><span id="Laws-2430"><a href="#Laws-2430"><span class="linenos">2430</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws-2431"><a href="#Laws-2431"><span class="linenos">2431</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws-2432"><a href="#Laws-2432"><span class="linenos">2432</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span>
</span><span id="Laws-2433"><a href="#Laws-2433"><span class="linenos">2433</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws-2434"><a href="#Laws-2434"><span class="linenos">2434</span></a>            <span class="p">)</span>
</span><span id="Laws-2435"><a href="#Laws-2435"><span class="linenos">2435</span></a>
</span><span id="Laws-2436"><a href="#Laws-2436"><span class="linenos">2436</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="Laws-2437"><a href="#Laws-2437"><span class="linenos">2437</span></a>
</span><span id="Laws-2438"><a href="#Laws-2438"><span class="linenos">2438</span></a>
</span><span id="Laws-2439"><a href="#Laws-2439"><span class="linenos">2439</span></a>    <span class="k">def</span> <span class="nf">check_curve_fit</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Laws-2440"><a href="#Laws-2440"><span class="linenos">2440</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2441"><a href="#Laws-2441"><span class="linenos">2441</span></a><span class="sd">        A decorator that evaluates curve fitting results</span>
</span><span id="Laws-2442"><a href="#Laws-2442"><span class="linenos">2442</span></a><span class="sd">        and generates a corresponding plot.</span>
</span><span id="Laws-2443"><a href="#Laws-2443"><span class="linenos">2443</span></a>
</span><span id="Laws-2444"><a href="#Laws-2444"><span class="linenos">2444</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="Laws-2445"><a href="#Laws-2445"><span class="linenos">2445</span></a><span class="sd">        - best_fit (str): Name of the best-fitting curve.</span>
</span><span id="Laws-2446"><a href="#Laws-2446"><span class="linenos">2446</span></a><span class="sd">        - param_frame (pd.DataFrame): DataFrame containing</span>
</span><span id="Laws-2447"><a href="#Laws-2447"><span class="linenos">2447</span></a><span class="sd">            curve parameters.</span>
</span><span id="Laws-2448"><a href="#Laws-2448"><span class="linenos">2448</span></a><span class="sd">        - y_pred (np.ndarray): Predicted values based on</span>
</span><span id="Laws-2449"><a href="#Laws-2449"><span class="linenos">2449</span></a><span class="sd">            the curve fitting.</span>
</span><span id="Laws-2450"><a href="#Laws-2450"><span class="linenos">2450</span></a><span class="sd">        - exp_y_pred (np.ndarray or None): Exponential</span>
</span><span id="Laws-2451"><a href="#Laws-2451"><span class="linenos">2451</span></a><span class="sd">            curve prediction (if applicable).</span>
</span><span id="Laws-2452"><a href="#Laws-2452"><span class="linenos">2452</span></a><span class="sd">        - plot_data (pd.Series or np.ndarray): Data used for fitting.</span>
</span><span id="Laws-2453"><a href="#Laws-2453"><span class="linenos">2453</span></a><span class="sd">        - labels (list): Axis labels for the plot.</span>
</span><span id="Laws-2454"><a href="#Laws-2454"><span class="linenos">2454</span></a>
</span><span id="Laws-2455"><a href="#Laws-2455"><span class="linenos">2455</span></a><span class="sd">        If `best_fit` is not among {&quot;linear&quot;, &quot;expon&quot;, &quot;expon_neg&quot;},</span>
</span><span id="Laws-2456"><a href="#Laws-2456"><span class="linenos">2456</span></a><span class="sd">        both the fitted curve and an additional exponential curve</span>
</span><span id="Laws-2457"><a href="#Laws-2457"><span class="linenos">2457</span></a><span class="sd">        are plotted. Otherwise, only the fitted curve is plotted.</span>
</span><span id="Laws-2458"><a href="#Laws-2458"><span class="linenos">2458</span></a>
</span><span id="Laws-2459"><a href="#Laws-2459"><span class="linenos">2459</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2460"><a href="#Laws-2460"><span class="linenos">2460</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2461"><a href="#Laws-2461"><span class="linenos">2461</span></a><span class="sd">        func : function</span>
</span><span id="Laws-2462"><a href="#Laws-2462"><span class="linenos">2462</span></a><span class="sd">            The function performing curve fitting.</span>
</span><span id="Laws-2463"><a href="#Laws-2463"><span class="linenos">2463</span></a>
</span><span id="Laws-2464"><a href="#Laws-2464"><span class="linenos">2464</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2465"><a href="#Laws-2465"><span class="linenos">2465</span></a><span class="sd">        --------</span>
</span><span id="Laws-2466"><a href="#Laws-2466"><span class="linenos">2466</span></a><span class="sd">        function</span>
</span><span id="Laws-2467"><a href="#Laws-2467"><span class="linenos">2467</span></a><span class="sd">            Wrapped function that returns:</span>
</span><span id="Laws-2468"><a href="#Laws-2468"><span class="linenos">2468</span></a><span class="sd">            - func.__name__ (str): Name of the function.</span>
</span><span id="Laws-2469"><a href="#Laws-2469"><span class="linenos">2469</span></a><span class="sd">            - best_fit (str): Best fitting curve name.</span>
</span><span id="Laws-2470"><a href="#Laws-2470"><span class="linenos">2470</span></a><span class="sd">            - param_frame (pd.DataFrame): Parameters of</span>
</span><span id="Laws-2471"><a href="#Laws-2471"><span class="linenos">2471</span></a><span class="sd">                the best fit.</span>
</span><span id="Laws-2472"><a href="#Laws-2472"><span class="linenos">2472</span></a><span class="sd">            - plot_obj (BytesIO): Image object containing</span>
</span><span id="Laws-2473"><a href="#Laws-2473"><span class="linenos">2473</span></a><span class="sd">                the generated plot.</span>
</span><span id="Laws-2474"><a href="#Laws-2474"><span class="linenos">2474</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2475"><a href="#Laws-2475"><span class="linenos">2475</span></a>
</span><span id="Laws-2476"><a href="#Laws-2476"><span class="linenos">2476</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws-2477"><a href="#Laws-2477"><span class="linenos">2477</span></a>            <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">exp_y_pred</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span>
</span><span id="Laws-2478"><a href="#Laws-2478"><span class="linenos">2478</span></a>                <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Laws-2479"><a href="#Laws-2479"><span class="linenos">2479</span></a>            <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws-2480"><a href="#Laws-2480"><span class="linenos">2480</span></a>            <span class="k">if</span> <span class="n">best_fit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="s2">&quot;expon&quot;</span><span class="p">,</span> <span class="s2">&quot;expon_neg&quot;</span><span class="p">}:</span>
</span><span id="Laws-2481"><a href="#Laws-2481"><span class="linenos">2481</span></a>                <span class="n">plot_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_curve</span><span class="p">(</span>
</span><span id="Laws-2482"><a href="#Laws-2482"><span class="linenos">2482</span></a>                    <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">exp_y_pred</span>
</span><span id="Laws-2483"><a href="#Laws-2483"><span class="linenos">2483</span></a>                <span class="p">)</span>
</span><span id="Laws-2484"><a href="#Laws-2484"><span class="linenos">2484</span></a>                <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">plot_obj</span>
</span><span id="Laws-2485"><a href="#Laws-2485"><span class="linenos">2485</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Laws-2486"><a href="#Laws-2486"><span class="linenos">2486</span></a>                <span class="n">plot_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_curve</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</span><span id="Laws-2487"><a href="#Laws-2487"><span class="linenos">2487</span></a>                <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">plot_obj</span>
</span><span id="Laws-2488"><a href="#Laws-2488"><span class="linenos">2488</span></a>
</span><span id="Laws-2489"><a href="#Laws-2489"><span class="linenos">2489</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="Laws-2490"><a href="#Laws-2490"><span class="linenos">2490</span></a>
</span><span id="Laws-2491"><a href="#Laws-2491"><span class="linenos">2491</span></a>
</span><span id="Laws-2492"><a href="#Laws-2492"><span class="linenos">2492</span></a>    <span class="k">def</span> <span class="nf">check_distribution_fit</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Laws-2493"><a href="#Laws-2493"><span class="linenos">2493</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2494"><a href="#Laws-2494"><span class="linenos">2494</span></a><span class="sd">        A decorator that evaluates the results of distribution</span>
</span><span id="Laws-2495"><a href="#Laws-2495"><span class="linenos">2495</span></a><span class="sd">        fitting and detects flexation points.</span>
</span><span id="Laws-2496"><a href="#Laws-2496"><span class="linenos">2496</span></a>
</span><span id="Laws-2497"><a href="#Laws-2497"><span class="linenos">2497</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="Laws-2498"><a href="#Laws-2498"><span class="linenos">2498</span></a><span class="sd">        - model (distfit object): The best-fitted distribution</span>
</span><span id="Laws-2499"><a href="#Laws-2499"><span class="linenos">2499</span></a><span class="sd">            model.</span>
</span><span id="Laws-2500"><a href="#Laws-2500"><span class="linenos">2500</span></a><span class="sd">        - data (pd.Series or np.ndarray): Data used for</span>
</span><span id="Laws-2501"><a href="#Laws-2501"><span class="linenos">2501</span></a><span class="sd">            distribution fitting.</span>
</span><span id="Laws-2502"><a href="#Laws-2502"><span class="linenos">2502</span></a>
</span><span id="Laws-2503"><a href="#Laws-2503"><span class="linenos">2503</span></a><span class="sd">        The function generates:</span>
</span><span id="Laws-2504"><a href="#Laws-2504"><span class="linenos">2504</span></a><span class="sd">        - A histogram plot of the fitted distribution.</span>
</span><span id="Laws-2505"><a href="#Laws-2505"><span class="linenos">2505</span></a><span class="sd">        - A model plot displaying the probability density function (PDF).</span>
</span><span id="Laws-2506"><a href="#Laws-2506"><span class="linenos">2506</span></a>
</span><span id="Laws-2507"><a href="#Laws-2507"><span class="linenos">2507</span></a><span class="sd">        If the fitted distribution is not in `const.DISTRIBUTIONS`</span>
</span><span id="Laws-2508"><a href="#Laws-2508"><span class="linenos">2508</span></a><span class="sd">        and the data has at least 4 observations, or if specific conditions</span>
</span><span id="Laws-2509"><a href="#Laws-2509"><span class="linenos">2509</span></a><span class="sd">        apply (e.g., Pareto or Lognormal with parameter &gt; 2),</span>
</span><span id="Laws-2510"><a href="#Laws-2510"><span class="linenos">2510</span></a><span class="sd">        an attempt is made to detect flexation points in the distribution.</span>
</span><span id="Laws-2511"><a href="#Laws-2511"><span class="linenos">2511</span></a>
</span><span id="Laws-2512"><a href="#Laws-2512"><span class="linenos">2512</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2513"><a href="#Laws-2513"><span class="linenos">2513</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2514"><a href="#Laws-2514"><span class="linenos">2514</span></a><span class="sd">        func : function</span>
</span><span id="Laws-2515"><a href="#Laws-2515"><span class="linenos">2515</span></a><span class="sd">            The function performing distribution fitting.</span>
</span><span id="Laws-2516"><a href="#Laws-2516"><span class="linenos">2516</span></a>
</span><span id="Laws-2517"><a href="#Laws-2517"><span class="linenos">2517</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2518"><a href="#Laws-2518"><span class="linenos">2518</span></a><span class="sd">        --------</span>
</span><span id="Laws-2519"><a href="#Laws-2519"><span class="linenos">2519</span></a><span class="sd">        function</span>
</span><span id="Laws-2520"><a href="#Laws-2520"><span class="linenos">2520</span></a><span class="sd">            Wrapped function that returns:</span>
</span><span id="Laws-2521"><a href="#Laws-2521"><span class="linenos">2521</span></a><span class="sd">            - func.__name__ (str): Name of the function.</span>
</span><span id="Laws-2522"><a href="#Laws-2522"><span class="linenos">2522</span></a><span class="sd">            - model (distfit object): Best-fitting distribution model.</span>
</span><span id="Laws-2523"><a href="#Laws-2523"><span class="linenos">2523</span></a><span class="sd">            - plot_distribution_obj (BytesIO): Image object containing</span>
</span><span id="Laws-2524"><a href="#Laws-2524"><span class="linenos">2524</span></a><span class="sd">                the histogram plot.</span>
</span><span id="Laws-2525"><a href="#Laws-2525"><span class="linenos">2525</span></a><span class="sd">            - plot_model_obj (BytesIO): Image object containing the PDF plot.</span>
</span><span id="Laws-2526"><a href="#Laws-2526"><span class="linenos">2526</span></a><span class="sd">            - flexation_point_detection_results (tuple, optional):</span>
</span><span id="Laws-2527"><a href="#Laws-2527"><span class="linenos">2527</span></a><span class="sd">            If flexation points are found, returns details of left</span>
</span><span id="Laws-2528"><a href="#Laws-2528"><span class="linenos">2528</span></a><span class="sd">            and right distributions.</span>
</span><span id="Laws-2529"><a href="#Laws-2529"><span class="linenos">2529</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2530"><a href="#Laws-2530"><span class="linenos">2530</span></a>
</span><span id="Laws-2531"><a href="#Laws-2531"><span class="linenos">2531</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws-2532"><a href="#Laws-2532"><span class="linenos">2532</span></a>            <span class="n">model</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws-2533"><a href="#Laws-2533"><span class="linenos">2533</span></a>
</span><span id="Laws-2534"><a href="#Laws-2534"><span class="linenos">2534</span></a>            <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_distribution</span><span class="p">(</span>
</span><span id="Laws-2535"><a href="#Laws-2535"><span class="linenos">2535</span></a>                <span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="Laws-2536"><a href="#Laws-2536"><span class="linenos">2536</span></a>            <span class="p">)</span>
</span><span id="Laws-2537"><a href="#Laws-2537"><span class="linenos">2537</span></a>            <span class="k">if</span> <span class="p">(</span>
</span><span id="Laws-2538"><a href="#Laws-2538"><span class="linenos">2538</span></a>                <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">const</span><span class="o">.</span><span class="n">DISTRIBUTIONS</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">4</span>
</span><span id="Laws-2539"><a href="#Laws-2539"><span class="linenos">2539</span></a>            <span class="p">):</span>  <span class="c1"># FIXME:</span>
</span><span id="Laws-2540"><a href="#Laws-2540"><span class="linenos">2540</span></a>                <span class="n">flexation_point_detection_results</span> <span class="o">=</span> <span class="n">Flexation</span><span class="p">()</span><span class="o">.</span><span class="n">find_distributions</span><span class="p">(</span>
</span><span id="Laws-2541"><a href="#Laws-2541"><span class="linenos">2541</span></a>                    <span class="n">model</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws-2542"><a href="#Laws-2542"><span class="linenos">2542</span></a>                <span class="p">)</span>
</span><span id="Laws-2543"><a href="#Laws-2543"><span class="linenos">2543</span></a>                <span class="k">if</span> <span class="n">flexation_point_detection_results</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Laws-2544"><a href="#Laws-2544"><span class="linenos">2544</span></a>
</span><span id="Laws-2545"><a href="#Laws-2545"><span class="linenos">2545</span></a>                    <span class="k">return</span> <span class="p">(</span>
</span><span id="Laws-2546"><a href="#Laws-2546"><span class="linenos">2546</span></a>                        <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="Laws-2547"><a href="#Laws-2547"><span class="linenos">2547</span></a>                        <span class="n">model</span><span class="p">,</span>
</span><span id="Laws-2548"><a href="#Laws-2548"><span class="linenos">2548</span></a>                        <span class="n">plot_distribution_obj</span><span class="p">,</span>
</span><span id="Laws-2549"><a href="#Laws-2549"><span class="linenos">2549</span></a>                        <span class="n">plot_model_obj</span><span class="p">,</span>
</span><span id="Laws-2550"><a href="#Laws-2550"><span class="linenos">2550</span></a>                        <span class="n">flexation_point_detection_results</span><span class="p">,</span>
</span><span id="Laws-2551"><a href="#Laws-2551"><span class="linenos">2551</span></a>                    <span class="p">)</span>
</span><span id="Laws-2552"><a href="#Laws-2552"><span class="linenos">2552</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Laws-2553"><a href="#Laws-2553"><span class="linenos">2553</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span>
</span><span id="Laws-2554"><a href="#Laws-2554"><span class="linenos">2554</span></a>            <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;pareto&quot;</span> <span class="ow">and</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Laws-2555"><a href="#Laws-2555"><span class="linenos">2555</span></a>                <span class="n">flexation_point_detection_results</span> <span class="o">=</span> <span class="n">Flexation</span><span class="p">()</span><span class="o">.</span><span class="n">find_distributions</span><span class="p">(</span>
</span><span id="Laws-2556"><a href="#Laws-2556"><span class="linenos">2556</span></a>                    <span class="n">model</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws-2557"><a href="#Laws-2557"><span class="linenos">2557</span></a>                <span class="p">)</span>
</span><span id="Laws-2558"><a href="#Laws-2558"><span class="linenos">2558</span></a>                <span class="k">if</span> <span class="n">flexation_point_detection_results</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Laws-2559"><a href="#Laws-2559"><span class="linenos">2559</span></a>
</span><span id="Laws-2560"><a href="#Laws-2560"><span class="linenos">2560</span></a>                    <span class="k">return</span> <span class="p">(</span>
</span><span id="Laws-2561"><a href="#Laws-2561"><span class="linenos">2561</span></a>                        <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="Laws-2562"><a href="#Laws-2562"><span class="linenos">2562</span></a>                        <span class="n">model</span><span class="p">,</span>
</span><span id="Laws-2563"><a href="#Laws-2563"><span class="linenos">2563</span></a>                        <span class="n">plot_distribution_obj</span><span class="p">,</span>
</span><span id="Laws-2564"><a href="#Laws-2564"><span class="linenos">2564</span></a>                        <span class="n">plot_model_obj</span><span class="p">,</span>
</span><span id="Laws-2565"><a href="#Laws-2565"><span class="linenos">2565</span></a>                        <span class="n">flexation_point_detection_results</span><span class="p">,</span>
</span><span id="Laws-2566"><a href="#Laws-2566"><span class="linenos">2566</span></a>                    <span class="p">)</span>
</span><span id="Laws-2567"><a href="#Laws-2567"><span class="linenos">2567</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Laws-2568"><a href="#Laws-2568"><span class="linenos">2568</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span>
</span><span id="Laws-2569"><a href="#Laws-2569"><span class="linenos">2569</span></a>            <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;lognorm&quot;</span> <span class="ow">and</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Laws-2570"><a href="#Laws-2570"><span class="linenos">2570</span></a>                <span class="n">flexation_point_detection_results</span> <span class="o">=</span> <span class="n">Flexation</span><span class="p">()</span><span class="o">.</span><span class="n">find_distributions</span><span class="p">(</span>
</span><span id="Laws-2571"><a href="#Laws-2571"><span class="linenos">2571</span></a>                    <span class="n">model</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws-2572"><a href="#Laws-2572"><span class="linenos">2572</span></a>                <span class="p">)</span>
</span><span id="Laws-2573"><a href="#Laws-2573"><span class="linenos">2573</span></a>                <span class="k">if</span> <span class="n">flexation_point_detection_results</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Laws-2574"><a href="#Laws-2574"><span class="linenos">2574</span></a>
</span><span id="Laws-2575"><a href="#Laws-2575"><span class="linenos">2575</span></a>                    <span class="k">return</span> <span class="p">(</span>
</span><span id="Laws-2576"><a href="#Laws-2576"><span class="linenos">2576</span></a>                        <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="Laws-2577"><a href="#Laws-2577"><span class="linenos">2577</span></a>                        <span class="n">model</span><span class="p">,</span>
</span><span id="Laws-2578"><a href="#Laws-2578"><span class="linenos">2578</span></a>                        <span class="n">plot_distribution_obj</span><span class="p">,</span>
</span><span id="Laws-2579"><a href="#Laws-2579"><span class="linenos">2579</span></a>                        <span class="n">plot_model_obj</span><span class="p">,</span>
</span><span id="Laws-2580"><a href="#Laws-2580"><span class="linenos">2580</span></a>                        <span class="n">flexation_point_detection_results</span><span class="p">,</span>
</span><span id="Laws-2581"><a href="#Laws-2581"><span class="linenos">2581</span></a>                    <span class="p">)</span>
</span><span id="Laws-2582"><a href="#Laws-2582"><span class="linenos">2582</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Laws-2583"><a href="#Laws-2583"><span class="linenos">2583</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span>
</span><span id="Laws-2584"><a href="#Laws-2584"><span class="linenos">2584</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Laws-2585"><a href="#Laws-2585"><span class="linenos">2585</span></a>                <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span>
</span><span id="Laws-2586"><a href="#Laws-2586"><span class="linenos">2586</span></a>
</span><span id="Laws-2587"><a href="#Laws-2587"><span class="linenos">2587</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="Laws-2588"><a href="#Laws-2588"><span class="linenos">2588</span></a>
</span><span id="Laws-2589"><a href="#Laws-2589"><span class="linenos">2589</span></a>
</span><span id="Laws-2590"><a href="#Laws-2590"><span class="linenos">2590</span></a>    <span class="nd">@log_curve_fitting_resluts</span>
</span><span id="Laws-2591"><a href="#Laws-2591"><span class="linenos">2591</span></a>    <span class="nd">@check_curve_fit</span>
</span><span id="Laws-2592"><a href="#Laws-2592"><span class="linenos">2592</span></a>    <span class="k">def</span> <span class="nf">visitation_frequency</span><span class="p">(</span>
</span><span id="Laws-2593"><a href="#Laws-2593"><span class="linenos">2593</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span> <span class="n">min_labels_no</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Laws-2594"><a href="#Laws-2594"><span class="linenos">2594</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Laws-2595"><a href="#Laws-2595"><span class="linenos">2595</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2596"><a href="#Laws-2596"><span class="linenos">2596</span></a><span class="sd">        Computes the visitation frequency of locations based</span>
</span><span id="Laws-2597"><a href="#Laws-2597"><span class="linenos">2597</span></a><span class="sd">        on trajectory data.</span>
</span><span id="Laws-2598"><a href="#Laws-2598"><span class="linenos">2598</span></a>
</span><span id="Laws-2599"><a href="#Laws-2599"><span class="linenos">2599</span></a><span class="sd">        The function:</span>
</span><span id="Laws-2600"><a href="#Laws-2600"><span class="linenos">2600</span></a><span class="sd">        - Computes visitation frequency from trajectory data.</span>
</span><span id="Laws-2601"><a href="#Laws-2601"><span class="linenos">2601</span></a><span class="sd">        - Averages visitation frequency over a specified</span>
</span><span id="Laws-2602"><a href="#Laws-2602"><span class="linenos">2602</span></a><span class="sd">            minimum number of labels.</span>
</span><span id="Laws-2603"><a href="#Laws-2603"><span class="linenos">2603</span></a><span class="sd">        - Performs curve fitting to find the best function</span>
</span><span id="Laws-2604"><a href="#Laws-2604"><span class="linenos">2604</span></a><span class="sd">            describing the relationship.</span>
</span><span id="Laws-2605"><a href="#Laws-2605"><span class="linenos">2605</span></a><span class="sd">        - Returns fitting results, including predictions</span>
</span><span id="Laws-2606"><a href="#Laws-2606"><span class="linenos">2606</span></a><span class="sd">            and parameter estimates.</span>
</span><span id="Laws-2607"><a href="#Laws-2607"><span class="linenos">2607</span></a>
</span><span id="Laws-2608"><a href="#Laws-2608"><span class="linenos">2608</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2609"><a href="#Laws-2609"><span class="linenos">2609</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2610"><a href="#Laws-2610"><span class="linenos">2610</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="Laws-2611"><a href="#Laws-2611"><span class="linenos">2611</span></a><span class="sd">            A trajectory dataset containing location visit information.</span>
</span><span id="Laws-2612"><a href="#Laws-2612"><span class="linenos">2612</span></a><span class="sd">        min_labels_no : int</span>
</span><span id="Laws-2613"><a href="#Laws-2613"><span class="linenos">2613</span></a><span class="sd">            Minimum number of labels required for averaging</span>
</span><span id="Laws-2614"><a href="#Laws-2614"><span class="linenos">2614</span></a><span class="sd">                the visitation frequency.</span>
</span><span id="Laws-2615"><a href="#Laws-2615"><span class="linenos">2615</span></a>
</span><span id="Laws-2616"><a href="#Laws-2616"><span class="linenos">2616</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2617"><a href="#Laws-2617"><span class="linenos">2617</span></a><span class="sd">        --------</span>
</span><span id="Laws-2618"><a href="#Laws-2618"><span class="linenos">2618</span></a><span class="sd">        tuple:</span>
</span><span id="Laws-2619"><a href="#Laws-2619"><span class="linenos">2619</span></a><span class="sd">            - best_fit (str): Best fitting curve name.</span>
</span><span id="Laws-2620"><a href="#Laws-2620"><span class="linenos">2620</span></a><span class="sd">            - global_params (pd.DataFrame): Parameters of the best fit.</span>
</span><span id="Laws-2621"><a href="#Laws-2621"><span class="linenos">2621</span></a><span class="sd">            - y_pred (np.ndarray): Predicted visitation frequencies.</span>
</span><span id="Laws-2622"><a href="#Laws-2622"><span class="linenos">2622</span></a><span class="sd">            - exp_y_pred (np.ndarray or None): Exponential curve</span>
</span><span id="Laws-2623"><a href="#Laws-2623"><span class="linenos">2623</span></a><span class="sd">                predictions (if applicable).</span>
</span><span id="Laws-2624"><a href="#Laws-2624"><span class="linenos">2624</span></a><span class="sd">            - avg_vf (pd.Series): Averaged visitation frequency data.</span>
</span><span id="Laws-2625"><a href="#Laws-2625"><span class="linenos">2625</span></a><span class="sd">            - labels (list): Axis labels for the plot.</span>
</span><span id="Laws-2626"><a href="#Laws-2626"><span class="linenos">2626</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2627"><a href="#Laws-2627"><span class="linenos">2627</span></a>
</span><span id="Laws-2628"><a href="#Laws-2628"><span class="linenos">2628</span></a>        <span class="n">vf</span> <span class="o">=</span> <span class="n">visitation_frequency</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Laws-2629"><a href="#Laws-2629"><span class="linenos">2629</span></a>        <span class="n">avg_vf</span> <span class="o">=</span> <span class="n">rowwise_average</span><span class="p">(</span><span class="n">vf</span><span class="p">,</span> <span class="n">row_count</span><span class="o">=</span><span class="n">min_labels_no</span><span class="p">)</span>
</span><span id="Laws-2630"><a href="#Laws-2630"><span class="linenos">2630</span></a>        <span class="n">avg_vf</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Laws-2631"><a href="#Laws-2631"><span class="linenos">2631</span></a>        <span class="n">vf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</span><span id="Laws-2632"><a href="#Laws-2632"><span class="linenos">2632</span></a>        <span class="n">avg_vf</span> <span class="o">=</span> <span class="n">avg_vf</span><span class="p">[</span><span class="o">~</span><span class="n">avg_vf</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</span><span id="Laws-2633"><a href="#Laws-2633"><span class="linenos">2633</span></a>
</span><span id="Laws-2634"><a href="#Laws-2634"><span class="linenos">2634</span></a>        <span class="n">y_pred</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">best_fit_params</span><span class="p">,</span> <span class="n">global_params</span><span class="p">,</span> <span class="n">expon_y_pred</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Laws-2635"><a href="#Laws-2635"><span class="linenos">2635</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">curve_fitting</span><span class="o">.</span><span class="n">model_choose</span><span class="p">(</span><span class="n">avg_vf</span><span class="p">)</span>
</span><span id="Laws-2636"><a href="#Laws-2636"><span class="linenos">2636</span></a>        <span class="p">)</span>
</span><span id="Laws-2637"><a href="#Laws-2637"><span class="linenos">2637</span></a>
</span><span id="Laws-2638"><a href="#Laws-2638"><span class="linenos">2638</span></a>        <span class="k">return</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">global_params</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">expon_y_pred</span><span class="p">,</span> <span class="n">avg_vf</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Rank&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">]</span>
</span><span id="Laws-2639"><a href="#Laws-2639"><span class="linenos">2639</span></a>
</span><span id="Laws-2640"><a href="#Laws-2640"><span class="linenos">2640</span></a>
</span><span id="Laws-2641"><a href="#Laws-2641"><span class="linenos">2641</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="Laws-2642"><a href="#Laws-2642"><span class="linenos">2642</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="Laws-2643"><a href="#Laws-2643"><span class="linenos">2643</span></a>    <span class="k">def</span> <span class="nf">jump_lengths_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Laws-2644"><a href="#Laws-2644"><span class="linenos">2644</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2645"><a href="#Laws-2645"><span class="linenos">2645</span></a><span class="sd">        Computes the distribution of jump lengths in a trajectory dataset.</span>
</span><span id="Laws-2646"><a href="#Laws-2646"><span class="linenos">2646</span></a>
</span><span id="Laws-2647"><a href="#Laws-2647"><span class="linenos">2647</span></a><span class="sd">        The function:</span>
</span><span id="Laws-2648"><a href="#Laws-2648"><span class="linenos">2648</span></a><span class="sd">        - Extracts jump lengths from the dataset.</span>
</span><span id="Laws-2649"><a href="#Laws-2649"><span class="linenos">2649</span></a><span class="sd">        - Removes zero values and converts the data into a distribution.</span>
</span><span id="Laws-2650"><a href="#Laws-2650"><span class="linenos">2650</span></a><span class="sd">        - Fits multiple statistical distributions and selects the best fit.</span>
</span><span id="Laws-2651"><a href="#Laws-2651"><span class="linenos">2651</span></a>
</span><span id="Laws-2652"><a href="#Laws-2652"><span class="linenos">2652</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2653"><a href="#Laws-2653"><span class="linenos">2653</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2654"><a href="#Laws-2654"><span class="linenos">2654</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="Laws-2655"><a href="#Laws-2655"><span class="linenos">2655</span></a><span class="sd">            A trajectory dataset containing movement data.</span>
</span><span id="Laws-2656"><a href="#Laws-2656"><span class="linenos">2656</span></a>
</span><span id="Laws-2657"><a href="#Laws-2657"><span class="linenos">2657</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2658"><a href="#Laws-2658"><span class="linenos">2658</span></a><span class="sd">        --------</span>
</span><span id="Laws-2659"><a href="#Laws-2659"><span class="linenos">2659</span></a><span class="sd">        tuple:</span>
</span><span id="Laws-2660"><a href="#Laws-2660"><span class="linenos">2660</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="Laws-2661"><a href="#Laws-2661"><span class="linenos">2661</span></a><span class="sd">            - jl (pd.Series): The processed jump length data.</span>
</span><span id="Laws-2662"><a href="#Laws-2662"><span class="linenos">2662</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2663"><a href="#Laws-2663"><span class="linenos">2663</span></a>
</span><span id="Laws-2664"><a href="#Laws-2664"><span class="linenos">2664</span></a>        <span class="n">jl</span> <span class="o">=</span> <span class="n">jump_lengths</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Laws-2665"><a href="#Laws-2665"><span class="linenos">2665</span></a>        <span class="n">jl</span> <span class="o">=</span> <span class="n">jl</span><span class="p">[</span><span class="n">jl</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Laws-2666"><a href="#Laws-2666"><span class="linenos">2666</span></a>        <span class="n">jl_dist</span> <span class="o">=</span> <span class="n">convert_to_distribution</span><span class="p">(</span><span class="n">jl</span><span class="p">,</span> <span class="n">num_of_classes</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span><span id="Laws-2667"><a href="#Laws-2667"><span class="linenos">2667</span></a>
</span><span id="Laws-2668"><a href="#Laws-2668"><span class="linenos">2668</span></a>        <span class="c1"># Fit to find the best theoretical distribution</span>
</span><span id="Laws-2669"><a href="#Laws-2669"><span class="linenos">2669</span></a>        <span class="n">jl</span> <span class="o">=</span> <span class="n">jl</span><span class="p">[</span><span class="o">~</span><span class="n">jl</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</span><span id="Laws-2670"><a href="#Laws-2670"><span class="linenos">2670</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="Laws-2671"><a href="#Laws-2671"><span class="linenos">2671</span></a>            <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="Laws-2672"><a href="#Laws-2672"><span class="linenos">2672</span></a>                <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="Laws-2673"><a href="#Laws-2673"><span class="linenos">2673</span></a>                <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="Laws-2674"><a href="#Laws-2674"><span class="linenos">2674</span></a>                <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="Laws-2675"><a href="#Laws-2675"><span class="linenos">2675</span></a>                <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="Laws-2676"><a href="#Laws-2676"><span class="linenos">2676</span></a>                <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="Laws-2677"><a href="#Laws-2677"><span class="linenos">2677</span></a>                <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="Laws-2678"><a href="#Laws-2678"><span class="linenos">2678</span></a>                <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="Laws-2679"><a href="#Laws-2679"><span class="linenos">2679</span></a>                <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="Laws-2680"><a href="#Laws-2680"><span class="linenos">2680</span></a>                <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="Laws-2681"><a href="#Laws-2681"><span class="linenos">2681</span></a>                <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="Laws-2682"><a href="#Laws-2682"><span class="linenos">2682</span></a>                <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="Laws-2683"><a href="#Laws-2683"><span class="linenos">2683</span></a>                <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="Laws-2684"><a href="#Laws-2684"><span class="linenos">2684</span></a>                <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="Laws-2685"><a href="#Laws-2685"><span class="linenos">2685</span></a>                <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="Laws-2686"><a href="#Laws-2686"><span class="linenos">2686</span></a>                <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="Laws-2687"><a href="#Laws-2687"><span class="linenos">2687</span></a>            <span class="p">],</span>
</span><span id="Laws-2688"><a href="#Laws-2688"><span class="linenos">2688</span></a>            <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="Laws-2689"><a href="#Laws-2689"><span class="linenos">2689</span></a>        <span class="p">)</span>
</span><span id="Laws-2690"><a href="#Laws-2690"><span class="linenos">2690</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">jl</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws-2691"><a href="#Laws-2691"><span class="linenos">2691</span></a>
</span><span id="Laws-2692"><a href="#Laws-2692"><span class="linenos">2692</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">jl</span>
</span><span id="Laws-2693"><a href="#Laws-2693"><span class="linenos">2693</span></a>
</span><span id="Laws-2694"><a href="#Laws-2694"><span class="linenos">2694</span></a>
</span><span id="Laws-2695"><a href="#Laws-2695"><span class="linenos">2695</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="Laws-2696"><a href="#Laws-2696"><span class="linenos">2696</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="Laws-2697"><a href="#Laws-2697"><span class="linenos">2697</span></a>    <span class="k">def</span> <span class="nf">waiting_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Laws-2698"><a href="#Laws-2698"><span class="linenos">2698</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2699"><a href="#Laws-2699"><span class="linenos">2699</span></a><span class="sd">        Computes the distribution of waiting times in a trajectory dataset.</span>
</span><span id="Laws-2700"><a href="#Laws-2700"><span class="linenos">2700</span></a>
</span><span id="Laws-2701"><a href="#Laws-2701"><span class="linenos">2701</span></a><span class="sd">        The function:</span>
</span><span id="Laws-2702"><a href="#Laws-2702"><span class="linenos">2702</span></a><span class="sd">        - Calculates the waiting times as the difference between start</span>
</span><span id="Laws-2703"><a href="#Laws-2703"><span class="linenos">2703</span></a><span class="sd">            and end times.</span>
</span><span id="Laws-2704"><a href="#Laws-2704"><span class="linenos">2704</span></a><span class="sd">        - Removes missing and zero values.</span>
</span><span id="Laws-2705"><a href="#Laws-2705"><span class="linenos">2705</span></a><span class="sd">        - Fits multiple statistical distributions and selects the best fit.</span>
</span><span id="Laws-2706"><a href="#Laws-2706"><span class="linenos">2706</span></a>
</span><span id="Laws-2707"><a href="#Laws-2707"><span class="linenos">2707</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2708"><a href="#Laws-2708"><span class="linenos">2708</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2709"><a href="#Laws-2709"><span class="linenos">2709</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="Laws-2710"><a href="#Laws-2710"><span class="linenos">2710</span></a><span class="sd">            A trajectory dataset containing time-based movement data.</span>
</span><span id="Laws-2711"><a href="#Laws-2711"><span class="linenos">2711</span></a>
</span><span id="Laws-2712"><a href="#Laws-2712"><span class="linenos">2712</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2713"><a href="#Laws-2713"><span class="linenos">2713</span></a><span class="sd">        --------</span>
</span><span id="Laws-2714"><a href="#Laws-2714"><span class="linenos">2714</span></a><span class="sd">        tuple:</span>
</span><span id="Laws-2715"><a href="#Laws-2715"><span class="linenos">2715</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="Laws-2716"><a href="#Laws-2716"><span class="linenos">2716</span></a><span class="sd">            - wt (pd.Series): The processed waiting time data.</span>
</span><span id="Laws-2717"><a href="#Laws-2717"><span class="linenos">2717</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2718"><a href="#Laws-2718"><span class="linenos">2718</span></a>
</span><span id="Laws-2719"><a href="#Laws-2719"><span class="linenos">2719</span></a>        <span class="n">data_set</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Laws-2720"><a href="#Laws-2720"><span class="linenos">2720</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Laws-2721"><a href="#Laws-2721"><span class="linenos">2721</span></a>            <span class="n">wt</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="Laws-2722"><a href="#Laws-2722"><span class="linenos">2722</span></a>                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
</span><span id="Laws-2723"><a href="#Laws-2723"><span class="linenos">2723</span></a>            <span class="p">)</span>
</span><span id="Laws-2724"><a href="#Laws-2724"><span class="linenos">2724</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Laws-2725"><a href="#Laws-2725"><span class="linenos">2725</span></a>            <span class="n">wt</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
</span><span id="Laws-2726"><a href="#Laws-2726"><span class="linenos">2726</span></a>
</span><span id="Laws-2727"><a href="#Laws-2727"><span class="linenos">2727</span></a>        <span class="n">wt</span> <span class="o">=</span> <span class="n">wt</span><span class="p">[</span><span class="o">~</span><span class="n">wt</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws-2728"><a href="#Laws-2728"><span class="linenos">2728</span></a>        <span class="n">wt</span> <span class="o">=</span> <span class="n">wt</span><span class="p">[</span><span class="n">wt</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Laws-2729"><a href="#Laws-2729"><span class="linenos">2729</span></a>
</span><span id="Laws-2730"><a href="#Laws-2730"><span class="linenos">2730</span></a>        <span class="c1"># Fit to find the best theoretical distribution</span>
</span><span id="Laws-2731"><a href="#Laws-2731"><span class="linenos">2731</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="Laws-2732"><a href="#Laws-2732"><span class="linenos">2732</span></a>            <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="Laws-2733"><a href="#Laws-2733"><span class="linenos">2733</span></a>                <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="Laws-2734"><a href="#Laws-2734"><span class="linenos">2734</span></a>                <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="Laws-2735"><a href="#Laws-2735"><span class="linenos">2735</span></a>                <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="Laws-2736"><a href="#Laws-2736"><span class="linenos">2736</span></a>                <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="Laws-2737"><a href="#Laws-2737"><span class="linenos">2737</span></a>                <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="Laws-2738"><a href="#Laws-2738"><span class="linenos">2738</span></a>                <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="Laws-2739"><a href="#Laws-2739"><span class="linenos">2739</span></a>                <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="Laws-2740"><a href="#Laws-2740"><span class="linenos">2740</span></a>                <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="Laws-2741"><a href="#Laws-2741"><span class="linenos">2741</span></a>                <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="Laws-2742"><a href="#Laws-2742"><span class="linenos">2742</span></a>                <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="Laws-2743"><a href="#Laws-2743"><span class="linenos">2743</span></a>                <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="Laws-2744"><a href="#Laws-2744"><span class="linenos">2744</span></a>                <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="Laws-2745"><a href="#Laws-2745"><span class="linenos">2745</span></a>                <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="Laws-2746"><a href="#Laws-2746"><span class="linenos">2746</span></a>                <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="Laws-2747"><a href="#Laws-2747"><span class="linenos">2747</span></a>                <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="Laws-2748"><a href="#Laws-2748"><span class="linenos">2748</span></a>            <span class="p">],</span>
</span><span id="Laws-2749"><a href="#Laws-2749"><span class="linenos">2749</span></a>            <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="Laws-2750"><a href="#Laws-2750"><span class="linenos">2750</span></a>        <span class="p">)</span>
</span><span id="Laws-2751"><a href="#Laws-2751"><span class="linenos">2751</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">wt</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws-2752"><a href="#Laws-2752"><span class="linenos">2752</span></a>
</span><span id="Laws-2753"><a href="#Laws-2753"><span class="linenos">2753</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">wt</span>
</span><span id="Laws-2754"><a href="#Laws-2754"><span class="linenos">2754</span></a>
</span><span id="Laws-2755"><a href="#Laws-2755"><span class="linenos">2755</span></a>
</span><span id="Laws-2756"><a href="#Laws-2756"><span class="linenos">2756</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="Laws-2757"><a href="#Laws-2757"><span class="linenos">2757</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="Laws-2758"><a href="#Laws-2758"><span class="linenos">2758</span></a>    <span class="k">def</span> <span class="nf">travel_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Laws-2759"><a href="#Laws-2759"><span class="linenos">2759</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2760"><a href="#Laws-2760"><span class="linenos">2760</span></a><span class="sd">        Computes the distribution of travel times between locations.</span>
</span><span id="Laws-2761"><a href="#Laws-2761"><span class="linenos">2761</span></a>
</span><span id="Laws-2762"><a href="#Laws-2762"><span class="linenos">2762</span></a><span class="sd">        The function:</span>
</span><span id="Laws-2763"><a href="#Laws-2763"><span class="linenos">2763</span></a><span class="sd">        - Calculates travel times as the time difference between</span>
</span><span id="Laws-2764"><a href="#Laws-2764"><span class="linenos">2764</span></a><span class="sd">            consecutive trajectory points.</span>
</span><span id="Laws-2765"><a href="#Laws-2765"><span class="linenos">2765</span></a><span class="sd">        - Removes missing values.</span>
</span><span id="Laws-2766"><a href="#Laws-2766"><span class="linenos">2766</span></a><span class="sd">        - Fits multiple statistical distributions and selects the best fit.</span>
</span><span id="Laws-2767"><a href="#Laws-2767"><span class="linenos">2767</span></a>
</span><span id="Laws-2768"><a href="#Laws-2768"><span class="linenos">2768</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2769"><a href="#Laws-2769"><span class="linenos">2769</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2770"><a href="#Laws-2770"><span class="linenos">2770</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="Laws-2771"><a href="#Laws-2771"><span class="linenos">2771</span></a><span class="sd">            A trajectory dataset containing time-based movement data.</span>
</span><span id="Laws-2772"><a href="#Laws-2772"><span class="linenos">2772</span></a>
</span><span id="Laws-2773"><a href="#Laws-2773"><span class="linenos">2773</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2774"><a href="#Laws-2774"><span class="linenos">2774</span></a><span class="sd">        --------</span>
</span><span id="Laws-2775"><a href="#Laws-2775"><span class="linenos">2775</span></a><span class="sd">        tuple:</span>
</span><span id="Laws-2776"><a href="#Laws-2776"><span class="linenos">2776</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="Laws-2777"><a href="#Laws-2777"><span class="linenos">2777</span></a><span class="sd">            - tt (pd.Series): The processed travel time data.</span>
</span><span id="Laws-2778"><a href="#Laws-2778"><span class="linenos">2778</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2779"><a href="#Laws-2779"><span class="linenos">2779</span></a>
</span><span id="Laws-2780"><a href="#Laws-2780"><span class="linenos">2780</span></a>        <span class="n">data_set</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Laws-2781"><a href="#Laws-2781"><span class="linenos">2781</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Laws-2782"><a href="#Laws-2782"><span class="linenos">2782</span></a>            <span class="n">tt</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Laws-2783"><a href="#Laws-2783"><span class="linenos">2783</span></a>                <span class="n">data_set</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Laws-2784"><a href="#Laws-2784"><span class="linenos">2784</span></a>                <span class="o">.</span><span class="n">progress_apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws-2785"><a href="#Laws-2785"><span class="linenos">2785</span></a>                <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Laws-2786"><a href="#Laws-2786"><span class="linenos">2786</span></a>            <span class="p">)</span>
</span><span id="Laws-2787"><a href="#Laws-2787"><span class="linenos">2787</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Laws-2788"><a href="#Laws-2788"><span class="linenos">2788</span></a>            <span class="n">shifted_start</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Laws-2789"><a href="#Laws-2789"><span class="linenos">2789</span></a>            <span class="n">tt</span> <span class="o">=</span> <span class="n">shifted_start</span> <span class="o">-</span> <span class="n">data_set</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
</span><span id="Laws-2790"><a href="#Laws-2790"><span class="linenos">2790</span></a>            <span class="n">tt</span> <span class="o">=</span> <span class="n">tt</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Laws-2791"><a href="#Laws-2791"><span class="linenos">2791</span></a>
</span><span id="Laws-2792"><a href="#Laws-2792"><span class="linenos">2792</span></a>        <span class="n">tt</span> <span class="o">=</span> <span class="n">tt</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</span><span id="Laws-2793"><a href="#Laws-2793"><span class="linenos">2793</span></a>        <span class="n">tt</span> <span class="o">=</span> <span class="n">tt</span><span class="p">[</span><span class="o">~</span><span class="n">tt</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</span><span id="Laws-2794"><a href="#Laws-2794"><span class="linenos">2794</span></a>
</span><span id="Laws-2795"><a href="#Laws-2795"><span class="linenos">2795</span></a>        <span class="c1"># Fit to find the best theoretical distribution</span>
</span><span id="Laws-2796"><a href="#Laws-2796"><span class="linenos">2796</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="Laws-2797"><a href="#Laws-2797"><span class="linenos">2797</span></a>            <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="Laws-2798"><a href="#Laws-2798"><span class="linenos">2798</span></a>                <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="Laws-2799"><a href="#Laws-2799"><span class="linenos">2799</span></a>                <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="Laws-2800"><a href="#Laws-2800"><span class="linenos">2800</span></a>                <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="Laws-2801"><a href="#Laws-2801"><span class="linenos">2801</span></a>                <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="Laws-2802"><a href="#Laws-2802"><span class="linenos">2802</span></a>                <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="Laws-2803"><a href="#Laws-2803"><span class="linenos">2803</span></a>                <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="Laws-2804"><a href="#Laws-2804"><span class="linenos">2804</span></a>                <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="Laws-2805"><a href="#Laws-2805"><span class="linenos">2805</span></a>                <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="Laws-2806"><a href="#Laws-2806"><span class="linenos">2806</span></a>                <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="Laws-2807"><a href="#Laws-2807"><span class="linenos">2807</span></a>                <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="Laws-2808"><a href="#Laws-2808"><span class="linenos">2808</span></a>                <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="Laws-2809"><a href="#Laws-2809"><span class="linenos">2809</span></a>                <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="Laws-2810"><a href="#Laws-2810"><span class="linenos">2810</span></a>                <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="Laws-2811"><a href="#Laws-2811"><span class="linenos">2811</span></a>                <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="Laws-2812"><a href="#Laws-2812"><span class="linenos">2812</span></a>                <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="Laws-2813"><a href="#Laws-2813"><span class="linenos">2813</span></a>            <span class="p">],</span>
</span><span id="Laws-2814"><a href="#Laws-2814"><span class="linenos">2814</span></a>            <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="Laws-2815"><a href="#Laws-2815"><span class="linenos">2815</span></a>        <span class="p">)</span>
</span><span id="Laws-2816"><a href="#Laws-2816"><span class="linenos">2816</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws-2817"><a href="#Laws-2817"><span class="linenos">2817</span></a>
</span><span id="Laws-2818"><a href="#Laws-2818"><span class="linenos">2818</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">tt</span>
</span><span id="Laws-2819"><a href="#Laws-2819"><span class="linenos">2819</span></a>
</span><span id="Laws-2820"><a href="#Laws-2820"><span class="linenos">2820</span></a>
</span><span id="Laws-2821"><a href="#Laws-2821"><span class="linenos">2821</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="Laws-2822"><a href="#Laws-2822"><span class="linenos">2822</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="Laws-2823"><a href="#Laws-2823"><span class="linenos">2823</span></a>    <span class="k">def</span> <span class="nf">rog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Laws-2824"><a href="#Laws-2824"><span class="linenos">2824</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2825"><a href="#Laws-2825"><span class="linenos">2825</span></a><span class="sd">        Computes the distribution of the radius of gyration (RoG).</span>
</span><span id="Laws-2826"><a href="#Laws-2826"><span class="linenos">2826</span></a>
</span><span id="Laws-2827"><a href="#Laws-2827"><span class="linenos">2827</span></a><span class="sd">        The function:</span>
</span><span id="Laws-2828"><a href="#Laws-2828"><span class="linenos">2828</span></a><span class="sd">        - Computes the radius of gyration for each trajectory.</span>
</span><span id="Laws-2829"><a href="#Laws-2829"><span class="linenos">2829</span></a><span class="sd">        - Fits multiple statistical distributions and selects the best fit.</span>
</span><span id="Laws-2830"><a href="#Laws-2830"><span class="linenos">2830</span></a>
</span><span id="Laws-2831"><a href="#Laws-2831"><span class="linenos">2831</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2832"><a href="#Laws-2832"><span class="linenos">2832</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2833"><a href="#Laws-2833"><span class="linenos">2833</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="Laws-2834"><a href="#Laws-2834"><span class="linenos">2834</span></a><span class="sd">            A trajectory dataset containing spatial movement data.</span>
</span><span id="Laws-2835"><a href="#Laws-2835"><span class="linenos">2835</span></a>
</span><span id="Laws-2836"><a href="#Laws-2836"><span class="linenos">2836</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2837"><a href="#Laws-2837"><span class="linenos">2837</span></a><span class="sd">        --------</span>
</span><span id="Laws-2838"><a href="#Laws-2838"><span class="linenos">2838</span></a><span class="sd">        tuple:</span>
</span><span id="Laws-2839"><a href="#Laws-2839"><span class="linenos">2839</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="Laws-2840"><a href="#Laws-2840"><span class="linenos">2840</span></a><span class="sd">            - rog (pd.Series): The processed radius of gyration data.</span>
</span><span id="Laws-2841"><a href="#Laws-2841"><span class="linenos">2841</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2842"><a href="#Laws-2842"><span class="linenos">2842</span></a>
</span><span id="Laws-2843"><a href="#Laws-2843"><span class="linenos">2843</span></a>        <span class="n">rog</span> <span class="o">=</span> <span class="n">radius_of_gyration</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time_evolution</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Laws-2844"><a href="#Laws-2844"><span class="linenos">2844</span></a>
</span><span id="Laws-2845"><a href="#Laws-2845"><span class="linenos">2845</span></a>        <span class="c1"># Fit to find the best theoretical distribution</span>
</span><span id="Laws-2846"><a href="#Laws-2846"><span class="linenos">2846</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="Laws-2847"><a href="#Laws-2847"><span class="linenos">2847</span></a>            <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="Laws-2848"><a href="#Laws-2848"><span class="linenos">2848</span></a>                <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="Laws-2849"><a href="#Laws-2849"><span class="linenos">2849</span></a>                <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="Laws-2850"><a href="#Laws-2850"><span class="linenos">2850</span></a>                <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="Laws-2851"><a href="#Laws-2851"><span class="linenos">2851</span></a>                <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="Laws-2852"><a href="#Laws-2852"><span class="linenos">2852</span></a>                <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="Laws-2853"><a href="#Laws-2853"><span class="linenos">2853</span></a>                <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="Laws-2854"><a href="#Laws-2854"><span class="linenos">2854</span></a>                <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="Laws-2855"><a href="#Laws-2855"><span class="linenos">2855</span></a>                <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="Laws-2856"><a href="#Laws-2856"><span class="linenos">2856</span></a>                <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="Laws-2857"><a href="#Laws-2857"><span class="linenos">2857</span></a>                <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="Laws-2858"><a href="#Laws-2858"><span class="linenos">2858</span></a>                <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="Laws-2859"><a href="#Laws-2859"><span class="linenos">2859</span></a>                <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="Laws-2860"><a href="#Laws-2860"><span class="linenos">2860</span></a>                <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="Laws-2861"><a href="#Laws-2861"><span class="linenos">2861</span></a>                <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="Laws-2862"><a href="#Laws-2862"><span class="linenos">2862</span></a>                <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="Laws-2863"><a href="#Laws-2863"><span class="linenos">2863</span></a>            <span class="p">],</span>
</span><span id="Laws-2864"><a href="#Laws-2864"><span class="linenos">2864</span></a>            <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="Laws-2865"><a href="#Laws-2865"><span class="linenos">2865</span></a>        <span class="p">)</span>
</span><span id="Laws-2866"><a href="#Laws-2866"><span class="linenos">2866</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">rog</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws-2867"><a href="#Laws-2867"><span class="linenos">2867</span></a>
</span><span id="Laws-2868"><a href="#Laws-2868"><span class="linenos">2868</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">rog</span>
</span><span id="Laws-2869"><a href="#Laws-2869"><span class="linenos">2869</span></a>
</span><span id="Laws-2870"><a href="#Laws-2870"><span class="linenos">2870</span></a>
</span><span id="Laws-2871"><a href="#Laws-2871"><span class="linenos">2871</span></a>    <span class="nd">@log_curve_fitting_resluts</span>
</span><span id="Laws-2872"><a href="#Laws-2872"><span class="linenos">2872</span></a>    <span class="nd">@check_curve_fit</span>
</span><span id="Laws-2873"><a href="#Laws-2873"><span class="linenos">2873</span></a>    <span class="k">def</span> <span class="nf">rog_over_time</span><span class="p">(</span>
</span><span id="Laws-2874"><a href="#Laws-2874"><span class="linenos">2874</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Laws-2875"><a href="#Laws-2875"><span class="linenos">2875</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span>
</span><span id="Laws-2876"><a href="#Laws-2876"><span class="linenos">2876</span></a>        <span class="n">min_records_no</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Laws-2877"><a href="#Laws-2877"><span class="linenos">2877</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Laws-2878"><a href="#Laws-2878"><span class="linenos">2878</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2879"><a href="#Laws-2879"><span class="linenos">2879</span></a><span class="sd">        Computes the evolution of the radius of gyration (RoG) over time.</span>
</span><span id="Laws-2880"><a href="#Laws-2880"><span class="linenos">2880</span></a>
</span><span id="Laws-2881"><a href="#Laws-2881"><span class="linenos">2881</span></a><span class="sd">        The function:</span>
</span><span id="Laws-2882"><a href="#Laws-2882"><span class="linenos">2882</span></a><span class="sd">        - Computes the radius of gyration for each trajectory over time.</span>
</span><span id="Laws-2883"><a href="#Laws-2883"><span class="linenos">2883</span></a><span class="sd">        - Averages the RoG values using a specified number of records.</span>
</span><span id="Laws-2884"><a href="#Laws-2884"><span class="linenos">2884</span></a><span class="sd">        - Fits a curve to model the evolution of RoG.</span>
</span><span id="Laws-2885"><a href="#Laws-2885"><span class="linenos">2885</span></a>
</span><span id="Laws-2886"><a href="#Laws-2886"><span class="linenos">2886</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2887"><a href="#Laws-2887"><span class="linenos">2887</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2888"><a href="#Laws-2888"><span class="linenos">2888</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="Laws-2889"><a href="#Laws-2889"><span class="linenos">2889</span></a><span class="sd">            A trajectory dataset containing movement data.</span>
</span><span id="Laws-2890"><a href="#Laws-2890"><span class="linenos">2890</span></a><span class="sd">        min_records_no : int</span>
</span><span id="Laws-2891"><a href="#Laws-2891"><span class="linenos">2891</span></a><span class="sd">            Minimum number of records required for averaging.</span>
</span><span id="Laws-2892"><a href="#Laws-2892"><span class="linenos">2892</span></a>
</span><span id="Laws-2893"><a href="#Laws-2893"><span class="linenos">2893</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2894"><a href="#Laws-2894"><span class="linenos">2894</span></a><span class="sd">        --------</span>
</span><span id="Laws-2895"><a href="#Laws-2895"><span class="linenos">2895</span></a><span class="sd">        tuple:</span>
</span><span id="Laws-2896"><a href="#Laws-2896"><span class="linenos">2896</span></a><span class="sd">            - best_fit (str): Name of the best fitting model.</span>
</span><span id="Laws-2897"><a href="#Laws-2897"><span class="linenos">2897</span></a><span class="sd">            - global_params (dict): Parameters of the best fit.</span>
</span><span id="Laws-2898"><a href="#Laws-2898"><span class="linenos">2898</span></a><span class="sd">            - y_pred (ndarray): Predicted values from the curve fit.</span>
</span><span id="Laws-2899"><a href="#Laws-2899"><span class="linenos">2899</span></a><span class="sd">            - expon_y_pred (ndarray): Alternative exponential model</span>
</span><span id="Laws-2900"><a href="#Laws-2900"><span class="linenos">2900</span></a><span class="sd">                predictions.</span>
</span><span id="Laws-2901"><a href="#Laws-2901"><span class="linenos">2901</span></a><span class="sd">            - avg_rog (pd.Series): Averaged RoG values over time.</span>
</span><span id="Laws-2902"><a href="#Laws-2902"><span class="linenos">2902</span></a><span class="sd">            - [&quot;Time&quot;, &quot;Values&quot;] (list): Column labels.</span>
</span><span id="Laws-2903"><a href="#Laws-2903"><span class="linenos">2903</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2904"><a href="#Laws-2904"><span class="linenos">2904</span></a>
</span><span id="Laws-2905"><a href="#Laws-2905"><span class="linenos">2905</span></a>        <span class="n">rog</span> <span class="o">=</span> <span class="n">radius_of_gyration</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time_evolution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Laws-2906"><a href="#Laws-2906"><span class="linenos">2906</span></a>        <span class="n">avg_rog</span> <span class="o">=</span> <span class="n">rowwise_average</span><span class="p">(</span><span class="n">rog</span><span class="p">,</span> <span class="n">row_count</span><span class="o">=</span><span class="n">min_records_no</span><span class="p">)</span>
</span><span id="Laws-2907"><a href="#Laws-2907"><span class="linenos">2907</span></a>        <span class="n">avg_rog</span> <span class="o">=</span> <span class="n">avg_rog</span><span class="p">[</span><span class="o">~</span><span class="n">avg_rog</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</span><span id="Laws-2908"><a href="#Laws-2908"><span class="linenos">2908</span></a>
</span><span id="Laws-2909"><a href="#Laws-2909"><span class="linenos">2909</span></a>        <span class="c1"># model selection</span>
</span><span id="Laws-2910"><a href="#Laws-2910"><span class="linenos">2910</span></a>        <span class="n">y_pred</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">best_fit_params</span><span class="p">,</span> <span class="n">global_params</span><span class="p">,</span> <span class="n">expon_y_pred</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Laws-2911"><a href="#Laws-2911"><span class="linenos">2911</span></a>            <span class="n">DistributionFitingTools</span><span class="p">()</span><span class="o">.</span><span class="n">model_choose</span><span class="p">(</span><span class="n">avg_rog</span><span class="p">)</span>
</span><span id="Laws-2912"><a href="#Laws-2912"><span class="linenos">2912</span></a>        <span class="p">)</span>
</span><span id="Laws-2913"><a href="#Laws-2913"><span class="linenos">2913</span></a>
</span><span id="Laws-2914"><a href="#Laws-2914"><span class="linenos">2914</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Laws-2915"><a href="#Laws-2915"><span class="linenos">2915</span></a>            <span class="n">best_fit</span><span class="p">,</span>
</span><span id="Laws-2916"><a href="#Laws-2916"><span class="linenos">2916</span></a>            <span class="n">global_params</span><span class="p">,</span>
</span><span id="Laws-2917"><a href="#Laws-2917"><span class="linenos">2917</span></a>            <span class="n">y_pred</span><span class="p">,</span>
</span><span id="Laws-2918"><a href="#Laws-2918"><span class="linenos">2918</span></a>            <span class="n">expon_y_pred</span><span class="p">,</span>
</span><span id="Laws-2919"><a href="#Laws-2919"><span class="linenos">2919</span></a>            <span class="n">avg_rog</span><span class="p">,</span>
</span><span id="Laws-2920"><a href="#Laws-2920"><span class="linenos">2920</span></a>            <span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;Values&quot;</span><span class="p">],</span>
</span><span id="Laws-2921"><a href="#Laws-2921"><span class="linenos">2921</span></a>        <span class="p">)</span>
</span><span id="Laws-2922"><a href="#Laws-2922"><span class="linenos">2922</span></a>
</span><span id="Laws-2923"><a href="#Laws-2923"><span class="linenos">2923</span></a>
</span><span id="Laws-2924"><a href="#Laws-2924"><span class="linenos">2924</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="Laws-2925"><a href="#Laws-2925"><span class="linenos">2925</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="Laws-2926"><a href="#Laws-2926"><span class="linenos">2926</span></a>    <span class="k">def</span> <span class="nf">msd_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Laws-2927"><a href="#Laws-2927"><span class="linenos">2927</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2928"><a href="#Laws-2928"><span class="linenos">2928</span></a><span class="sd">        Computes the distribution of mean squared displacement (MSD).</span>
</span><span id="Laws-2929"><a href="#Laws-2929"><span class="linenos">2929</span></a>
</span><span id="Laws-2930"><a href="#Laws-2930"><span class="linenos">2930</span></a><span class="sd">        The function:</span>
</span><span id="Laws-2931"><a href="#Laws-2931"><span class="linenos">2931</span></a><span class="sd">        - Computes MSD without time evolution.</span>
</span><span id="Laws-2932"><a href="#Laws-2932"><span class="linenos">2932</span></a><span class="sd">        - Fits multiple statistical distributions and selects the best fit.</span>
</span><span id="Laws-2933"><a href="#Laws-2933"><span class="linenos">2933</span></a>
</span><span id="Laws-2934"><a href="#Laws-2934"><span class="linenos">2934</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2935"><a href="#Laws-2935"><span class="linenos">2935</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2936"><a href="#Laws-2936"><span class="linenos">2936</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="Laws-2937"><a href="#Laws-2937"><span class="linenos">2937</span></a><span class="sd">            A trajectory dataset containing movement data.</span>
</span><span id="Laws-2938"><a href="#Laws-2938"><span class="linenos">2938</span></a>
</span><span id="Laws-2939"><a href="#Laws-2939"><span class="linenos">2939</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2940"><a href="#Laws-2940"><span class="linenos">2940</span></a><span class="sd">        --------</span>
</span><span id="Laws-2941"><a href="#Laws-2941"><span class="linenos">2941</span></a><span class="sd">        tuple:</span>
</span><span id="Laws-2942"><a href="#Laws-2942"><span class="linenos">2942</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="Laws-2943"><a href="#Laws-2943"><span class="linenos">2943</span></a><span class="sd">            - msd (pd.Series): The computed MSD values.</span>
</span><span id="Laws-2944"><a href="#Laws-2944"><span class="linenos">2944</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-2945"><a href="#Laws-2945"><span class="linenos">2945</span></a>
</span><span id="Laws-2946"><a href="#Laws-2946"><span class="linenos">2946</span></a>        <span class="n">msd</span> <span class="o">=</span> <span class="n">mean_square_displacement</span><span class="p">(</span>
</span><span id="Laws-2947"><a href="#Laws-2947"><span class="linenos">2947</span></a>            <span class="n">data</span><span class="p">,</span>
</span><span id="Laws-2948"><a href="#Laws-2948"><span class="linenos">2948</span></a>            <span class="n">time_evolution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Laws-2949"><a href="#Laws-2949"><span class="linenos">2949</span></a>            <span class="n">from_center</span><span class="o">=</span><span class="kc">True</span>
</span><span id="Laws-2950"><a href="#Laws-2950"><span class="linenos">2950</span></a>        <span class="p">)</span>
</span><span id="Laws-2951"><a href="#Laws-2951"><span class="linenos">2951</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span>
</span><span id="Laws-2952"><a href="#Laws-2952"><span class="linenos">2952</span></a>            <span class="n">distr</span><span class="o">=</span><span class="p">[</span>
</span><span id="Laws-2953"><a href="#Laws-2953"><span class="linenos">2953</span></a>                <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
</span><span id="Laws-2954"><a href="#Laws-2954"><span class="linenos">2954</span></a>                <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
</span><span id="Laws-2955"><a href="#Laws-2955"><span class="linenos">2955</span></a>                <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
</span><span id="Laws-2956"><a href="#Laws-2956"><span class="linenos">2956</span></a>                <span class="s2">&quot;dweibull&quot;</span><span class="p">,</span>
</span><span id="Laws-2957"><a href="#Laws-2957"><span class="linenos">2957</span></a>                <span class="s2">&quot;t&quot;</span><span class="p">,</span>
</span><span id="Laws-2958"><a href="#Laws-2958"><span class="linenos">2958</span></a>                <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
</span><span id="Laws-2959"><a href="#Laws-2959"><span class="linenos">2959</span></a>                <span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
</span><span id="Laws-2960"><a href="#Laws-2960"><span class="linenos">2960</span></a>                <span class="s2">&quot;lognorm&quot;</span><span class="p">,</span>
</span><span id="Laws-2961"><a href="#Laws-2961"><span class="linenos">2961</span></a>                <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
</span><span id="Laws-2962"><a href="#Laws-2962"><span class="linenos">2962</span></a>                <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="Laws-2963"><a href="#Laws-2963"><span class="linenos">2963</span></a>                <span class="s2">&quot;loggamma&quot;</span><span class="p">,</span>
</span><span id="Laws-2964"><a href="#Laws-2964"><span class="linenos">2964</span></a>                <span class="s2">&quot;truncexpon&quot;</span><span class="p">,</span>
</span><span id="Laws-2965"><a href="#Laws-2965"><span class="linenos">2965</span></a>                <span class="s2">&quot;truncnorm&quot;</span><span class="p">,</span>
</span><span id="Laws-2966"><a href="#Laws-2966"><span class="linenos">2966</span></a>                <span class="s2">&quot;truncpareto&quot;</span><span class="p">,</span>
</span><span id="Laws-2967"><a href="#Laws-2967"><span class="linenos">2967</span></a>                <span class="s2">&quot;powerlaw&quot;</span><span class="p">,</span>
</span><span id="Laws-2968"><a href="#Laws-2968"><span class="linenos">2968</span></a>            <span class="p">],</span>
</span><span id="Laws-2969"><a href="#Laws-2969"><span class="linenos">2969</span></a>            <span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">,</span>
</span><span id="Laws-2970"><a href="#Laws-2970"><span class="linenos">2970</span></a>        <span class="p">)</span>
</span><span id="Laws-2971"><a href="#Laws-2971"><span class="linenos">2971</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">msd</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws-2972"><a href="#Laws-2972"><span class="linenos">2972</span></a>
</span><span id="Laws-2973"><a href="#Laws-2973"><span class="linenos">2973</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">msd</span>
</span><span id="Laws-2974"><a href="#Laws-2974"><span class="linenos">2974</span></a>
</span><span id="Laws-2975"><a href="#Laws-2975"><span class="linenos">2975</span></a>
</span><span id="Laws-2976"><a href="#Laws-2976"><span class="linenos">2976</span></a>    <span class="nd">@log_curve_fitting_resluts</span>
</span><span id="Laws-2977"><a href="#Laws-2977"><span class="linenos">2977</span></a>    <span class="nd">@check_curve_fit</span>
</span><span id="Laws-2978"><a href="#Laws-2978"><span class="linenos">2978</span></a>    <span class="k">def</span> <span class="nf">msd_curve</span><span class="p">(</span>
</span><span id="Laws-2979"><a href="#Laws-2979"><span class="linenos">2979</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Laws-2980"><a href="#Laws-2980"><span class="linenos">2980</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span>
</span><span id="Laws-2981"><a href="#Laws-2981"><span class="linenos">2981</span></a>        <span class="n">min_records_no</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Laws-2982"><a href="#Laws-2982"><span class="linenos">2982</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Laws-2983"><a href="#Laws-2983"><span class="linenos">2983</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-2984"><a href="#Laws-2984"><span class="linenos">2984</span></a><span class="sd">        Computes the mean squared displacement (MSD) curve over time.</span>
</span><span id="Laws-2985"><a href="#Laws-2985"><span class="linenos">2985</span></a>
</span><span id="Laws-2986"><a href="#Laws-2986"><span class="linenos">2986</span></a><span class="sd">        The function:</span>
</span><span id="Laws-2987"><a href="#Laws-2987"><span class="linenos">2987</span></a><span class="sd">        - Computes MSD over time.</span>
</span><span id="Laws-2988"><a href="#Laws-2988"><span class="linenos">2988</span></a><span class="sd">        - Averages MSD values using a specified number of records.</span>
</span><span id="Laws-2989"><a href="#Laws-2989"><span class="linenos">2989</span></a><span class="sd">        - Fits a curve to model MSD behavior.</span>
</span><span id="Laws-2990"><a href="#Laws-2990"><span class="linenos">2990</span></a>
</span><span id="Laws-2991"><a href="#Laws-2991"><span class="linenos">2991</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-2992"><a href="#Laws-2992"><span class="linenos">2992</span></a><span class="sd">        -----------</span>
</span><span id="Laws-2993"><a href="#Laws-2993"><span class="linenos">2993</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="Laws-2994"><a href="#Laws-2994"><span class="linenos">2994</span></a><span class="sd">            A trajectory dataset containing movement data.</span>
</span><span id="Laws-2995"><a href="#Laws-2995"><span class="linenos">2995</span></a><span class="sd">        min_records_no : int</span>
</span><span id="Laws-2996"><a href="#Laws-2996"><span class="linenos">2996</span></a><span class="sd">            Minimum number of records required for averaging.</span>
</span><span id="Laws-2997"><a href="#Laws-2997"><span class="linenos">2997</span></a>
</span><span id="Laws-2998"><a href="#Laws-2998"><span class="linenos">2998</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-2999"><a href="#Laws-2999"><span class="linenos">2999</span></a><span class="sd">        --------</span>
</span><span id="Laws-3000"><a href="#Laws-3000"><span class="linenos">3000</span></a><span class="sd">        tuple:</span>
</span><span id="Laws-3001"><a href="#Laws-3001"><span class="linenos">3001</span></a><span class="sd">            - best_fit (str): Name of the best fitting model.</span>
</span><span id="Laws-3002"><a href="#Laws-3002"><span class="linenos">3002</span></a><span class="sd">            - global_params (dict): Parameters of the best fit.</span>
</span><span id="Laws-3003"><a href="#Laws-3003"><span class="linenos">3003</span></a><span class="sd">            - y_pred (ndarray): Predicted values from the curve fit.</span>
</span><span id="Laws-3004"><a href="#Laws-3004"><span class="linenos">3004</span></a><span class="sd">            - expon_y_pred (ndarray): Alternative exponential model</span>
</span><span id="Laws-3005"><a href="#Laws-3005"><span class="linenos">3005</span></a><span class="sd">                predictions.</span>
</span><span id="Laws-3006"><a href="#Laws-3006"><span class="linenos">3006</span></a><span class="sd">            - avg_msd (pd.Series): Averaged MSD values over time.</span>
</span><span id="Laws-3007"><a href="#Laws-3007"><span class="linenos">3007</span></a><span class="sd">            - [&quot;t&quot;, &quot;MSD&quot;] (list): Column labels.</span>
</span><span id="Laws-3008"><a href="#Laws-3008"><span class="linenos">3008</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-3009"><a href="#Laws-3009"><span class="linenos">3009</span></a>
</span><span id="Laws-3010"><a href="#Laws-3010"><span class="linenos">3010</span></a>        <span class="n">msd</span> <span class="o">=</span> <span class="n">mean_square_displacement</span><span class="p">(</span>
</span><span id="Laws-3011"><a href="#Laws-3011"><span class="linenos">3011</span></a>            <span class="n">data</span><span class="p">,</span>
</span><span id="Laws-3012"><a href="#Laws-3012"><span class="linenos">3012</span></a>            <span class="n">time_evolution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Laws-3013"><a href="#Laws-3013"><span class="linenos">3013</span></a>            <span class="n">from_center</span><span class="o">=</span><span class="kc">False</span>
</span><span id="Laws-3014"><a href="#Laws-3014"><span class="linenos">3014</span></a>        <span class="p">)</span>
</span><span id="Laws-3015"><a href="#Laws-3015"><span class="linenos">3015</span></a>        <span class="n">avg_msd</span> <span class="o">=</span> <span class="n">rowwise_average</span><span class="p">(</span><span class="n">msd</span><span class="p">,</span> <span class="n">row_count</span><span class="o">=</span><span class="n">min_records_no</span><span class="p">)</span>
</span><span id="Laws-3016"><a href="#Laws-3016"><span class="linenos">3016</span></a>        <span class="n">avg_msd</span> <span class="o">=</span> <span class="n">avg_msd</span><span class="p">[</span><span class="o">~</span><span class="n">avg_msd</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</span><span id="Laws-3017"><a href="#Laws-3017"><span class="linenos">3017</span></a>        <span class="c1"># model selection</span>
</span><span id="Laws-3018"><a href="#Laws-3018"><span class="linenos">3018</span></a>        <span class="n">y_pred</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">best_fit_params</span><span class="p">,</span> <span class="n">global_params</span><span class="p">,</span> <span class="n">expon_y_pred</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Laws-3019"><a href="#Laws-3019"><span class="linenos">3019</span></a>            <span class="n">DistributionFitingTools</span><span class="p">()</span><span class="o">.</span><span class="n">model_choose</span><span class="p">(</span><span class="n">avg_msd</span><span class="p">)</span>
</span><span id="Laws-3020"><a href="#Laws-3020"><span class="linenos">3020</span></a>        <span class="p">)</span>
</span><span id="Laws-3021"><a href="#Laws-3021"><span class="linenos">3021</span></a>
</span><span id="Laws-3022"><a href="#Laws-3022"><span class="linenos">3022</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Laws-3023"><a href="#Laws-3023"><span class="linenos">3023</span></a>            <span class="n">best_fit</span><span class="p">,</span>
</span><span id="Laws-3024"><a href="#Laws-3024"><span class="linenos">3024</span></a>            <span class="n">global_params</span><span class="p">,</span>
</span><span id="Laws-3025"><a href="#Laws-3025"><span class="linenos">3025</span></a>            <span class="n">y_pred</span><span class="p">,</span>
</span><span id="Laws-3026"><a href="#Laws-3026"><span class="linenos">3026</span></a>            <span class="n">expon_y_pred</span><span class="p">,</span>
</span><span id="Laws-3027"><a href="#Laws-3027"><span class="linenos">3027</span></a>            <span class="n">avg_msd</span><span class="p">,</span>
</span><span id="Laws-3028"><a href="#Laws-3028"><span class="linenos">3028</span></a>            <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;MSD&quot;</span><span class="p">]</span>
</span><span id="Laws-3029"><a href="#Laws-3029"><span class="linenos">3029</span></a>        <span class="p">)</span>
</span><span id="Laws-3030"><a href="#Laws-3030"><span class="linenos">3030</span></a>
</span><span id="Laws-3031"><a href="#Laws-3031"><span class="linenos">3031</span></a>
</span><span id="Laws-3032"><a href="#Laws-3032"><span class="linenos">3032</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="Laws-3033"><a href="#Laws-3033"><span class="linenos">3033</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="Laws-3034"><a href="#Laws-3034"><span class="linenos">3034</span></a>    <span class="k">def</span> <span class="nf">return_time_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Laws-3035"><a href="#Laws-3035"><span class="linenos">3035</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-3036"><a href="#Laws-3036"><span class="linenos">3036</span></a><span class="sd">        Computes the distribution of return times.</span>
</span><span id="Laws-3037"><a href="#Laws-3037"><span class="linenos">3037</span></a>
</span><span id="Laws-3038"><a href="#Laws-3038"><span class="linenos">3038</span></a><span class="sd">        The function:</span>
</span><span id="Laws-3039"><a href="#Laws-3039"><span class="linenos">3039</span></a><span class="sd">        - Identifies return times based on revisited locations.</span>
</span><span id="Laws-3040"><a href="#Laws-3040"><span class="linenos">3040</span></a><span class="sd">        - Fits a statistical distribution to the return time values.</span>
</span><span id="Laws-3041"><a href="#Laws-3041"><span class="linenos">3041</span></a>
</span><span id="Laws-3042"><a href="#Laws-3042"><span class="linenos">3042</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-3043"><a href="#Laws-3043"><span class="linenos">3043</span></a><span class="sd">        -----------</span>
</span><span id="Laws-3044"><a href="#Laws-3044"><span class="linenos">3044</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="Laws-3045"><a href="#Laws-3045"><span class="linenos">3045</span></a><span class="sd">            A trajectory dataset containing labeled locations and timestamps.</span>
</span><span id="Laws-3046"><a href="#Laws-3046"><span class="linenos">3046</span></a>
</span><span id="Laws-3047"><a href="#Laws-3047"><span class="linenos">3047</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-3048"><a href="#Laws-3048"><span class="linenos">3048</span></a><span class="sd">        --------</span>
</span><span id="Laws-3049"><a href="#Laws-3049"><span class="linenos">3049</span></a><span class="sd">        tuple:</span>
</span><span id="Laws-3050"><a href="#Laws-3050"><span class="linenos">3050</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="Laws-3051"><a href="#Laws-3051"><span class="linenos">3051</span></a><span class="sd">            - rt (pd.Series): The computed return time values.</span>
</span><span id="Laws-3052"><a href="#Laws-3052"><span class="linenos">3052</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-3053"><a href="#Laws-3053"><span class="linenos">3053</span></a>
</span><span id="Laws-3054"><a href="#Laws-3054"><span class="linenos">3054</span></a>        <span class="n">to_concat</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Laws-3055"><a href="#Laws-3055"><span class="linenos">3055</span></a>        <span class="n">data_set</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Laws-3056"><a href="#Laws-3056"><span class="linenos">3056</span></a>        <span class="k">for</span> <span class="n">uid</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
</span><span id="Laws-3057"><a href="#Laws-3057"><span class="linenos">3057</span></a>            <span class="n">data_set</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="Laws-3058"><a href="#Laws-3058"><span class="linenos">3058</span></a>            <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">))),</span>
</span><span id="Laws-3059"><a href="#Laws-3059"><span class="linenos">3059</span></a>        <span class="p">):</span>
</span><span id="Laws-3060"><a href="#Laws-3060"><span class="linenos">3060</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()[[</span><span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">]]</span>
</span><span id="Laws-3061"><a href="#Laws-3061"><span class="linenos">3061</span></a>
</span><span id="Laws-3062"><a href="#Laws-3062"><span class="linenos">3062</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;new_place&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">~</span><span class="n">vals</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
</span><span id="Laws-3063"><a href="#Laws-3063"><span class="linenos">3063</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;new_place&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="Laws-3064"><a href="#Laws-3064"><span class="linenos">3064</span></a>                <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="s2">&quot;new_place&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;new_place&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</span><span id="Laws-3065"><a href="#Laws-3065"><span class="linenos">3065</span></a>            <span class="p">)</span>
</span><span id="Laws-3066"><a href="#Laws-3066"><span class="linenos">3066</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands_reach&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>
</span><span id="Laws-3067"><a href="#Laws-3067"><span class="linenos">3067</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[[</span><span class="s2">&quot;islands&quot;</span><span class="p">,</span> <span class="s2">&quot;islands_reach&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Laws-3068"><a href="#Laws-3068"><span class="linenos">3068</span></a>
</span><span id="Laws-3069"><a href="#Laws-3069"><span class="linenos">3069</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;islands_reach&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Laws-3070"><a href="#Laws-3070"><span class="linenos">3070</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">vals</span><span class="o">.</span><span class="n">islands</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Laws-3071"><a href="#Laws-3071"><span class="linenos">3071</span></a>
</span><span id="Laws-3072"><a href="#Laws-3072"><span class="linenos">3072</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;islands&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="Laws-3073"><a href="#Laws-3073"><span class="linenos">3073</span></a>                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws-3074"><a href="#Laws-3074"><span class="linenos">3074</span></a>            <span class="p">)</span>
</span><span id="Laws-3075"><a href="#Laws-3075"><span class="linenos">3075</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</span><span id="Laws-3076"><a href="#Laws-3076"><span class="linenos">3076</span></a>            <span class="n">to_concat</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="Laws-3077"><a href="#Laws-3077"><span class="linenos">3077</span></a>
</span><span id="Laws-3078"><a href="#Laws-3078"><span class="linenos">3078</span></a>        <span class="n">rt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">to_concat</span><span class="p">)</span>
</span><span id="Laws-3079"><a href="#Laws-3079"><span class="linenos">3079</span></a>        <span class="n">rt</span> <span class="o">=</span> <span class="n">rt</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Laws-3080"><a href="#Laws-3080"><span class="linenos">3080</span></a>        <span class="n">rt</span> <span class="o">=</span> <span class="n">rt</span><span class="p">[</span><span class="n">rt</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Laws-3081"><a href="#Laws-3081"><span class="linenos">3081</span></a>        <span class="n">rt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">to_concat</span><span class="p">)</span>
</span><span id="Laws-3082"><a href="#Laws-3082"><span class="linenos">3082</span></a>        <span class="n">rt</span> <span class="o">=</span> <span class="n">rt</span><span class="p">[</span><span class="n">rt</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Laws-3083"><a href="#Laws-3083"><span class="linenos">3083</span></a>
</span><span id="Laws-3084"><a href="#Laws-3084"><span class="linenos">3084</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">)</span>
</span><span id="Laws-3085"><a href="#Laws-3085"><span class="linenos">3085</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">rt</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws-3086"><a href="#Laws-3086"><span class="linenos">3086</span></a>
</span><span id="Laws-3087"><a href="#Laws-3087"><span class="linenos">3087</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">rt</span>
</span><span id="Laws-3088"><a href="#Laws-3088"><span class="linenos">3088</span></a>
</span><span id="Laws-3089"><a href="#Laws-3089"><span class="linenos">3089</span></a>
</span><span id="Laws-3090"><a href="#Laws-3090"><span class="linenos">3090</span></a>    <span class="nd">@log_distribution_fitting_resluts</span>
</span><span id="Laws-3091"><a href="#Laws-3091"><span class="linenos">3091</span></a>    <span class="nd">@check_distribution_fit</span>
</span><span id="Laws-3092"><a href="#Laws-3092"><span class="linenos">3092</span></a>    <span class="k">def</span> <span class="nf">exploration_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Laws-3093"><a href="#Laws-3093"><span class="linenos">3093</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-3094"><a href="#Laws-3094"><span class="linenos">3094</span></a><span class="sd">        Computes the distribution of exploration times.</span>
</span><span id="Laws-3095"><a href="#Laws-3095"><span class="linenos">3095</span></a>
</span><span id="Laws-3096"><a href="#Laws-3096"><span class="linenos">3096</span></a><span class="sd">        The function:</span>
</span><span id="Laws-3097"><a href="#Laws-3097"><span class="linenos">3097</span></a><span class="sd">        - Identifies exploration periods as the time spent in</span>
</span><span id="Laws-3098"><a href="#Laws-3098"><span class="linenos">3098</span></a><span class="sd">            newly visited locations.</span>
</span><span id="Laws-3099"><a href="#Laws-3099"><span class="linenos">3099</span></a><span class="sd">        - Fits a statistical distribution to the exploration time values.</span>
</span><span id="Laws-3100"><a href="#Laws-3100"><span class="linenos">3100</span></a>
</span><span id="Laws-3101"><a href="#Laws-3101"><span class="linenos">3101</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-3102"><a href="#Laws-3102"><span class="linenos">3102</span></a><span class="sd">        -----------</span>
</span><span id="Laws-3103"><a href="#Laws-3103"><span class="linenos">3103</span></a><span class="sd">        data : TrajectoriesFrame</span>
</span><span id="Laws-3104"><a href="#Laws-3104"><span class="linenos">3104</span></a><span class="sd">            A trajectory dataset containing labeled locations and timestamps.</span>
</span><span id="Laws-3105"><a href="#Laws-3105"><span class="linenos">3105</span></a>
</span><span id="Laws-3106"><a href="#Laws-3106"><span class="linenos">3106</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-3107"><a href="#Laws-3107"><span class="linenos">3107</span></a><span class="sd">        --------</span>
</span><span id="Laws-3108"><a href="#Laws-3108"><span class="linenos">3108</span></a><span class="sd">        tuple:</span>
</span><span id="Laws-3109"><a href="#Laws-3109"><span class="linenos">3109</span></a><span class="sd">            - model (distfit object): The fitted distribution model.</span>
</span><span id="Laws-3110"><a href="#Laws-3110"><span class="linenos">3110</span></a><span class="sd">            - et (pd.Series): The computed exploration time values.</span>
</span><span id="Laws-3111"><a href="#Laws-3111"><span class="linenos">3111</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-3112"><a href="#Laws-3112"><span class="linenos">3112</span></a>
</span><span id="Laws-3113"><a href="#Laws-3113"><span class="linenos">3113</span></a>        <span class="n">to_concat</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Laws-3114"><a href="#Laws-3114"><span class="linenos">3114</span></a>        <span class="n">data_set</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Laws-3115"><a href="#Laws-3115"><span class="linenos">3115</span></a>        <span class="k">for</span> <span class="n">uid</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
</span><span id="Laws-3116"><a href="#Laws-3116"><span class="linenos">3116</span></a>            <span class="n">data_set</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="Laws-3117"><a href="#Laws-3117"><span class="linenos">3117</span></a>            <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">))),</span>
</span><span id="Laws-3118"><a href="#Laws-3118"><span class="linenos">3118</span></a>        <span class="p">):</span>
</span><span id="Laws-3119"><a href="#Laws-3119"><span class="linenos">3119</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()[[</span><span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">]]</span>
</span><span id="Laws-3120"><a href="#Laws-3120"><span class="linenos">3120</span></a>
</span><span id="Laws-3121"><a href="#Laws-3121"><span class="linenos">3121</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;old_place&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
</span><span id="Laws-3122"><a href="#Laws-3122"><span class="linenos">3122</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;old_place&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="Laws-3123"><a href="#Laws-3123"><span class="linenos">3123</span></a>                <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="s2">&quot;old_place&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;old_place&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</span><span id="Laws-3124"><a href="#Laws-3124"><span class="linenos">3124</span></a>            <span class="p">)</span>
</span><span id="Laws-3125"><a href="#Laws-3125"><span class="linenos">3125</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands_reach&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>
</span><span id="Laws-3126"><a href="#Laws-3126"><span class="linenos">3126</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;islands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[[</span><span class="s2">&quot;islands&quot;</span><span class="p">,</span> <span class="s2">&quot;islands_reach&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Laws-3127"><a href="#Laws-3127"><span class="linenos">3127</span></a>
</span><span id="Laws-3128"><a href="#Laws-3128"><span class="linenos">3128</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;islands_reach&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Laws-3129"><a href="#Laws-3129"><span class="linenos">3129</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">vals</span><span class="o">.</span><span class="n">islands</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Laws-3130"><a href="#Laws-3130"><span class="linenos">3130</span></a>
</span><span id="Laws-3131"><a href="#Laws-3131"><span class="linenos">3131</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;islands&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="Laws-3132"><a href="#Laws-3132"><span class="linenos">3132</span></a>                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws-3133"><a href="#Laws-3133"><span class="linenos">3133</span></a>            <span class="p">)</span>
</span><span id="Laws-3134"><a href="#Laws-3134"><span class="linenos">3134</span></a>            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Laws-3135"><a href="#Laws-3135"><span class="linenos">3135</span></a>                <span class="k">continue</span>
</span><span id="Laws-3136"><a href="#Laws-3136"><span class="linenos">3136</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</span><span id="Laws-3137"><a href="#Laws-3137"><span class="linenos">3137</span></a>            <span class="n">to_concat</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="Laws-3138"><a href="#Laws-3138"><span class="linenos">3138</span></a>
</span><span id="Laws-3139"><a href="#Laws-3139"><span class="linenos">3139</span></a>        <span class="n">et</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">to_concat</span><span class="p">)</span>
</span><span id="Laws-3140"><a href="#Laws-3140"><span class="linenos">3140</span></a>        <span class="n">et</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Laws-3141"><a href="#Laws-3141"><span class="linenos">3141</span></a>        <span class="n">et</span> <span class="o">=</span> <span class="n">et</span><span class="p">[</span><span class="n">et</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Laws-3142"><a href="#Laws-3142"><span class="linenos">3142</span></a>
</span><span id="Laws-3143"><a href="#Laws-3143"><span class="linenos">3143</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s2">&quot;wasserstein&quot;</span><span class="p">)</span>
</span><span id="Laws-3144"><a href="#Laws-3144"><span class="linenos">3144</span></a>        <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">et</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws-3145"><a href="#Laws-3145"><span class="linenos">3145</span></a>
</span><span id="Laws-3146"><a href="#Laws-3146"><span class="linenos">3146</span></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">et</span>
</span><span id="Laws-3147"><a href="#Laws-3147"><span class="linenos">3147</span></a>
</span><span id="Laws-3148"><a href="#Laws-3148"><span class="linenos">3148</span></a>
</span><span id="Laws-3149"><a href="#Laws-3149"><span class="linenos">3149</span></a>    <span class="nd">@log_msd_split</span>
</span><span id="Laws-3150"><a href="#Laws-3150"><span class="linenos">3150</span></a>    <span class="k">def</span> <span class="nf">msd_curve_split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="Laws-3151"><a href="#Laws-3151"><span class="linenos">3151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-3152"><a href="#Laws-3152"><span class="linenos">3152</span></a><span class="sd">        Computes and groups MSD curves based on the radius of gyration (RoG).</span>
</span><span id="Laws-3153"><a href="#Laws-3153"><span class="linenos">3153</span></a>
</span><span id="Laws-3154"><a href="#Laws-3154"><span class="linenos">3154</span></a><span class="sd">        The function:</span>
</span><span id="Laws-3155"><a href="#Laws-3155"><span class="linenos">3155</span></a><span class="sd">        - Converts trajectory data to a GeoDataFrame.</span>
</span><span id="Laws-3156"><a href="#Laws-3156"><span class="linenos">3156</span></a><span class="sd">        - Computes the center of mass and starting points for each trajectory.</span>
</span><span id="Laws-3157"><a href="#Laws-3157"><span class="linenos">3157</span></a><span class="sd">        - Filters data to only include new explorations.</span>
</span><span id="Laws-3158"><a href="#Laws-3158"><span class="linenos">3158</span></a><span class="sd">        - Computes MSD and RoG values for each group.</span>
</span><span id="Laws-3159"><a href="#Laws-3159"><span class="linenos">3159</span></a><span class="sd">        - Groups MSD curves based on RoG bins and fits curves to them.</span>
</span><span id="Laws-3160"><a href="#Laws-3160"><span class="linenos">3160</span></a>
</span><span id="Laws-3161"><a href="#Laws-3161"><span class="linenos">3161</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-3162"><a href="#Laws-3162"><span class="linenos">3162</span></a><span class="sd">        -----------</span>
</span><span id="Laws-3163"><a href="#Laws-3163"><span class="linenos">3163</span></a><span class="sd">        data : pd.DataFrame</span>
</span><span id="Laws-3164"><a href="#Laws-3164"><span class="linenos">3164</span></a><span class="sd">            A dataset containing longitude and latitude coordinates.</span>
</span><span id="Laws-3165"><a href="#Laws-3165"><span class="linenos">3165</span></a>
</span><span id="Laws-3166"><a href="#Laws-3166"><span class="linenos">3166</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-3167"><a href="#Laws-3167"><span class="linenos">3167</span></a><span class="sd">        --------</span>
</span><span id="Laws-3168"><a href="#Laws-3168"><span class="linenos">3168</span></a><span class="sd">        tuple:</span>
</span><span id="Laws-3169"><a href="#Laws-3169"><span class="linenos">3169</span></a><span class="sd">            - msd_results (pd.DataFrame): Summary of MSD curve fitting for</span>
</span><span id="Laws-3170"><a href="#Laws-3170"><span class="linenos">3170</span></a><span class="sd">                different RoG ranges.</span>
</span><span id="Laws-3171"><a href="#Laws-3171"><span class="linenos">3171</span></a><span class="sd">            - buffer (BytesIO): A buffer containing the saved MSD plot.</span>
</span><span id="Laws-3172"><a href="#Laws-3172"><span class="linenos">3172</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-3173"><a href="#Laws-3173"><span class="linenos">3173</span></a>
</span><span id="Laws-3174"><a href="#Laws-3174"><span class="linenos">3174</span></a>        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
</span><span id="Laws-3175"><a href="#Laws-3175"><span class="linenos">3175</span></a>            <span class="n">data</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">points_from_xy</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">])</span>
</span><span id="Laws-3176"><a href="#Laws-3176"><span class="linenos">3176</span></a>        <span class="p">)</span>
</span><span id="Laws-3177"><a href="#Laws-3177"><span class="linenos">3177</span></a>        <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="mi">4326</span>
</span><span id="Laws-3178"><a href="#Laws-3178"><span class="linenos">3178</span></a>        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="mi">3857</span><span class="p">)</span>
</span><span id="Laws-3179"><a href="#Laws-3179"><span class="linenos">3179</span></a>        <span class="n">com</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="Laws-3180"><a href="#Laws-3180"><span class="linenos">3180</span></a>            <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">Point</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">z</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</span><span id="Laws-3181"><a href="#Laws-3181"><span class="linenos">3181</span></a>        <span class="p">)</span>
</span><span id="Laws-3182"><a href="#Laws-3182"><span class="linenos">3182</span></a>        <span class="n">starting_points</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Laws-3183"><a href="#Laws-3183"><span class="linenos">3183</span></a>            <span class="n">gdf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">geometry</span>
</span><span id="Laws-3184"><a href="#Laws-3184"><span class="linenos">3184</span></a>        <span class="p">)</span>
</span><span id="Laws-3185"><a href="#Laws-3185"><span class="linenos">3185</span></a>        <span class="n">to_concat_msd</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Laws-3186"><a href="#Laws-3186"><span class="linenos">3186</span></a>        <span class="n">to_concat_rog</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Laws-3187"><a href="#Laws-3187"><span class="linenos">3187</span></a>        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Laws-3188"><a href="#Laws-3188"><span class="linenos">3188</span></a>            <span class="n">vals</span><span class="p">[</span><span class="s2">&quot;is_new&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">~</span><span class="n">vals</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
</span><span id="Laws-3189"><a href="#Laws-3189"><span class="linenos">3189</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">vals</span><span class="p">[</span><span class="s2">&quot;is_new&quot;</span><span class="p">]]</span>
</span><span id="Laws-3190"><a href="#Laws-3190"><span class="linenos">3190</span></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Laws-3191"><a href="#Laws-3191"><span class="linenos">3191</span></a>            <span class="n">msd_ind</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">starting_points</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="Laws-3192"><a href="#Laws-3192"><span class="linenos">3192</span></a>            <span class="n">rog_ind</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">com</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="Laws-3193"><a href="#Laws-3193"><span class="linenos">3193</span></a>            <span class="n">msd_ind</span> <span class="o">=</span> <span class="n">groupwise_expansion</span><span class="p">(</span><span class="n">msd_ind</span><span class="p">)</span>
</span><span id="Laws-3194"><a href="#Laws-3194"><span class="linenos">3194</span></a>            <span class="n">to_concat_msd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msd_ind</span><span class="p">)</span>
</span><span id="Laws-3195"><a href="#Laws-3195"><span class="linenos">3195</span></a>            <span class="n">to_concat_rog</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rog_ind</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="Laws-3196"><a href="#Laws-3196"><span class="linenos">3196</span></a>        <span class="n">final_msd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">to_concat_msd</span><span class="p">)</span>
</span><span id="Laws-3197"><a href="#Laws-3197"><span class="linenos">3197</span></a>        <span class="n">final_rog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
</span><span id="Laws-3198"><a href="#Laws-3198"><span class="linenos">3198</span></a>            <span class="n">to_concat_rog</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span>
</span><span id="Laws-3199"><a href="#Laws-3199"><span class="linenos">3199</span></a>        <span class="p">)</span>
</span><span id="Laws-3200"><a href="#Laws-3200"><span class="linenos">3200</span></a>
</span><span id="Laws-3201"><a href="#Laws-3201"><span class="linenos">3201</span></a>        <span class="n">final_rog</span><span class="p">[</span><span class="s2">&quot;bins&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span>
</span><span id="Laws-3202"><a href="#Laws-3202"><span class="linenos">3202</span></a>            <span class="n">final_rog</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
</span><span id="Laws-3203"><a href="#Laws-3203"><span class="linenos">3203</span></a>            <span class="n">bins</span><span class="o">=</span><span class="p">[</span>
</span><span id="Laws-3204"><a href="#Laws-3204"><span class="linenos">3204</span></a>                <span class="mi">0</span><span class="p">,</span> <span class="mf">2e3</span><span class="p">,</span> <span class="mf">4e3</span><span class="p">,</span> <span class="mf">8e3</span><span class="p">,</span> <span class="mf">16e3</span><span class="p">,</span> <span class="mf">32e3</span><span class="p">,</span> <span class="mf">64e3</span><span class="p">,</span> <span class="mf">128e3</span><span class="p">,</span> <span class="mf">256e3</span><span class="p">,</span> <span class="mf">512e3</span><span class="p">,</span> <span class="mf">1024e3</span>
</span><span id="Laws-3205"><a href="#Laws-3205"><span class="linenos">3205</span></a>            <span class="p">],</span>
</span><span id="Laws-3206"><a href="#Laws-3206"><span class="linenos">3206</span></a>        <span class="p">)</span>
</span><span id="Laws-3207"><a href="#Laws-3207"><span class="linenos">3207</span></a>        <span class="n">msd_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="Laws-3208"><a href="#Laws-3208"><span class="linenos">3208</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;RoG range [km]&quot;</span><span class="p">,</span> <span class="s2">&quot;curve&quot;</span><span class="p">,</span> <span class="s2">&quot;param1&quot;</span><span class="p">,</span> <span class="s2">&quot;param2&quot;</span><span class="p">]</span>
</span><span id="Laws-3209"><a href="#Laws-3209"><span class="linenos">3209</span></a>        <span class="p">)</span>
</span><span id="Laws-3210"><a href="#Laws-3210"><span class="linenos">3210</span></a>        <span class="n">buffer</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Laws-3211"><a href="#Laws-3211"><span class="linenos">3211</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</span><span id="Laws-3212"><a href="#Laws-3212"><span class="linenos">3212</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
</span><span id="Laws-3213"><a href="#Laws-3213"><span class="linenos">3213</span></a>        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">final_rog</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;bins&quot;</span><span class="p">):</span>
</span><span id="Laws-3214"><a href="#Laws-3214"><span class="linenos">3214</span></a>            <span class="k">if</span> <span class="n">vals</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="Laws-3215"><a href="#Laws-3215"><span class="linenos">3215</span></a>                <span class="k">continue</span>
</span><span id="Laws-3216"><a href="#Laws-3216"><span class="linenos">3216</span></a>            <span class="k">if</span> <span class="n">vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Laws-3217"><a href="#Laws-3217"><span class="linenos">3217</span></a>                <span class="k">continue</span>
</span><span id="Laws-3218"><a href="#Laws-3218"><span class="linenos">3218</span></a>            <span class="n">msd_pick</span> <span class="o">=</span> <span class="n">final_msd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
</span><span id="Laws-3219"><a href="#Laws-3219"><span class="linenos">3219</span></a>            <span class="n">msd_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
</span><span id="Laws-3220"><a href="#Laws-3220"><span class="linenos">3220</span></a>                <span class="n">msd_pick</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Laws-3221"><a href="#Laws-3221"><span class="linenos">3221</span></a>            <span class="p">)</span>  <span class="c1"># find min number of rows for</span>
</span><span id="Laws-3222"><a href="#Laws-3222"><span class="linenos">3222</span></a>            <span class="c1"># individuals</span>
</span><span id="Laws-3223"><a href="#Laws-3223"><span class="linenos">3223</span></a>            <span class="n">msd_pick_avg</span> <span class="o">=</span> <span class="n">rowwise_average</span><span class="p">(</span><span class="n">msd_pick</span><span class="p">,</span> <span class="n">msd_rows</span><span class="p">)</span>
</span><span id="Laws-3224"><a href="#Laws-3224"><span class="linenos">3224</span></a>            <span class="k">try</span><span class="p">:</span>  <span class="c1"># now average rowwise</span>
</span><span id="Laws-3225"><a href="#Laws-3225"><span class="linenos">3225</span></a>                <span class="n">msd_chosen</span> <span class="o">=</span> <span class="n">DistributionFitingTools</span><span class="p">()</span><span class="o">.</span><span class="n">model_choose</span><span class="p">(</span>
</span><span id="Laws-3226"><a href="#Laws-3226"><span class="linenos">3226</span></a>                    <span class="n">msd_pick_avg</span>
</span><span id="Laws-3227"><a href="#Laws-3227"><span class="linenos">3227</span></a>                <span class="p">)</span>  <span class="c1"># pick model</span>
</span><span id="Laws-3228"><a href="#Laws-3228"><span class="linenos">3228</span></a>            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="Laws-3229"><a href="#Laws-3229"><span class="linenos">3229</span></a>                <span class="k">continue</span>
</span><span id="Laws-3230"><a href="#Laws-3230"><span class="linenos">3230</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">msd_chosen</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="Laws-3231"><a href="#Laws-3231"><span class="linenos">3231</span></a>                <span class="k">continue</span>
</span><span id="Laws-3232"><a href="#Laws-3232"><span class="linenos">3232</span></a>            <span class="n">avg_error</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span>
</span><span id="Laws-3233"><a href="#Laws-3233"><span class="linenos">3233</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">msd_pick_avg</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">msd_chosen</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="Laws-3234"><a href="#Laws-3234"><span class="linenos">3234</span></a>            <span class="p">)</span>
</span><span id="Laws-3235"><a href="#Laws-3235"><span class="linenos">3235</span></a>            <span class="k">if</span> <span class="n">avg_error</span> <span class="o">&lt;</span> <span class="mf">0.25</span><span class="p">:</span>
</span><span id="Laws-3236"><a href="#Laws-3236"><span class="linenos">3236</span></a>                <span class="k">continue</span>
</span><span id="Laws-3237"><a href="#Laws-3237"><span class="linenos">3237</span></a>            <span class="n">msd_results</span> <span class="o">=</span> <span class="n">msd_results</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span>
</span><span id="Laws-3238"><a href="#Laws-3238"><span class="linenos">3238</span></a>                <span class="p">{</span>
</span><span id="Laws-3239"><a href="#Laws-3239"><span class="linenos">3239</span></a>                    <span class="s2">&quot;RoG range [km]&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ind</span><span class="o">.</span><span class="n">left</span><span class="o">/</span><span class="mi">1000</span><span class="p">))</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ind</span><span class="o">.</span><span class="n">right</span><span class="o">/</span><span class="mi">1000</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="Laws-3240"><a href="#Laws-3240"><span class="linenos">3240</span></a>                    <span class="s2">&quot;curve&quot;</span><span class="p">:</span> <span class="n">msd_chosen</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span id="Laws-3241"><a href="#Laws-3241"><span class="linenos">3241</span></a>                    <span class="s2">&quot;param1&quot;</span><span class="p">:</span> <span class="n">msd_chosen</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws-3242"><a href="#Laws-3242"><span class="linenos">3242</span></a>                    <span class="s2">&quot;param2&quot;</span><span class="p">:</span> <span class="n">msd_chosen</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws-3243"><a href="#Laws-3243"><span class="linenos">3243</span></a>                <span class="p">},</span>
</span><span id="Laws-3244"><a href="#Laws-3244"><span class="linenos">3244</span></a>                <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Laws-3245"><a href="#Laws-3245"><span class="linenos">3245</span></a>            <span class="p">)</span>
</span><span id="Laws-3246"><a href="#Laws-3246"><span class="linenos">3246</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">msd_rows</span><span class="p">),</span> <span class="n">msd_pick_avg</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws-3247"><a href="#Laws-3247"><span class="linenos">3247</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="Laws-3248"><a href="#Laws-3248"><span class="linenos">3248</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">msd_pick_avg</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="Laws-3249"><a href="#Laws-3249"><span class="linenos">3249</span></a>                <span class="n">msd_chosen</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws-3250"><a href="#Laws-3250"><span class="linenos">3250</span></a>                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;RoG:&lt;</span><span class="si">{</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ind</span><span class="o">.</span><span class="n">right</span><span class="o">/</span><span class="mi">1000</span><span class="p">))</span><span class="si">}</span><span class="s2">km (</span><span class="si">{</span><span class="n">vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Laws-3251"><a href="#Laws-3251"><span class="linenos">3251</span></a>            <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws-3252"><a href="#Laws-3252"><span class="linenos">3252</span></a>
</span><span id="Laws-3253"><a href="#Laws-3253"><span class="linenos">3253</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="Laws-3254"><a href="#Laws-3254"><span class="linenos">3254</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</span><span id="Laws-3255"><a href="#Laws-3255"><span class="linenos">3255</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
</span><span id="Laws-3256"><a href="#Laws-3256"><span class="linenos">3256</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;MSD&quot;</span><span class="p">)</span>
</span><span id="Laws-3257"><a href="#Laws-3257"><span class="linenos">3257</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
</span><span id="Laws-3258"><a href="#Laws-3258"><span class="linenos">3258</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws-3259"><a href="#Laws-3259"><span class="linenos">3259</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
</span><span id="Laws-3260"><a href="#Laws-3260"><span class="linenos">3260</span></a>                <span class="s2">&quot;MSD split.png&quot;</span><span class="p">,</span>
</span><span id="Laws-3261"><a href="#Laws-3261"><span class="linenos">3261</span></a>            <span class="p">)</span>
</span><span id="Laws-3262"><a href="#Laws-3262"><span class="linenos">3262</span></a>        <span class="p">)</span>
</span><span id="Laws-3263"><a href="#Laws-3263"><span class="linenos">3263</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</span><span id="Laws-3264"><a href="#Laws-3264"><span class="linenos">3264</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Laws-3265"><a href="#Laws-3265"><span class="linenos">3265</span></a>        <span class="n">buffer</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Laws-3266"><a href="#Laws-3266"><span class="linenos">3266</span></a>
</span><span id="Laws-3267"><a href="#Laws-3267"><span class="linenos">3267</span></a>        <span class="k">return</span> <span class="n">msd_results</span><span class="p">,</span> <span class="n">buffer</span>
</span><span id="Laws-3268"><a href="#Laws-3268"><span class="linenos">3268</span></a>
</span><span id="Laws-3269"><a href="#Laws-3269"><span class="linenos">3269</span></a>
</span><span id="Laws-3270"><a href="#Laws-3270"><span class="linenos">3270</span></a>    <span class="nd">@log_curve_fitting_resluts</span>
</span><span id="Laws-3271"><a href="#Laws-3271"><span class="linenos">3271</span></a>    <span class="nd">@check_curve_fit</span>
</span><span id="Laws-3272"><a href="#Laws-3272"><span class="linenos">3272</span></a>    <span class="k">def</span> <span class="nf">distinct_locations_over_time</span><span class="p">(</span>
</span><span id="Laws-3273"><a href="#Laws-3273"><span class="linenos">3273</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Laws-3274"><a href="#Laws-3274"><span class="linenos">3274</span></a>        <span class="n">nrows</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Laws-3275"><a href="#Laws-3275"><span class="linenos">3275</span></a>        <span class="n">n_data</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Laws-3276"><a href="#Laws-3276"><span class="linenos">3276</span></a>        <span class="n">data</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span>
</span><span id="Laws-3277"><a href="#Laws-3277"><span class="linenos">3277</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Laws-3278"><a href="#Laws-3278"><span class="linenos">3278</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-3279"><a href="#Laws-3279"><span class="linenos">3279</span></a><span class="sd">        Computes the number of distinct locations visited over time.</span>
</span><span id="Laws-3280"><a href="#Laws-3280"><span class="linenos">3280</span></a>
</span><span id="Laws-3281"><a href="#Laws-3281"><span class="linenos">3281</span></a><span class="sd">        The function:</span>
</span><span id="Laws-3282"><a href="#Laws-3282"><span class="linenos">3282</span></a><span class="sd">        - Computes the cumulative number of distinct locations visited.</span>
</span><span id="Laws-3283"><a href="#Laws-3283"><span class="linenos">3283</span></a><span class="sd">        - Fits a curve to model the growth of visited locations over time.</span>
</span><span id="Laws-3284"><a href="#Laws-3284"><span class="linenos">3284</span></a>
</span><span id="Laws-3285"><a href="#Laws-3285"><span class="linenos">3285</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-3286"><a href="#Laws-3286"><span class="linenos">3286</span></a><span class="sd">        -----------</span>
</span><span id="Laws-3287"><a href="#Laws-3287"><span class="linenos">3287</span></a><span class="sd">        nrows : int</span>
</span><span id="Laws-3288"><a href="#Laws-3288"><span class="linenos">3288</span></a><span class="sd">            Number of rows in the dataset.</span>
</span><span id="Laws-3289"><a href="#Laws-3289"><span class="linenos">3289</span></a><span class="sd">        n_data : int</span>
</span><span id="Laws-3290"><a href="#Laws-3290"><span class="linenos">3290</span></a><span class="sd">            Total data points available.</span>
</span><span id="Laws-3291"><a href="#Laws-3291"><span class="linenos">3291</span></a><span class="sd">        data : pd.Series</span>
</span><span id="Laws-3292"><a href="#Laws-3292"><span class="linenos">3292</span></a><span class="sd">            A dataset containing the count of distinct locations.</span>
</span><span id="Laws-3293"><a href="#Laws-3293"><span class="linenos">3293</span></a>
</span><span id="Laws-3294"><a href="#Laws-3294"><span class="linenos">3294</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-3295"><a href="#Laws-3295"><span class="linenos">3295</span></a><span class="sd">        --------</span>
</span><span id="Laws-3296"><a href="#Laws-3296"><span class="linenos">3296</span></a><span class="sd">        tuple:</span>
</span><span id="Laws-3297"><a href="#Laws-3297"><span class="linenos">3297</span></a><span class="sd">            - best_fit (str): Name of the best fitting model.</span>
</span><span id="Laws-3298"><a href="#Laws-3298"><span class="linenos">3298</span></a><span class="sd">            - global_params (dict): Parameters of the best fit.</span>
</span><span id="Laws-3299"><a href="#Laws-3299"><span class="linenos">3299</span></a><span class="sd">            - y_pred (ndarray): Predicted values from the curve fit.</span>
</span><span id="Laws-3300"><a href="#Laws-3300"><span class="linenos">3300</span></a><span class="sd">            - expon_y_pred (ndarray): Alternative exponential model</span>
</span><span id="Laws-3301"><a href="#Laws-3301"><span class="linenos">3301</span></a><span class="sd">                predictions.</span>
</span><span id="Laws-3302"><a href="#Laws-3302"><span class="linenos">3302</span></a><span class="sd">            - pd.Series(data): The input data as a pandas Series.</span>
</span><span id="Laws-3303"><a href="#Laws-3303"><span class="linenos">3303</span></a><span class="sd">            - [&quot;t&quot;, &quot;S(t)&quot;] (list): Column labels.</span>
</span><span id="Laws-3304"><a href="#Laws-3304"><span class="linenos">3304</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-3305"><a href="#Laws-3305"><span class="linenos">3305</span></a>
</span><span id="Laws-3306"><a href="#Laws-3306"><span class="linenos">3306</span></a>        <span class="n">y_pred</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">best_fit_params</span><span class="p">,</span> <span class="n">global_params</span><span class="p">,</span> <span class="n">expon_y_pred</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Laws-3307"><a href="#Laws-3307"><span class="linenos">3307</span></a>            <span class="n">DistributionFitingTools</span><span class="p">()</span><span class="o">.</span><span class="n">model_choose</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</span><span id="Laws-3308"><a href="#Laws-3308"><span class="linenos">3308</span></a>        <span class="p">)</span>
</span><span id="Laws-3309"><a href="#Laws-3309"><span class="linenos">3309</span></a>
</span><span id="Laws-3310"><a href="#Laws-3310"><span class="linenos">3310</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Laws-3311"><a href="#Laws-3311"><span class="linenos">3311</span></a>            <span class="n">best_fit</span><span class="p">,</span>
</span><span id="Laws-3312"><a href="#Laws-3312"><span class="linenos">3312</span></a>            <span class="n">global_params</span><span class="p">,</span>
</span><span id="Laws-3313"><a href="#Laws-3313"><span class="linenos">3313</span></a>            <span class="n">y_pred</span><span class="p">,</span>
</span><span id="Laws-3314"><a href="#Laws-3314"><span class="linenos">3314</span></a>            <span class="n">expon_y_pred</span><span class="p">,</span>
</span><span id="Laws-3315"><a href="#Laws-3315"><span class="linenos">3315</span></a>            <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
</span><span id="Laws-3316"><a href="#Laws-3316"><span class="linenos">3316</span></a>            <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;S(t)&quot;</span><span class="p">],</span>
</span><span id="Laws-3317"><a href="#Laws-3317"><span class="linenos">3317</span></a>        <span class="p">)</span>
</span><span id="Laws-3318"><a href="#Laws-3318"><span class="linenos">3318</span></a>
</span><span id="Laws-3319"><a href="#Laws-3319"><span class="linenos">3319</span></a>
</span><span id="Laws-3320"><a href="#Laws-3320"><span class="linenos">3320</span></a>    <span class="nd">@log_pnew_estimation</span>
</span><span id="Laws-3321"><a href="#Laws-3321"><span class="linenos">3321</span></a>    <span class="k">def</span> <span class="nf">estimate_pnew</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filled_data</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Laws-3322"><a href="#Laws-3322"><span class="linenos">3322</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws-3323"><a href="#Laws-3323"><span class="linenos">3323</span></a><span class="sd">        Estimates parameters (rho, gamma) for the probability of</span>
</span><span id="Laws-3324"><a href="#Laws-3324"><span class="linenos">3324</span></a><span class="sd">        discovering new locations.</span>
</span><span id="Laws-3325"><a href="#Laws-3325"><span class="linenos">3325</span></a>
</span><span id="Laws-3326"><a href="#Laws-3326"><span class="linenos">3326</span></a><span class="sd">        The function:</span>
</span><span id="Laws-3327"><a href="#Laws-3327"><span class="linenos">3327</span></a><span class="sd">        - Computes the rate of discovery of new locations (P_new).</span>
</span><span id="Laws-3328"><a href="#Laws-3328"><span class="linenos">3328</span></a><span class="sd">        - Fits a linear model in log-log space to estimate the parameters.</span>
</span><span id="Laws-3329"><a href="#Laws-3329"><span class="linenos">3329</span></a>
</span><span id="Laws-3330"><a href="#Laws-3330"><span class="linenos">3330</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws-3331"><a href="#Laws-3331"><span class="linenos">3331</span></a><span class="sd">        -----------</span>
</span><span id="Laws-3332"><a href="#Laws-3332"><span class="linenos">3332</span></a><span class="sd">        nrows : int</span>
</span><span id="Laws-3333"><a href="#Laws-3333"><span class="linenos">3333</span></a><span class="sd">            Number of rows in the dataset.</span>
</span><span id="Laws-3334"><a href="#Laws-3334"><span class="linenos">3334</span></a><span class="sd">        n_data : int</span>
</span><span id="Laws-3335"><a href="#Laws-3335"><span class="linenos">3335</span></a><span class="sd">            Total data points available.</span>
</span><span id="Laws-3336"><a href="#Laws-3336"><span class="linenos">3336</span></a><span class="sd">        S_t : list or np.array</span>
</span><span id="Laws-3337"><a href="#Laws-3337"><span class="linenos">3337</span></a><span class="sd">            Sequence of distinct locations visited over time.</span>
</span><span id="Laws-3338"><a href="#Laws-3338"><span class="linenos">3338</span></a>
</span><span id="Laws-3339"><a href="#Laws-3339"><span class="linenos">3339</span></a><span class="sd">        Returns:</span>
</span><span id="Laws-3340"><a href="#Laws-3340"><span class="linenos">3340</span></a><span class="sd">        --------</span>
</span><span id="Laws-3341"><a href="#Laws-3341"><span class="linenos">3341</span></a><span class="sd">        tuple:</span>
</span><span id="Laws-3342"><a href="#Laws-3342"><span class="linenos">3342</span></a><span class="sd">            - rho_hat (float): Estimated rho parameter.</span>
</span><span id="Laws-3343"><a href="#Laws-3343"><span class="linenos">3343</span></a><span class="sd">            - gamma_hat (float): Estimated gamma parameter.</span>
</span><span id="Laws-3344"><a href="#Laws-3344"><span class="linenos">3344</span></a><span class="sd">            - DeltaS (np.array): Changes in S(t).</span>
</span><span id="Laws-3345"><a href="#Laws-3345"><span class="linenos">3345</span></a><span class="sd">            - S_mid (np.array): Midpoints of S(t).</span>
</span><span id="Laws-3346"><a href="#Laws-3346"><span class="linenos">3346</span></a><span class="sd">            - intercept (float): Intercept of the log-log regression.</span>
</span><span id="Laws-3347"><a href="#Laws-3347"><span class="linenos">3347</span></a><span class="sd">            - slope (float): Slope of the log-log regression (negative gamma).</span>
</span><span id="Laws-3348"><a href="#Laws-3348"><span class="linenos">3348</span></a><span class="sd">            - nrows (int): Number of rows in the dataset.</span>
</span><span id="Laws-3349"><a href="#Laws-3349"><span class="linenos">3349</span></a><span class="sd">            - n_data (int): Total data points available.</span>
</span><span id="Laws-3350"><a href="#Laws-3350"><span class="linenos">3350</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws-3351"><a href="#Laws-3351"><span class="linenos">3351</span></a>        <span class="n">filled_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;filled_data.csv&quot;</span><span class="p">)</span>
</span><span id="Laws-3352"><a href="#Laws-3352"><span class="linenos">3352</span></a>        <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filled_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</span><span id="Laws-3353"><a href="#Laws-3353"><span class="linenos">3353</span></a>        <span class="n">t_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Laws-3354"><a href="#Laws-3354"><span class="linenos">3354</span></a>
</span><span id="Laws-3355"><a href="#Laws-3355"><span class="linenos">3355</span></a>        <span class="n">n_array</span> <span class="o">=</span> <span class="n">filled_data</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>
</span><span id="Laws-3356"><a href="#Laws-3356"><span class="linenos">3356</span></a>        <span class="n">n_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">n_array</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)])</span>
</span><span id="Laws-3357"><a href="#Laws-3357"><span class="linenos">3357</span></a>
</span><span id="Laws-3358"><a href="#Laws-3358"><span class="linenos">3358</span></a>
</span><span id="Laws-3359"><a href="#Laws-3359"><span class="linenos">3359</span></a>        <span class="n">S_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">filled_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s1">&#39;new_sum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)])</span>
</span><span id="Laws-3360"><a href="#Laws-3360"><span class="linenos">3360</span></a>
</span><span id="Laws-3361"><a href="#Laws-3361"><span class="linenos">3361</span></a>        <span class="n">fit_n</span> <span class="o">=</span> <span class="n">powerlaw</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">n_array</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="n">discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Laws-3362"><a href="#Laws-3362"><span class="linenos">3362</span></a>        <span class="n">beta_est</span> <span class="o">=</span> <span class="n">fit_n</span><span class="o">.</span><span class="n">power_law</span><span class="o">.</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Laws-3363"><a href="#Laws-3363"><span class="linenos">3363</span></a>        <span class="n">C_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n_array</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">)</span> <span class="o">-</span> <span class="n">beta_est</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">t_array</span><span class="p">)))</span>
</span><span id="Laws-3364"><a href="#Laws-3364"><span class="linenos">3364</span></a>
</span><span id="Laws-3365"><a href="#Laws-3365"><span class="linenos">3365</span></a>        <span class="n">fit_s</span> <span class="o">=</span> <span class="n">powerlaw</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">S_array</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="n">discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Laws-3366"><a href="#Laws-3366"><span class="linenos">3366</span></a>        <span class="n">alpha_est</span> <span class="o">=</span> <span class="n">fit_s</span><span class="o">.</span><span class="n">power_law</span><span class="o">.</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Laws-3367"><a href="#Laws-3367"><span class="linenos">3367</span></a>        <span class="n">K_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">S_array</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">)</span> <span class="o">-</span> <span class="n">alpha_est</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">t_array</span><span class="p">)))</span>
</span><span id="Laws-3368"><a href="#Laws-3368"><span class="linenos">3368</span></a>
</span><span id="Laws-3369"><a href="#Laws-3369"><span class="linenos">3369</span></a>        <span class="c1"># Gamma from theory</span>
</span><span id="Laws-3370"><a href="#Laws-3370"><span class="linenos">3370</span></a>        <span class="n">gamma_est</span> <span class="o">=</span> <span class="n">beta_est</span> <span class="o">/</span> <span class="n">alpha_est</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Laws-3371"><a href="#Laws-3371"><span class="linenos">3371</span></a>
</span><span id="Laws-3372"><a href="#Laws-3372"><span class="linenos">3372</span></a>        <span class="c1"># Estimate rho from prefactor relation</span>
</span><span id="Laws-3373"><a href="#Laws-3373"><span class="linenos">3373</span></a>        <span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">K_est</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">gamma_est</span><span class="p">)</span>
</span><span id="Laws-3374"><a href="#Laws-3374"><span class="linenos">3374</span></a>        <span class="n">den</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">gamma_est</span><span class="p">)</span>
</span><span id="Laws-3375"><a href="#Laws-3375"><span class="linenos">3375</span></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">num</span> <span class="o">/</span> <span class="n">den</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">C_est</span><span class="p">)</span>
</span><span id="Laws-3376"><a href="#Laws-3376"><span class="linenos">3376</span></a>        <span class="n">rho_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</span><span id="Laws-3377"><a href="#Laws-3377"><span class="linenos">3377</span></a>
</span><span id="Laws-3378"><a href="#Laws-3378"><span class="linenos">3378</span></a>        <span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma_est</span>
</span><span id="Laws-3379"><a href="#Laws-3379"><span class="linenos">3379</span></a>        <span class="n">rho</span> <span class="o">=</span> <span class="n">rho_est</span>
</span><span id="Laws-3380"><a href="#Laws-3380"><span class="linenos">3380</span></a>
</span><span id="Laws-3381"><a href="#Laws-3381"><span class="linenos">3381</span></a>
</span><span id="Laws-3382"><a href="#Laws-3382"><span class="linenos">3382</span></a>        <span class="n">DeltaS</span> <span class="o">=</span> <span class="n">S_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">S_array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Laws-3383"><a href="#Laws-3383"><span class="linenos">3383</span></a>        <span class="n">S_mid</span> <span class="o">=</span> <span class="n">S_array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Laws-3384"><a href="#Laws-3384"><span class="linenos">3384</span></a>        <span class="n">slope</span> <span class="o">=</span> <span class="o">-</span><span class="n">gamma</span>
</span><span id="Laws-3385"><a href="#Laws-3385"><span class="linenos">3385</span></a>        <span class="n">intercept</span> <span class="o">=</span> <span class="n">temp</span>
</span><span id="Laws-3386"><a href="#Laws-3386"><span class="linenos">3386</span></a>
</span><span id="Laws-3387"><a href="#Laws-3387"><span class="linenos">3387</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">DeltaS</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">S_mid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Laws-3388"><a href="#Laws-3388"><span class="linenos">3388</span></a>        <span class="n">DeltaS</span> <span class="o">=</span> <span class="n">DeltaS</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span><span id="Laws-3389"><a href="#Laws-3389"><span class="linenos">3389</span></a>        <span class="n">S_mid</span> <span class="o">=</span> <span class="n">S_mid</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span><span id="Laws-3390"><a href="#Laws-3390"><span class="linenos">3390</span></a>
</span><span id="Laws-3391"><a href="#Laws-3391"><span class="linenos">3391</span></a>        <span class="c1"># S_t = np.array(S_t)</span>
</span><span id="Laws-3392"><a href="#Laws-3392"><span class="linenos">3392</span></a>        <span class="c1"># DeltaS = S_t[1:] - S_t[:-1]</span>
</span><span id="Laws-3393"><a href="#Laws-3393"><span class="linenos">3393</span></a>        <span class="c1"># S_mid = S_t[:-1]</span>
</span><span id="Laws-3394"><a href="#Laws-3394"><span class="linenos">3394</span></a>        <span class="c1"># mask = (DeltaS &gt; 0) &amp; (S_mid &gt; 0)</span>
</span><span id="Laws-3395"><a href="#Laws-3395"><span class="linenos">3395</span></a>        <span class="c1"># DeltaS = DeltaS[mask]</span>
</span><span id="Laws-3396"><a href="#Laws-3396"><span class="linenos">3396</span></a>        <span class="c1"># S_mid = S_mid[mask]</span>
</span><span id="Laws-3397"><a href="#Laws-3397"><span class="linenos">3397</span></a>
</span><span id="Laws-3398"><a href="#Laws-3398"><span class="linenos">3398</span></a>        <span class="c1"># X = np.log(S_mid).reshape(-1, 1)  # predictor</span>
</span><span id="Laws-3399"><a href="#Laws-3399"><span class="linenos">3399</span></a>        <span class="c1"># y = np.log(DeltaS)  # response</span>
</span><span id="Laws-3400"><a href="#Laws-3400"><span class="linenos">3400</span></a>
</span><span id="Laws-3401"><a href="#Laws-3401"><span class="linenos">3401</span></a>        <span class="c1"># model = LinearRegression()</span>
</span><span id="Laws-3402"><a href="#Laws-3402"><span class="linenos">3402</span></a>        <span class="c1"># model.fit(X, y)</span>
</span><span id="Laws-3403"><a href="#Laws-3403"><span class="linenos">3403</span></a>
</span><span id="Laws-3404"><a href="#Laws-3404"><span class="linenos">3404</span></a>        <span class="c1"># slope = model.coef_[0]</span>
</span><span id="Laws-3405"><a href="#Laws-3405"><span class="linenos">3405</span></a>        <span class="c1"># intercept = model.intercept_</span>
</span><span id="Laws-3406"><a href="#Laws-3406"><span class="linenos">3406</span></a>        <span class="c1"># gamma_est = -slope</span>
</span><span id="Laws-3407"><a href="#Laws-3407"><span class="linenos">3407</span></a>        <span class="c1"># rho_est = np.exp(intercept)</span>
</span><span id="Laws-3408"><a href="#Laws-3408"><span class="linenos">3408</span></a>
</span><span id="Laws-3409"><a href="#Laws-3409"><span class="linenos">3409</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Laws-3410"><a href="#Laws-3410"><span class="linenos">3410</span></a>            <span class="n">rho</span><span class="p">,</span>
</span><span id="Laws-3411"><a href="#Laws-3411"><span class="linenos">3411</span></a>            <span class="n">gamma</span><span class="p">,</span>
</span><span id="Laws-3412"><a href="#Laws-3412"><span class="linenos">3412</span></a>            <span class="n">DeltaS</span><span class="p">,</span>
</span><span id="Laws-3413"><a href="#Laws-3413"><span class="linenos">3413</span></a>            <span class="n">S_mid</span><span class="p">,</span>
</span><span id="Laws-3414"><a href="#Laws-3414"><span class="linenos">3414</span></a>            <span class="n">intercept</span><span class="p">,</span>
</span><span id="Laws-3415"><a href="#Laws-3415"><span class="linenos">3415</span></a>            <span class="n">slope</span><span class="p">,</span>
</span><span id="Laws-3416"><a href="#Laws-3416"><span class="linenos">3416</span></a>            <span class="n">nrows</span><span class="p">,</span>
</span><span id="Laws-3417"><a href="#Laws-3417"><span class="linenos">3417</span></a>            <span class="n">t_array</span>
</span><span id="Laws-3418"><a href="#Laws-3418"><span class="linenos">3418</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A class for handling statistical data analysis and generating
reports in PDF format.</p>

<p>This class takes in a dataset, performs statistical analysis,
applies curve fitting techniques, and generates a PDF report
summarizing the results.</p>

<h2 id="parameters">Parameters:</h2>

<p>pdf_object : FPDF
    An instance of the <code>FPDF</code> class used for generating the
        PDF report.
stats_frame : DataSetStats
    An instance of <code><a href="#DataSetStats">DataSetStats</a></code> containing statistical
        information about the dataset.
output_path : str
    The file path where the generated PDF report will be saved.</p>

<h2 id="attributes">Attributes:</h2>

<p>pdf_object : FPDF
    The PDF object used for report generation.
output_path : str
    The location where the final report will be stored.
stats_frame : DataSetStats
    The dataset statistics object containing calculated metrics.
curve_fitting : DistributionFitingTools
    A toolset for fitting distributions to the dataset.</p>
</div>


                            <div id="Laws.__init__" class="classattr">
                                        <input id="Laws.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Laws</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">pdf_object</span><span class="p">:</span> <span class="n">fpdf</span><span class="o">.</span><span class="n">fpdf</span><span class="o">.</span><span class="n">FPDF</span>,</span><span class="param">	<span class="n">stats_frame</span><span class="p">:</span> <span class="n"><a href="#DataSetStats">DataSetStats</a></span>,</span><span class="param">	<span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span></span>)</span>

                <label class="view-source-button" for="Laws.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.__init__-1601"><a href="#Laws.__init__-1601"><span class="linenos">1601</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Laws.__init__-1602"><a href="#Laws.__init__-1602"><span class="linenos">1602</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="Laws.__init__-1603"><a href="#Laws.__init__-1603"><span class="linenos">1603</span></a>            <span class="n">pdf_object</span><span class="p">:</span> <span class="n">FPDF</span><span class="p">,</span>
</span><span id="Laws.__init__-1604"><a href="#Laws.__init__-1604"><span class="linenos">1604</span></a>            <span class="n">stats_frame</span><span class="p">:</span> <span class="n">DataSetStats</span><span class="p">,</span>
</span><span id="Laws.__init__-1605"><a href="#Laws.__init__-1605"><span class="linenos">1605</span></a>            <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="Laws.__init__-1606"><a href="#Laws.__init__-1606"><span class="linenos">1606</span></a>        <span class="p">):</span>
</span><span id="Laws.__init__-1607"><a href="#Laws.__init__-1607"><span class="linenos">1607</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws.__init__-1608"><a href="#Laws.__init__-1608"><span class="linenos">1608</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws.__init__-1609"><a href="#Laws.__init__-1609"><span class="linenos">1609</span></a><span class="sd">        -----------</span>
</span><span id="Laws.__init__-1610"><a href="#Laws.__init__-1610"><span class="linenos">1610</span></a><span class="sd">        pdf_object : FPDF</span>
</span><span id="Laws.__init__-1611"><a href="#Laws.__init__-1611"><span class="linenos">1611</span></a><span class="sd">            An instance of the `FPDF` class used for generating the</span>
</span><span id="Laws.__init__-1612"><a href="#Laws.__init__-1612"><span class="linenos">1612</span></a><span class="sd">                PDF report.</span>
</span><span id="Laws.__init__-1613"><a href="#Laws.__init__-1613"><span class="linenos">1613</span></a><span class="sd">        stats_frame : DataSetStats</span>
</span><span id="Laws.__init__-1614"><a href="#Laws.__init__-1614"><span class="linenos">1614</span></a><span class="sd">            An instance of `DataSetStats` containing statistical</span>
</span><span id="Laws.__init__-1615"><a href="#Laws.__init__-1615"><span class="linenos">1615</span></a><span class="sd">                information about the dataset.</span>
</span><span id="Laws.__init__-1616"><a href="#Laws.__init__-1616"><span class="linenos">1616</span></a><span class="sd">        output_path : str</span>
</span><span id="Laws.__init__-1617"><a href="#Laws.__init__-1617"><span class="linenos">1617</span></a><span class="sd">            The file path where the generated PDF report will be saved.</span>
</span><span id="Laws.__init__-1618"><a href="#Laws.__init__-1618"><span class="linenos">1618</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws.__init__-1619"><a href="#Laws.__init__-1619"><span class="linenos">1619</span></a>
</span><span id="Laws.__init__-1620"><a href="#Laws.__init__-1620"><span class="linenos">1620</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span> <span class="o">=</span> <span class="n">pdf_object</span>
</span><span id="Laws.__init__-1621"><a href="#Laws.__init__-1621"><span class="linenos">1621</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span> <span class="o">=</span> <span class="n">output_path</span>
</span><span id="Laws.__init__-1622"><a href="#Laws.__init__-1622"><span class="linenos">1622</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span> <span class="o">=</span> <span class="n">stats_frame</span>
</span><span id="Laws.__init__-1623"><a href="#Laws.__init__-1623"><span class="linenos">1623</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">curve_fitting</span> <span class="o">=</span> <span class="n">DistributionFitingTools</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><h2 id="parameters">Parameters:</h2>

<p>pdf_object : FPDF
    An instance of the <code>FPDF</code> class used for generating the
        PDF report.
stats_frame : DataSetStats
    An instance of <code><a href="#DataSetStats">DataSetStats</a></code> containing statistical
        information about the dataset.
output_path : str
    The file path where the generated PDF report will be saved.</p>
</div>


                            </div>
                            <div id="Laws.pdf_object" class="classattr">
                                <div class="attr variable">
            <span class="name">pdf_object</span>

        
    </div>
    <a class="headerlink" href="#Laws.pdf_object"></a>
    
    

                            </div>
                            <div id="Laws.output_path" class="classattr">
                                <div class="attr variable">
            <span class="name">output_path</span>

        
    </div>
    <a class="headerlink" href="#Laws.output_path"></a>
    
    

                            </div>
                            <div id="Laws.stats_frame" class="classattr">
                                <div class="attr variable">
            <span class="name">stats_frame</span>

        
    </div>
    <a class="headerlink" href="#Laws.stats_frame"></a>
    
    

                            </div>
                            <div id="Laws.curve_fitting" class="classattr">
                                <div class="attr variable">
            <span class="name">curve_fitting</span>

        
    </div>
    <a class="headerlink" href="#Laws.curve_fitting"></a>
    
    

                            </div>
                            <div id="Laws.log_curve_fitting_resluts" class="classattr">
                                        <input id="Laws.log_curve_fitting_resluts-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">log_curve_fitting_resluts</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">func</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.log_curve_fitting_resluts-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.log_curve_fitting_resluts"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.log_curve_fitting_resluts-2157"><a href="#Laws.log_curve_fitting_resluts-2157"><span class="linenos">2157</span></a>    <span class="k">def</span> <span class="nf">log_curve_fitting_resluts</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Laws.log_curve_fitting_resluts-2158"><a href="#Laws.log_curve_fitting_resluts-2158"><span class="linenos">2158</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws.log_curve_fitting_resluts-2159"><a href="#Laws.log_curve_fitting_resluts-2159"><span class="linenos">2159</span></a><span class="sd">        A decorator that logs and saves curve fitting results</span>
</span><span id="Laws.log_curve_fitting_resluts-2160"><a href="#Laws.log_curve_fitting_resluts-2160"><span class="linenos">2160</span></a><span class="sd">        to a PDF report.</span>
</span><span id="Laws.log_curve_fitting_resluts-2161"><a href="#Laws.log_curve_fitting_resluts-2161"><span class="linenos">2161</span></a>
</span><span id="Laws.log_curve_fitting_resluts-2162"><a href="#Laws.log_curve_fitting_resluts-2162"><span class="linenos">2162</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="Laws.log_curve_fitting_resluts-2163"><a href="#Laws.log_curve_fitting_resluts-2163"><span class="linenos">2163</span></a><span class="sd">        - func_name (str): Name of the function.</span>
</span><span id="Laws.log_curve_fitting_resluts-2164"><a href="#Laws.log_curve_fitting_resluts-2164"><span class="linenos">2164</span></a><span class="sd">        - best_fit (str): Name of the best-fitting curve.</span>
</span><span id="Laws.log_curve_fitting_resluts-2165"><a href="#Laws.log_curve_fitting_resluts-2165"><span class="linenos">2165</span></a><span class="sd">        - param_frame (pd.DataFrame): DataFrame containing</span>
</span><span id="Laws.log_curve_fitting_resluts-2166"><a href="#Laws.log_curve_fitting_resluts-2166"><span class="linenos">2166</span></a><span class="sd">            curve parameters.</span>
</span><span id="Laws.log_curve_fitting_resluts-2167"><a href="#Laws.log_curve_fitting_resluts-2167"><span class="linenos">2167</span></a><span class="sd">        - plot_obj (BytesIO): The plot image object.</span>
</span><span id="Laws.log_curve_fitting_resluts-2168"><a href="#Laws.log_curve_fitting_resluts-2168"><span class="linenos">2168</span></a>
</span><span id="Laws.log_curve_fitting_resluts-2169"><a href="#Laws.log_curve_fitting_resluts-2169"><span class="linenos">2169</span></a><span class="sd">        The results are logged in `self.stats_frame`</span>
</span><span id="Laws.log_curve_fitting_resluts-2170"><a href="#Laws.log_curve_fitting_resluts-2170"><span class="linenos">2170</span></a><span class="sd">            and added to a PDF report.</span>
</span><span id="Laws.log_curve_fitting_resluts-2171"><a href="#Laws.log_curve_fitting_resluts-2171"><span class="linenos">2171</span></a>
</span><span id="Laws.log_curve_fitting_resluts-2172"><a href="#Laws.log_curve_fitting_resluts-2172"><span class="linenos">2172</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws.log_curve_fitting_resluts-2173"><a href="#Laws.log_curve_fitting_resluts-2173"><span class="linenos">2173</span></a><span class="sd">        -----------</span>
</span><span id="Laws.log_curve_fitting_resluts-2174"><a href="#Laws.log_curve_fitting_resluts-2174"><span class="linenos">2174</span></a><span class="sd">        func : function</span>
</span><span id="Laws.log_curve_fitting_resluts-2175"><a href="#Laws.log_curve_fitting_resluts-2175"><span class="linenos">2175</span></a><span class="sd">            The function performing curve fitting.</span>
</span><span id="Laws.log_curve_fitting_resluts-2176"><a href="#Laws.log_curve_fitting_resluts-2176"><span class="linenos">2176</span></a>
</span><span id="Laws.log_curve_fitting_resluts-2177"><a href="#Laws.log_curve_fitting_resluts-2177"><span class="linenos">2177</span></a><span class="sd">        Returns:</span>
</span><span id="Laws.log_curve_fitting_resluts-2178"><a href="#Laws.log_curve_fitting_resluts-2178"><span class="linenos">2178</span></a><span class="sd">        --------</span>
</span><span id="Laws.log_curve_fitting_resluts-2179"><a href="#Laws.log_curve_fitting_resluts-2179"><span class="linenos">2179</span></a><span class="sd">        function</span>
</span><span id="Laws.log_curve_fitting_resluts-2180"><a href="#Laws.log_curve_fitting_resluts-2180"><span class="linenos">2180</span></a><span class="sd">            Wrapped function with additional logging and PDF output.</span>
</span><span id="Laws.log_curve_fitting_resluts-2181"><a href="#Laws.log_curve_fitting_resluts-2181"><span class="linenos">2181</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws.log_curve_fitting_resluts-2182"><a href="#Laws.log_curve_fitting_resluts-2182"><span class="linenos">2182</span></a>
</span><span id="Laws.log_curve_fitting_resluts-2183"><a href="#Laws.log_curve_fitting_resluts-2183"><span class="linenos">2183</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.log_curve_fitting_resluts-2184"><a href="#Laws.log_curve_fitting_resluts-2184"><span class="linenos">2184</span></a>            <span class="n">func_name</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.log_curve_fitting_resluts-2185"><a href="#Laws.log_curve_fitting_resluts-2185"><span class="linenos">2185</span></a>            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">param_frame</span><span class="p">[</span><span class="n">param_frame</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_fit</span><span class="p">]</span>
</span><span id="Laws.log_curve_fitting_resluts-2186"><a href="#Laws.log_curve_fitting_resluts-2186"><span class="linenos">2186</span></a>
</span><span id="Laws.log_curve_fitting_resluts-2187"><a href="#Laws.log_curve_fitting_resluts-2187"><span class="linenos">2187</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">func_name</span><span class="p">:</span> <span class="n">best_fit</span><span class="p">})</span>
</span><span id="Laws.log_curve_fitting_resluts-2188"><a href="#Laws.log_curve_fitting_resluts-2188"><span class="linenos">2188</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws.log_curve_fitting_resluts-2189"><a href="#Laws.log_curve_fitting_resluts-2189"><span class="linenos">2189</span></a>                <span class="p">{</span>
</span><span id="Laws.log_curve_fitting_resluts-2190"><a href="#Laws.log_curve_fitting_resluts-2190"><span class="linenos">2190</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">filtered_df</span><span class="p">[</span>
</span><span id="Laws.log_curve_fitting_resluts-2191"><a href="#Laws.log_curve_fitting_resluts-2191"><span class="linenos">2191</span></a>                        <span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">,</span> <span class="s2">&quot;param2&quot;</span><span class="p">]</span>
</span><span id="Laws.log_curve_fitting_resluts-2192"><a href="#Laws.log_curve_fitting_resluts-2192"><span class="linenos">2192</span></a>                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Laws.log_curve_fitting_resluts-2193"><a href="#Laws.log_curve_fitting_resluts-2193"><span class="linenos">2193</span></a>                <span class="p">}</span>
</span><span id="Laws.log_curve_fitting_resluts-2194"><a href="#Laws.log_curve_fitting_resluts-2194"><span class="linenos">2194</span></a>            <span class="p">)</span>
</span><span id="Laws.log_curve_fitting_resluts-2195"><a href="#Laws.log_curve_fitting_resluts-2195"><span class="linenos">2195</span></a>
</span><span id="Laws.log_curve_fitting_resluts-2196"><a href="#Laws.log_curve_fitting_resluts-2196"><span class="linenos">2196</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">func_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws.log_curve_fitting_resluts-2197"><a href="#Laws.log_curve_fitting_resluts-2197"><span class="linenos">2197</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws.log_curve_fitting_resluts-2198"><a href="#Laws.log_curve_fitting_resluts-2198"><span class="linenos">2198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.log_curve_fitting_resluts-2199"><a href="#Laws.log_curve_fitting_resluts-2199"><span class="linenos">2199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.log_curve_fitting_resluts-2200"><a href="#Laws.log_curve_fitting_resluts-2200"><span class="linenos">2200</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.log_curve_fitting_resluts-2201"><a href="#Laws.log_curve_fitting_resluts-2201"><span class="linenos">2201</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.log_curve_fitting_resluts-2202"><a href="#Laws.log_curve_fitting_resluts-2202"><span class="linenos">2202</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">best_fit</span><span class="si">}</span><span class="s1"> with Param 1: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">,&#39;</span>
</span><span id="Laws.log_curve_fitting_resluts-2203"><a href="#Laws.log_curve_fitting_resluts-2203"><span class="linenos">2203</span></a>                <span class="sa">f</span><span class="s1">&#39;Param 2: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.log_curve_fitting_resluts-2204"><a href="#Laws.log_curve_fitting_resluts-2204"><span class="linenos">2204</span></a>            <span class="p">)</span>
</span><span id="Laws.log_curve_fitting_resluts-2205"><a href="#Laws.log_curve_fitting_resluts-2205"><span class="linenos">2205</span></a>
</span><span id="Laws.log_curve_fitting_resluts-2206"><a href="#Laws.log_curve_fitting_resluts-2206"><span class="linenos">2206</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.log_curve_fitting_resluts-2207"><a href="#Laws.log_curve_fitting_resluts-2207"><span class="linenos">2207</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_curves_table</span><span class="p">(</span>
</span><span id="Laws.log_curve_fitting_resluts-2208"><a href="#Laws.log_curve_fitting_resluts-2208"><span class="linenos">2208</span></a>                <span class="n">param_frame</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="n">y_position_global</span> <span class="o">+</span> <span class="mi">13</span>
</span><span id="Laws.log_curve_fitting_resluts-2209"><a href="#Laws.log_curve_fitting_resluts-2209"><span class="linenos">2209</span></a>            <span class="p">)</span>
</span><span id="Laws.log_curve_fitting_resluts-2210"><a href="#Laws.log_curve_fitting_resluts-2210"><span class="linenos">2210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.log_curve_fitting_resluts-2211"><a href="#Laws.log_curve_fitting_resluts-2211"><span class="linenos">2211</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj</span><span class="p">,</span>
</span><span id="Laws.log_curve_fitting_resluts-2212"><a href="#Laws.log_curve_fitting_resluts-2212"><span class="linenos">2212</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.log_curve_fitting_resluts-2213"><a href="#Laws.log_curve_fitting_resluts-2213"><span class="linenos">2213</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws.log_curve_fitting_resluts-2214"><a href="#Laws.log_curve_fitting_resluts-2214"><span class="linenos">2214</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span>
</span><span id="Laws.log_curve_fitting_resluts-2215"><a href="#Laws.log_curve_fitting_resluts-2215"><span class="linenos">2215</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.log_curve_fitting_resluts-2216"><a href="#Laws.log_curve_fitting_resluts-2216"><span class="linenos">2216</span></a>            <span class="p">)</span>
</span><span id="Laws.log_curve_fitting_resluts-2217"><a href="#Laws.log_curve_fitting_resluts-2217"><span class="linenos">2217</span></a>
</span><span id="Laws.log_curve_fitting_resluts-2218"><a href="#Laws.log_curve_fitting_resluts-2218"><span class="linenos">2218</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span></pre></div>


            <div class="docstring"><p>A decorator that logs and saves curve fitting results
to a PDF report.</p>

<p>The decorated function is expected to return:</p>

<ul>
<li>func_name (str): Name of the function.</li>
<li>best_fit (str): Name of the best-fitting curve.</li>
<li>param_frame (pd.DataFrame): DataFrame containing
curve parameters.</li>
<li>plot_obj (BytesIO): The plot image object.</li>
</ul>

<p>The results are logged in <code>self.stats_frame</code>
    and added to a PDF report.</p>

<h2 id="parameters">Parameters:</h2>

<p>func : function
    The function performing curve fitting.</p>

<h2 id="returns">Returns:</h2>

<p>function
    Wrapped function with additional logging and PDF output.</p>
</div>


                            </div>
                            <div id="Laws.log_distribution_fitting_resluts" class="classattr">
                                        <input id="Laws.log_distribution_fitting_resluts-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">log_distribution_fitting_resluts</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">func</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.log_distribution_fitting_resluts-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.log_distribution_fitting_resluts"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.log_distribution_fitting_resluts-2221"><a href="#Laws.log_distribution_fitting_resluts-2221"><span class="linenos">2221</span></a>    <span class="k">def</span> <span class="nf">log_distribution_fitting_resluts</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Laws.log_distribution_fitting_resluts-2222"><a href="#Laws.log_distribution_fitting_resluts-2222"><span class="linenos">2222</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws.log_distribution_fitting_resluts-2223"><a href="#Laws.log_distribution_fitting_resluts-2223"><span class="linenos">2223</span></a><span class="sd">        A decorator that logs and saves distribution fitting</span>
</span><span id="Laws.log_distribution_fitting_resluts-2224"><a href="#Laws.log_distribution_fitting_resluts-2224"><span class="linenos">2224</span></a><span class="sd">        results to a PDF report.</span>
</span><span id="Laws.log_distribution_fitting_resluts-2225"><a href="#Laws.log_distribution_fitting_resluts-2225"><span class="linenos">2225</span></a>
</span><span id="Laws.log_distribution_fitting_resluts-2226"><a href="#Laws.log_distribution_fitting_resluts-2226"><span class="linenos">2226</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="Laws.log_distribution_fitting_resluts-2227"><a href="#Laws.log_distribution_fitting_resluts-2227"><span class="linenos">2227</span></a><span class="sd">        - results[0] (str): The name of the fitted distribution.</span>
</span><span id="Laws.log_distribution_fitting_resluts-2228"><a href="#Laws.log_distribution_fitting_resluts-2228"><span class="linenos">2228</span></a><span class="sd">        - results[1] (distfit object): Fitted distribution model.</span>
</span><span id="Laws.log_distribution_fitting_resluts-2229"><a href="#Laws.log_distribution_fitting_resluts-2229"><span class="linenos">2229</span></a><span class="sd">        - results[2] (BytesIO): Distribution plot.</span>
</span><span id="Laws.log_distribution_fitting_resluts-2230"><a href="#Laws.log_distribution_fitting_resluts-2230"><span class="linenos">2230</span></a><span class="sd">        - results[3] (BytesIO): Model plot.</span>
</span><span id="Laws.log_distribution_fitting_resluts-2231"><a href="#Laws.log_distribution_fitting_resluts-2231"><span class="linenos">2231</span></a><span class="sd">        - results[4] (tuple, optional): If present, contains</span>
</span><span id="Laws.log_distribution_fitting_resluts-2232"><a href="#Laws.log_distribution_fitting_resluts-2232"><span class="linenos">2232</span></a><span class="sd">            information about a flexion point.</span>
</span><span id="Laws.log_distribution_fitting_resluts-2233"><a href="#Laws.log_distribution_fitting_resluts-2233"><span class="linenos">2233</span></a>
</span><span id="Laws.log_distribution_fitting_resluts-2234"><a href="#Laws.log_distribution_fitting_resluts-2234"><span class="linenos">2234</span></a><span class="sd">        If a flexion point is detected, it logs both left</span>
</span><span id="Laws.log_distribution_fitting_resluts-2235"><a href="#Laws.log_distribution_fitting_resluts-2235"><span class="linenos">2235</span></a><span class="sd">        and right distributions and plots them separately.</span>
</span><span id="Laws.log_distribution_fitting_resluts-2236"><a href="#Laws.log_distribution_fitting_resluts-2236"><span class="linenos">2236</span></a>
</span><span id="Laws.log_distribution_fitting_resluts-2237"><a href="#Laws.log_distribution_fitting_resluts-2237"><span class="linenos">2237</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws.log_distribution_fitting_resluts-2238"><a href="#Laws.log_distribution_fitting_resluts-2238"><span class="linenos">2238</span></a><span class="sd">        -----------</span>
</span><span id="Laws.log_distribution_fitting_resluts-2239"><a href="#Laws.log_distribution_fitting_resluts-2239"><span class="linenos">2239</span></a><span class="sd">        func : function</span>
</span><span id="Laws.log_distribution_fitting_resluts-2240"><a href="#Laws.log_distribution_fitting_resluts-2240"><span class="linenos">2240</span></a><span class="sd">            The function performing distribution fitting.</span>
</span><span id="Laws.log_distribution_fitting_resluts-2241"><a href="#Laws.log_distribution_fitting_resluts-2241"><span class="linenos">2241</span></a>
</span><span id="Laws.log_distribution_fitting_resluts-2242"><a href="#Laws.log_distribution_fitting_resluts-2242"><span class="linenos">2242</span></a><span class="sd">        Returns:</span>
</span><span id="Laws.log_distribution_fitting_resluts-2243"><a href="#Laws.log_distribution_fitting_resluts-2243"><span class="linenos">2243</span></a><span class="sd">        --------</span>
</span><span id="Laws.log_distribution_fitting_resluts-2244"><a href="#Laws.log_distribution_fitting_resluts-2244"><span class="linenos">2244</span></a><span class="sd">        function</span>
</span><span id="Laws.log_distribution_fitting_resluts-2245"><a href="#Laws.log_distribution_fitting_resluts-2245"><span class="linenos">2245</span></a><span class="sd">            Wrapped function with additional logging and PDF output.</span>
</span><span id="Laws.log_distribution_fitting_resluts-2246"><a href="#Laws.log_distribution_fitting_resluts-2246"><span class="linenos">2246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws.log_distribution_fitting_resluts-2247"><a href="#Laws.log_distribution_fitting_resluts-2247"><span class="linenos">2247</span></a>
</span><span id="Laws.log_distribution_fitting_resluts-2248"><a href="#Laws.log_distribution_fitting_resluts-2248"><span class="linenos">2248</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.log_distribution_fitting_resluts-2249"><a href="#Laws.log_distribution_fitting_resluts-2249"><span class="linenos">2249</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2250"><a href="#Laws.log_distribution_fitting_resluts-2250"><span class="linenos">2250</span></a>
</span><span id="Laws.log_distribution_fitting_resluts-2251"><a href="#Laws.log_distribution_fitting_resluts-2251"><span class="linenos">2251</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]})</span>
</span><span id="Laws.log_distribution_fitting_resluts-2252"><a href="#Laws.log_distribution_fitting_resluts-2252"><span class="linenos">2252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws.log_distribution_fitting_resluts-2253"><a href="#Laws.log_distribution_fitting_resluts-2253"><span class="linenos">2253</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]}</span>
</span><span id="Laws.log_distribution_fitting_resluts-2254"><a href="#Laws.log_distribution_fitting_resluts-2254"><span class="linenos">2254</span></a>            <span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2255"><a href="#Laws.log_distribution_fitting_resluts-2255"><span class="linenos">2255</span></a>
</span><span id="Laws.log_distribution_fitting_resluts-2256"><a href="#Laws.log_distribution_fitting_resluts-2256"><span class="linenos">2256</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2257"><a href="#Laws.log_distribution_fitting_resluts-2257"><span class="linenos">2257</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws.log_distribution_fitting_resluts-2258"><a href="#Laws.log_distribution_fitting_resluts-2258"><span class="linenos">2258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2259"><a href="#Laws.log_distribution_fitting_resluts-2259"><span class="linenos">2259</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2260"><a href="#Laws.log_distribution_fitting_resluts-2260"><span class="linenos">2260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2261"><a href="#Laws.log_distribution_fitting_resluts-2261"><span class="linenos">2261</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.log_distribution_fitting_resluts-2262"><a href="#Laws.log_distribution_fitting_resluts-2262"><span class="linenos">2262</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.log_distribution_fitting_resluts-2263"><a href="#Laws.log_distribution_fitting_resluts-2263"><span class="linenos">2263</span></a>            <span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2264"><a href="#Laws.log_distribution_fitting_resluts-2264"><span class="linenos">2264</span></a>
</span><span id="Laws.log_distribution_fitting_resluts-2265"><a href="#Laws.log_distribution_fitting_resluts-2265"><span class="linenos">2265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.log_distribution_fitting_resluts-2266"><a href="#Laws.log_distribution_fitting_resluts-2266"><span class="linenos">2266</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.log_distribution_fitting_resluts-2267"><a href="#Laws.log_distribution_fitting_resluts-2267"><span class="linenos">2267</span></a>            <span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2268"><a href="#Laws.log_distribution_fitting_resluts-2268"><span class="linenos">2268</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.log_distribution_fitting_resluts-2269"><a href="#Laws.log_distribution_fitting_resluts-2269"><span class="linenos">2269</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.log_distribution_fitting_resluts-2270"><a href="#Laws.log_distribution_fitting_resluts-2270"><span class="linenos">2270</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.log_distribution_fitting_resluts-2271"><a href="#Laws.log_distribution_fitting_resluts-2271"><span class="linenos">2271</span></a>            <span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2272"><a href="#Laws.log_distribution_fitting_resluts-2272"><span class="linenos">2272</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.log_distribution_fitting_resluts-2273"><a href="#Laws.log_distribution_fitting_resluts-2273"><span class="linenos">2273</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.log_distribution_fitting_resluts-2274"><a href="#Laws.log_distribution_fitting_resluts-2274"><span class="linenos">2274</span></a>            <span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2275"><a href="#Laws.log_distribution_fitting_resluts-2275"><span class="linenos">2275</span></a>
</span><span id="Laws.log_distribution_fitting_resluts-2276"><a href="#Laws.log_distribution_fitting_resluts-2276"><span class="linenos">2276</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Laws.log_distribution_fitting_resluts-2277"><a href="#Laws.log_distribution_fitting_resluts-2277"><span class="linenos">2277</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.log_distribution_fitting_resluts-2278"><a href="#Laws.log_distribution_fitting_resluts-2278"><span class="linenos">2278</span></a>                    <span class="sa">f</span><span class="s2">&quot;At point </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">, the flexion point of the distributions was found&quot;</span>
</span><span id="Laws.log_distribution_fitting_resluts-2279"><a href="#Laws.log_distribution_fitting_resluts-2279"><span class="linenos">2279</span></a>                <span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2280"><a href="#Laws.log_distribution_fitting_resluts-2280"><span class="linenos">2280</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.log_distribution_fitting_resluts-2281"><a href="#Laws.log_distribution_fitting_resluts-2281"><span class="linenos">2281</span></a>                    <span class="sa">f</span><span class="s1">&#39;Left distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.log_distribution_fitting_resluts-2282"><a href="#Laws.log_distribution_fitting_resluts-2282"><span class="linenos">2282</span></a>                <span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2283"><a href="#Laws.log_distribution_fitting_resluts-2283"><span class="linenos">2283</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.log_distribution_fitting_resluts-2284"><a href="#Laws.log_distribution_fitting_resluts-2284"><span class="linenos">2284</span></a>                    <span class="sa">f</span><span class="s1">&#39;Right distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.log_distribution_fitting_resluts-2285"><a href="#Laws.log_distribution_fitting_resluts-2285"><span class="linenos">2285</span></a>                <span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2286"><a href="#Laws.log_distribution_fitting_resluts-2286"><span class="linenos">2286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.log_distribution_fitting_resluts-2287"><a href="#Laws.log_distribution_fitting_resluts-2287"><span class="linenos">2287</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.log_distribution_fitting_resluts-2288"><a href="#Laws.log_distribution_fitting_resluts-2288"><span class="linenos">2288</span></a>                <span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2289"><a href="#Laws.log_distribution_fitting_resluts-2289"><span class="linenos">2289</span></a>                <span class="n">plot_distribution</span><span class="p">,</span> <span class="n">plot_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_double_distribution</span><span class="p">(</span>
</span><span id="Laws.log_distribution_fitting_resluts-2290"><a href="#Laws.log_distribution_fitting_resluts-2290"><span class="linenos">2290</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.log_distribution_fitting_resluts-2291"><a href="#Laws.log_distribution_fitting_resluts-2291"><span class="linenos">2291</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
</span><span id="Laws.log_distribution_fitting_resluts-2292"><a href="#Laws.log_distribution_fitting_resluts-2292"><span class="linenos">2292</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
</span><span id="Laws.log_distribution_fitting_resluts-2293"><a href="#Laws.log_distribution_fitting_resluts-2293"><span class="linenos">2293</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
</span><span id="Laws.log_distribution_fitting_resluts-2294"><a href="#Laws.log_distribution_fitting_resluts-2294"><span class="linenos">2294</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
</span><span id="Laws.log_distribution_fitting_resluts-2295"><a href="#Laws.log_distribution_fitting_resluts-2295"><span class="linenos">2295</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.log_distribution_fitting_resluts-2296"><a href="#Laws.log_distribution_fitting_resluts-2296"><span class="linenos">2296</span></a>                <span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2297"><a href="#Laws.log_distribution_fitting_resluts-2297"><span class="linenos">2297</span></a>                <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.log_distribution_fitting_resluts-2298"><a href="#Laws.log_distribution_fitting_resluts-2298"><span class="linenos">2298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.log_distribution_fitting_resluts-2299"><a href="#Laws.log_distribution_fitting_resluts-2299"><span class="linenos">2299</span></a>                    <span class="n">plot_distribution</span><span class="p">,</span>
</span><span id="Laws.log_distribution_fitting_resluts-2300"><a href="#Laws.log_distribution_fitting_resluts-2300"><span class="linenos">2300</span></a>                    <span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.log_distribution_fitting_resluts-2301"><a href="#Laws.log_distribution_fitting_resluts-2301"><span class="linenos">2301</span></a>                    <span class="mi">60</span><span class="p">,</span>
</span><span id="Laws.log_distribution_fitting_resluts-2302"><a href="#Laws.log_distribution_fitting_resluts-2302"><span class="linenos">2302</span></a>                    <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Laws.log_distribution_fitting_resluts-2303"><a href="#Laws.log_distribution_fitting_resluts-2303"><span class="linenos">2303</span></a>                    <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.log_distribution_fitting_resluts-2304"><a href="#Laws.log_distribution_fitting_resluts-2304"><span class="linenos">2304</span></a>                <span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2305"><a href="#Laws.log_distribution_fitting_resluts-2305"><span class="linenos">2305</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.log_distribution_fitting_resluts-2306"><a href="#Laws.log_distribution_fitting_resluts-2306"><span class="linenos">2306</span></a>                    <span class="n">plot_models</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.log_distribution_fitting_resluts-2307"><a href="#Laws.log_distribution_fitting_resluts-2307"><span class="linenos">2307</span></a>                <span class="p">)</span>
</span><span id="Laws.log_distribution_fitting_resluts-2308"><a href="#Laws.log_distribution_fitting_resluts-2308"><span class="linenos">2308</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span><span id="Laws.log_distribution_fitting_resluts-2309"><a href="#Laws.log_distribution_fitting_resluts-2309"><span class="linenos">2309</span></a>
</span><span id="Laws.log_distribution_fitting_resluts-2310"><a href="#Laws.log_distribution_fitting_resluts-2310"><span class="linenos">2310</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span></pre></div>


            <div class="docstring"><p>A decorator that logs and saves distribution fitting
results to a PDF report.</p>

<p>The decorated function is expected to return:</p>

<ul>
<li>results[0] (str): The name of the fitted distribution.</li>
<li>results[1] (distfit object): Fitted distribution model.</li>
<li>results[2] (BytesIO): Distribution plot.</li>
<li>results[3] (BytesIO): Model plot.</li>
<li>results[4] (tuple, optional): If present, contains
information about a flexion point.</li>
</ul>

<p>If a flexion point is detected, it logs both left
and right distributions and plots them separately.</p>

<h2 id="parameters">Parameters:</h2>

<p>func : function
    The function performing distribution fitting.</p>

<h2 id="returns">Returns:</h2>

<p>function
    Wrapped function with additional logging and PDF output.</p>
</div>


                            </div>
                            <div id="Laws.log_pnew_estimation" class="classattr">
                                        <input id="Laws.log_pnew_estimation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">log_pnew_estimation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">func</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.log_pnew_estimation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.log_pnew_estimation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.log_pnew_estimation-2313"><a href="#Laws.log_pnew_estimation-2313"><span class="linenos">2313</span></a>    <span class="k">def</span> <span class="nf">log_pnew_estimation</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Laws.log_pnew_estimation-2314"><a href="#Laws.log_pnew_estimation-2314"><span class="linenos">2314</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws.log_pnew_estimation-2315"><a href="#Laws.log_pnew_estimation-2315"><span class="linenos">2315</span></a><span class="sd">        A decorator that logs and saves P_new estimation results</span>
</span><span id="Laws.log_pnew_estimation-2316"><a href="#Laws.log_pnew_estimation-2316"><span class="linenos">2316</span></a><span class="sd">        to a PDF report.</span>
</span><span id="Laws.log_pnew_estimation-2317"><a href="#Laws.log_pnew_estimation-2317"><span class="linenos">2317</span></a>
</span><span id="Laws.log_pnew_estimation-2318"><a href="#Laws.log_pnew_estimation-2318"><span class="linenos">2318</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="Laws.log_pnew_estimation-2319"><a href="#Laws.log_pnew_estimation-2319"><span class="linenos">2319</span></a><span class="sd">        - rho_est (float): Estimated rho parameter.</span>
</span><span id="Laws.log_pnew_estimation-2320"><a href="#Laws.log_pnew_estimation-2320"><span class="linenos">2320</span></a><span class="sd">        - gamma_est (float): Estimated gamma parameter.</span>
</span><span id="Laws.log_pnew_estimation-2321"><a href="#Laws.log_pnew_estimation-2321"><span class="linenos">2321</span></a><span class="sd">        - DeltaS (np.ndarray): Change in S values for log-log regression.</span>
</span><span id="Laws.log_pnew_estimation-2322"><a href="#Laws.log_pnew_estimation-2322"><span class="linenos">2322</span></a><span class="sd">        - S_mid (np.ndarray): Midpoints of S values for log-log regression.</span>
</span><span id="Laws.log_pnew_estimation-2323"><a href="#Laws.log_pnew_estimation-2323"><span class="linenos">2323</span></a><span class="sd">        - intercept (float): Intercept of the fitted regression line.</span>
</span><span id="Laws.log_pnew_estimation-2324"><a href="#Laws.log_pnew_estimation-2324"><span class="linenos">2324</span></a><span class="sd">        - slope (float): Slope of the fitted regression line.</span>
</span><span id="Laws.log_pnew_estimation-2325"><a href="#Laws.log_pnew_estimation-2325"><span class="linenos">2325</span></a><span class="sd">        - nrows (int): Number of time steps for estimation.</span>
</span><span id="Laws.log_pnew_estimation-2326"><a href="#Laws.log_pnew_estimation-2326"><span class="linenos">2326</span></a><span class="sd">        - n_data (int): Number of data points.</span>
</span><span id="Laws.log_pnew_estimation-2327"><a href="#Laws.log_pnew_estimation-2327"><span class="linenos">2327</span></a>
</span><span id="Laws.log_pnew_estimation-2328"><a href="#Laws.log_pnew_estimation-2328"><span class="linenos">2328</span></a><span class="sd">        The results are logged in `self.stats_frame`</span>
</span><span id="Laws.log_pnew_estimation-2329"><a href="#Laws.log_pnew_estimation-2329"><span class="linenos">2329</span></a><span class="sd">        and visualized in a PDF.</span>
</span><span id="Laws.log_pnew_estimation-2330"><a href="#Laws.log_pnew_estimation-2330"><span class="linenos">2330</span></a>
</span><span id="Laws.log_pnew_estimation-2331"><a href="#Laws.log_pnew_estimation-2331"><span class="linenos">2331</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws.log_pnew_estimation-2332"><a href="#Laws.log_pnew_estimation-2332"><span class="linenos">2332</span></a><span class="sd">        -----------</span>
</span><span id="Laws.log_pnew_estimation-2333"><a href="#Laws.log_pnew_estimation-2333"><span class="linenos">2333</span></a><span class="sd">        func : function</span>
</span><span id="Laws.log_pnew_estimation-2334"><a href="#Laws.log_pnew_estimation-2334"><span class="linenos">2334</span></a><span class="sd">            The function performing P_new estimation.</span>
</span><span id="Laws.log_pnew_estimation-2335"><a href="#Laws.log_pnew_estimation-2335"><span class="linenos">2335</span></a>
</span><span id="Laws.log_pnew_estimation-2336"><a href="#Laws.log_pnew_estimation-2336"><span class="linenos">2336</span></a><span class="sd">        Returns:</span>
</span><span id="Laws.log_pnew_estimation-2337"><a href="#Laws.log_pnew_estimation-2337"><span class="linenos">2337</span></a><span class="sd">        --------</span>
</span><span id="Laws.log_pnew_estimation-2338"><a href="#Laws.log_pnew_estimation-2338"><span class="linenos">2338</span></a><span class="sd">        function</span>
</span><span id="Laws.log_pnew_estimation-2339"><a href="#Laws.log_pnew_estimation-2339"><span class="linenos">2339</span></a><span class="sd">            Wrapped function with additional logging and PDF output.</span>
</span><span id="Laws.log_pnew_estimation-2340"><a href="#Laws.log_pnew_estimation-2340"><span class="linenos">2340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws.log_pnew_estimation-2341"><a href="#Laws.log_pnew_estimation-2341"><span class="linenos">2341</span></a>
</span><span id="Laws.log_pnew_estimation-2342"><a href="#Laws.log_pnew_estimation-2342"><span class="linenos">2342</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.log_pnew_estimation-2343"><a href="#Laws.log_pnew_estimation-2343"><span class="linenos">2343</span></a>            <span class="n">rho_est</span><span class="p">,</span> <span class="n">gamma_est</span><span class="p">,</span> <span class="n">DeltaS</span><span class="p">,</span> <span class="n">S_mid</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span>
</span><span id="Laws.log_pnew_estimation-2344"><a href="#Laws.log_pnew_estimation-2344"><span class="linenos">2344</span></a>                <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Laws.log_pnew_estimation-2345"><a href="#Laws.log_pnew_estimation-2345"><span class="linenos">2345</span></a>            <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws.log_pnew_estimation-2346"><a href="#Laws.log_pnew_estimation-2346"><span class="linenos">2346</span></a>
</span><span id="Laws.log_pnew_estimation-2347"><a href="#Laws.log_pnew_estimation-2347"><span class="linenos">2347</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;rho&quot;</span><span class="p">:</span> <span class="n">rho_est</span><span class="p">})</span>
</span><span id="Laws.log_pnew_estimation-2348"><a href="#Laws.log_pnew_estimation-2348"><span class="linenos">2348</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">gamma_est</span><span class="p">})</span>
</span><span id="Laws.log_pnew_estimation-2349"><a href="#Laws.log_pnew_estimation-2349"><span class="linenos">2349</span></a>
</span><span id="Laws.log_pnew_estimation-2350"><a href="#Laws.log_pnew_estimation-2350"><span class="linenos">2350</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.log_pnew_estimation-2351"><a href="#Laws.log_pnew_estimation-2351"><span class="linenos">2351</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="s2">&quot;Pnew estimation&quot;</span><span class="p">)</span>
</span><span id="Laws.log_pnew_estimation-2352"><a href="#Laws.log_pnew_estimation-2352"><span class="linenos">2352</span></a>
</span><span id="Laws.log_pnew_estimation-2353"><a href="#Laws.log_pnew_estimation-2353"><span class="linenos">2353</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="Laws.log_pnew_estimation-2354"><a href="#Laws.log_pnew_estimation-2354"><span class="linenos">2354</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="Laws.log_pnew_estimation-2355"><a href="#Laws.log_pnew_estimation-2355"><span class="linenos">2355</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.log_pnew_estimation-2356"><a href="#Laws.log_pnew_estimation-2356"><span class="linenos">2356</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;gamma  = </span><span class="si">{</span><span class="n">gamma_est</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.log_pnew_estimation-2357"><a href="#Laws.log_pnew_estimation-2357"><span class="linenos">2357</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;rho  = </span><span class="si">{</span><span class="n">rho_est</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.log_pnew_estimation-2358"><a href="#Laws.log_pnew_estimation-2358"><span class="linenos">2358</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.log_pnew_estimation-2359"><a href="#Laws.log_pnew_estimation-2359"><span class="linenos">2359</span></a>            <span class="n">plot_obj1</span><span class="p">,</span> <span class="n">plot_obj2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_P_new</span><span class="p">(</span>
</span><span id="Laws.log_pnew_estimation-2360"><a href="#Laws.log_pnew_estimation-2360"><span class="linenos">2360</span></a>                <span class="n">rho_est</span><span class="p">,</span> <span class="n">gamma_est</span><span class="p">,</span> <span class="n">DeltaS</span><span class="p">,</span> <span class="n">S_mid</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span>
</span><span id="Laws.log_pnew_estimation-2361"><a href="#Laws.log_pnew_estimation-2361"><span class="linenos">2361</span></a>            <span class="p">)</span>
</span><span id="Laws.log_pnew_estimation-2362"><a href="#Laws.log_pnew_estimation-2362"><span class="linenos">2362</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.log_pnew_estimation-2363"><a href="#Laws.log_pnew_estimation-2363"><span class="linenos">2363</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj1</span><span class="p">,</span>
</span><span id="Laws.log_pnew_estimation-2364"><a href="#Laws.log_pnew_estimation-2364"><span class="linenos">2364</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.log_pnew_estimation-2365"><a href="#Laws.log_pnew_estimation-2365"><span class="linenos">2365</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws.log_pnew_estimation-2366"><a href="#Laws.log_pnew_estimation-2366"><span class="linenos">2366</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Laws.log_pnew_estimation-2367"><a href="#Laws.log_pnew_estimation-2367"><span class="linenos">2367</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.log_pnew_estimation-2368"><a href="#Laws.log_pnew_estimation-2368"><span class="linenos">2368</span></a>            <span class="p">)</span>
</span><span id="Laws.log_pnew_estimation-2369"><a href="#Laws.log_pnew_estimation-2369"><span class="linenos">2369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.log_pnew_estimation-2370"><a href="#Laws.log_pnew_estimation-2370"><span class="linenos">2370</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj2</span><span class="p">,</span>
</span><span id="Laws.log_pnew_estimation-2371"><a href="#Laws.log_pnew_estimation-2371"><span class="linenos">2371</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.log_pnew_estimation-2372"><a href="#Laws.log_pnew_estimation-2372"><span class="linenos">2372</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws.log_pnew_estimation-2373"><a href="#Laws.log_pnew_estimation-2373"><span class="linenos">2373</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span>
</span><span id="Laws.log_pnew_estimation-2374"><a href="#Laws.log_pnew_estimation-2374"><span class="linenos">2374</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.log_pnew_estimation-2375"><a href="#Laws.log_pnew_estimation-2375"><span class="linenos">2375</span></a>            <span class="p">)</span>
</span><span id="Laws.log_pnew_estimation-2376"><a href="#Laws.log_pnew_estimation-2376"><span class="linenos">2376</span></a>
</span><span id="Laws.log_pnew_estimation-2377"><a href="#Laws.log_pnew_estimation-2377"><span class="linenos">2377</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span></pre></div>


            <div class="docstring"><p>A decorator that logs and saves P_new estimation results
to a PDF report.</p>

<p>The decorated function is expected to return:</p>

<ul>
<li>rho_est (float): Estimated rho parameter.</li>
<li>gamma_est (float): Estimated gamma parameter.</li>
<li>DeltaS (np.ndarray): Change in S values for log-log regression.</li>
<li>S_mid (np.ndarray): Midpoints of S values for log-log regression.</li>
<li>intercept (float): Intercept of the fitted regression line.</li>
<li>slope (float): Slope of the fitted regression line.</li>
<li>nrows (int): Number of time steps for estimation.</li>
<li>n_data (int): Number of data points.</li>
</ul>

<p>The results are logged in <code>self.stats_frame</code>
and visualized in a PDF.</p>

<h2 id="parameters">Parameters:</h2>

<p>func : function
    The function performing P_new estimation.</p>

<h2 id="returns">Returns:</h2>

<p>function
    Wrapped function with additional logging and PDF output.</p>
</div>


                            </div>
                            <div id="Laws.log_msd_split" class="classattr">
                                        <input id="Laws.log_msd_split-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">log_msd_split</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">func</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.log_msd_split-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.log_msd_split"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.log_msd_split-2380"><a href="#Laws.log_msd_split-2380"><span class="linenos">2380</span></a>    <span class="k">def</span> <span class="nf">log_msd_split</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Laws.log_msd_split-2381"><a href="#Laws.log_msd_split-2381"><span class="linenos">2381</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws.log_msd_split-2382"><a href="#Laws.log_msd_split-2382"><span class="linenos">2382</span></a><span class="sd">        A decorator that logs and saves MSD split results</span>
</span><span id="Laws.log_msd_split-2383"><a href="#Laws.log_msd_split-2383"><span class="linenos">2383</span></a><span class="sd">        to a PDF report.</span>
</span><span id="Laws.log_msd_split-2384"><a href="#Laws.log_msd_split-2384"><span class="linenos">2384</span></a>
</span><span id="Laws.log_msd_split-2385"><a href="#Laws.log_msd_split-2385"><span class="linenos">2385</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="Laws.log_msd_split-2386"><a href="#Laws.log_msd_split-2386"><span class="linenos">2386</span></a><span class="sd">        - msd_results (pd.DataFrame): MSD split results</span>
</span><span id="Laws.log_msd_split-2387"><a href="#Laws.log_msd_split-2387"><span class="linenos">2387</span></a><span class="sd">            including range and curve parameters.</span>
</span><span id="Laws.log_msd_split-2388"><a href="#Laws.log_msd_split-2388"><span class="linenos">2388</span></a><span class="sd">        - plot_obj (BytesIO): The plot image object.</span>
</span><span id="Laws.log_msd_split-2389"><a href="#Laws.log_msd_split-2389"><span class="linenos">2389</span></a>
</span><span id="Laws.log_msd_split-2390"><a href="#Laws.log_msd_split-2390"><span class="linenos">2390</span></a><span class="sd">        The results are stored in `self.stats_frame`</span>
</span><span id="Laws.log_msd_split-2391"><a href="#Laws.log_msd_split-2391"><span class="linenos">2391</span></a><span class="sd">        and included in a PDF report.</span>
</span><span id="Laws.log_msd_split-2392"><a href="#Laws.log_msd_split-2392"><span class="linenos">2392</span></a>
</span><span id="Laws.log_msd_split-2393"><a href="#Laws.log_msd_split-2393"><span class="linenos">2393</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws.log_msd_split-2394"><a href="#Laws.log_msd_split-2394"><span class="linenos">2394</span></a><span class="sd">        -----------</span>
</span><span id="Laws.log_msd_split-2395"><a href="#Laws.log_msd_split-2395"><span class="linenos">2395</span></a><span class="sd">        func : function</span>
</span><span id="Laws.log_msd_split-2396"><a href="#Laws.log_msd_split-2396"><span class="linenos">2396</span></a><span class="sd">            The function performing MSD split analysis.</span>
</span><span id="Laws.log_msd_split-2397"><a href="#Laws.log_msd_split-2397"><span class="linenos">2397</span></a>
</span><span id="Laws.log_msd_split-2398"><a href="#Laws.log_msd_split-2398"><span class="linenos">2398</span></a><span class="sd">        Returns:</span>
</span><span id="Laws.log_msd_split-2399"><a href="#Laws.log_msd_split-2399"><span class="linenos">2399</span></a><span class="sd">        --------</span>
</span><span id="Laws.log_msd_split-2400"><a href="#Laws.log_msd_split-2400"><span class="linenos">2400</span></a><span class="sd">        function</span>
</span><span id="Laws.log_msd_split-2401"><a href="#Laws.log_msd_split-2401"><span class="linenos">2401</span></a><span class="sd">            Wrapped function with additional logging and PDF output.</span>
</span><span id="Laws.log_msd_split-2402"><a href="#Laws.log_msd_split-2402"><span class="linenos">2402</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws.log_msd_split-2403"><a href="#Laws.log_msd_split-2403"><span class="linenos">2403</span></a>
</span><span id="Laws.log_msd_split-2404"><a href="#Laws.log_msd_split-2404"><span class="linenos">2404</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.log_msd_split-2405"><a href="#Laws.log_msd_split-2405"><span class="linenos">2405</span></a>            <span class="n">msd_results</span><span class="p">,</span> <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws.log_msd_split-2406"><a href="#Laws.log_msd_split-2406"><span class="linenos">2406</span></a>            <span class="n">msd_curve</span> <span class="o">=</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws.log_msd_split-2407"><a href="#Laws.log_msd_split-2407"><span class="linenos">2407</span></a>                <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;RoG range [km]&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span>
</span><span id="Laws.log_msd_split-2408"><a href="#Laws.log_msd_split-2408"><span class="linenos">2408</span></a>            <span class="p">)</span>
</span><span id="Laws.log_msd_split-2409"><a href="#Laws.log_msd_split-2409"><span class="linenos">2409</span></a>            <span class="n">msd_curve_params</span> <span class="o">=</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws.log_msd_split-2410"><a href="#Laws.log_msd_split-2410"><span class="linenos">2410</span></a>                <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;RoG range [km]&quot;</span><span class="p">]</span>
</span><span id="Laws.log_msd_split-2411"><a href="#Laws.log_msd_split-2411"><span class="linenos">2411</span></a>                <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
</span><span id="Laws.log_msd_split-2412"><a href="#Laws.log_msd_split-2412"><span class="linenos">2412</span></a>                <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span>
</span><span id="Laws.log_msd_split-2413"><a href="#Laws.log_msd_split-2413"><span class="linenos">2413</span></a>                <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</span><span id="Laws.log_msd_split-2414"><a href="#Laws.log_msd_split-2414"><span class="linenos">2414</span></a>                <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
</span><span id="Laws.log_msd_split-2415"><a href="#Laws.log_msd_split-2415"><span class="linenos">2415</span></a>                <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="Laws.log_msd_split-2416"><a href="#Laws.log_msd_split-2416"><span class="linenos">2416</span></a>                <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
</span><span id="Laws.log_msd_split-2417"><a href="#Laws.log_msd_split-2417"><span class="linenos">2417</span></a>                <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="Laws.log_msd_split-2418"><a href="#Laws.log_msd_split-2418"><span class="linenos">2418</span></a>            <span class="p">)</span>
</span><span id="Laws.log_msd_split-2419"><a href="#Laws.log_msd_split-2419"><span class="linenos">2419</span></a>
</span><span id="Laws.log_msd_split-2420"><a href="#Laws.log_msd_split-2420"><span class="linenos">2420</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;msd_curve&quot;</span><span class="p">:</span> <span class="n">msd_curve</span><span class="p">})</span>
</span><span id="Laws.log_msd_split-2421"><a href="#Laws.log_msd_split-2421"><span class="linenos">2421</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;msd_curve_params&quot;</span><span class="p">:</span> <span class="n">msd_curve_params</span><span class="p">})</span>
</span><span id="Laws.log_msd_split-2422"><a href="#Laws.log_msd_split-2422"><span class="linenos">2422</span></a>
</span><span id="Laws.log_msd_split-2423"><a href="#Laws.log_msd_split-2423"><span class="linenos">2423</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.log_msd_split-2424"><a href="#Laws.log_msd_split-2424"><span class="linenos">2424</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="s2">&quot;MSD split&quot;</span><span class="p">)</span>
</span><span id="Laws.log_msd_split-2425"><a href="#Laws.log_msd_split-2425"><span class="linenos">2425</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.log_msd_split-2426"><a href="#Laws.log_msd_split-2426"><span class="linenos">2426</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="Laws.log_msd_split-2427"><a href="#Laws.log_msd_split-2427"><span class="linenos">2427</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_msd_split_table</span><span class="p">(</span><span class="n">msd_results</span><span class="p">)</span>
</span><span id="Laws.log_msd_split-2428"><a href="#Laws.log_msd_split-2428"><span class="linenos">2428</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.log_msd_split-2429"><a href="#Laws.log_msd_split-2429"><span class="linenos">2429</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj</span><span class="p">,</span>
</span><span id="Laws.log_msd_split-2430"><a href="#Laws.log_msd_split-2430"><span class="linenos">2430</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.log_msd_split-2431"><a href="#Laws.log_msd_split-2431"><span class="linenos">2431</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws.log_msd_split-2432"><a href="#Laws.log_msd_split-2432"><span class="linenos">2432</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span>
</span><span id="Laws.log_msd_split-2433"><a href="#Laws.log_msd_split-2433"><span class="linenos">2433</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.log_msd_split-2434"><a href="#Laws.log_msd_split-2434"><span class="linenos">2434</span></a>            <span class="p">)</span>
</span><span id="Laws.log_msd_split-2435"><a href="#Laws.log_msd_split-2435"><span class="linenos">2435</span></a>
</span><span id="Laws.log_msd_split-2436"><a href="#Laws.log_msd_split-2436"><span class="linenos">2436</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span></pre></div>


            <div class="docstring"><p>A decorator that logs and saves MSD split results
to a PDF report.</p>

<p>The decorated function is expected to return:</p>

<ul>
<li>msd_results (pd.DataFrame): MSD split results
including range and curve parameters.</li>
<li>plot_obj (BytesIO): The plot image object.</li>
</ul>

<p>The results are stored in <code>self.stats_frame</code>
and included in a PDF report.</p>

<h2 id="parameters">Parameters:</h2>

<p>func : function
    The function performing MSD split analysis.</p>

<h2 id="returns">Returns:</h2>

<p>function
    Wrapped function with additional logging and PDF output.</p>
</div>


                            </div>
                            <div id="Laws.check_curve_fit" class="classattr">
                                        <input id="Laws.check_curve_fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_curve_fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">func</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.check_curve_fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.check_curve_fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.check_curve_fit-2439"><a href="#Laws.check_curve_fit-2439"><span class="linenos">2439</span></a>    <span class="k">def</span> <span class="nf">check_curve_fit</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Laws.check_curve_fit-2440"><a href="#Laws.check_curve_fit-2440"><span class="linenos">2440</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws.check_curve_fit-2441"><a href="#Laws.check_curve_fit-2441"><span class="linenos">2441</span></a><span class="sd">        A decorator that evaluates curve fitting results</span>
</span><span id="Laws.check_curve_fit-2442"><a href="#Laws.check_curve_fit-2442"><span class="linenos">2442</span></a><span class="sd">        and generates a corresponding plot.</span>
</span><span id="Laws.check_curve_fit-2443"><a href="#Laws.check_curve_fit-2443"><span class="linenos">2443</span></a>
</span><span id="Laws.check_curve_fit-2444"><a href="#Laws.check_curve_fit-2444"><span class="linenos">2444</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="Laws.check_curve_fit-2445"><a href="#Laws.check_curve_fit-2445"><span class="linenos">2445</span></a><span class="sd">        - best_fit (str): Name of the best-fitting curve.</span>
</span><span id="Laws.check_curve_fit-2446"><a href="#Laws.check_curve_fit-2446"><span class="linenos">2446</span></a><span class="sd">        - param_frame (pd.DataFrame): DataFrame containing</span>
</span><span id="Laws.check_curve_fit-2447"><a href="#Laws.check_curve_fit-2447"><span class="linenos">2447</span></a><span class="sd">            curve parameters.</span>
</span><span id="Laws.check_curve_fit-2448"><a href="#Laws.check_curve_fit-2448"><span class="linenos">2448</span></a><span class="sd">        - y_pred (np.ndarray): Predicted values based on</span>
</span><span id="Laws.check_curve_fit-2449"><a href="#Laws.check_curve_fit-2449"><span class="linenos">2449</span></a><span class="sd">            the curve fitting.</span>
</span><span id="Laws.check_curve_fit-2450"><a href="#Laws.check_curve_fit-2450"><span class="linenos">2450</span></a><span class="sd">        - exp_y_pred (np.ndarray or None): Exponential</span>
</span><span id="Laws.check_curve_fit-2451"><a href="#Laws.check_curve_fit-2451"><span class="linenos">2451</span></a><span class="sd">            curve prediction (if applicable).</span>
</span><span id="Laws.check_curve_fit-2452"><a href="#Laws.check_curve_fit-2452"><span class="linenos">2452</span></a><span class="sd">        - plot_data (pd.Series or np.ndarray): Data used for fitting.</span>
</span><span id="Laws.check_curve_fit-2453"><a href="#Laws.check_curve_fit-2453"><span class="linenos">2453</span></a><span class="sd">        - labels (list): Axis labels for the plot.</span>
</span><span id="Laws.check_curve_fit-2454"><a href="#Laws.check_curve_fit-2454"><span class="linenos">2454</span></a>
</span><span id="Laws.check_curve_fit-2455"><a href="#Laws.check_curve_fit-2455"><span class="linenos">2455</span></a><span class="sd">        If `best_fit` is not among {&quot;linear&quot;, &quot;expon&quot;, &quot;expon_neg&quot;},</span>
</span><span id="Laws.check_curve_fit-2456"><a href="#Laws.check_curve_fit-2456"><span class="linenos">2456</span></a><span class="sd">        both the fitted curve and an additional exponential curve</span>
</span><span id="Laws.check_curve_fit-2457"><a href="#Laws.check_curve_fit-2457"><span class="linenos">2457</span></a><span class="sd">        are plotted. Otherwise, only the fitted curve is plotted.</span>
</span><span id="Laws.check_curve_fit-2458"><a href="#Laws.check_curve_fit-2458"><span class="linenos">2458</span></a>
</span><span id="Laws.check_curve_fit-2459"><a href="#Laws.check_curve_fit-2459"><span class="linenos">2459</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws.check_curve_fit-2460"><a href="#Laws.check_curve_fit-2460"><span class="linenos">2460</span></a><span class="sd">        -----------</span>
</span><span id="Laws.check_curve_fit-2461"><a href="#Laws.check_curve_fit-2461"><span class="linenos">2461</span></a><span class="sd">        func : function</span>
</span><span id="Laws.check_curve_fit-2462"><a href="#Laws.check_curve_fit-2462"><span class="linenos">2462</span></a><span class="sd">            The function performing curve fitting.</span>
</span><span id="Laws.check_curve_fit-2463"><a href="#Laws.check_curve_fit-2463"><span class="linenos">2463</span></a>
</span><span id="Laws.check_curve_fit-2464"><a href="#Laws.check_curve_fit-2464"><span class="linenos">2464</span></a><span class="sd">        Returns:</span>
</span><span id="Laws.check_curve_fit-2465"><a href="#Laws.check_curve_fit-2465"><span class="linenos">2465</span></a><span class="sd">        --------</span>
</span><span id="Laws.check_curve_fit-2466"><a href="#Laws.check_curve_fit-2466"><span class="linenos">2466</span></a><span class="sd">        function</span>
</span><span id="Laws.check_curve_fit-2467"><a href="#Laws.check_curve_fit-2467"><span class="linenos">2467</span></a><span class="sd">            Wrapped function that returns:</span>
</span><span id="Laws.check_curve_fit-2468"><a href="#Laws.check_curve_fit-2468"><span class="linenos">2468</span></a><span class="sd">            - func.__name__ (str): Name of the function.</span>
</span><span id="Laws.check_curve_fit-2469"><a href="#Laws.check_curve_fit-2469"><span class="linenos">2469</span></a><span class="sd">            - best_fit (str): Best fitting curve name.</span>
</span><span id="Laws.check_curve_fit-2470"><a href="#Laws.check_curve_fit-2470"><span class="linenos">2470</span></a><span class="sd">            - param_frame (pd.DataFrame): Parameters of</span>
</span><span id="Laws.check_curve_fit-2471"><a href="#Laws.check_curve_fit-2471"><span class="linenos">2471</span></a><span class="sd">                the best fit.</span>
</span><span id="Laws.check_curve_fit-2472"><a href="#Laws.check_curve_fit-2472"><span class="linenos">2472</span></a><span class="sd">            - plot_obj (BytesIO): Image object containing</span>
</span><span id="Laws.check_curve_fit-2473"><a href="#Laws.check_curve_fit-2473"><span class="linenos">2473</span></a><span class="sd">                the generated plot.</span>
</span><span id="Laws.check_curve_fit-2474"><a href="#Laws.check_curve_fit-2474"><span class="linenos">2474</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws.check_curve_fit-2475"><a href="#Laws.check_curve_fit-2475"><span class="linenos">2475</span></a>
</span><span id="Laws.check_curve_fit-2476"><a href="#Laws.check_curve_fit-2476"><span class="linenos">2476</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.check_curve_fit-2477"><a href="#Laws.check_curve_fit-2477"><span class="linenos">2477</span></a>            <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">exp_y_pred</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span>
</span><span id="Laws.check_curve_fit-2478"><a href="#Laws.check_curve_fit-2478"><span class="linenos">2478</span></a>                <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Laws.check_curve_fit-2479"><a href="#Laws.check_curve_fit-2479"><span class="linenos">2479</span></a>            <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws.check_curve_fit-2480"><a href="#Laws.check_curve_fit-2480"><span class="linenos">2480</span></a>            <span class="k">if</span> <span class="n">best_fit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="s2">&quot;expon&quot;</span><span class="p">,</span> <span class="s2">&quot;expon_neg&quot;</span><span class="p">}:</span>
</span><span id="Laws.check_curve_fit-2481"><a href="#Laws.check_curve_fit-2481"><span class="linenos">2481</span></a>                <span class="n">plot_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_curve</span><span class="p">(</span>
</span><span id="Laws.check_curve_fit-2482"><a href="#Laws.check_curve_fit-2482"><span class="linenos">2482</span></a>                    <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">exp_y_pred</span>
</span><span id="Laws.check_curve_fit-2483"><a href="#Laws.check_curve_fit-2483"><span class="linenos">2483</span></a>                <span class="p">)</span>
</span><span id="Laws.check_curve_fit-2484"><a href="#Laws.check_curve_fit-2484"><span class="linenos">2484</span></a>                <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">plot_obj</span>
</span><span id="Laws.check_curve_fit-2485"><a href="#Laws.check_curve_fit-2485"><span class="linenos">2485</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Laws.check_curve_fit-2486"><a href="#Laws.check_curve_fit-2486"><span class="linenos">2486</span></a>                <span class="n">plot_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_curve</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</span><span id="Laws.check_curve_fit-2487"><a href="#Laws.check_curve_fit-2487"><span class="linenos">2487</span></a>                <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">plot_obj</span>
</span><span id="Laws.check_curve_fit-2488"><a href="#Laws.check_curve_fit-2488"><span class="linenos">2488</span></a>
</span><span id="Laws.check_curve_fit-2489"><a href="#Laws.check_curve_fit-2489"><span class="linenos">2489</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span></pre></div>


            <div class="docstring"><p>A decorator that evaluates curve fitting results
and generates a corresponding plot.</p>

<p>The decorated function is expected to return:</p>

<ul>
<li>best_fit (str): Name of the best-fitting curve.</li>
<li>param_frame (pd.DataFrame): DataFrame containing
curve parameters.</li>
<li>y_pred (np.ndarray): Predicted values based on
the curve fitting.</li>
<li>exp_y_pred (np.ndarray or None): Exponential
curve prediction (if applicable).</li>
<li>plot_data (pd.Series or np.ndarray): Data used for fitting.</li>
<li>labels (list): Axis labels for the plot.</li>
</ul>

<p>If <code>best_fit</code> is not among {"linear", "expon", "expon_neg"},
both the fitted curve and an additional exponential curve
are plotted. Otherwise, only the fitted curve is plotted.</p>

<h2 id="parameters">Parameters:</h2>

<p>func : function
    The function performing curve fitting.</p>

<h2 id="returns">Returns:</h2>

<p>function
    Wrapped function that returns:
    - func.__name__ (str): Name of the function.
    - best_fit (str): Best fitting curve name.
    - param_frame (pd.DataFrame): Parameters of
        the best fit.
    - plot_obj (BytesIO): Image object containing
        the generated plot.</p>
</div>


                            </div>
                            <div id="Laws.check_distribution_fit" class="classattr">
                                        <input id="Laws.check_distribution_fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_distribution_fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">func</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.check_distribution_fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.check_distribution_fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.check_distribution_fit-2492"><a href="#Laws.check_distribution_fit-2492"><span class="linenos">2492</span></a>    <span class="k">def</span> <span class="nf">check_distribution_fit</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Laws.check_distribution_fit-2493"><a href="#Laws.check_distribution_fit-2493"><span class="linenos">2493</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Laws.check_distribution_fit-2494"><a href="#Laws.check_distribution_fit-2494"><span class="linenos">2494</span></a><span class="sd">        A decorator that evaluates the results of distribution</span>
</span><span id="Laws.check_distribution_fit-2495"><a href="#Laws.check_distribution_fit-2495"><span class="linenos">2495</span></a><span class="sd">        fitting and detects flexation points.</span>
</span><span id="Laws.check_distribution_fit-2496"><a href="#Laws.check_distribution_fit-2496"><span class="linenos">2496</span></a>
</span><span id="Laws.check_distribution_fit-2497"><a href="#Laws.check_distribution_fit-2497"><span class="linenos">2497</span></a><span class="sd">        The decorated function is expected to return:</span>
</span><span id="Laws.check_distribution_fit-2498"><a href="#Laws.check_distribution_fit-2498"><span class="linenos">2498</span></a><span class="sd">        - model (distfit object): The best-fitted distribution</span>
</span><span id="Laws.check_distribution_fit-2499"><a href="#Laws.check_distribution_fit-2499"><span class="linenos">2499</span></a><span class="sd">            model.</span>
</span><span id="Laws.check_distribution_fit-2500"><a href="#Laws.check_distribution_fit-2500"><span class="linenos">2500</span></a><span class="sd">        - data (pd.Series or np.ndarray): Data used for</span>
</span><span id="Laws.check_distribution_fit-2501"><a href="#Laws.check_distribution_fit-2501"><span class="linenos">2501</span></a><span class="sd">            distribution fitting.</span>
</span><span id="Laws.check_distribution_fit-2502"><a href="#Laws.check_distribution_fit-2502"><span class="linenos">2502</span></a>
</span><span id="Laws.check_distribution_fit-2503"><a href="#Laws.check_distribution_fit-2503"><span class="linenos">2503</span></a><span class="sd">        The function generates:</span>
</span><span id="Laws.check_distribution_fit-2504"><a href="#Laws.check_distribution_fit-2504"><span class="linenos">2504</span></a><span class="sd">        - A histogram plot of the fitted distribution.</span>
</span><span id="Laws.check_distribution_fit-2505"><a href="#Laws.check_distribution_fit-2505"><span class="linenos">2505</span></a><span class="sd">        - A model plot displaying the probability density function (PDF).</span>
</span><span id="Laws.check_distribution_fit-2506"><a href="#Laws.check_distribution_fit-2506"><span class="linenos">2506</span></a>
</span><span id="Laws.check_distribution_fit-2507"><a href="#Laws.check_distribution_fit-2507"><span class="linenos">2507</span></a><span class="sd">        If the fitted distribution is not in `const.DISTRIBUTIONS`</span>
</span><span id="Laws.check_distribution_fit-2508"><a href="#Laws.check_distribution_fit-2508"><span class="linenos">2508</span></a><span class="sd">        and the data has at least 4 observations, or if specific conditions</span>
</span><span id="Laws.check_distribution_fit-2509"><a href="#Laws.check_distribution_fit-2509"><span class="linenos">2509</span></a><span class="sd">        apply (e.g., Pareto or Lognormal with parameter &gt; 2),</span>
</span><span id="Laws.check_distribution_fit-2510"><a href="#Laws.check_distribution_fit-2510"><span class="linenos">2510</span></a><span class="sd">        an attempt is made to detect flexation points in the distribution.</span>
</span><span id="Laws.check_distribution_fit-2511"><a href="#Laws.check_distribution_fit-2511"><span class="linenos">2511</span></a>
</span><span id="Laws.check_distribution_fit-2512"><a href="#Laws.check_distribution_fit-2512"><span class="linenos">2512</span></a><span class="sd">        Parameters:</span>
</span><span id="Laws.check_distribution_fit-2513"><a href="#Laws.check_distribution_fit-2513"><span class="linenos">2513</span></a><span class="sd">        -----------</span>
</span><span id="Laws.check_distribution_fit-2514"><a href="#Laws.check_distribution_fit-2514"><span class="linenos">2514</span></a><span class="sd">        func : function</span>
</span><span id="Laws.check_distribution_fit-2515"><a href="#Laws.check_distribution_fit-2515"><span class="linenos">2515</span></a><span class="sd">            The function performing distribution fitting.</span>
</span><span id="Laws.check_distribution_fit-2516"><a href="#Laws.check_distribution_fit-2516"><span class="linenos">2516</span></a>
</span><span id="Laws.check_distribution_fit-2517"><a href="#Laws.check_distribution_fit-2517"><span class="linenos">2517</span></a><span class="sd">        Returns:</span>
</span><span id="Laws.check_distribution_fit-2518"><a href="#Laws.check_distribution_fit-2518"><span class="linenos">2518</span></a><span class="sd">        --------</span>
</span><span id="Laws.check_distribution_fit-2519"><a href="#Laws.check_distribution_fit-2519"><span class="linenos">2519</span></a><span class="sd">        function</span>
</span><span id="Laws.check_distribution_fit-2520"><a href="#Laws.check_distribution_fit-2520"><span class="linenos">2520</span></a><span class="sd">            Wrapped function that returns:</span>
</span><span id="Laws.check_distribution_fit-2521"><a href="#Laws.check_distribution_fit-2521"><span class="linenos">2521</span></a><span class="sd">            - func.__name__ (str): Name of the function.</span>
</span><span id="Laws.check_distribution_fit-2522"><a href="#Laws.check_distribution_fit-2522"><span class="linenos">2522</span></a><span class="sd">            - model (distfit object): Best-fitting distribution model.</span>
</span><span id="Laws.check_distribution_fit-2523"><a href="#Laws.check_distribution_fit-2523"><span class="linenos">2523</span></a><span class="sd">            - plot_distribution_obj (BytesIO): Image object containing</span>
</span><span id="Laws.check_distribution_fit-2524"><a href="#Laws.check_distribution_fit-2524"><span class="linenos">2524</span></a><span class="sd">                the histogram plot.</span>
</span><span id="Laws.check_distribution_fit-2525"><a href="#Laws.check_distribution_fit-2525"><span class="linenos">2525</span></a><span class="sd">            - plot_model_obj (BytesIO): Image object containing the PDF plot.</span>
</span><span id="Laws.check_distribution_fit-2526"><a href="#Laws.check_distribution_fit-2526"><span class="linenos">2526</span></a><span class="sd">            - flexation_point_detection_results (tuple, optional):</span>
</span><span id="Laws.check_distribution_fit-2527"><a href="#Laws.check_distribution_fit-2527"><span class="linenos">2527</span></a><span class="sd">            If flexation points are found, returns details of left</span>
</span><span id="Laws.check_distribution_fit-2528"><a href="#Laws.check_distribution_fit-2528"><span class="linenos">2528</span></a><span class="sd">            and right distributions.</span>
</span><span id="Laws.check_distribution_fit-2529"><a href="#Laws.check_distribution_fit-2529"><span class="linenos">2529</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Laws.check_distribution_fit-2530"><a href="#Laws.check_distribution_fit-2530"><span class="linenos">2530</span></a>
</span><span id="Laws.check_distribution_fit-2531"><a href="#Laws.check_distribution_fit-2531"><span class="linenos">2531</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.check_distribution_fit-2532"><a href="#Laws.check_distribution_fit-2532"><span class="linenos">2532</span></a>            <span class="n">model</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.check_distribution_fit-2533"><a href="#Laws.check_distribution_fit-2533"><span class="linenos">2533</span></a>
</span><span id="Laws.check_distribution_fit-2534"><a href="#Laws.check_distribution_fit-2534"><span class="linenos">2534</span></a>            <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_distribution</span><span class="p">(</span>
</span><span id="Laws.check_distribution_fit-2535"><a href="#Laws.check_distribution_fit-2535"><span class="linenos">2535</span></a>                <span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="Laws.check_distribution_fit-2536"><a href="#Laws.check_distribution_fit-2536"><span class="linenos">2536</span></a>            <span class="p">)</span>
</span><span id="Laws.check_distribution_fit-2537"><a href="#Laws.check_distribution_fit-2537"><span class="linenos">2537</span></a>            <span class="k">if</span> <span class="p">(</span>
</span><span id="Laws.check_distribution_fit-2538"><a href="#Laws.check_distribution_fit-2538"><span class="linenos">2538</span></a>                <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">const</span><span class="o">.</span><span class="n">DISTRIBUTIONS</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">4</span>
</span><span id="Laws.check_distribution_fit-2539"><a href="#Laws.check_distribution_fit-2539"><span class="linenos">2539</span></a>            <span class="p">):</span>  <span class="c1"># FIXME:</span>
</span><span id="Laws.check_distribution_fit-2540"><a href="#Laws.check_distribution_fit-2540"><span class="linenos">2540</span></a>                <span class="n">flexation_point_detection_results</span> <span class="o">=</span> <span class="n">Flexation</span><span class="p">()</span><span class="o">.</span><span class="n">find_distributions</span><span class="p">(</span>
</span><span id="Laws.check_distribution_fit-2541"><a href="#Laws.check_distribution_fit-2541"><span class="linenos">2541</span></a>                    <span class="n">model</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws.check_distribution_fit-2542"><a href="#Laws.check_distribution_fit-2542"><span class="linenos">2542</span></a>                <span class="p">)</span>
</span><span id="Laws.check_distribution_fit-2543"><a href="#Laws.check_distribution_fit-2543"><span class="linenos">2543</span></a>                <span class="k">if</span> <span class="n">flexation_point_detection_results</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Laws.check_distribution_fit-2544"><a href="#Laws.check_distribution_fit-2544"><span class="linenos">2544</span></a>
</span><span id="Laws.check_distribution_fit-2545"><a href="#Laws.check_distribution_fit-2545"><span class="linenos">2545</span></a>                    <span class="k">return</span> <span class="p">(</span>
</span><span id="Laws.check_distribution_fit-2546"><a href="#Laws.check_distribution_fit-2546"><span class="linenos">2546</span></a>                        <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2547"><a href="#Laws.check_distribution_fit-2547"><span class="linenos">2547</span></a>                        <span class="n">model</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2548"><a href="#Laws.check_distribution_fit-2548"><span class="linenos">2548</span></a>                        <span class="n">plot_distribution_obj</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2549"><a href="#Laws.check_distribution_fit-2549"><span class="linenos">2549</span></a>                        <span class="n">plot_model_obj</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2550"><a href="#Laws.check_distribution_fit-2550"><span class="linenos">2550</span></a>                        <span class="n">flexation_point_detection_results</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2551"><a href="#Laws.check_distribution_fit-2551"><span class="linenos">2551</span></a>                    <span class="p">)</span>
</span><span id="Laws.check_distribution_fit-2552"><a href="#Laws.check_distribution_fit-2552"><span class="linenos">2552</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Laws.check_distribution_fit-2553"><a href="#Laws.check_distribution_fit-2553"><span class="linenos">2553</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span>
</span><span id="Laws.check_distribution_fit-2554"><a href="#Laws.check_distribution_fit-2554"><span class="linenos">2554</span></a>            <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;pareto&quot;</span> <span class="ow">and</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Laws.check_distribution_fit-2555"><a href="#Laws.check_distribution_fit-2555"><span class="linenos">2555</span></a>                <span class="n">flexation_point_detection_results</span> <span class="o">=</span> <span class="n">Flexation</span><span class="p">()</span><span class="o">.</span><span class="n">find_distributions</span><span class="p">(</span>
</span><span id="Laws.check_distribution_fit-2556"><a href="#Laws.check_distribution_fit-2556"><span class="linenos">2556</span></a>                    <span class="n">model</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws.check_distribution_fit-2557"><a href="#Laws.check_distribution_fit-2557"><span class="linenos">2557</span></a>                <span class="p">)</span>
</span><span id="Laws.check_distribution_fit-2558"><a href="#Laws.check_distribution_fit-2558"><span class="linenos">2558</span></a>                <span class="k">if</span> <span class="n">flexation_point_detection_results</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Laws.check_distribution_fit-2559"><a href="#Laws.check_distribution_fit-2559"><span class="linenos">2559</span></a>
</span><span id="Laws.check_distribution_fit-2560"><a href="#Laws.check_distribution_fit-2560"><span class="linenos">2560</span></a>                    <span class="k">return</span> <span class="p">(</span>
</span><span id="Laws.check_distribution_fit-2561"><a href="#Laws.check_distribution_fit-2561"><span class="linenos">2561</span></a>                        <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2562"><a href="#Laws.check_distribution_fit-2562"><span class="linenos">2562</span></a>                        <span class="n">model</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2563"><a href="#Laws.check_distribution_fit-2563"><span class="linenos">2563</span></a>                        <span class="n">plot_distribution_obj</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2564"><a href="#Laws.check_distribution_fit-2564"><span class="linenos">2564</span></a>                        <span class="n">plot_model_obj</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2565"><a href="#Laws.check_distribution_fit-2565"><span class="linenos">2565</span></a>                        <span class="n">flexation_point_detection_results</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2566"><a href="#Laws.check_distribution_fit-2566"><span class="linenos">2566</span></a>                    <span class="p">)</span>
</span><span id="Laws.check_distribution_fit-2567"><a href="#Laws.check_distribution_fit-2567"><span class="linenos">2567</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Laws.check_distribution_fit-2568"><a href="#Laws.check_distribution_fit-2568"><span class="linenos">2568</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span>
</span><span id="Laws.check_distribution_fit-2569"><a href="#Laws.check_distribution_fit-2569"><span class="linenos">2569</span></a>            <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;lognorm&quot;</span> <span class="ow">and</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Laws.check_distribution_fit-2570"><a href="#Laws.check_distribution_fit-2570"><span class="linenos">2570</span></a>                <span class="n">flexation_point_detection_results</span> <span class="o">=</span> <span class="n">Flexation</span><span class="p">()</span><span class="o">.</span><span class="n">find_distributions</span><span class="p">(</span>
</span><span id="Laws.check_distribution_fit-2571"><a href="#Laws.check_distribution_fit-2571"><span class="linenos">2571</span></a>                    <span class="n">model</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="Laws.check_distribution_fit-2572"><a href="#Laws.check_distribution_fit-2572"><span class="linenos">2572</span></a>                <span class="p">)</span>
</span><span id="Laws.check_distribution_fit-2573"><a href="#Laws.check_distribution_fit-2573"><span class="linenos">2573</span></a>                <span class="k">if</span> <span class="n">flexation_point_detection_results</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Laws.check_distribution_fit-2574"><a href="#Laws.check_distribution_fit-2574"><span class="linenos">2574</span></a>
</span><span id="Laws.check_distribution_fit-2575"><a href="#Laws.check_distribution_fit-2575"><span class="linenos">2575</span></a>                    <span class="k">return</span> <span class="p">(</span>
</span><span id="Laws.check_distribution_fit-2576"><a href="#Laws.check_distribution_fit-2576"><span class="linenos">2576</span></a>                        <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2577"><a href="#Laws.check_distribution_fit-2577"><span class="linenos">2577</span></a>                        <span class="n">model</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2578"><a href="#Laws.check_distribution_fit-2578"><span class="linenos">2578</span></a>                        <span class="n">plot_distribution_obj</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2579"><a href="#Laws.check_distribution_fit-2579"><span class="linenos">2579</span></a>                        <span class="n">plot_model_obj</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2580"><a href="#Laws.check_distribution_fit-2580"><span class="linenos">2580</span></a>                        <span class="n">flexation_point_detection_results</span><span class="p">,</span>
</span><span id="Laws.check_distribution_fit-2581"><a href="#Laws.check_distribution_fit-2581"><span class="linenos">2581</span></a>                    <span class="p">)</span>
</span><span id="Laws.check_distribution_fit-2582"><a href="#Laws.check_distribution_fit-2582"><span class="linenos">2582</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Laws.check_distribution_fit-2583"><a href="#Laws.check_distribution_fit-2583"><span class="linenos">2583</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span>
</span><span id="Laws.check_distribution_fit-2584"><a href="#Laws.check_distribution_fit-2584"><span class="linenos">2584</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Laws.check_distribution_fit-2585"><a href="#Laws.check_distribution_fit-2585"><span class="linenos">2585</span></a>                <span class="k">return</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">plot_distribution_obj</span><span class="p">,</span> <span class="n">plot_model_obj</span>
</span><span id="Laws.check_distribution_fit-2586"><a href="#Laws.check_distribution_fit-2586"><span class="linenos">2586</span></a>
</span><span id="Laws.check_distribution_fit-2587"><a href="#Laws.check_distribution_fit-2587"><span class="linenos">2587</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span></pre></div>


            <div class="docstring"><p>A decorator that evaluates the results of distribution
fitting and detects flexation points.</p>

<p>The decorated function is expected to return:</p>

<ul>
<li>model (distfit object): The best-fitted distribution
model.</li>
<li>data (pd.Series or np.ndarray): Data used for
distribution fitting.</li>
</ul>

<p>The function generates:</p>

<ul>
<li>A histogram plot of the fitted distribution.</li>
<li>A model plot displaying the probability density function (PDF).</li>
</ul>

<p>If the fitted distribution is not in <code>const.DISTRIBUTIONS</code>
and the data has at least 4 observations, or if specific conditions
apply (e.g., Pareto or Lognormal with parameter &gt; 2),
an attempt is made to detect flexation points in the distribution.</p>

<h2 id="parameters">Parameters:</h2>

<p>func : function
    The function performing distribution fitting.</p>

<h2 id="returns">Returns:</h2>

<p>function
    Wrapped function that returns:
    - func.__name__ (str): Name of the function.
    - model (distfit object): Best-fitting distribution model.
    - plot_distribution_obj (BytesIO): Image object containing
        the histogram plot.
    - plot_model_obj (BytesIO): Image object containing the PDF plot.
    - flexation_point_detection_results (tuple, optional):
    If flexation points are found, returns details of left
    and right distributions.</p>
</div>


                            </div>
                            <div id="Laws.visitation_frequency" class="classattr">
                                        <input id="Laws.visitation_frequency-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">visitation_frequency</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.visitation_frequency-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.visitation_frequency"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.visitation_frequency-2183"><a href="#Laws.visitation_frequency-2183"><span class="linenos">2183</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.visitation_frequency-2184"><a href="#Laws.visitation_frequency-2184"><span class="linenos">2184</span></a>            <span class="n">func_name</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.visitation_frequency-2185"><a href="#Laws.visitation_frequency-2185"><span class="linenos">2185</span></a>            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">param_frame</span><span class="p">[</span><span class="n">param_frame</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_fit</span><span class="p">]</span>
</span><span id="Laws.visitation_frequency-2186"><a href="#Laws.visitation_frequency-2186"><span class="linenos">2186</span></a>
</span><span id="Laws.visitation_frequency-2187"><a href="#Laws.visitation_frequency-2187"><span class="linenos">2187</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">func_name</span><span class="p">:</span> <span class="n">best_fit</span><span class="p">})</span>
</span><span id="Laws.visitation_frequency-2188"><a href="#Laws.visitation_frequency-2188"><span class="linenos">2188</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws.visitation_frequency-2189"><a href="#Laws.visitation_frequency-2189"><span class="linenos">2189</span></a>                <span class="p">{</span>
</span><span id="Laws.visitation_frequency-2190"><a href="#Laws.visitation_frequency-2190"><span class="linenos">2190</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">filtered_df</span><span class="p">[</span>
</span><span id="Laws.visitation_frequency-2191"><a href="#Laws.visitation_frequency-2191"><span class="linenos">2191</span></a>                        <span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">,</span> <span class="s2">&quot;param2&quot;</span><span class="p">]</span>
</span><span id="Laws.visitation_frequency-2192"><a href="#Laws.visitation_frequency-2192"><span class="linenos">2192</span></a>                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Laws.visitation_frequency-2193"><a href="#Laws.visitation_frequency-2193"><span class="linenos">2193</span></a>                <span class="p">}</span>
</span><span id="Laws.visitation_frequency-2194"><a href="#Laws.visitation_frequency-2194"><span class="linenos">2194</span></a>            <span class="p">)</span>
</span><span id="Laws.visitation_frequency-2195"><a href="#Laws.visitation_frequency-2195"><span class="linenos">2195</span></a>
</span><span id="Laws.visitation_frequency-2196"><a href="#Laws.visitation_frequency-2196"><span class="linenos">2196</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">func_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws.visitation_frequency-2197"><a href="#Laws.visitation_frequency-2197"><span class="linenos">2197</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws.visitation_frequency-2198"><a href="#Laws.visitation_frequency-2198"><span class="linenos">2198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.visitation_frequency-2199"><a href="#Laws.visitation_frequency-2199"><span class="linenos">2199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.visitation_frequency-2200"><a href="#Laws.visitation_frequency-2200"><span class="linenos">2200</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.visitation_frequency-2201"><a href="#Laws.visitation_frequency-2201"><span class="linenos">2201</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.visitation_frequency-2202"><a href="#Laws.visitation_frequency-2202"><span class="linenos">2202</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">best_fit</span><span class="si">}</span><span class="s1"> with Param 1: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">,&#39;</span>
</span><span id="Laws.visitation_frequency-2203"><a href="#Laws.visitation_frequency-2203"><span class="linenos">2203</span></a>                <span class="sa">f</span><span class="s1">&#39;Param 2: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.visitation_frequency-2204"><a href="#Laws.visitation_frequency-2204"><span class="linenos">2204</span></a>            <span class="p">)</span>
</span><span id="Laws.visitation_frequency-2205"><a href="#Laws.visitation_frequency-2205"><span class="linenos">2205</span></a>
</span><span id="Laws.visitation_frequency-2206"><a href="#Laws.visitation_frequency-2206"><span class="linenos">2206</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.visitation_frequency-2207"><a href="#Laws.visitation_frequency-2207"><span class="linenos">2207</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_curves_table</span><span class="p">(</span>
</span><span id="Laws.visitation_frequency-2208"><a href="#Laws.visitation_frequency-2208"><span class="linenos">2208</span></a>                <span class="n">param_frame</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="n">y_position_global</span> <span class="o">+</span> <span class="mi">13</span>
</span><span id="Laws.visitation_frequency-2209"><a href="#Laws.visitation_frequency-2209"><span class="linenos">2209</span></a>            <span class="p">)</span>
</span><span id="Laws.visitation_frequency-2210"><a href="#Laws.visitation_frequency-2210"><span class="linenos">2210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.visitation_frequency-2211"><a href="#Laws.visitation_frequency-2211"><span class="linenos">2211</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj</span><span class="p">,</span>
</span><span id="Laws.visitation_frequency-2212"><a href="#Laws.visitation_frequency-2212"><span class="linenos">2212</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.visitation_frequency-2213"><a href="#Laws.visitation_frequency-2213"><span class="linenos">2213</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws.visitation_frequency-2214"><a href="#Laws.visitation_frequency-2214"><span class="linenos">2214</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span>
</span><span id="Laws.visitation_frequency-2215"><a href="#Laws.visitation_frequency-2215"><span class="linenos">2215</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.visitation_frequency-2216"><a href="#Laws.visitation_frequency-2216"><span class="linenos">2216</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes the visitation frequency of locations based
on trajectory data.</p>

<p>The function:</p>

<ul>
<li>Computes visitation frequency from trajectory data.</li>
<li>Averages visitation frequency over a specified
minimum number of labels.</li>
<li>Performs curve fitting to find the best function
describing the relationship.</li>
<li>Returns fitting results, including predictions
and parameter estimates.</li>
</ul>

<h2 id="parameters">Parameters:</h2>

<p>data : TrajectoriesFrame
    A trajectory dataset containing location visit information.
min_labels_no : int
    Minimum number of labels required for averaging
        the visitation frequency.</p>

<h2 id="returns">Returns:</h2>

<p>tuple:
    - best_fit (str): Best fitting curve name.
    - global_params (pd.DataFrame): Parameters of the best fit.
    - y_pred (np.ndarray): Predicted visitation frequencies.
    - exp_y_pred (np.ndarray or None): Exponential curve
        predictions (if applicable).
    - avg_vf (pd.Series): Averaged visitation frequency data.
    - labels (list): Axis labels for the plot.</p>
</div>


                            </div>
                            <div id="Laws.jump_lengths_distribution" class="classattr">
                                        <input id="Laws.jump_lengths_distribution-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">jump_lengths_distribution</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.jump_lengths_distribution-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.jump_lengths_distribution"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.jump_lengths_distribution-2248"><a href="#Laws.jump_lengths_distribution-2248"><span class="linenos">2248</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.jump_lengths_distribution-2249"><a href="#Laws.jump_lengths_distribution-2249"><span class="linenos">2249</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2250"><a href="#Laws.jump_lengths_distribution-2250"><span class="linenos">2250</span></a>
</span><span id="Laws.jump_lengths_distribution-2251"><a href="#Laws.jump_lengths_distribution-2251"><span class="linenos">2251</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]})</span>
</span><span id="Laws.jump_lengths_distribution-2252"><a href="#Laws.jump_lengths_distribution-2252"><span class="linenos">2252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws.jump_lengths_distribution-2253"><a href="#Laws.jump_lengths_distribution-2253"><span class="linenos">2253</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]}</span>
</span><span id="Laws.jump_lengths_distribution-2254"><a href="#Laws.jump_lengths_distribution-2254"><span class="linenos">2254</span></a>            <span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2255"><a href="#Laws.jump_lengths_distribution-2255"><span class="linenos">2255</span></a>
</span><span id="Laws.jump_lengths_distribution-2256"><a href="#Laws.jump_lengths_distribution-2256"><span class="linenos">2256</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2257"><a href="#Laws.jump_lengths_distribution-2257"><span class="linenos">2257</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws.jump_lengths_distribution-2258"><a href="#Laws.jump_lengths_distribution-2258"><span class="linenos">2258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2259"><a href="#Laws.jump_lengths_distribution-2259"><span class="linenos">2259</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2260"><a href="#Laws.jump_lengths_distribution-2260"><span class="linenos">2260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2261"><a href="#Laws.jump_lengths_distribution-2261"><span class="linenos">2261</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.jump_lengths_distribution-2262"><a href="#Laws.jump_lengths_distribution-2262"><span class="linenos">2262</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.jump_lengths_distribution-2263"><a href="#Laws.jump_lengths_distribution-2263"><span class="linenos">2263</span></a>            <span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2264"><a href="#Laws.jump_lengths_distribution-2264"><span class="linenos">2264</span></a>
</span><span id="Laws.jump_lengths_distribution-2265"><a href="#Laws.jump_lengths_distribution-2265"><span class="linenos">2265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.jump_lengths_distribution-2266"><a href="#Laws.jump_lengths_distribution-2266"><span class="linenos">2266</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.jump_lengths_distribution-2267"><a href="#Laws.jump_lengths_distribution-2267"><span class="linenos">2267</span></a>            <span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2268"><a href="#Laws.jump_lengths_distribution-2268"><span class="linenos">2268</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.jump_lengths_distribution-2269"><a href="#Laws.jump_lengths_distribution-2269"><span class="linenos">2269</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.jump_lengths_distribution-2270"><a href="#Laws.jump_lengths_distribution-2270"><span class="linenos">2270</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.jump_lengths_distribution-2271"><a href="#Laws.jump_lengths_distribution-2271"><span class="linenos">2271</span></a>            <span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2272"><a href="#Laws.jump_lengths_distribution-2272"><span class="linenos">2272</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.jump_lengths_distribution-2273"><a href="#Laws.jump_lengths_distribution-2273"><span class="linenos">2273</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.jump_lengths_distribution-2274"><a href="#Laws.jump_lengths_distribution-2274"><span class="linenos">2274</span></a>            <span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2275"><a href="#Laws.jump_lengths_distribution-2275"><span class="linenos">2275</span></a>
</span><span id="Laws.jump_lengths_distribution-2276"><a href="#Laws.jump_lengths_distribution-2276"><span class="linenos">2276</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Laws.jump_lengths_distribution-2277"><a href="#Laws.jump_lengths_distribution-2277"><span class="linenos">2277</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.jump_lengths_distribution-2278"><a href="#Laws.jump_lengths_distribution-2278"><span class="linenos">2278</span></a>                    <span class="sa">f</span><span class="s2">&quot;At point </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">, the flexion point of the distributions was found&quot;</span>
</span><span id="Laws.jump_lengths_distribution-2279"><a href="#Laws.jump_lengths_distribution-2279"><span class="linenos">2279</span></a>                <span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2280"><a href="#Laws.jump_lengths_distribution-2280"><span class="linenos">2280</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.jump_lengths_distribution-2281"><a href="#Laws.jump_lengths_distribution-2281"><span class="linenos">2281</span></a>                    <span class="sa">f</span><span class="s1">&#39;Left distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.jump_lengths_distribution-2282"><a href="#Laws.jump_lengths_distribution-2282"><span class="linenos">2282</span></a>                <span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2283"><a href="#Laws.jump_lengths_distribution-2283"><span class="linenos">2283</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.jump_lengths_distribution-2284"><a href="#Laws.jump_lengths_distribution-2284"><span class="linenos">2284</span></a>                    <span class="sa">f</span><span class="s1">&#39;Right distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.jump_lengths_distribution-2285"><a href="#Laws.jump_lengths_distribution-2285"><span class="linenos">2285</span></a>                <span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2286"><a href="#Laws.jump_lengths_distribution-2286"><span class="linenos">2286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.jump_lengths_distribution-2287"><a href="#Laws.jump_lengths_distribution-2287"><span class="linenos">2287</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.jump_lengths_distribution-2288"><a href="#Laws.jump_lengths_distribution-2288"><span class="linenos">2288</span></a>                <span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2289"><a href="#Laws.jump_lengths_distribution-2289"><span class="linenos">2289</span></a>                <span class="n">plot_distribution</span><span class="p">,</span> <span class="n">plot_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_double_distribution</span><span class="p">(</span>
</span><span id="Laws.jump_lengths_distribution-2290"><a href="#Laws.jump_lengths_distribution-2290"><span class="linenos">2290</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.jump_lengths_distribution-2291"><a href="#Laws.jump_lengths_distribution-2291"><span class="linenos">2291</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
</span><span id="Laws.jump_lengths_distribution-2292"><a href="#Laws.jump_lengths_distribution-2292"><span class="linenos">2292</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
</span><span id="Laws.jump_lengths_distribution-2293"><a href="#Laws.jump_lengths_distribution-2293"><span class="linenos">2293</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
</span><span id="Laws.jump_lengths_distribution-2294"><a href="#Laws.jump_lengths_distribution-2294"><span class="linenos">2294</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
</span><span id="Laws.jump_lengths_distribution-2295"><a href="#Laws.jump_lengths_distribution-2295"><span class="linenos">2295</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.jump_lengths_distribution-2296"><a href="#Laws.jump_lengths_distribution-2296"><span class="linenos">2296</span></a>                <span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2297"><a href="#Laws.jump_lengths_distribution-2297"><span class="linenos">2297</span></a>                <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.jump_lengths_distribution-2298"><a href="#Laws.jump_lengths_distribution-2298"><span class="linenos">2298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.jump_lengths_distribution-2299"><a href="#Laws.jump_lengths_distribution-2299"><span class="linenos">2299</span></a>                    <span class="n">plot_distribution</span><span class="p">,</span>
</span><span id="Laws.jump_lengths_distribution-2300"><a href="#Laws.jump_lengths_distribution-2300"><span class="linenos">2300</span></a>                    <span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.jump_lengths_distribution-2301"><a href="#Laws.jump_lengths_distribution-2301"><span class="linenos">2301</span></a>                    <span class="mi">60</span><span class="p">,</span>
</span><span id="Laws.jump_lengths_distribution-2302"><a href="#Laws.jump_lengths_distribution-2302"><span class="linenos">2302</span></a>                    <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Laws.jump_lengths_distribution-2303"><a href="#Laws.jump_lengths_distribution-2303"><span class="linenos">2303</span></a>                    <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.jump_lengths_distribution-2304"><a href="#Laws.jump_lengths_distribution-2304"><span class="linenos">2304</span></a>                <span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2305"><a href="#Laws.jump_lengths_distribution-2305"><span class="linenos">2305</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.jump_lengths_distribution-2306"><a href="#Laws.jump_lengths_distribution-2306"><span class="linenos">2306</span></a>                    <span class="n">plot_models</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.jump_lengths_distribution-2307"><a href="#Laws.jump_lengths_distribution-2307"><span class="linenos">2307</span></a>                <span class="p">)</span>
</span><span id="Laws.jump_lengths_distribution-2308"><a href="#Laws.jump_lengths_distribution-2308"><span class="linenos">2308</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Computes the distribution of jump lengths in a trajectory dataset.</p>

<p>The function:</p>

<ul>
<li>Extracts jump lengths from the dataset.</li>
<li>Removes zero values and converts the data into a distribution.</li>
<li>Fits multiple statistical distributions and selects the best fit.</li>
</ul>

<h2 id="parameters">Parameters:</h2>

<p>data : TrajectoriesFrame
    A trajectory dataset containing movement data.</p>

<h2 id="returns">Returns:</h2>

<p>tuple:
    - model (distfit object): The fitted distribution model.
    - jl (pd.Series): The processed jump length data.</p>
</div>


                            </div>
                            <div id="Laws.waiting_times" class="classattr">
                                        <input id="Laws.waiting_times-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">waiting_times</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.waiting_times-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.waiting_times"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.waiting_times-2248"><a href="#Laws.waiting_times-2248"><span class="linenos">2248</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.waiting_times-2249"><a href="#Laws.waiting_times-2249"><span class="linenos">2249</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.waiting_times-2250"><a href="#Laws.waiting_times-2250"><span class="linenos">2250</span></a>
</span><span id="Laws.waiting_times-2251"><a href="#Laws.waiting_times-2251"><span class="linenos">2251</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]})</span>
</span><span id="Laws.waiting_times-2252"><a href="#Laws.waiting_times-2252"><span class="linenos">2252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws.waiting_times-2253"><a href="#Laws.waiting_times-2253"><span class="linenos">2253</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]}</span>
</span><span id="Laws.waiting_times-2254"><a href="#Laws.waiting_times-2254"><span class="linenos">2254</span></a>            <span class="p">)</span>
</span><span id="Laws.waiting_times-2255"><a href="#Laws.waiting_times-2255"><span class="linenos">2255</span></a>
</span><span id="Laws.waiting_times-2256"><a href="#Laws.waiting_times-2256"><span class="linenos">2256</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws.waiting_times-2257"><a href="#Laws.waiting_times-2257"><span class="linenos">2257</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws.waiting_times-2258"><a href="#Laws.waiting_times-2258"><span class="linenos">2258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.waiting_times-2259"><a href="#Laws.waiting_times-2259"><span class="linenos">2259</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.waiting_times-2260"><a href="#Laws.waiting_times-2260"><span class="linenos">2260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.waiting_times-2261"><a href="#Laws.waiting_times-2261"><span class="linenos">2261</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.waiting_times-2262"><a href="#Laws.waiting_times-2262"><span class="linenos">2262</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.waiting_times-2263"><a href="#Laws.waiting_times-2263"><span class="linenos">2263</span></a>            <span class="p">)</span>
</span><span id="Laws.waiting_times-2264"><a href="#Laws.waiting_times-2264"><span class="linenos">2264</span></a>
</span><span id="Laws.waiting_times-2265"><a href="#Laws.waiting_times-2265"><span class="linenos">2265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.waiting_times-2266"><a href="#Laws.waiting_times-2266"><span class="linenos">2266</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.waiting_times-2267"><a href="#Laws.waiting_times-2267"><span class="linenos">2267</span></a>            <span class="p">)</span>
</span><span id="Laws.waiting_times-2268"><a href="#Laws.waiting_times-2268"><span class="linenos">2268</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.waiting_times-2269"><a href="#Laws.waiting_times-2269"><span class="linenos">2269</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.waiting_times-2270"><a href="#Laws.waiting_times-2270"><span class="linenos">2270</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.waiting_times-2271"><a href="#Laws.waiting_times-2271"><span class="linenos">2271</span></a>            <span class="p">)</span>
</span><span id="Laws.waiting_times-2272"><a href="#Laws.waiting_times-2272"><span class="linenos">2272</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.waiting_times-2273"><a href="#Laws.waiting_times-2273"><span class="linenos">2273</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.waiting_times-2274"><a href="#Laws.waiting_times-2274"><span class="linenos">2274</span></a>            <span class="p">)</span>
</span><span id="Laws.waiting_times-2275"><a href="#Laws.waiting_times-2275"><span class="linenos">2275</span></a>
</span><span id="Laws.waiting_times-2276"><a href="#Laws.waiting_times-2276"><span class="linenos">2276</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Laws.waiting_times-2277"><a href="#Laws.waiting_times-2277"><span class="linenos">2277</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.waiting_times-2278"><a href="#Laws.waiting_times-2278"><span class="linenos">2278</span></a>                    <span class="sa">f</span><span class="s2">&quot;At point </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">, the flexion point of the distributions was found&quot;</span>
</span><span id="Laws.waiting_times-2279"><a href="#Laws.waiting_times-2279"><span class="linenos">2279</span></a>                <span class="p">)</span>
</span><span id="Laws.waiting_times-2280"><a href="#Laws.waiting_times-2280"><span class="linenos">2280</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.waiting_times-2281"><a href="#Laws.waiting_times-2281"><span class="linenos">2281</span></a>                    <span class="sa">f</span><span class="s1">&#39;Left distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.waiting_times-2282"><a href="#Laws.waiting_times-2282"><span class="linenos">2282</span></a>                <span class="p">)</span>
</span><span id="Laws.waiting_times-2283"><a href="#Laws.waiting_times-2283"><span class="linenos">2283</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.waiting_times-2284"><a href="#Laws.waiting_times-2284"><span class="linenos">2284</span></a>                    <span class="sa">f</span><span class="s1">&#39;Right distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.waiting_times-2285"><a href="#Laws.waiting_times-2285"><span class="linenos">2285</span></a>                <span class="p">)</span>
</span><span id="Laws.waiting_times-2286"><a href="#Laws.waiting_times-2286"><span class="linenos">2286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.waiting_times-2287"><a href="#Laws.waiting_times-2287"><span class="linenos">2287</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.waiting_times-2288"><a href="#Laws.waiting_times-2288"><span class="linenos">2288</span></a>                <span class="p">)</span>
</span><span id="Laws.waiting_times-2289"><a href="#Laws.waiting_times-2289"><span class="linenos">2289</span></a>                <span class="n">plot_distribution</span><span class="p">,</span> <span class="n">plot_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_double_distribution</span><span class="p">(</span>
</span><span id="Laws.waiting_times-2290"><a href="#Laws.waiting_times-2290"><span class="linenos">2290</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.waiting_times-2291"><a href="#Laws.waiting_times-2291"><span class="linenos">2291</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
</span><span id="Laws.waiting_times-2292"><a href="#Laws.waiting_times-2292"><span class="linenos">2292</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
</span><span id="Laws.waiting_times-2293"><a href="#Laws.waiting_times-2293"><span class="linenos">2293</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
</span><span id="Laws.waiting_times-2294"><a href="#Laws.waiting_times-2294"><span class="linenos">2294</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
</span><span id="Laws.waiting_times-2295"><a href="#Laws.waiting_times-2295"><span class="linenos">2295</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.waiting_times-2296"><a href="#Laws.waiting_times-2296"><span class="linenos">2296</span></a>                <span class="p">)</span>
</span><span id="Laws.waiting_times-2297"><a href="#Laws.waiting_times-2297"><span class="linenos">2297</span></a>                <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.waiting_times-2298"><a href="#Laws.waiting_times-2298"><span class="linenos">2298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.waiting_times-2299"><a href="#Laws.waiting_times-2299"><span class="linenos">2299</span></a>                    <span class="n">plot_distribution</span><span class="p">,</span>
</span><span id="Laws.waiting_times-2300"><a href="#Laws.waiting_times-2300"><span class="linenos">2300</span></a>                    <span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.waiting_times-2301"><a href="#Laws.waiting_times-2301"><span class="linenos">2301</span></a>                    <span class="mi">60</span><span class="p">,</span>
</span><span id="Laws.waiting_times-2302"><a href="#Laws.waiting_times-2302"><span class="linenos">2302</span></a>                    <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Laws.waiting_times-2303"><a href="#Laws.waiting_times-2303"><span class="linenos">2303</span></a>                    <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.waiting_times-2304"><a href="#Laws.waiting_times-2304"><span class="linenos">2304</span></a>                <span class="p">)</span>
</span><span id="Laws.waiting_times-2305"><a href="#Laws.waiting_times-2305"><span class="linenos">2305</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.waiting_times-2306"><a href="#Laws.waiting_times-2306"><span class="linenos">2306</span></a>                    <span class="n">plot_models</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.waiting_times-2307"><a href="#Laws.waiting_times-2307"><span class="linenos">2307</span></a>                <span class="p">)</span>
</span><span id="Laws.waiting_times-2308"><a href="#Laws.waiting_times-2308"><span class="linenos">2308</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Computes the distribution of waiting times in a trajectory dataset.</p>

<p>The function:</p>

<ul>
<li>Calculates the waiting times as the difference between start
and end times.</li>
<li>Removes missing and zero values.</li>
<li>Fits multiple statistical distributions and selects the best fit.</li>
</ul>

<h2 id="parameters">Parameters:</h2>

<p>data : TrajectoriesFrame
    A trajectory dataset containing time-based movement data.</p>

<h2 id="returns">Returns:</h2>

<p>tuple:
    - model (distfit object): The fitted distribution model.
    - wt (pd.Series): The processed waiting time data.</p>
</div>


                            </div>
                            <div id="Laws.travel_times" class="classattr">
                                        <input id="Laws.travel_times-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">travel_times</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.travel_times-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.travel_times"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.travel_times-2248"><a href="#Laws.travel_times-2248"><span class="linenos">2248</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.travel_times-2249"><a href="#Laws.travel_times-2249"><span class="linenos">2249</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.travel_times-2250"><a href="#Laws.travel_times-2250"><span class="linenos">2250</span></a>
</span><span id="Laws.travel_times-2251"><a href="#Laws.travel_times-2251"><span class="linenos">2251</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]})</span>
</span><span id="Laws.travel_times-2252"><a href="#Laws.travel_times-2252"><span class="linenos">2252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws.travel_times-2253"><a href="#Laws.travel_times-2253"><span class="linenos">2253</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]}</span>
</span><span id="Laws.travel_times-2254"><a href="#Laws.travel_times-2254"><span class="linenos">2254</span></a>            <span class="p">)</span>
</span><span id="Laws.travel_times-2255"><a href="#Laws.travel_times-2255"><span class="linenos">2255</span></a>
</span><span id="Laws.travel_times-2256"><a href="#Laws.travel_times-2256"><span class="linenos">2256</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws.travel_times-2257"><a href="#Laws.travel_times-2257"><span class="linenos">2257</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws.travel_times-2258"><a href="#Laws.travel_times-2258"><span class="linenos">2258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.travel_times-2259"><a href="#Laws.travel_times-2259"><span class="linenos">2259</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.travel_times-2260"><a href="#Laws.travel_times-2260"><span class="linenos">2260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.travel_times-2261"><a href="#Laws.travel_times-2261"><span class="linenos">2261</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.travel_times-2262"><a href="#Laws.travel_times-2262"><span class="linenos">2262</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.travel_times-2263"><a href="#Laws.travel_times-2263"><span class="linenos">2263</span></a>            <span class="p">)</span>
</span><span id="Laws.travel_times-2264"><a href="#Laws.travel_times-2264"><span class="linenos">2264</span></a>
</span><span id="Laws.travel_times-2265"><a href="#Laws.travel_times-2265"><span class="linenos">2265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.travel_times-2266"><a href="#Laws.travel_times-2266"><span class="linenos">2266</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.travel_times-2267"><a href="#Laws.travel_times-2267"><span class="linenos">2267</span></a>            <span class="p">)</span>
</span><span id="Laws.travel_times-2268"><a href="#Laws.travel_times-2268"><span class="linenos">2268</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.travel_times-2269"><a href="#Laws.travel_times-2269"><span class="linenos">2269</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.travel_times-2270"><a href="#Laws.travel_times-2270"><span class="linenos">2270</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.travel_times-2271"><a href="#Laws.travel_times-2271"><span class="linenos">2271</span></a>            <span class="p">)</span>
</span><span id="Laws.travel_times-2272"><a href="#Laws.travel_times-2272"><span class="linenos">2272</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.travel_times-2273"><a href="#Laws.travel_times-2273"><span class="linenos">2273</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.travel_times-2274"><a href="#Laws.travel_times-2274"><span class="linenos">2274</span></a>            <span class="p">)</span>
</span><span id="Laws.travel_times-2275"><a href="#Laws.travel_times-2275"><span class="linenos">2275</span></a>
</span><span id="Laws.travel_times-2276"><a href="#Laws.travel_times-2276"><span class="linenos">2276</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Laws.travel_times-2277"><a href="#Laws.travel_times-2277"><span class="linenos">2277</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.travel_times-2278"><a href="#Laws.travel_times-2278"><span class="linenos">2278</span></a>                    <span class="sa">f</span><span class="s2">&quot;At point </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">, the flexion point of the distributions was found&quot;</span>
</span><span id="Laws.travel_times-2279"><a href="#Laws.travel_times-2279"><span class="linenos">2279</span></a>                <span class="p">)</span>
</span><span id="Laws.travel_times-2280"><a href="#Laws.travel_times-2280"><span class="linenos">2280</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.travel_times-2281"><a href="#Laws.travel_times-2281"><span class="linenos">2281</span></a>                    <span class="sa">f</span><span class="s1">&#39;Left distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.travel_times-2282"><a href="#Laws.travel_times-2282"><span class="linenos">2282</span></a>                <span class="p">)</span>
</span><span id="Laws.travel_times-2283"><a href="#Laws.travel_times-2283"><span class="linenos">2283</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.travel_times-2284"><a href="#Laws.travel_times-2284"><span class="linenos">2284</span></a>                    <span class="sa">f</span><span class="s1">&#39;Right distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.travel_times-2285"><a href="#Laws.travel_times-2285"><span class="linenos">2285</span></a>                <span class="p">)</span>
</span><span id="Laws.travel_times-2286"><a href="#Laws.travel_times-2286"><span class="linenos">2286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.travel_times-2287"><a href="#Laws.travel_times-2287"><span class="linenos">2287</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.travel_times-2288"><a href="#Laws.travel_times-2288"><span class="linenos">2288</span></a>                <span class="p">)</span>
</span><span id="Laws.travel_times-2289"><a href="#Laws.travel_times-2289"><span class="linenos">2289</span></a>                <span class="n">plot_distribution</span><span class="p">,</span> <span class="n">plot_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_double_distribution</span><span class="p">(</span>
</span><span id="Laws.travel_times-2290"><a href="#Laws.travel_times-2290"><span class="linenos">2290</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.travel_times-2291"><a href="#Laws.travel_times-2291"><span class="linenos">2291</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
</span><span id="Laws.travel_times-2292"><a href="#Laws.travel_times-2292"><span class="linenos">2292</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
</span><span id="Laws.travel_times-2293"><a href="#Laws.travel_times-2293"><span class="linenos">2293</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
</span><span id="Laws.travel_times-2294"><a href="#Laws.travel_times-2294"><span class="linenos">2294</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
</span><span id="Laws.travel_times-2295"><a href="#Laws.travel_times-2295"><span class="linenos">2295</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.travel_times-2296"><a href="#Laws.travel_times-2296"><span class="linenos">2296</span></a>                <span class="p">)</span>
</span><span id="Laws.travel_times-2297"><a href="#Laws.travel_times-2297"><span class="linenos">2297</span></a>                <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.travel_times-2298"><a href="#Laws.travel_times-2298"><span class="linenos">2298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.travel_times-2299"><a href="#Laws.travel_times-2299"><span class="linenos">2299</span></a>                    <span class="n">plot_distribution</span><span class="p">,</span>
</span><span id="Laws.travel_times-2300"><a href="#Laws.travel_times-2300"><span class="linenos">2300</span></a>                    <span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.travel_times-2301"><a href="#Laws.travel_times-2301"><span class="linenos">2301</span></a>                    <span class="mi">60</span><span class="p">,</span>
</span><span id="Laws.travel_times-2302"><a href="#Laws.travel_times-2302"><span class="linenos">2302</span></a>                    <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Laws.travel_times-2303"><a href="#Laws.travel_times-2303"><span class="linenos">2303</span></a>                    <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.travel_times-2304"><a href="#Laws.travel_times-2304"><span class="linenos">2304</span></a>                <span class="p">)</span>
</span><span id="Laws.travel_times-2305"><a href="#Laws.travel_times-2305"><span class="linenos">2305</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.travel_times-2306"><a href="#Laws.travel_times-2306"><span class="linenos">2306</span></a>                    <span class="n">plot_models</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.travel_times-2307"><a href="#Laws.travel_times-2307"><span class="linenos">2307</span></a>                <span class="p">)</span>
</span><span id="Laws.travel_times-2308"><a href="#Laws.travel_times-2308"><span class="linenos">2308</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Computes the distribution of travel times between locations.</p>

<p>The function:</p>

<ul>
<li>Calculates travel times as the time difference between
consecutive trajectory points.</li>
<li>Removes missing values.</li>
<li>Fits multiple statistical distributions and selects the best fit.</li>
</ul>

<h2 id="parameters">Parameters:</h2>

<p>data : TrajectoriesFrame
    A trajectory dataset containing time-based movement data.</p>

<h2 id="returns">Returns:</h2>

<p>tuple:
    - model (distfit object): The fitted distribution model.
    - tt (pd.Series): The processed travel time data.</p>
</div>


                            </div>
                            <div id="Laws.rog" class="classattr">
                                        <input id="Laws.rog-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rog</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.rog-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.rog"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.rog-2248"><a href="#Laws.rog-2248"><span class="linenos">2248</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.rog-2249"><a href="#Laws.rog-2249"><span class="linenos">2249</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.rog-2250"><a href="#Laws.rog-2250"><span class="linenos">2250</span></a>
</span><span id="Laws.rog-2251"><a href="#Laws.rog-2251"><span class="linenos">2251</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]})</span>
</span><span id="Laws.rog-2252"><a href="#Laws.rog-2252"><span class="linenos">2252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws.rog-2253"><a href="#Laws.rog-2253"><span class="linenos">2253</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]}</span>
</span><span id="Laws.rog-2254"><a href="#Laws.rog-2254"><span class="linenos">2254</span></a>            <span class="p">)</span>
</span><span id="Laws.rog-2255"><a href="#Laws.rog-2255"><span class="linenos">2255</span></a>
</span><span id="Laws.rog-2256"><a href="#Laws.rog-2256"><span class="linenos">2256</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws.rog-2257"><a href="#Laws.rog-2257"><span class="linenos">2257</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws.rog-2258"><a href="#Laws.rog-2258"><span class="linenos">2258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.rog-2259"><a href="#Laws.rog-2259"><span class="linenos">2259</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.rog-2260"><a href="#Laws.rog-2260"><span class="linenos">2260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.rog-2261"><a href="#Laws.rog-2261"><span class="linenos">2261</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.rog-2262"><a href="#Laws.rog-2262"><span class="linenos">2262</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.rog-2263"><a href="#Laws.rog-2263"><span class="linenos">2263</span></a>            <span class="p">)</span>
</span><span id="Laws.rog-2264"><a href="#Laws.rog-2264"><span class="linenos">2264</span></a>
</span><span id="Laws.rog-2265"><a href="#Laws.rog-2265"><span class="linenos">2265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.rog-2266"><a href="#Laws.rog-2266"><span class="linenos">2266</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.rog-2267"><a href="#Laws.rog-2267"><span class="linenos">2267</span></a>            <span class="p">)</span>
</span><span id="Laws.rog-2268"><a href="#Laws.rog-2268"><span class="linenos">2268</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.rog-2269"><a href="#Laws.rog-2269"><span class="linenos">2269</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.rog-2270"><a href="#Laws.rog-2270"><span class="linenos">2270</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.rog-2271"><a href="#Laws.rog-2271"><span class="linenos">2271</span></a>            <span class="p">)</span>
</span><span id="Laws.rog-2272"><a href="#Laws.rog-2272"><span class="linenos">2272</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.rog-2273"><a href="#Laws.rog-2273"><span class="linenos">2273</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.rog-2274"><a href="#Laws.rog-2274"><span class="linenos">2274</span></a>            <span class="p">)</span>
</span><span id="Laws.rog-2275"><a href="#Laws.rog-2275"><span class="linenos">2275</span></a>
</span><span id="Laws.rog-2276"><a href="#Laws.rog-2276"><span class="linenos">2276</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Laws.rog-2277"><a href="#Laws.rog-2277"><span class="linenos">2277</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.rog-2278"><a href="#Laws.rog-2278"><span class="linenos">2278</span></a>                    <span class="sa">f</span><span class="s2">&quot;At point </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">, the flexion point of the distributions was found&quot;</span>
</span><span id="Laws.rog-2279"><a href="#Laws.rog-2279"><span class="linenos">2279</span></a>                <span class="p">)</span>
</span><span id="Laws.rog-2280"><a href="#Laws.rog-2280"><span class="linenos">2280</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.rog-2281"><a href="#Laws.rog-2281"><span class="linenos">2281</span></a>                    <span class="sa">f</span><span class="s1">&#39;Left distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.rog-2282"><a href="#Laws.rog-2282"><span class="linenos">2282</span></a>                <span class="p">)</span>
</span><span id="Laws.rog-2283"><a href="#Laws.rog-2283"><span class="linenos">2283</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.rog-2284"><a href="#Laws.rog-2284"><span class="linenos">2284</span></a>                    <span class="sa">f</span><span class="s1">&#39;Right distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.rog-2285"><a href="#Laws.rog-2285"><span class="linenos">2285</span></a>                <span class="p">)</span>
</span><span id="Laws.rog-2286"><a href="#Laws.rog-2286"><span class="linenos">2286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.rog-2287"><a href="#Laws.rog-2287"><span class="linenos">2287</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.rog-2288"><a href="#Laws.rog-2288"><span class="linenos">2288</span></a>                <span class="p">)</span>
</span><span id="Laws.rog-2289"><a href="#Laws.rog-2289"><span class="linenos">2289</span></a>                <span class="n">plot_distribution</span><span class="p">,</span> <span class="n">plot_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_double_distribution</span><span class="p">(</span>
</span><span id="Laws.rog-2290"><a href="#Laws.rog-2290"><span class="linenos">2290</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.rog-2291"><a href="#Laws.rog-2291"><span class="linenos">2291</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
</span><span id="Laws.rog-2292"><a href="#Laws.rog-2292"><span class="linenos">2292</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
</span><span id="Laws.rog-2293"><a href="#Laws.rog-2293"><span class="linenos">2293</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
</span><span id="Laws.rog-2294"><a href="#Laws.rog-2294"><span class="linenos">2294</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
</span><span id="Laws.rog-2295"><a href="#Laws.rog-2295"><span class="linenos">2295</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.rog-2296"><a href="#Laws.rog-2296"><span class="linenos">2296</span></a>                <span class="p">)</span>
</span><span id="Laws.rog-2297"><a href="#Laws.rog-2297"><span class="linenos">2297</span></a>                <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.rog-2298"><a href="#Laws.rog-2298"><span class="linenos">2298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.rog-2299"><a href="#Laws.rog-2299"><span class="linenos">2299</span></a>                    <span class="n">plot_distribution</span><span class="p">,</span>
</span><span id="Laws.rog-2300"><a href="#Laws.rog-2300"><span class="linenos">2300</span></a>                    <span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.rog-2301"><a href="#Laws.rog-2301"><span class="linenos">2301</span></a>                    <span class="mi">60</span><span class="p">,</span>
</span><span id="Laws.rog-2302"><a href="#Laws.rog-2302"><span class="linenos">2302</span></a>                    <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Laws.rog-2303"><a href="#Laws.rog-2303"><span class="linenos">2303</span></a>                    <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.rog-2304"><a href="#Laws.rog-2304"><span class="linenos">2304</span></a>                <span class="p">)</span>
</span><span id="Laws.rog-2305"><a href="#Laws.rog-2305"><span class="linenos">2305</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.rog-2306"><a href="#Laws.rog-2306"><span class="linenos">2306</span></a>                    <span class="n">plot_models</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.rog-2307"><a href="#Laws.rog-2307"><span class="linenos">2307</span></a>                <span class="p">)</span>
</span><span id="Laws.rog-2308"><a href="#Laws.rog-2308"><span class="linenos">2308</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Computes the distribution of the radius of gyration (RoG).</p>

<p>The function:</p>

<ul>
<li>Computes the radius of gyration for each trajectory.</li>
<li>Fits multiple statistical distributions and selects the best fit.</li>
</ul>

<h2 id="parameters">Parameters:</h2>

<p>data : TrajectoriesFrame
    A trajectory dataset containing spatial movement data.</p>

<h2 id="returns">Returns:</h2>

<p>tuple:
    - model (distfit object): The fitted distribution model.
    - rog (pd.Series): The processed radius of gyration data.</p>
</div>


                            </div>
                            <div id="Laws.rog_over_time" class="classattr">
                                        <input id="Laws.rog_over_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rog_over_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.rog_over_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.rog_over_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.rog_over_time-2183"><a href="#Laws.rog_over_time-2183"><span class="linenos">2183</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.rog_over_time-2184"><a href="#Laws.rog_over_time-2184"><span class="linenos">2184</span></a>            <span class="n">func_name</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.rog_over_time-2185"><a href="#Laws.rog_over_time-2185"><span class="linenos">2185</span></a>            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">param_frame</span><span class="p">[</span><span class="n">param_frame</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_fit</span><span class="p">]</span>
</span><span id="Laws.rog_over_time-2186"><a href="#Laws.rog_over_time-2186"><span class="linenos">2186</span></a>
</span><span id="Laws.rog_over_time-2187"><a href="#Laws.rog_over_time-2187"><span class="linenos">2187</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">func_name</span><span class="p">:</span> <span class="n">best_fit</span><span class="p">})</span>
</span><span id="Laws.rog_over_time-2188"><a href="#Laws.rog_over_time-2188"><span class="linenos">2188</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws.rog_over_time-2189"><a href="#Laws.rog_over_time-2189"><span class="linenos">2189</span></a>                <span class="p">{</span>
</span><span id="Laws.rog_over_time-2190"><a href="#Laws.rog_over_time-2190"><span class="linenos">2190</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">filtered_df</span><span class="p">[</span>
</span><span id="Laws.rog_over_time-2191"><a href="#Laws.rog_over_time-2191"><span class="linenos">2191</span></a>                        <span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">,</span> <span class="s2">&quot;param2&quot;</span><span class="p">]</span>
</span><span id="Laws.rog_over_time-2192"><a href="#Laws.rog_over_time-2192"><span class="linenos">2192</span></a>                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Laws.rog_over_time-2193"><a href="#Laws.rog_over_time-2193"><span class="linenos">2193</span></a>                <span class="p">}</span>
</span><span id="Laws.rog_over_time-2194"><a href="#Laws.rog_over_time-2194"><span class="linenos">2194</span></a>            <span class="p">)</span>
</span><span id="Laws.rog_over_time-2195"><a href="#Laws.rog_over_time-2195"><span class="linenos">2195</span></a>
</span><span id="Laws.rog_over_time-2196"><a href="#Laws.rog_over_time-2196"><span class="linenos">2196</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">func_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws.rog_over_time-2197"><a href="#Laws.rog_over_time-2197"><span class="linenos">2197</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws.rog_over_time-2198"><a href="#Laws.rog_over_time-2198"><span class="linenos">2198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.rog_over_time-2199"><a href="#Laws.rog_over_time-2199"><span class="linenos">2199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.rog_over_time-2200"><a href="#Laws.rog_over_time-2200"><span class="linenos">2200</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.rog_over_time-2201"><a href="#Laws.rog_over_time-2201"><span class="linenos">2201</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.rog_over_time-2202"><a href="#Laws.rog_over_time-2202"><span class="linenos">2202</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">best_fit</span><span class="si">}</span><span class="s1"> with Param 1: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">,&#39;</span>
</span><span id="Laws.rog_over_time-2203"><a href="#Laws.rog_over_time-2203"><span class="linenos">2203</span></a>                <span class="sa">f</span><span class="s1">&#39;Param 2: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.rog_over_time-2204"><a href="#Laws.rog_over_time-2204"><span class="linenos">2204</span></a>            <span class="p">)</span>
</span><span id="Laws.rog_over_time-2205"><a href="#Laws.rog_over_time-2205"><span class="linenos">2205</span></a>
</span><span id="Laws.rog_over_time-2206"><a href="#Laws.rog_over_time-2206"><span class="linenos">2206</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.rog_over_time-2207"><a href="#Laws.rog_over_time-2207"><span class="linenos">2207</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_curves_table</span><span class="p">(</span>
</span><span id="Laws.rog_over_time-2208"><a href="#Laws.rog_over_time-2208"><span class="linenos">2208</span></a>                <span class="n">param_frame</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="n">y_position_global</span> <span class="o">+</span> <span class="mi">13</span>
</span><span id="Laws.rog_over_time-2209"><a href="#Laws.rog_over_time-2209"><span class="linenos">2209</span></a>            <span class="p">)</span>
</span><span id="Laws.rog_over_time-2210"><a href="#Laws.rog_over_time-2210"><span class="linenos">2210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.rog_over_time-2211"><a href="#Laws.rog_over_time-2211"><span class="linenos">2211</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj</span><span class="p">,</span>
</span><span id="Laws.rog_over_time-2212"><a href="#Laws.rog_over_time-2212"><span class="linenos">2212</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.rog_over_time-2213"><a href="#Laws.rog_over_time-2213"><span class="linenos">2213</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws.rog_over_time-2214"><a href="#Laws.rog_over_time-2214"><span class="linenos">2214</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span>
</span><span id="Laws.rog_over_time-2215"><a href="#Laws.rog_over_time-2215"><span class="linenos">2215</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.rog_over_time-2216"><a href="#Laws.rog_over_time-2216"><span class="linenos">2216</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes the evolution of the radius of gyration (RoG) over time.</p>

<p>The function:</p>

<ul>
<li>Computes the radius of gyration for each trajectory over time.</li>
<li>Averages the RoG values using a specified number of records.</li>
<li>Fits a curve to model the evolution of RoG.</li>
</ul>

<h2 id="parameters">Parameters:</h2>

<p>data : TrajectoriesFrame
    A trajectory dataset containing movement data.
min_records_no : int
    Minimum number of records required for averaging.</p>

<h2 id="returns">Returns:</h2>

<p>tuple:
    - best_fit (str): Name of the best fitting model.
    - global_params (dict): Parameters of the best fit.
    - y_pred (ndarray): Predicted values from the curve fit.
    - expon_y_pred (ndarray): Alternative exponential model
        predictions.
    - avg_rog (pd.Series): Averaged RoG values over time.
    - ["Time", "Values"] (list): Column labels.</p>
</div>


                            </div>
                            <div id="Laws.msd_distribution" class="classattr">
                                        <input id="Laws.msd_distribution-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">msd_distribution</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.msd_distribution-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.msd_distribution"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.msd_distribution-2248"><a href="#Laws.msd_distribution-2248"><span class="linenos">2248</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.msd_distribution-2249"><a href="#Laws.msd_distribution-2249"><span class="linenos">2249</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.msd_distribution-2250"><a href="#Laws.msd_distribution-2250"><span class="linenos">2250</span></a>
</span><span id="Laws.msd_distribution-2251"><a href="#Laws.msd_distribution-2251"><span class="linenos">2251</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]})</span>
</span><span id="Laws.msd_distribution-2252"><a href="#Laws.msd_distribution-2252"><span class="linenos">2252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws.msd_distribution-2253"><a href="#Laws.msd_distribution-2253"><span class="linenos">2253</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]}</span>
</span><span id="Laws.msd_distribution-2254"><a href="#Laws.msd_distribution-2254"><span class="linenos">2254</span></a>            <span class="p">)</span>
</span><span id="Laws.msd_distribution-2255"><a href="#Laws.msd_distribution-2255"><span class="linenos">2255</span></a>
</span><span id="Laws.msd_distribution-2256"><a href="#Laws.msd_distribution-2256"><span class="linenos">2256</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws.msd_distribution-2257"><a href="#Laws.msd_distribution-2257"><span class="linenos">2257</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws.msd_distribution-2258"><a href="#Laws.msd_distribution-2258"><span class="linenos">2258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.msd_distribution-2259"><a href="#Laws.msd_distribution-2259"><span class="linenos">2259</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.msd_distribution-2260"><a href="#Laws.msd_distribution-2260"><span class="linenos">2260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.msd_distribution-2261"><a href="#Laws.msd_distribution-2261"><span class="linenos">2261</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.msd_distribution-2262"><a href="#Laws.msd_distribution-2262"><span class="linenos">2262</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.msd_distribution-2263"><a href="#Laws.msd_distribution-2263"><span class="linenos">2263</span></a>            <span class="p">)</span>
</span><span id="Laws.msd_distribution-2264"><a href="#Laws.msd_distribution-2264"><span class="linenos">2264</span></a>
</span><span id="Laws.msd_distribution-2265"><a href="#Laws.msd_distribution-2265"><span class="linenos">2265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.msd_distribution-2266"><a href="#Laws.msd_distribution-2266"><span class="linenos">2266</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.msd_distribution-2267"><a href="#Laws.msd_distribution-2267"><span class="linenos">2267</span></a>            <span class="p">)</span>
</span><span id="Laws.msd_distribution-2268"><a href="#Laws.msd_distribution-2268"><span class="linenos">2268</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.msd_distribution-2269"><a href="#Laws.msd_distribution-2269"><span class="linenos">2269</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.msd_distribution-2270"><a href="#Laws.msd_distribution-2270"><span class="linenos">2270</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.msd_distribution-2271"><a href="#Laws.msd_distribution-2271"><span class="linenos">2271</span></a>            <span class="p">)</span>
</span><span id="Laws.msd_distribution-2272"><a href="#Laws.msd_distribution-2272"><span class="linenos">2272</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.msd_distribution-2273"><a href="#Laws.msd_distribution-2273"><span class="linenos">2273</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.msd_distribution-2274"><a href="#Laws.msd_distribution-2274"><span class="linenos">2274</span></a>            <span class="p">)</span>
</span><span id="Laws.msd_distribution-2275"><a href="#Laws.msd_distribution-2275"><span class="linenos">2275</span></a>
</span><span id="Laws.msd_distribution-2276"><a href="#Laws.msd_distribution-2276"><span class="linenos">2276</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Laws.msd_distribution-2277"><a href="#Laws.msd_distribution-2277"><span class="linenos">2277</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.msd_distribution-2278"><a href="#Laws.msd_distribution-2278"><span class="linenos">2278</span></a>                    <span class="sa">f</span><span class="s2">&quot;At point </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">, the flexion point of the distributions was found&quot;</span>
</span><span id="Laws.msd_distribution-2279"><a href="#Laws.msd_distribution-2279"><span class="linenos">2279</span></a>                <span class="p">)</span>
</span><span id="Laws.msd_distribution-2280"><a href="#Laws.msd_distribution-2280"><span class="linenos">2280</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.msd_distribution-2281"><a href="#Laws.msd_distribution-2281"><span class="linenos">2281</span></a>                    <span class="sa">f</span><span class="s1">&#39;Left distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.msd_distribution-2282"><a href="#Laws.msd_distribution-2282"><span class="linenos">2282</span></a>                <span class="p">)</span>
</span><span id="Laws.msd_distribution-2283"><a href="#Laws.msd_distribution-2283"><span class="linenos">2283</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.msd_distribution-2284"><a href="#Laws.msd_distribution-2284"><span class="linenos">2284</span></a>                    <span class="sa">f</span><span class="s1">&#39;Right distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.msd_distribution-2285"><a href="#Laws.msd_distribution-2285"><span class="linenos">2285</span></a>                <span class="p">)</span>
</span><span id="Laws.msd_distribution-2286"><a href="#Laws.msd_distribution-2286"><span class="linenos">2286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.msd_distribution-2287"><a href="#Laws.msd_distribution-2287"><span class="linenos">2287</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.msd_distribution-2288"><a href="#Laws.msd_distribution-2288"><span class="linenos">2288</span></a>                <span class="p">)</span>
</span><span id="Laws.msd_distribution-2289"><a href="#Laws.msd_distribution-2289"><span class="linenos">2289</span></a>                <span class="n">plot_distribution</span><span class="p">,</span> <span class="n">plot_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_double_distribution</span><span class="p">(</span>
</span><span id="Laws.msd_distribution-2290"><a href="#Laws.msd_distribution-2290"><span class="linenos">2290</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.msd_distribution-2291"><a href="#Laws.msd_distribution-2291"><span class="linenos">2291</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
</span><span id="Laws.msd_distribution-2292"><a href="#Laws.msd_distribution-2292"><span class="linenos">2292</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
</span><span id="Laws.msd_distribution-2293"><a href="#Laws.msd_distribution-2293"><span class="linenos">2293</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
</span><span id="Laws.msd_distribution-2294"><a href="#Laws.msd_distribution-2294"><span class="linenos">2294</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
</span><span id="Laws.msd_distribution-2295"><a href="#Laws.msd_distribution-2295"><span class="linenos">2295</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.msd_distribution-2296"><a href="#Laws.msd_distribution-2296"><span class="linenos">2296</span></a>                <span class="p">)</span>
</span><span id="Laws.msd_distribution-2297"><a href="#Laws.msd_distribution-2297"><span class="linenos">2297</span></a>                <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.msd_distribution-2298"><a href="#Laws.msd_distribution-2298"><span class="linenos">2298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.msd_distribution-2299"><a href="#Laws.msd_distribution-2299"><span class="linenos">2299</span></a>                    <span class="n">plot_distribution</span><span class="p">,</span>
</span><span id="Laws.msd_distribution-2300"><a href="#Laws.msd_distribution-2300"><span class="linenos">2300</span></a>                    <span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.msd_distribution-2301"><a href="#Laws.msd_distribution-2301"><span class="linenos">2301</span></a>                    <span class="mi">60</span><span class="p">,</span>
</span><span id="Laws.msd_distribution-2302"><a href="#Laws.msd_distribution-2302"><span class="linenos">2302</span></a>                    <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Laws.msd_distribution-2303"><a href="#Laws.msd_distribution-2303"><span class="linenos">2303</span></a>                    <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.msd_distribution-2304"><a href="#Laws.msd_distribution-2304"><span class="linenos">2304</span></a>                <span class="p">)</span>
</span><span id="Laws.msd_distribution-2305"><a href="#Laws.msd_distribution-2305"><span class="linenos">2305</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.msd_distribution-2306"><a href="#Laws.msd_distribution-2306"><span class="linenos">2306</span></a>                    <span class="n">plot_models</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.msd_distribution-2307"><a href="#Laws.msd_distribution-2307"><span class="linenos">2307</span></a>                <span class="p">)</span>
</span><span id="Laws.msd_distribution-2308"><a href="#Laws.msd_distribution-2308"><span class="linenos">2308</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Computes the distribution of mean squared displacement (MSD).</p>

<p>The function:</p>

<ul>
<li>Computes MSD without time evolution.</li>
<li>Fits multiple statistical distributions and selects the best fit.</li>
</ul>

<h2 id="parameters">Parameters:</h2>

<p>data : TrajectoriesFrame
    A trajectory dataset containing movement data.</p>

<h2 id="returns">Returns:</h2>

<p>tuple:
    - model (distfit object): The fitted distribution model.
    - msd (pd.Series): The computed MSD values.</p>
</div>


                            </div>
                            <div id="Laws.msd_curve" class="classattr">
                                        <input id="Laws.msd_curve-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">msd_curve</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.msd_curve-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.msd_curve"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.msd_curve-2183"><a href="#Laws.msd_curve-2183"><span class="linenos">2183</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.msd_curve-2184"><a href="#Laws.msd_curve-2184"><span class="linenos">2184</span></a>            <span class="n">func_name</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.msd_curve-2185"><a href="#Laws.msd_curve-2185"><span class="linenos">2185</span></a>            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">param_frame</span><span class="p">[</span><span class="n">param_frame</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_fit</span><span class="p">]</span>
</span><span id="Laws.msd_curve-2186"><a href="#Laws.msd_curve-2186"><span class="linenos">2186</span></a>
</span><span id="Laws.msd_curve-2187"><a href="#Laws.msd_curve-2187"><span class="linenos">2187</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">func_name</span><span class="p">:</span> <span class="n">best_fit</span><span class="p">})</span>
</span><span id="Laws.msd_curve-2188"><a href="#Laws.msd_curve-2188"><span class="linenos">2188</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws.msd_curve-2189"><a href="#Laws.msd_curve-2189"><span class="linenos">2189</span></a>                <span class="p">{</span>
</span><span id="Laws.msd_curve-2190"><a href="#Laws.msd_curve-2190"><span class="linenos">2190</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">filtered_df</span><span class="p">[</span>
</span><span id="Laws.msd_curve-2191"><a href="#Laws.msd_curve-2191"><span class="linenos">2191</span></a>                        <span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">,</span> <span class="s2">&quot;param2&quot;</span><span class="p">]</span>
</span><span id="Laws.msd_curve-2192"><a href="#Laws.msd_curve-2192"><span class="linenos">2192</span></a>                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Laws.msd_curve-2193"><a href="#Laws.msd_curve-2193"><span class="linenos">2193</span></a>                <span class="p">}</span>
</span><span id="Laws.msd_curve-2194"><a href="#Laws.msd_curve-2194"><span class="linenos">2194</span></a>            <span class="p">)</span>
</span><span id="Laws.msd_curve-2195"><a href="#Laws.msd_curve-2195"><span class="linenos">2195</span></a>
</span><span id="Laws.msd_curve-2196"><a href="#Laws.msd_curve-2196"><span class="linenos">2196</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">func_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws.msd_curve-2197"><a href="#Laws.msd_curve-2197"><span class="linenos">2197</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws.msd_curve-2198"><a href="#Laws.msd_curve-2198"><span class="linenos">2198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.msd_curve-2199"><a href="#Laws.msd_curve-2199"><span class="linenos">2199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.msd_curve-2200"><a href="#Laws.msd_curve-2200"><span class="linenos">2200</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.msd_curve-2201"><a href="#Laws.msd_curve-2201"><span class="linenos">2201</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.msd_curve-2202"><a href="#Laws.msd_curve-2202"><span class="linenos">2202</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">best_fit</span><span class="si">}</span><span class="s1"> with Param 1: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">,&#39;</span>
</span><span id="Laws.msd_curve-2203"><a href="#Laws.msd_curve-2203"><span class="linenos">2203</span></a>                <span class="sa">f</span><span class="s1">&#39;Param 2: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.msd_curve-2204"><a href="#Laws.msd_curve-2204"><span class="linenos">2204</span></a>            <span class="p">)</span>
</span><span id="Laws.msd_curve-2205"><a href="#Laws.msd_curve-2205"><span class="linenos">2205</span></a>
</span><span id="Laws.msd_curve-2206"><a href="#Laws.msd_curve-2206"><span class="linenos">2206</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.msd_curve-2207"><a href="#Laws.msd_curve-2207"><span class="linenos">2207</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_curves_table</span><span class="p">(</span>
</span><span id="Laws.msd_curve-2208"><a href="#Laws.msd_curve-2208"><span class="linenos">2208</span></a>                <span class="n">param_frame</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="n">y_position_global</span> <span class="o">+</span> <span class="mi">13</span>
</span><span id="Laws.msd_curve-2209"><a href="#Laws.msd_curve-2209"><span class="linenos">2209</span></a>            <span class="p">)</span>
</span><span id="Laws.msd_curve-2210"><a href="#Laws.msd_curve-2210"><span class="linenos">2210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.msd_curve-2211"><a href="#Laws.msd_curve-2211"><span class="linenos">2211</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj</span><span class="p">,</span>
</span><span id="Laws.msd_curve-2212"><a href="#Laws.msd_curve-2212"><span class="linenos">2212</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.msd_curve-2213"><a href="#Laws.msd_curve-2213"><span class="linenos">2213</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws.msd_curve-2214"><a href="#Laws.msd_curve-2214"><span class="linenos">2214</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span>
</span><span id="Laws.msd_curve-2215"><a href="#Laws.msd_curve-2215"><span class="linenos">2215</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.msd_curve-2216"><a href="#Laws.msd_curve-2216"><span class="linenos">2216</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes the mean squared displacement (MSD) curve over time.</p>

<p>The function:</p>

<ul>
<li>Computes MSD over time.</li>
<li>Averages MSD values using a specified number of records.</li>
<li>Fits a curve to model MSD behavior.</li>
</ul>

<h2 id="parameters">Parameters:</h2>

<p>data : TrajectoriesFrame
    A trajectory dataset containing movement data.
min_records_no : int
    Minimum number of records required for averaging.</p>

<h2 id="returns">Returns:</h2>

<p>tuple:
    - best_fit (str): Name of the best fitting model.
    - global_params (dict): Parameters of the best fit.
    - y_pred (ndarray): Predicted values from the curve fit.
    - expon_y_pred (ndarray): Alternative exponential model
        predictions.
    - avg_msd (pd.Series): Averaged MSD values over time.
    - ["t", "MSD"] (list): Column labels.</p>
</div>


                            </div>
                            <div id="Laws.return_time_distribution" class="classattr">
                                        <input id="Laws.return_time_distribution-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">return_time_distribution</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.return_time_distribution-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.return_time_distribution"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.return_time_distribution-2248"><a href="#Laws.return_time_distribution-2248"><span class="linenos">2248</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.return_time_distribution-2249"><a href="#Laws.return_time_distribution-2249"><span class="linenos">2249</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.return_time_distribution-2250"><a href="#Laws.return_time_distribution-2250"><span class="linenos">2250</span></a>
</span><span id="Laws.return_time_distribution-2251"><a href="#Laws.return_time_distribution-2251"><span class="linenos">2251</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]})</span>
</span><span id="Laws.return_time_distribution-2252"><a href="#Laws.return_time_distribution-2252"><span class="linenos">2252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws.return_time_distribution-2253"><a href="#Laws.return_time_distribution-2253"><span class="linenos">2253</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]}</span>
</span><span id="Laws.return_time_distribution-2254"><a href="#Laws.return_time_distribution-2254"><span class="linenos">2254</span></a>            <span class="p">)</span>
</span><span id="Laws.return_time_distribution-2255"><a href="#Laws.return_time_distribution-2255"><span class="linenos">2255</span></a>
</span><span id="Laws.return_time_distribution-2256"><a href="#Laws.return_time_distribution-2256"><span class="linenos">2256</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws.return_time_distribution-2257"><a href="#Laws.return_time_distribution-2257"><span class="linenos">2257</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws.return_time_distribution-2258"><a href="#Laws.return_time_distribution-2258"><span class="linenos">2258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.return_time_distribution-2259"><a href="#Laws.return_time_distribution-2259"><span class="linenos">2259</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.return_time_distribution-2260"><a href="#Laws.return_time_distribution-2260"><span class="linenos">2260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.return_time_distribution-2261"><a href="#Laws.return_time_distribution-2261"><span class="linenos">2261</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.return_time_distribution-2262"><a href="#Laws.return_time_distribution-2262"><span class="linenos">2262</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.return_time_distribution-2263"><a href="#Laws.return_time_distribution-2263"><span class="linenos">2263</span></a>            <span class="p">)</span>
</span><span id="Laws.return_time_distribution-2264"><a href="#Laws.return_time_distribution-2264"><span class="linenos">2264</span></a>
</span><span id="Laws.return_time_distribution-2265"><a href="#Laws.return_time_distribution-2265"><span class="linenos">2265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.return_time_distribution-2266"><a href="#Laws.return_time_distribution-2266"><span class="linenos">2266</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.return_time_distribution-2267"><a href="#Laws.return_time_distribution-2267"><span class="linenos">2267</span></a>            <span class="p">)</span>
</span><span id="Laws.return_time_distribution-2268"><a href="#Laws.return_time_distribution-2268"><span class="linenos">2268</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.return_time_distribution-2269"><a href="#Laws.return_time_distribution-2269"><span class="linenos">2269</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.return_time_distribution-2270"><a href="#Laws.return_time_distribution-2270"><span class="linenos">2270</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.return_time_distribution-2271"><a href="#Laws.return_time_distribution-2271"><span class="linenos">2271</span></a>            <span class="p">)</span>
</span><span id="Laws.return_time_distribution-2272"><a href="#Laws.return_time_distribution-2272"><span class="linenos">2272</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.return_time_distribution-2273"><a href="#Laws.return_time_distribution-2273"><span class="linenos">2273</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.return_time_distribution-2274"><a href="#Laws.return_time_distribution-2274"><span class="linenos">2274</span></a>            <span class="p">)</span>
</span><span id="Laws.return_time_distribution-2275"><a href="#Laws.return_time_distribution-2275"><span class="linenos">2275</span></a>
</span><span id="Laws.return_time_distribution-2276"><a href="#Laws.return_time_distribution-2276"><span class="linenos">2276</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Laws.return_time_distribution-2277"><a href="#Laws.return_time_distribution-2277"><span class="linenos">2277</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.return_time_distribution-2278"><a href="#Laws.return_time_distribution-2278"><span class="linenos">2278</span></a>                    <span class="sa">f</span><span class="s2">&quot;At point </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">, the flexion point of the distributions was found&quot;</span>
</span><span id="Laws.return_time_distribution-2279"><a href="#Laws.return_time_distribution-2279"><span class="linenos">2279</span></a>                <span class="p">)</span>
</span><span id="Laws.return_time_distribution-2280"><a href="#Laws.return_time_distribution-2280"><span class="linenos">2280</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.return_time_distribution-2281"><a href="#Laws.return_time_distribution-2281"><span class="linenos">2281</span></a>                    <span class="sa">f</span><span class="s1">&#39;Left distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.return_time_distribution-2282"><a href="#Laws.return_time_distribution-2282"><span class="linenos">2282</span></a>                <span class="p">)</span>
</span><span id="Laws.return_time_distribution-2283"><a href="#Laws.return_time_distribution-2283"><span class="linenos">2283</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.return_time_distribution-2284"><a href="#Laws.return_time_distribution-2284"><span class="linenos">2284</span></a>                    <span class="sa">f</span><span class="s1">&#39;Right distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.return_time_distribution-2285"><a href="#Laws.return_time_distribution-2285"><span class="linenos">2285</span></a>                <span class="p">)</span>
</span><span id="Laws.return_time_distribution-2286"><a href="#Laws.return_time_distribution-2286"><span class="linenos">2286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.return_time_distribution-2287"><a href="#Laws.return_time_distribution-2287"><span class="linenos">2287</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.return_time_distribution-2288"><a href="#Laws.return_time_distribution-2288"><span class="linenos">2288</span></a>                <span class="p">)</span>
</span><span id="Laws.return_time_distribution-2289"><a href="#Laws.return_time_distribution-2289"><span class="linenos">2289</span></a>                <span class="n">plot_distribution</span><span class="p">,</span> <span class="n">plot_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_double_distribution</span><span class="p">(</span>
</span><span id="Laws.return_time_distribution-2290"><a href="#Laws.return_time_distribution-2290"><span class="linenos">2290</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.return_time_distribution-2291"><a href="#Laws.return_time_distribution-2291"><span class="linenos">2291</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
</span><span id="Laws.return_time_distribution-2292"><a href="#Laws.return_time_distribution-2292"><span class="linenos">2292</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
</span><span id="Laws.return_time_distribution-2293"><a href="#Laws.return_time_distribution-2293"><span class="linenos">2293</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
</span><span id="Laws.return_time_distribution-2294"><a href="#Laws.return_time_distribution-2294"><span class="linenos">2294</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
</span><span id="Laws.return_time_distribution-2295"><a href="#Laws.return_time_distribution-2295"><span class="linenos">2295</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.return_time_distribution-2296"><a href="#Laws.return_time_distribution-2296"><span class="linenos">2296</span></a>                <span class="p">)</span>
</span><span id="Laws.return_time_distribution-2297"><a href="#Laws.return_time_distribution-2297"><span class="linenos">2297</span></a>                <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.return_time_distribution-2298"><a href="#Laws.return_time_distribution-2298"><span class="linenos">2298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.return_time_distribution-2299"><a href="#Laws.return_time_distribution-2299"><span class="linenos">2299</span></a>                    <span class="n">plot_distribution</span><span class="p">,</span>
</span><span id="Laws.return_time_distribution-2300"><a href="#Laws.return_time_distribution-2300"><span class="linenos">2300</span></a>                    <span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.return_time_distribution-2301"><a href="#Laws.return_time_distribution-2301"><span class="linenos">2301</span></a>                    <span class="mi">60</span><span class="p">,</span>
</span><span id="Laws.return_time_distribution-2302"><a href="#Laws.return_time_distribution-2302"><span class="linenos">2302</span></a>                    <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Laws.return_time_distribution-2303"><a href="#Laws.return_time_distribution-2303"><span class="linenos">2303</span></a>                    <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.return_time_distribution-2304"><a href="#Laws.return_time_distribution-2304"><span class="linenos">2304</span></a>                <span class="p">)</span>
</span><span id="Laws.return_time_distribution-2305"><a href="#Laws.return_time_distribution-2305"><span class="linenos">2305</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.return_time_distribution-2306"><a href="#Laws.return_time_distribution-2306"><span class="linenos">2306</span></a>                    <span class="n">plot_models</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.return_time_distribution-2307"><a href="#Laws.return_time_distribution-2307"><span class="linenos">2307</span></a>                <span class="p">)</span>
</span><span id="Laws.return_time_distribution-2308"><a href="#Laws.return_time_distribution-2308"><span class="linenos">2308</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Computes the distribution of return times.</p>

<p>The function:</p>

<ul>
<li>Identifies return times based on revisited locations.</li>
<li>Fits a statistical distribution to the return time values.</li>
</ul>

<h2 id="parameters">Parameters:</h2>

<p>data : TrajectoriesFrame
    A trajectory dataset containing labeled locations and timestamps.</p>

<h2 id="returns">Returns:</h2>

<p>tuple:
    - model (distfit object): The fitted distribution model.
    - rt (pd.Series): The computed return time values.</p>
</div>


                            </div>
                            <div id="Laws.exploration_time" class="classattr">
                                        <input id="Laws.exploration_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">exploration_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.exploration_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.exploration_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.exploration_time-2248"><a href="#Laws.exploration_time-2248"><span class="linenos">2248</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.exploration_time-2249"><a href="#Laws.exploration_time-2249"><span class="linenos">2249</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.exploration_time-2250"><a href="#Laws.exploration_time-2250"><span class="linenos">2250</span></a>
</span><span id="Laws.exploration_time-2251"><a href="#Laws.exploration_time-2251"><span class="linenos">2251</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]})</span>
</span><span id="Laws.exploration_time-2252"><a href="#Laws.exploration_time-2252"><span class="linenos">2252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws.exploration_time-2253"><a href="#Laws.exploration_time-2253"><span class="linenos">2253</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]}</span>
</span><span id="Laws.exploration_time-2254"><a href="#Laws.exploration_time-2254"><span class="linenos">2254</span></a>            <span class="p">)</span>
</span><span id="Laws.exploration_time-2255"><a href="#Laws.exploration_time-2255"><span class="linenos">2255</span></a>
</span><span id="Laws.exploration_time-2256"><a href="#Laws.exploration_time-2256"><span class="linenos">2256</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws.exploration_time-2257"><a href="#Laws.exploration_time-2257"><span class="linenos">2257</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws.exploration_time-2258"><a href="#Laws.exploration_time-2258"><span class="linenos">2258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.exploration_time-2259"><a href="#Laws.exploration_time-2259"><span class="linenos">2259</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.exploration_time-2260"><a href="#Laws.exploration_time-2260"><span class="linenos">2260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.exploration_time-2261"><a href="#Laws.exploration_time-2261"><span class="linenos">2261</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.exploration_time-2262"><a href="#Laws.exploration_time-2262"><span class="linenos">2262</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.exploration_time-2263"><a href="#Laws.exploration_time-2263"><span class="linenos">2263</span></a>            <span class="p">)</span>
</span><span id="Laws.exploration_time-2264"><a href="#Laws.exploration_time-2264"><span class="linenos">2264</span></a>
</span><span id="Laws.exploration_time-2265"><a href="#Laws.exploration_time-2265"><span class="linenos">2265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.exploration_time-2266"><a href="#Laws.exploration_time-2266"><span class="linenos">2266</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.exploration_time-2267"><a href="#Laws.exploration_time-2267"><span class="linenos">2267</span></a>            <span class="p">)</span>
</span><span id="Laws.exploration_time-2268"><a href="#Laws.exploration_time-2268"><span class="linenos">2268</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.exploration_time-2269"><a href="#Laws.exploration_time-2269"><span class="linenos">2269</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.exploration_time-2270"><a href="#Laws.exploration_time-2270"><span class="linenos">2270</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.exploration_time-2271"><a href="#Laws.exploration_time-2271"><span class="linenos">2271</span></a>            <span class="p">)</span>
</span><span id="Laws.exploration_time-2272"><a href="#Laws.exploration_time-2272"><span class="linenos">2272</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.exploration_time-2273"><a href="#Laws.exploration_time-2273"><span class="linenos">2273</span></a>                <span class="n">results</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.exploration_time-2274"><a href="#Laws.exploration_time-2274"><span class="linenos">2274</span></a>            <span class="p">)</span>
</span><span id="Laws.exploration_time-2275"><a href="#Laws.exploration_time-2275"><span class="linenos">2275</span></a>
</span><span id="Laws.exploration_time-2276"><a href="#Laws.exploration_time-2276"><span class="linenos">2276</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Laws.exploration_time-2277"><a href="#Laws.exploration_time-2277"><span class="linenos">2277</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.exploration_time-2278"><a href="#Laws.exploration_time-2278"><span class="linenos">2278</span></a>                    <span class="sa">f</span><span class="s2">&quot;At point </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">, the flexion point of the distributions was found&quot;</span>
</span><span id="Laws.exploration_time-2279"><a href="#Laws.exploration_time-2279"><span class="linenos">2279</span></a>                <span class="p">)</span>
</span><span id="Laws.exploration_time-2280"><a href="#Laws.exploration_time-2280"><span class="linenos">2280</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.exploration_time-2281"><a href="#Laws.exploration_time-2281"><span class="linenos">2281</span></a>                    <span class="sa">f</span><span class="s1">&#39;Left distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.exploration_time-2282"><a href="#Laws.exploration_time-2282"><span class="linenos">2282</span></a>                <span class="p">)</span>
</span><span id="Laws.exploration_time-2283"><a href="#Laws.exploration_time-2283"><span class="linenos">2283</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.exploration_time-2284"><a href="#Laws.exploration_time-2284"><span class="linenos">2284</span></a>                    <span class="sa">f</span><span class="s1">&#39;Right distribution is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> with params: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.exploration_time-2285"><a href="#Laws.exploration_time-2285"><span class="linenos">2285</span></a>                <span class="p">)</span>
</span><span id="Laws.exploration_time-2286"><a href="#Laws.exploration_time-2286"><span class="linenos">2286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_distribution_table</span><span class="p">(</span>
</span><span id="Laws.exploration_time-2287"><a href="#Laws.exploration_time-2287"><span class="linenos">2287</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">]]</span>
</span><span id="Laws.exploration_time-2288"><a href="#Laws.exploration_time-2288"><span class="linenos">2288</span></a>                <span class="p">)</span>
</span><span id="Laws.exploration_time-2289"><a href="#Laws.exploration_time-2289"><span class="linenos">2289</span></a>                <span class="n">plot_distribution</span><span class="p">,</span> <span class="n">plot_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_double_distribution</span><span class="p">(</span>
</span><span id="Laws.exploration_time-2290"><a href="#Laws.exploration_time-2290"><span class="linenos">2290</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.exploration_time-2291"><a href="#Laws.exploration_time-2291"><span class="linenos">2291</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
</span><span id="Laws.exploration_time-2292"><a href="#Laws.exploration_time-2292"><span class="linenos">2292</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
</span><span id="Laws.exploration_time-2293"><a href="#Laws.exploration_time-2293"><span class="linenos">2293</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
</span><span id="Laws.exploration_time-2294"><a href="#Laws.exploration_time-2294"><span class="linenos">2294</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
</span><span id="Laws.exploration_time-2295"><a href="#Laws.exploration_time-2295"><span class="linenos">2295</span></a>                    <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Laws.exploration_time-2296"><a href="#Laws.exploration_time-2296"><span class="linenos">2296</span></a>                <span class="p">)</span>
</span><span id="Laws.exploration_time-2297"><a href="#Laws.exploration_time-2297"><span class="linenos">2297</span></a>                <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.exploration_time-2298"><a href="#Laws.exploration_time-2298"><span class="linenos">2298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.exploration_time-2299"><a href="#Laws.exploration_time-2299"><span class="linenos">2299</span></a>                    <span class="n">plot_distribution</span><span class="p">,</span>
</span><span id="Laws.exploration_time-2300"><a href="#Laws.exploration_time-2300"><span class="linenos">2300</span></a>                    <span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.exploration_time-2301"><a href="#Laws.exploration_time-2301"><span class="linenos">2301</span></a>                    <span class="mi">60</span><span class="p">,</span>
</span><span id="Laws.exploration_time-2302"><a href="#Laws.exploration_time-2302"><span class="linenos">2302</span></a>                    <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Laws.exploration_time-2303"><a href="#Laws.exploration_time-2303"><span class="linenos">2303</span></a>                    <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.exploration_time-2304"><a href="#Laws.exploration_time-2304"><span class="linenos">2304</span></a>                <span class="p">)</span>
</span><span id="Laws.exploration_time-2305"><a href="#Laws.exploration_time-2305"><span class="linenos">2305</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.exploration_time-2306"><a href="#Laws.exploration_time-2306"><span class="linenos">2306</span></a>                    <span class="n">plot_models</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span>
</span><span id="Laws.exploration_time-2307"><a href="#Laws.exploration_time-2307"><span class="linenos">2307</span></a>                <span class="p">)</span>
</span><span id="Laws.exploration_time-2308"><a href="#Laws.exploration_time-2308"><span class="linenos">2308</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Computes the distribution of exploration times.</p>

<p>The function:</p>

<ul>
<li>Identifies exploration periods as the time spent in
newly visited locations.</li>
<li>Fits a statistical distribution to the exploration time values.</li>
</ul>

<h2 id="parameters">Parameters:</h2>

<p>data : TrajectoriesFrame
    A trajectory dataset containing labeled locations and timestamps.</p>

<h2 id="returns">Returns:</h2>

<p>tuple:
    - model (distfit object): The fitted distribution model.
    - et (pd.Series): The computed exploration time values.</p>
</div>


                            </div>
                            <div id="Laws.msd_curve_split" class="classattr">
                                        <input id="Laws.msd_curve_split-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">msd_curve_split</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.msd_curve_split-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.msd_curve_split"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.msd_curve_split-2404"><a href="#Laws.msd_curve_split-2404"><span class="linenos">2404</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.msd_curve_split-2405"><a href="#Laws.msd_curve_split-2405"><span class="linenos">2405</span></a>            <span class="n">msd_results</span><span class="p">,</span> <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws.msd_curve_split-2406"><a href="#Laws.msd_curve_split-2406"><span class="linenos">2406</span></a>            <span class="n">msd_curve</span> <span class="o">=</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws.msd_curve_split-2407"><a href="#Laws.msd_curve_split-2407"><span class="linenos">2407</span></a>                <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;RoG range [km]&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span>
</span><span id="Laws.msd_curve_split-2408"><a href="#Laws.msd_curve_split-2408"><span class="linenos">2408</span></a>            <span class="p">)</span>
</span><span id="Laws.msd_curve_split-2409"><a href="#Laws.msd_curve_split-2409"><span class="linenos">2409</span></a>            <span class="n">msd_curve_params</span> <span class="o">=</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="Laws.msd_curve_split-2410"><a href="#Laws.msd_curve_split-2410"><span class="linenos">2410</span></a>                <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;RoG range [km]&quot;</span><span class="p">]</span>
</span><span id="Laws.msd_curve_split-2411"><a href="#Laws.msd_curve_split-2411"><span class="linenos">2411</span></a>                <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
</span><span id="Laws.msd_curve_split-2412"><a href="#Laws.msd_curve_split-2412"><span class="linenos">2412</span></a>                <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span>
</span><span id="Laws.msd_curve_split-2413"><a href="#Laws.msd_curve_split-2413"><span class="linenos">2413</span></a>                <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</span><span id="Laws.msd_curve_split-2414"><a href="#Laws.msd_curve_split-2414"><span class="linenos">2414</span></a>                <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
</span><span id="Laws.msd_curve_split-2415"><a href="#Laws.msd_curve_split-2415"><span class="linenos">2415</span></a>                <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="Laws.msd_curve_split-2416"><a href="#Laws.msd_curve_split-2416"><span class="linenos">2416</span></a>                <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
</span><span id="Laws.msd_curve_split-2417"><a href="#Laws.msd_curve_split-2417"><span class="linenos">2417</span></a>                <span class="o">+</span> <span class="n">msd_results</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="Laws.msd_curve_split-2418"><a href="#Laws.msd_curve_split-2418"><span class="linenos">2418</span></a>            <span class="p">)</span>
</span><span id="Laws.msd_curve_split-2419"><a href="#Laws.msd_curve_split-2419"><span class="linenos">2419</span></a>
</span><span id="Laws.msd_curve_split-2420"><a href="#Laws.msd_curve_split-2420"><span class="linenos">2420</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;msd_curve&quot;</span><span class="p">:</span> <span class="n">msd_curve</span><span class="p">})</span>
</span><span id="Laws.msd_curve_split-2421"><a href="#Laws.msd_curve_split-2421"><span class="linenos">2421</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;msd_curve_params&quot;</span><span class="p">:</span> <span class="n">msd_curve_params</span><span class="p">})</span>
</span><span id="Laws.msd_curve_split-2422"><a href="#Laws.msd_curve_split-2422"><span class="linenos">2422</span></a>
</span><span id="Laws.msd_curve_split-2423"><a href="#Laws.msd_curve_split-2423"><span class="linenos">2423</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.msd_curve_split-2424"><a href="#Laws.msd_curve_split-2424"><span class="linenos">2424</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="s2">&quot;MSD split&quot;</span><span class="p">)</span>
</span><span id="Laws.msd_curve_split-2425"><a href="#Laws.msd_curve_split-2425"><span class="linenos">2425</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.msd_curve_split-2426"><a href="#Laws.msd_curve_split-2426"><span class="linenos">2426</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="Laws.msd_curve_split-2427"><a href="#Laws.msd_curve_split-2427"><span class="linenos">2427</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_msd_split_table</span><span class="p">(</span><span class="n">msd_results</span><span class="p">)</span>
</span><span id="Laws.msd_curve_split-2428"><a href="#Laws.msd_curve_split-2428"><span class="linenos">2428</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.msd_curve_split-2429"><a href="#Laws.msd_curve_split-2429"><span class="linenos">2429</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj</span><span class="p">,</span>
</span><span id="Laws.msd_curve_split-2430"><a href="#Laws.msd_curve_split-2430"><span class="linenos">2430</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.msd_curve_split-2431"><a href="#Laws.msd_curve_split-2431"><span class="linenos">2431</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws.msd_curve_split-2432"><a href="#Laws.msd_curve_split-2432"><span class="linenos">2432</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span>
</span><span id="Laws.msd_curve_split-2433"><a href="#Laws.msd_curve_split-2433"><span class="linenos">2433</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.msd_curve_split-2434"><a href="#Laws.msd_curve_split-2434"><span class="linenos">2434</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes and groups MSD curves based on the radius of gyration (RoG).</p>

<p>The function:</p>

<ul>
<li>Converts trajectory data to a GeoDataFrame.</li>
<li>Computes the center of mass and starting points for each trajectory.</li>
<li>Filters data to only include new explorations.</li>
<li>Computes MSD and RoG values for each group.</li>
<li>Groups MSD curves based on RoG bins and fits curves to them.</li>
</ul>

<h2 id="parameters">Parameters:</h2>

<p>data : pd.DataFrame
    A dataset containing longitude and latitude coordinates.</p>

<h2 id="returns">Returns:</h2>

<p>tuple:
    - msd_results (pd.DataFrame): Summary of MSD curve fitting for
        different RoG ranges.
    - buffer (BytesIO): A buffer containing the saved MSD plot.</p>
</div>


                            </div>
                            <div id="Laws.distinct_locations_over_time" class="classattr">
                                        <input id="Laws.distinct_locations_over_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">distinct_locations_over_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.distinct_locations_over_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.distinct_locations_over_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.distinct_locations_over_time-2183"><a href="#Laws.distinct_locations_over_time-2183"><span class="linenos">2183</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.distinct_locations_over_time-2184"><a href="#Laws.distinct_locations_over_time-2184"><span class="linenos">2184</span></a>            <span class="n">func_name</span><span class="p">,</span> <span class="n">best_fit</span><span class="p">,</span> <span class="n">param_frame</span><span class="p">,</span> <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Laws.distinct_locations_over_time-2185"><a href="#Laws.distinct_locations_over_time-2185"><span class="linenos">2185</span></a>            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">param_frame</span><span class="p">[</span><span class="n">param_frame</span><span class="p">[</span><span class="s2">&quot;curve&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_fit</span><span class="p">]</span>
</span><span id="Laws.distinct_locations_over_time-2186"><a href="#Laws.distinct_locations_over_time-2186"><span class="linenos">2186</span></a>
</span><span id="Laws.distinct_locations_over_time-2187"><a href="#Laws.distinct_locations_over_time-2187"><span class="linenos">2187</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="n">func_name</span><span class="p">:</span> <span class="n">best_fit</span><span class="p">})</span>
</span><span id="Laws.distinct_locations_over_time-2188"><a href="#Laws.distinct_locations_over_time-2188"><span class="linenos">2188</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="Laws.distinct_locations_over_time-2189"><a href="#Laws.distinct_locations_over_time-2189"><span class="linenos">2189</span></a>                <span class="p">{</span>
</span><span id="Laws.distinct_locations_over_time-2190"><a href="#Laws.distinct_locations_over_time-2190"><span class="linenos">2190</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">_params&quot;</span><span class="p">:</span> <span class="n">filtered_df</span><span class="p">[</span>
</span><span id="Laws.distinct_locations_over_time-2191"><a href="#Laws.distinct_locations_over_time-2191"><span class="linenos">2191</span></a>                        <span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">,</span> <span class="s2">&quot;param2&quot;</span><span class="p">]</span>
</span><span id="Laws.distinct_locations_over_time-2192"><a href="#Laws.distinct_locations_over_time-2192"><span class="linenos">2192</span></a>                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Laws.distinct_locations_over_time-2193"><a href="#Laws.distinct_locations_over_time-2193"><span class="linenos">2193</span></a>                <span class="p">}</span>
</span><span id="Laws.distinct_locations_over_time-2194"><a href="#Laws.distinct_locations_over_time-2194"><span class="linenos">2194</span></a>            <span class="p">)</span>
</span><span id="Laws.distinct_locations_over_time-2195"><a href="#Laws.distinct_locations_over_time-2195"><span class="linenos">2195</span></a>
</span><span id="Laws.distinct_locations_over_time-2196"><a href="#Laws.distinct_locations_over_time-2196"><span class="linenos">2196</span></a>            <span class="n">func_name</span> <span class="o">=</span> <span class="n">func_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="Laws.distinct_locations_over_time-2197"><a href="#Laws.distinct_locations_over_time-2197"><span class="linenos">2197</span></a>            <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</span><span id="Laws.distinct_locations_over_time-2198"><a href="#Laws.distinct_locations_over_time-2198"><span class="linenos">2198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.distinct_locations_over_time-2199"><a href="#Laws.distinct_locations_over_time-2199"><span class="linenos">2199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.distinct_locations_over_time-2200"><a href="#Laws.distinct_locations_over_time-2200"><span class="linenos">2200</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.distinct_locations_over_time-2201"><a href="#Laws.distinct_locations_over_time-2201"><span class="linenos">2201</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span>
</span><span id="Laws.distinct_locations_over_time-2202"><a href="#Laws.distinct_locations_over_time-2202"><span class="linenos">2202</span></a>                <span class="sa">f</span><span class="s1">&#39;Best fit: </span><span class="si">{</span><span class="n">best_fit</span><span class="si">}</span><span class="s1"> with Param 1: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">,&#39;</span>
</span><span id="Laws.distinct_locations_over_time-2203"><a href="#Laws.distinct_locations_over_time-2203"><span class="linenos">2203</span></a>                <span class="sa">f</span><span class="s1">&#39;Param 2: </span><span class="si">{</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;param2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Laws.distinct_locations_over_time-2204"><a href="#Laws.distinct_locations_over_time-2204"><span class="linenos">2204</span></a>            <span class="p">)</span>
</span><span id="Laws.distinct_locations_over_time-2205"><a href="#Laws.distinct_locations_over_time-2205"><span class="linenos">2205</span></a>
</span><span id="Laws.distinct_locations_over_time-2206"><a href="#Laws.distinct_locations_over_time-2206"><span class="linenos">2206</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.distinct_locations_over_time-2207"><a href="#Laws.distinct_locations_over_time-2207"><span class="linenos">2207</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_curves_table</span><span class="p">(</span>
</span><span id="Laws.distinct_locations_over_time-2208"><a href="#Laws.distinct_locations_over_time-2208"><span class="linenos">2208</span></a>                <span class="n">param_frame</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="n">y_position_global</span> <span class="o">+</span> <span class="mi">13</span>
</span><span id="Laws.distinct_locations_over_time-2209"><a href="#Laws.distinct_locations_over_time-2209"><span class="linenos">2209</span></a>            <span class="p">)</span>
</span><span id="Laws.distinct_locations_over_time-2210"><a href="#Laws.distinct_locations_over_time-2210"><span class="linenos">2210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.distinct_locations_over_time-2211"><a href="#Laws.distinct_locations_over_time-2211"><span class="linenos">2211</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj</span><span class="p">,</span>
</span><span id="Laws.distinct_locations_over_time-2212"><a href="#Laws.distinct_locations_over_time-2212"><span class="linenos">2212</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.distinct_locations_over_time-2213"><a href="#Laws.distinct_locations_over_time-2213"><span class="linenos">2213</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws.distinct_locations_over_time-2214"><a href="#Laws.distinct_locations_over_time-2214"><span class="linenos">2214</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span>
</span><span id="Laws.distinct_locations_over_time-2215"><a href="#Laws.distinct_locations_over_time-2215"><span class="linenos">2215</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.distinct_locations_over_time-2216"><a href="#Laws.distinct_locations_over_time-2216"><span class="linenos">2216</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes the number of distinct locations visited over time.</p>

<p>The function:</p>

<ul>
<li>Computes the cumulative number of distinct locations visited.</li>
<li>Fits a curve to model the growth of visited locations over time.</li>
</ul>

<h2 id="parameters">Parameters:</h2>

<p>nrows : int
    Number of rows in the dataset.
n_data : int
    Total data points available.
data : pd.Series
    A dataset containing the count of distinct locations.</p>

<h2 id="returns">Returns:</h2>

<p>tuple:
    - best_fit (str): Name of the best fitting model.
    - global_params (dict): Parameters of the best fit.
    - y_pred (ndarray): Predicted values from the curve fit.
    - expon_y_pred (ndarray): Alternative exponential model
        predictions.
    - pd.Series(data): The input data as a pandas Series.
    - ["t", "S(t)"] (list): Column labels.</p>
</div>


                            </div>
                            <div id="Laws.estimate_pnew" class="classattr">
                                        <input id="Laws.estimate_pnew-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_pnew</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Laws.estimate_pnew-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Laws.estimate_pnew"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Laws.estimate_pnew-2342"><a href="#Laws.estimate_pnew-2342"><span class="linenos">2342</span></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Laws.estimate_pnew-2343"><a href="#Laws.estimate_pnew-2343"><span class="linenos">2343</span></a>            <span class="n">rho_est</span><span class="p">,</span> <span class="n">gamma_est</span><span class="p">,</span> <span class="n">DeltaS</span><span class="p">,</span> <span class="n">S_mid</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span>
</span><span id="Laws.estimate_pnew-2344"><a href="#Laws.estimate_pnew-2344"><span class="linenos">2344</span></a>                <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Laws.estimate_pnew-2345"><a href="#Laws.estimate_pnew-2345"><span class="linenos">2345</span></a>            <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Laws.estimate_pnew-2346"><a href="#Laws.estimate_pnew-2346"><span class="linenos">2346</span></a>
</span><span id="Laws.estimate_pnew-2347"><a href="#Laws.estimate_pnew-2347"><span class="linenos">2347</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;rho&quot;</span><span class="p">:</span> <span class="n">rho_est</span><span class="p">})</span>
</span><span id="Laws.estimate_pnew-2348"><a href="#Laws.estimate_pnew-2348"><span class="linenos">2348</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">gamma_est</span><span class="p">})</span>
</span><span id="Laws.estimate_pnew-2349"><a href="#Laws.estimate_pnew-2349"><span class="linenos">2349</span></a>
</span><span id="Laws.estimate_pnew-2350"><a href="#Laws.estimate_pnew-2350"><span class="linenos">2350</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Laws.estimate_pnew-2351"><a href="#Laws.estimate_pnew-2351"><span class="linenos">2351</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="s2">&quot;Pnew estimation&quot;</span><span class="p">)</span>
</span><span id="Laws.estimate_pnew-2352"><a href="#Laws.estimate_pnew-2352"><span class="linenos">2352</span></a>
</span><span id="Laws.estimate_pnew-2353"><a href="#Laws.estimate_pnew-2353"><span class="linenos">2353</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="Laws.estimate_pnew-2354"><a href="#Laws.estimate_pnew-2354"><span class="linenos">2354</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
</span><span id="Laws.estimate_pnew-2355"><a href="#Laws.estimate_pnew-2355"><span class="linenos">2355</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Laws.estimate_pnew-2356"><a href="#Laws.estimate_pnew-2356"><span class="linenos">2356</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;gamma  = </span><span class="si">{</span><span class="n">gamma_est</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.estimate_pnew-2357"><a href="#Laws.estimate_pnew-2357"><span class="linenos">2357</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_cell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;rho  = </span><span class="si">{</span><span class="n">rho_est</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Laws.estimate_pnew-2358"><a href="#Laws.estimate_pnew-2358"><span class="linenos">2358</span></a>            <span class="n">y_position_global</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_object</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>
</span><span id="Laws.estimate_pnew-2359"><a href="#Laws.estimate_pnew-2359"><span class="linenos">2359</span></a>            <span class="n">plot_obj1</span><span class="p">,</span> <span class="n">plot_obj2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_P_new</span><span class="p">(</span>
</span><span id="Laws.estimate_pnew-2360"><a href="#Laws.estimate_pnew-2360"><span class="linenos">2360</span></a>                <span class="n">rho_est</span><span class="p">,</span> <span class="n">gamma_est</span><span class="p">,</span> <span class="n">DeltaS</span><span class="p">,</span> <span class="n">S_mid</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span>
</span><span id="Laws.estimate_pnew-2361"><a href="#Laws.estimate_pnew-2361"><span class="linenos">2361</span></a>            <span class="p">)</span>
</span><span id="Laws.estimate_pnew-2362"><a href="#Laws.estimate_pnew-2362"><span class="linenos">2362</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.estimate_pnew-2363"><a href="#Laws.estimate_pnew-2363"><span class="linenos">2363</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj1</span><span class="p">,</span>
</span><span id="Laws.estimate_pnew-2364"><a href="#Laws.estimate_pnew-2364"><span class="linenos">2364</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.estimate_pnew-2365"><a href="#Laws.estimate_pnew-2365"><span class="linenos">2365</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws.estimate_pnew-2366"><a href="#Laws.estimate_pnew-2366"><span class="linenos">2366</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Laws.estimate_pnew-2367"><a href="#Laws.estimate_pnew-2367"><span class="linenos">2367</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.estimate_pnew-2368"><a href="#Laws.estimate_pnew-2368"><span class="linenos">2368</span></a>            <span class="p">)</span>
</span><span id="Laws.estimate_pnew-2369"><a href="#Laws.estimate_pnew-2369"><span class="linenos">2369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdf_plot</span><span class="p">(</span>
</span><span id="Laws.estimate_pnew-2370"><a href="#Laws.estimate_pnew-2370"><span class="linenos">2370</span></a>                <span class="n">plot_obj</span><span class="o">=</span><span class="n">plot_obj2</span><span class="p">,</span>
</span><span id="Laws.estimate_pnew-2371"><a href="#Laws.estimate_pnew-2371"><span class="linenos">2371</span></a>                <span class="n">image_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="Laws.estimate_pnew-2372"><a href="#Laws.estimate_pnew-2372"><span class="linenos">2372</span></a>                <span class="n">image_height</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span><span id="Laws.estimate_pnew-2373"><a href="#Laws.estimate_pnew-2373"><span class="linenos">2373</span></a>                <span class="n">x_position</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span>
</span><span id="Laws.estimate_pnew-2374"><a href="#Laws.estimate_pnew-2374"><span class="linenos">2374</span></a>                <span class="n">y_position</span><span class="o">=</span><span class="n">y_position_global</span><span class="p">,</span>
</span><span id="Laws.estimate_pnew-2375"><a href="#Laws.estimate_pnew-2375"><span class="linenos">2375</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Estimates parameters (rho, gamma) for the probability of
discovering new locations.</p>

<p>The function:</p>

<ul>
<li>Computes the rate of discovery of new locations (P_new).</li>
<li>Fits a linear model in log-log space to estimate the parameters.</li>
</ul>

<h2 id="parameters">Parameters:</h2>

<p>nrows : int
    Number of rows in the dataset.
n_data : int
    Total data points available.
S_t : list or np.array
    Sequence of distinct locations visited over time.</p>

<h2 id="returns">Returns:</h2>

<p>tuple:
    - rho_hat (float): Estimated rho parameter.
    - gamma_hat (float): Estimated gamma parameter.
    - DeltaS (np.array): Changes in S(t).
    - S_mid (np.array): Midpoints of S(t).
    - intercept (float): Intercept of the log-log regression.
    - slope (float): Slope of the log-log regression (negative gamma).
    - nrows (int): Number of rows in the dataset.
    - n_data (int): Total data points available.</p>
</div>


                            </div>
                </section>
                <section id="ScalingLawsCalc">
                            <input id="ScalingLawsCalc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ScalingLawsCalc</span>:

                <label class="view-source-button" for="ScalingLawsCalc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScalingLawsCalc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalingLawsCalc-3422"><a href="#ScalingLawsCalc-3422"><span class="linenos">3422</span></a><span class="k">class</span> <span class="nc">ScalingLawsCalc</span><span class="p">:</span>
</span><span id="ScalingLawsCalc-3423"><a href="#ScalingLawsCalc-3423"><span class="linenos">3423</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc-3424"><a href="#ScalingLawsCalc-3424"><span class="linenos">3424</span></a><span class="sd">    A class for processing animal trajectory data, performing</span>
</span><span id="ScalingLawsCalc-3425"><a href="#ScalingLawsCalc-3425"><span class="linenos">3425</span></a><span class="sd">    statistical analyses, and generating a PDF report with results.</span>
</span><span id="ScalingLawsCalc-3426"><a href="#ScalingLawsCalc-3426"><span class="linenos">3426</span></a>
</span><span id="ScalingLawsCalc-3427"><a href="#ScalingLawsCalc-3427"><span class="linenos">3427</span></a><span class="sd">    Attributes:</span>
</span><span id="ScalingLawsCalc-3428"><a href="#ScalingLawsCalc-3428"><span class="linenos">3428</span></a><span class="sd">        data (TrajectoriesFrame): The trajectory data of animals.</span>
</span><span id="ScalingLawsCalc-3429"><a href="#ScalingLawsCalc-3429"><span class="linenos">3429</span></a><span class="sd">        animal_name (str): Name of the dataset.</span>
</span><span id="ScalingLawsCalc-3430"><a href="#ScalingLawsCalc-3430"><span class="linenos">3430</span></a><span class="sd">        output_dir (str): Directory to store the output files.</span>
</span><span id="ScalingLawsCalc-3431"><a href="#ScalingLawsCalc-3431"><span class="linenos">3431</span></a><span class="sd">        output_dir_animal (str): Path for the specific dataset output.</span>
</span><span id="ScalingLawsCalc-3432"><a href="#ScalingLawsCalc-3432"><span class="linenos">3432</span></a><span class="sd">        pdf (FPDF): PDF object to generate reports.</span>
</span><span id="ScalingLawsCalc-3433"><a href="#ScalingLawsCalc-3433"><span class="linenos">3433</span></a><span class="sd">        stats_frame (DataSetStats): Object for tracking dataset statistics.</span>
</span><span id="ScalingLawsCalc-3434"><a href="#ScalingLawsCalc-3434"><span class="linenos">3434</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc-3435"><a href="#ScalingLawsCalc-3435"><span class="linenos">3435</span></a>
</span><span id="ScalingLawsCalc-3436"><a href="#ScalingLawsCalc-3436"><span class="linenos">3436</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3437"><a href="#ScalingLawsCalc-3437"><span class="linenos">3437</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ScalingLawsCalc-3438"><a href="#ScalingLawsCalc-3438"><span class="linenos">3438</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span>
</span><span id="ScalingLawsCalc-3439"><a href="#ScalingLawsCalc-3439"><span class="linenos">3439</span></a>        <span class="n">data_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="ScalingLawsCalc-3440"><a href="#ScalingLawsCalc-3440"><span class="linenos">3440</span></a>        <span class="n">output_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="ScalingLawsCalc-3441"><a href="#ScalingLawsCalc-3441"><span class="linenos">3441</span></a>        <span class="n">stats_frame</span><span class="p">:</span> <span class="n">DataSetStats</span><span class="p">,</span>
</span><span id="ScalingLawsCalc-3442"><a href="#ScalingLawsCalc-3442"><span class="linenos">3442</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ScalingLawsCalc-3443"><a href="#ScalingLawsCalc-3443"><span class="linenos">3443</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc-3444"><a href="#ScalingLawsCalc-3444"><span class="linenos">3444</span></a><span class="sd">        Initializes the ScalingLawsCalc class.</span>
</span><span id="ScalingLawsCalc-3445"><a href="#ScalingLawsCalc-3445"><span class="linenos">3445</span></a>
</span><span id="ScalingLawsCalc-3446"><a href="#ScalingLawsCalc-3446"><span class="linenos">3446</span></a><span class="sd">        Args:</span>
</span><span id="ScalingLawsCalc-3447"><a href="#ScalingLawsCalc-3447"><span class="linenos">3447</span></a><span class="sd">            data (TrajectoriesFrame): The trajectory dataset.</span>
</span><span id="ScalingLawsCalc-3448"><a href="#ScalingLawsCalc-3448"><span class="linenos">3448</span></a><span class="sd">            data_name (str): The name of the dataset.</span>
</span><span id="ScalingLawsCalc-3449"><a href="#ScalingLawsCalc-3449"><span class="linenos">3449</span></a><span class="sd">            output_dir (str): Directory to save output files.</span>
</span><span id="ScalingLawsCalc-3450"><a href="#ScalingLawsCalc-3450"><span class="linenos">3450</span></a><span class="sd">            stats_frame (DataSetStats): Object to store statistics</span>
</span><span id="ScalingLawsCalc-3451"><a href="#ScalingLawsCalc-3451"><span class="linenos">3451</span></a><span class="sd">                of the dataset.</span>
</span><span id="ScalingLawsCalc-3452"><a href="#ScalingLawsCalc-3452"><span class="linenos">3452</span></a>
</span><span id="ScalingLawsCalc-3453"><a href="#ScalingLawsCalc-3453"><span class="linenos">3453</span></a><span class="sd">        Raises:</span>
</span><span id="ScalingLawsCalc-3454"><a href="#ScalingLawsCalc-3454"><span class="linenos">3454</span></a><span class="sd">            FileExistsError: If the output directory for the dataset</span>
</span><span id="ScalingLawsCalc-3455"><a href="#ScalingLawsCalc-3455"><span class="linenos">3455</span></a><span class="sd">                already exists.</span>
</span><span id="ScalingLawsCalc-3456"><a href="#ScalingLawsCalc-3456"><span class="linenos">3456</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc-3457"><a href="#ScalingLawsCalc-3457"><span class="linenos">3457</span></a>
</span><span id="ScalingLawsCalc-3458"><a href="#ScalingLawsCalc-3458"><span class="linenos">3458</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="ScalingLawsCalc-3459"><a href="#ScalingLawsCalc-3459"><span class="linenos">3459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span> <span class="o">=</span> <span class="n">data_name</span>
</span><span id="ScalingLawsCalc-3460"><a href="#ScalingLawsCalc-3460"><span class="linenos">3460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">output_dir</span>
</span><span id="ScalingLawsCalc-3461"><a href="#ScalingLawsCalc-3461"><span class="linenos">3461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">data_name</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3462"><a href="#ScalingLawsCalc-3462"><span class="linenos">3462</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span> <span class="o">=</span> <span class="n">FPDF</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3463"><a href="#ScalingLawsCalc-3463"><span class="linenos">3463</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span> <span class="o">=</span> <span class="n">stats_frame</span>
</span><span id="ScalingLawsCalc-3464"><a href="#ScalingLawsCalc-3464"><span class="linenos">3464</span></a>
</span><span id="ScalingLawsCalc-3465"><a href="#ScalingLawsCalc-3465"><span class="linenos">3465</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ScalingLawsCalc-3466"><a href="#ScalingLawsCalc-3466"><span class="linenos">3466</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3467"><a href="#ScalingLawsCalc-3467"><span class="linenos">3467</span></a>        <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
</span><span id="ScalingLawsCalc-3468"><a href="#ScalingLawsCalc-3468"><span class="linenos">3468</span></a>            <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3469"><a href="#ScalingLawsCalc-3469"><span class="linenos">3469</span></a>                <span class="sa">f</span><span class="s2">&quot;The directory </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span><span class="si">}</span><span class="s2"> already exists. &quot;</span>
</span><span id="ScalingLawsCalc-3470"><a href="#ScalingLawsCalc-3470"><span class="linenos">3470</span></a>                <span class="sa">f</span><span class="s2">&quot;Please remove it or specify a different name.&quot;</span>
</span><span id="ScalingLawsCalc-3471"><a href="#ScalingLawsCalc-3471"><span class="linenos">3471</span></a>            <span class="p">)</span>
</span><span id="ScalingLawsCalc-3472"><a href="#ScalingLawsCalc-3472"><span class="linenos">3472</span></a>
</span><span id="ScalingLawsCalc-3473"><a href="#ScalingLawsCalc-3473"><span class="linenos">3473</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3474"><a href="#ScalingLawsCalc-3474"><span class="linenos">3474</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">set_auto_page_break</span><span class="p">(</span><span class="n">auto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3475"><a href="#ScalingLawsCalc-3475"><span class="linenos">3475</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3476"><a href="#ScalingLawsCalc-3476"><span class="linenos">3476</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3477"><a href="#ScalingLawsCalc-3477"><span class="linenos">3477</span></a>            <span class="mi">200</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ln</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="ScalingLawsCalc-3478"><a href="#ScalingLawsCalc-3478"><span class="linenos">3478</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3479"><a href="#ScalingLawsCalc-3479"><span class="linenos">3479</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3480"><a href="#ScalingLawsCalc-3480"><span class="linenos">3480</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3481"><a href="#ScalingLawsCalc-3481"><span class="linenos">3481</span></a>
</span><span id="ScalingLawsCalc-3482"><a href="#ScalingLawsCalc-3482"><span class="linenos">3482</span></a>
</span><span id="ScalingLawsCalc-3483"><a href="#ScalingLawsCalc-3483"><span class="linenos">3483</span></a>    <span class="k">def</span> <span class="nf">_preprocess_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoriesFrame</span><span class="p">:</span>
</span><span id="ScalingLawsCalc-3484"><a href="#ScalingLawsCalc-3484"><span class="linenos">3484</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc-3485"><a href="#ScalingLawsCalc-3485"><span class="linenos">3485</span></a><span class="sd">        Preprocesses the trajectory data by filtering, converting</span>
</span><span id="ScalingLawsCalc-3486"><a href="#ScalingLawsCalc-3486"><span class="linenos">3486</span></a><span class="sd">        coordinate systems, and calculating summary statistics.</span>
</span><span id="ScalingLawsCalc-3487"><a href="#ScalingLawsCalc-3487"><span class="linenos">3487</span></a>
</span><span id="ScalingLawsCalc-3488"><a href="#ScalingLawsCalc-3488"><span class="linenos">3488</span></a><span class="sd">        Returns:</span>
</span><span id="ScalingLawsCalc-3489"><a href="#ScalingLawsCalc-3489"><span class="linenos">3489</span></a><span class="sd">            TrajectoriesFrame: The preprocessed trajectory data.</span>
</span><span id="ScalingLawsCalc-3490"><a href="#ScalingLawsCalc-3490"><span class="linenos">3490</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc-3491"><a href="#ScalingLawsCalc-3491"><span class="linenos">3491</span></a>
</span><span id="ScalingLawsCalc-3492"><a href="#ScalingLawsCalc-3492"><span class="linenos">3492</span></a>        <span class="n">preproc</span> <span class="o">=</span> <span class="n">Prepocessing</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3493"><a href="#ScalingLawsCalc-3493"><span class="linenos">3493</span></a>        <span class="n">stats</span> <span class="o">=</span> <span class="n">Stats</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3494"><a href="#ScalingLawsCalc-3494"><span class="linenos">3494</span></a>        <span class="n">mean_points_values</span> <span class="o">=</span> <span class="n">preproc</span><span class="o">.</span><span class="n">get_mean_points</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3495"><a href="#ScalingLawsCalc-3495"><span class="linenos">3495</span></a>        <span class="n">compressed_points</span> <span class="o">=</span> <span class="n">preproc</span><span class="o">.</span><span class="n">set_start_stop_time</span><span class="p">(</span><span class="n">mean_points_values</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3496"><a href="#ScalingLawsCalc-3496"><span class="linenos">3496</span></a>        <span class="n">converted_to_cartesian</span> <span class="o">=</span> <span class="n">preproc</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">compressed_points</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3497"><a href="#ScalingLawsCalc-3497"><span class="linenos">3497</span></a>        <span class="n">filtered_animals</span> <span class="o">=</span> <span class="n">preproc</span><span class="o">.</span><span class="n">filter_by_quartiles</span><span class="p">(</span><span class="n">converted_to_cartesian</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3498"><a href="#ScalingLawsCalc-3498"><span class="linenos">3498</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;animal_no&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_animals_no</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)})</span>
</span><span id="ScalingLawsCalc-3499"><a href="#ScalingLawsCalc-3499"><span class="linenos">3499</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3500"><a href="#ScalingLawsCalc-3500"><span class="linenos">3500</span></a>            <span class="p">{</span><span class="s2">&quot;animal_after_filtration&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_animals_no</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="ScalingLawsCalc-3501"><a href="#ScalingLawsCalc-3501"><span class="linenos">3501</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3502"><a href="#ScalingLawsCalc-3502"><span class="linenos">3502</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;time_period&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_period</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)})</span>
</span><span id="ScalingLawsCalc-3503"><a href="#ScalingLawsCalc-3503"><span class="linenos">3503</span></a>
</span><span id="ScalingLawsCalc-3504"><a href="#ScalingLawsCalc-3504"><span class="linenos">3504</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3505"><a href="#ScalingLawsCalc-3505"><span class="linenos">3505</span></a>            <span class="p">{</span>
</span><span id="ScalingLawsCalc-3506"><a href="#ScalingLawsCalc-3506"><span class="linenos">3506</span></a>                <span class="s2">&quot;min_label_no&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="ScalingLawsCalc-3507"><a href="#ScalingLawsCalc-3507"><span class="linenos">3507</span></a>                    <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;user_id : </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;no: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="ScalingLawsCalc-3508"><a href="#ScalingLawsCalc-3508"><span class="linenos">3508</span></a>                    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_min_labels_no_after_filtration</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3509"><a href="#ScalingLawsCalc-3509"><span class="linenos">3509</span></a>                        <span class="n">filtered_animals</span>
</span><span id="ScalingLawsCalc-3510"><a href="#ScalingLawsCalc-3510"><span class="linenos">3510</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3511"><a href="#ScalingLawsCalc-3511"><span class="linenos">3511</span></a>                <span class="p">]</span>
</span><span id="ScalingLawsCalc-3512"><a href="#ScalingLawsCalc-3512"><span class="linenos">3512</span></a>            <span class="p">}</span>
</span><span id="ScalingLawsCalc-3513"><a href="#ScalingLawsCalc-3513"><span class="linenos">3513</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3514"><a href="#ScalingLawsCalc-3514"><span class="linenos">3514</span></a>
</span><span id="ScalingLawsCalc-3515"><a href="#ScalingLawsCalc-3515"><span class="linenos">3515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3516"><a href="#ScalingLawsCalc-3516"><span class="linenos">3516</span></a>            <span class="p">{</span>
</span><span id="ScalingLawsCalc-3517"><a href="#ScalingLawsCalc-3517"><span class="linenos">3517</span></a>                <span class="s2">&quot;min_records&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="ScalingLawsCalc-3518"><a href="#ScalingLawsCalc-3518"><span class="linenos">3518</span></a>                    <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;user_id : </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;no: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="ScalingLawsCalc-3519"><a href="#ScalingLawsCalc-3519"><span class="linenos">3519</span></a>                    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_min_records_no_before_filtration</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3520"><a href="#ScalingLawsCalc-3520"><span class="linenos">3520</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
</span><span id="ScalingLawsCalc-3521"><a href="#ScalingLawsCalc-3521"><span class="linenos">3521</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3522"><a href="#ScalingLawsCalc-3522"><span class="linenos">3522</span></a>                <span class="p">]</span>
</span><span id="ScalingLawsCalc-3523"><a href="#ScalingLawsCalc-3523"><span class="linenos">3523</span></a>            <span class="p">}</span>
</span><span id="ScalingLawsCalc-3524"><a href="#ScalingLawsCalc-3524"><span class="linenos">3524</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3525"><a href="#ScalingLawsCalc-3525"><span class="linenos">3525</span></a>
</span><span id="ScalingLawsCalc-3526"><a href="#ScalingLawsCalc-3526"><span class="linenos">3526</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3527"><a href="#ScalingLawsCalc-3527"><span class="linenos">3527</span></a>            <span class="p">{</span><span class="s2">&quot;avg_duration&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_mean_periods</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="ScalingLawsCalc-3528"><a href="#ScalingLawsCalc-3528"><span class="linenos">3528</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3529"><a href="#ScalingLawsCalc-3529"><span class="linenos">3529</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3530"><a href="#ScalingLawsCalc-3530"><span class="linenos">3530</span></a>            <span class="p">{</span><span class="s2">&quot;min_duration&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_min_periods</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="ScalingLawsCalc-3531"><a href="#ScalingLawsCalc-3531"><span class="linenos">3531</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3532"><a href="#ScalingLawsCalc-3532"><span class="linenos">3532</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3533"><a href="#ScalingLawsCalc-3533"><span class="linenos">3533</span></a>            <span class="p">{</span><span class="s2">&quot;max_duration&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_max_periods</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="ScalingLawsCalc-3534"><a href="#ScalingLawsCalc-3534"><span class="linenos">3534</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3535"><a href="#ScalingLawsCalc-3535"><span class="linenos">3535</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3536"><a href="#ScalingLawsCalc-3536"><span class="linenos">3536</span></a>            <span class="p">{</span><span class="s2">&quot;overall_set_area&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_overall_area</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="ScalingLawsCalc-3537"><a href="#ScalingLawsCalc-3537"><span class="linenos">3537</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3538"><a href="#ScalingLawsCalc-3538"><span class="linenos">3538</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3539"><a href="#ScalingLawsCalc-3539"><span class="linenos">3539</span></a>            <span class="p">{</span><span class="s2">&quot;average_set_area&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_mean_area</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="ScalingLawsCalc-3540"><a href="#ScalingLawsCalc-3540"><span class="linenos">3540</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3541"><a href="#ScalingLawsCalc-3541"><span class="linenos">3541</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3542"><a href="#ScalingLawsCalc-3542"><span class="linenos">3542</span></a>            <span class="p">{</span><span class="s2">&quot;min_area&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_min_area</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="ScalingLawsCalc-3543"><a href="#ScalingLawsCalc-3543"><span class="linenos">3543</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3544"><a href="#ScalingLawsCalc-3544"><span class="linenos">3544</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3545"><a href="#ScalingLawsCalc-3545"><span class="linenos">3545</span></a>            <span class="p">{</span><span class="s2">&quot;max_area&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_max_area</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="ScalingLawsCalc-3546"><a href="#ScalingLawsCalc-3546"><span class="linenos">3546</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3547"><a href="#ScalingLawsCalc-3547"><span class="linenos">3547</span></a>
</span><span id="ScalingLawsCalc-3548"><a href="#ScalingLawsCalc-3548"><span class="linenos">3548</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3549"><a href="#ScalingLawsCalc-3549"><span class="linenos">3549</span></a>            <span class="p">{</span>
</span><span id="ScalingLawsCalc-3550"><a href="#ScalingLawsCalc-3550"><span class="linenos">3550</span></a>                <span class="s2">&quot;mean_label_no&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_mean_labels_no_after_filtration</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3551"><a href="#ScalingLawsCalc-3551"><span class="linenos">3551</span></a>                    <span class="n">filtered_animals</span>
</span><span id="ScalingLawsCalc-3552"><a href="#ScalingLawsCalc-3552"><span class="linenos">3552</span></a>                <span class="p">)</span>
</span><span id="ScalingLawsCalc-3553"><a href="#ScalingLawsCalc-3553"><span class="linenos">3553</span></a>            <span class="p">}</span>
</span><span id="ScalingLawsCalc-3554"><a href="#ScalingLawsCalc-3554"><span class="linenos">3554</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3555"><a href="#ScalingLawsCalc-3555"><span class="linenos">3555</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3556"><a href="#ScalingLawsCalc-3556"><span class="linenos">3556</span></a>            <span class="p">{</span><span class="s2">&quot;std_label_no&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_std_labels_no_after_filtration</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3557"><a href="#ScalingLawsCalc-3557"><span class="linenos">3557</span></a>                <span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3558"><a href="#ScalingLawsCalc-3558"><span class="linenos">3558</span></a>            <span class="p">}</span>
</span><span id="ScalingLawsCalc-3559"><a href="#ScalingLawsCalc-3559"><span class="linenos">3559</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3560"><a href="#ScalingLawsCalc-3560"><span class="linenos">3560</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3561"><a href="#ScalingLawsCalc-3561"><span class="linenos">3561</span></a>            <span class="p">{</span><span class="s2">&quot;mean_records&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_mean_records_no_before_filtration</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3562"><a href="#ScalingLawsCalc-3562"><span class="linenos">3562</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3563"><a href="#ScalingLawsCalc-3563"><span class="linenos">3563</span></a>            <span class="p">}</span>
</span><span id="ScalingLawsCalc-3564"><a href="#ScalingLawsCalc-3564"><span class="linenos">3564</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3565"><a href="#ScalingLawsCalc-3565"><span class="linenos">3565</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3566"><a href="#ScalingLawsCalc-3566"><span class="linenos">3566</span></a>            <span class="p">{</span><span class="s2">&quot;std_records&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_std_records_no_before_filtration</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3567"><a href="#ScalingLawsCalc-3567"><span class="linenos">3567</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3568"><a href="#ScalingLawsCalc-3568"><span class="linenos">3568</span></a>            <span class="p">}</span>
</span><span id="ScalingLawsCalc-3569"><a href="#ScalingLawsCalc-3569"><span class="linenos">3569</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3570"><a href="#ScalingLawsCalc-3570"><span class="linenos">3570</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3571"><a href="#ScalingLawsCalc-3571"><span class="linenos">3571</span></a>            <span class="p">{</span><span class="s2">&quot;std_duration&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_std_periods</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="ScalingLawsCalc-3572"><a href="#ScalingLawsCalc-3572"><span class="linenos">3572</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3573"><a href="#ScalingLawsCalc-3573"><span class="linenos">3573</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3574"><a href="#ScalingLawsCalc-3574"><span class="linenos">3574</span></a>            <span class="p">{</span><span class="s2">&quot;std_area&quot;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_std_area</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)}</span>
</span><span id="ScalingLawsCalc-3575"><a href="#ScalingLawsCalc-3575"><span class="linenos">3575</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3576"><a href="#ScalingLawsCalc-3576"><span class="linenos">3576</span></a>
</span><span id="ScalingLawsCalc-3577"><a href="#ScalingLawsCalc-3577"><span class="linenos">3577</span></a>        <span class="k">return</span> <span class="n">filtered_animals</span>
</span><span id="ScalingLawsCalc-3578"><a href="#ScalingLawsCalc-3578"><span class="linenos">3578</span></a>
</span><span id="ScalingLawsCalc-3579"><a href="#ScalingLawsCalc-3579"><span class="linenos">3579</span></a>
</span><span id="ScalingLawsCalc-3580"><a href="#ScalingLawsCalc-3580"><span class="linenos">3580</span></a>    <span class="k">def</span> <span class="nf">_advenced_preprocessing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalingLawsCalc-3581"><a href="#ScalingLawsCalc-3581"><span class="linenos">3581</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc-3582"><a href="#ScalingLawsCalc-3582"><span class="linenos">3582</span></a><span class="sd">        Performs advanced preprocessing by filtering, filling missing data,</span>
</span><span id="ScalingLawsCalc-3583"><a href="#ScalingLawsCalc-3583"><span class="linenos">3583</span></a><span class="sd">        and calculating distinct locations over time.</span>
</span><span id="ScalingLawsCalc-3584"><a href="#ScalingLawsCalc-3584"><span class="linenos">3584</span></a>
</span><span id="ScalingLawsCalc-3585"><a href="#ScalingLawsCalc-3585"><span class="linenos">3585</span></a><span class="sd">        Returns:</span>
</span><span id="ScalingLawsCalc-3586"><a href="#ScalingLawsCalc-3586"><span class="linenos">3586</span></a><span class="sd">            tuple: Processed data, number of rows, data index, and unique</span>
</span><span id="ScalingLawsCalc-3587"><a href="#ScalingLawsCalc-3587"><span class="linenos">3587</span></a><span class="sd">                locations count.</span>
</span><span id="ScalingLawsCalc-3588"><a href="#ScalingLawsCalc-3588"><span class="linenos">3588</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc-3589"><a href="#ScalingLawsCalc-3589"><span class="linenos">3589</span></a>
</span><span id="ScalingLawsCalc-3590"><a href="#ScalingLawsCalc-3590"><span class="linenos">3590</span></a>        <span class="n">preproc</span> <span class="o">=</span> <span class="n">Prepocessing</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3591"><a href="#ScalingLawsCalc-3591"><span class="linenos">3591</span></a>        <span class="n">filtrated_data</span> <span class="o">=</span> <span class="n">preproc</span><span class="o">.</span><span class="n">filter_by_quartiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3592"><a href="#ScalingLawsCalc-3592"><span class="linenos">3592</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ScalingLawsCalc-3593"><a href="#ScalingLawsCalc-3593"><span class="linenos">3593</span></a>            <span class="n">filtrated_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3594"><a href="#ScalingLawsCalc-3594"><span class="linenos">3594</span></a>            <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Unnamed: 0&quot;</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">])</span>
</span><span id="ScalingLawsCalc-3595"><a href="#ScalingLawsCalc-3595"><span class="linenos">3595</span></a>            <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3596"><a href="#ScalingLawsCalc-3596"><span class="linenos">3596</span></a>            <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3597"><a href="#ScalingLawsCalc-3597"><span class="linenos">3597</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3598"><a href="#ScalingLawsCalc-3598"><span class="linenos">3598</span></a>        <span class="n">filled_data</span> <span class="o">=</span> <span class="n">preproc</span><span class="o">.</span><span class="n">filing_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3599"><a href="#ScalingLawsCalc-3599"><span class="linenos">3599</span></a>        <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filled_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</span><span id="ScalingLawsCalc-3600"><a href="#ScalingLawsCalc-3600"><span class="linenos">3600</span></a>        <span class="n">n_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3601"><a href="#ScalingLawsCalc-3601"><span class="linenos">3601</span></a>        <span class="n">S_data</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ScalingLawsCalc-3602"><a href="#ScalingLawsCalc-3602"><span class="linenos">3602</span></a>            <span class="n">filled_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s2">&quot;new_sum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3603"><a href="#ScalingLawsCalc-3603"><span class="linenos">3603</span></a>        <span class="p">]</span>
</span><span id="ScalingLawsCalc-3604"><a href="#ScalingLawsCalc-3604"><span class="linenos">3604</span></a>
</span><span id="ScalingLawsCalc-3605"><a href="#ScalingLawsCalc-3605"><span class="linenos">3605</span></a>        <span class="k">return</span> <span class="n">filled_data</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span><span class="p">,</span> <span class="n">S_data</span>
</span><span id="ScalingLawsCalc-3606"><a href="#ScalingLawsCalc-3606"><span class="linenos">3606</span></a>
</span><span id="ScalingLawsCalc-3607"><a href="#ScalingLawsCalc-3607"><span class="linenos">3607</span></a>
</span><span id="ScalingLawsCalc-3608"><a href="#ScalingLawsCalc-3608"><span class="linenos">3608</span></a>    <span class="k">def</span> <span class="nf">process_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ScalingLawsCalc-3609"><a href="#ScalingLawsCalc-3609"><span class="linenos">3609</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc-3610"><a href="#ScalingLawsCalc-3610"><span class="linenos">3610</span></a><span class="sd">        Main processing function that executes preprocessing,</span>
</span><span id="ScalingLawsCalc-3611"><a href="#ScalingLawsCalc-3611"><span class="linenos">3611</span></a><span class="sd">        statistical analysis, and generates a PDF report with various</span>
</span><span id="ScalingLawsCalc-3612"><a href="#ScalingLawsCalc-3612"><span class="linenos">3612</span></a><span class="sd">        scaling laws.</span>
</span><span id="ScalingLawsCalc-3613"><a href="#ScalingLawsCalc-3613"><span class="linenos">3613</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc-3614"><a href="#ScalingLawsCalc-3614"><span class="linenos">3614</span></a>
</span><span id="ScalingLawsCalc-3615"><a href="#ScalingLawsCalc-3615"><span class="linenos">3615</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;animal&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span><span class="p">})</span>
</span><span id="ScalingLawsCalc-3616"><a href="#ScalingLawsCalc-3616"><span class="linenos">3616</span></a>
</span><span id="ScalingLawsCalc-3617"><a href="#ScalingLawsCalc-3617"><span class="linenos">3617</span></a>        <span class="n">filtered_animals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess_data</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3618"><a href="#ScalingLawsCalc-3618"><span class="linenos">3618</span></a>        <span class="n">filtered_animals</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3619"><a href="#ScalingLawsCalc-3619"><span class="linenos">3619</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;compressed_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3620"><a href="#ScalingLawsCalc-3620"><span class="linenos">3620</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3621"><a href="#ScalingLawsCalc-3621"><span class="linenos">3621</span></a>        <span class="n">filled_data</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span><span class="p">,</span> <span class="n">S_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advenced_preprocessing</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3622"><a href="#ScalingLawsCalc-3622"><span class="linenos">3622</span></a>
</span><span id="ScalingLawsCalc-3623"><a href="#ScalingLawsCalc-3623"><span class="linenos">3623</span></a>        <span class="n">min_label_no</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ScalingLawsCalc-3624"><a href="#ScalingLawsCalc-3624"><span class="linenos">3624</span></a>            <span class="p">[</span><span class="n">value</span><span class="p">]</span>
</span><span id="ScalingLawsCalc-3625"><a href="#ScalingLawsCalc-3625"><span class="linenos">3625</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">Stats</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3626"><a href="#ScalingLawsCalc-3626"><span class="linenos">3626</span></a>            <span class="o">.</span><span class="n">get_min_labels_no_after_filtration</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3627"><a href="#ScalingLawsCalc-3627"><span class="linenos">3627</span></a>            <span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3628"><a href="#ScalingLawsCalc-3628"><span class="linenos">3628</span></a>        <span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ScalingLawsCalc-3629"><a href="#ScalingLawsCalc-3629"><span class="linenos">3629</span></a>
</span><span id="ScalingLawsCalc-3630"><a href="#ScalingLawsCalc-3630"><span class="linenos">3630</span></a>        <span class="n">min_records</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ScalingLawsCalc-3631"><a href="#ScalingLawsCalc-3631"><span class="linenos">3631</span></a>            <span class="p">[</span><span class="n">value</span><span class="p">]</span>
</span><span id="ScalingLawsCalc-3632"><a href="#ScalingLawsCalc-3632"><span class="linenos">3632</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">Stats</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3633"><a href="#ScalingLawsCalc-3633"><span class="linenos">3633</span></a>            <span class="o">.</span><span class="n">get_min_records_no_before_filtration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3634"><a href="#ScalingLawsCalc-3634"><span class="linenos">3634</span></a>            <span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3635"><a href="#ScalingLawsCalc-3635"><span class="linenos">3635</span></a>        <span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ScalingLawsCalc-3636"><a href="#ScalingLawsCalc-3636"><span class="linenos">3636</span></a>
</span><span id="ScalingLawsCalc-3637"><a href="#ScalingLawsCalc-3637"><span class="linenos">3637</span></a>        <span class="n">laws</span> <span class="o">=</span> <span class="n">Laws</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3638"><a href="#ScalingLawsCalc-3638"><span class="linenos">3638</span></a>            <span class="n">pdf_object</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span>
</span><span id="ScalingLawsCalc-3639"><a href="#ScalingLawsCalc-3639"><span class="linenos">3639</span></a>            <span class="n">stats_frame</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="p">,</span>
</span><span id="ScalingLawsCalc-3640"><a href="#ScalingLawsCalc-3640"><span class="linenos">3640</span></a>            <span class="n">output_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span><span class="p">,</span>
</span><span id="ScalingLawsCalc-3641"><a href="#ScalingLawsCalc-3641"><span class="linenos">3641</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3642"><a href="#ScalingLawsCalc-3642"><span class="linenos">3642</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">visitation_frequency</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">,</span> <span class="n">min_label_no</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3643"><a href="#ScalingLawsCalc-3643"><span class="linenos">3643</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">distinct_locations_over_time</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span><span class="p">,</span> <span class="n">S_data</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3644"><a href="#ScalingLawsCalc-3644"><span class="linenos">3644</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">msd_curve_split</span><span class="p">(</span><span class="n">filled_data</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3645"><a href="#ScalingLawsCalc-3645"><span class="linenos">3645</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">rog_over_time</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">,</span> <span class="n">min_records</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3646"><a href="#ScalingLawsCalc-3646"><span class="linenos">3646</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span><span id="ScalingLawsCalc-3647"><a href="#ScalingLawsCalc-3647"><span class="linenos">3647</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">waiting_times</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3648"><a href="#ScalingLawsCalc-3648"><span class="linenos">3648</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">jump_lengths_distribution</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3649"><a href="#ScalingLawsCalc-3649"><span class="linenos">3649</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">travel_times</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3650"><a href="#ScalingLawsCalc-3650"><span class="linenos">3650</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">rog</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3651"><a href="#ScalingLawsCalc-3651"><span class="linenos">3651</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">msd_distribution</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3652"><a href="#ScalingLawsCalc-3652"><span class="linenos">3652</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">return_time_distribution</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3653"><a href="#ScalingLawsCalc-3653"><span class="linenos">3653</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">exploration_time</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3654"><a href="#ScalingLawsCalc-3654"><span class="linenos">3654</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">estimate_pnew</span><span class="p">(</span><span class="n">filled_data</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3655"><a href="#ScalingLawsCalc-3655"><span class="linenos">3655</span></a>
</span><span id="ScalingLawsCalc-3656"><a href="#ScalingLawsCalc-3656"><span class="linenos">3656</span></a>        <span class="n">pdf_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="ScalingLawsCalc-3657"><a href="#ScalingLawsCalc-3657"><span class="linenos">3657</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span><span class="si">}</span><span class="s2">.pdf&quot;</span>
</span><span id="ScalingLawsCalc-3658"><a href="#ScalingLawsCalc-3658"><span class="linenos">3658</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc-3659"><a href="#ScalingLawsCalc-3659"><span class="linenos">3659</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">pdf_path</span><span class="p">)</span>
</span><span id="ScalingLawsCalc-3660"><a href="#ScalingLawsCalc-3660"><span class="linenos">3660</span></a>
</span><span id="ScalingLawsCalc-3661"><a href="#ScalingLawsCalc-3661"><span class="linenos">3661</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_record</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>A class for processing animal trajectory data, performing
statistical analyses, and generating a PDF report with results.</p>

<p>Attributes:
    data (TrajectoriesFrame): The trajectory data of animals.
    animal_name (str): Name of the dataset.
    output_dir (str): Directory to store the output files.
    output_dir_animal (str): Path for the specific dataset output.
    pdf (FPDF): PDF object to generate reports.
    stats_frame (DataSetStats): Object for tracking dataset statistics.</p>
</div>


                            <div id="ScalingLawsCalc.__init__" class="classattr">
                                        <input id="ScalingLawsCalc.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ScalingLawsCalc</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">humobi</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">TrajectoriesFrame</span>,</span><span class="param">	<span class="n">data_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">output_dir</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">stats_frame</span><span class="p">:</span> <span class="n"><a href="#DataSetStats">DataSetStats</a></span></span>)</span>

                <label class="view-source-button" for="ScalingLawsCalc.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScalingLawsCalc.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalingLawsCalc.__init__-3436"><a href="#ScalingLawsCalc.__init__-3436"><span class="linenos">3436</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="ScalingLawsCalc.__init__-3437"><a href="#ScalingLawsCalc.__init__-3437"><span class="linenos">3437</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ScalingLawsCalc.__init__-3438"><a href="#ScalingLawsCalc.__init__-3438"><span class="linenos">3438</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">TrajectoriesFrame</span><span class="p">,</span>
</span><span id="ScalingLawsCalc.__init__-3439"><a href="#ScalingLawsCalc.__init__-3439"><span class="linenos">3439</span></a>        <span class="n">data_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="ScalingLawsCalc.__init__-3440"><a href="#ScalingLawsCalc.__init__-3440"><span class="linenos">3440</span></a>        <span class="n">output_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="ScalingLawsCalc.__init__-3441"><a href="#ScalingLawsCalc.__init__-3441"><span class="linenos">3441</span></a>        <span class="n">stats_frame</span><span class="p">:</span> <span class="n">DataSetStats</span><span class="p">,</span>
</span><span id="ScalingLawsCalc.__init__-3442"><a href="#ScalingLawsCalc.__init__-3442"><span class="linenos">3442</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ScalingLawsCalc.__init__-3443"><a href="#ScalingLawsCalc.__init__-3443"><span class="linenos">3443</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc.__init__-3444"><a href="#ScalingLawsCalc.__init__-3444"><span class="linenos">3444</span></a><span class="sd">        Initializes the ScalingLawsCalc class.</span>
</span><span id="ScalingLawsCalc.__init__-3445"><a href="#ScalingLawsCalc.__init__-3445"><span class="linenos">3445</span></a>
</span><span id="ScalingLawsCalc.__init__-3446"><a href="#ScalingLawsCalc.__init__-3446"><span class="linenos">3446</span></a><span class="sd">        Args:</span>
</span><span id="ScalingLawsCalc.__init__-3447"><a href="#ScalingLawsCalc.__init__-3447"><span class="linenos">3447</span></a><span class="sd">            data (TrajectoriesFrame): The trajectory dataset.</span>
</span><span id="ScalingLawsCalc.__init__-3448"><a href="#ScalingLawsCalc.__init__-3448"><span class="linenos">3448</span></a><span class="sd">            data_name (str): The name of the dataset.</span>
</span><span id="ScalingLawsCalc.__init__-3449"><a href="#ScalingLawsCalc.__init__-3449"><span class="linenos">3449</span></a><span class="sd">            output_dir (str): Directory to save output files.</span>
</span><span id="ScalingLawsCalc.__init__-3450"><a href="#ScalingLawsCalc.__init__-3450"><span class="linenos">3450</span></a><span class="sd">            stats_frame (DataSetStats): Object to store statistics</span>
</span><span id="ScalingLawsCalc.__init__-3451"><a href="#ScalingLawsCalc.__init__-3451"><span class="linenos">3451</span></a><span class="sd">                of the dataset.</span>
</span><span id="ScalingLawsCalc.__init__-3452"><a href="#ScalingLawsCalc.__init__-3452"><span class="linenos">3452</span></a>
</span><span id="ScalingLawsCalc.__init__-3453"><a href="#ScalingLawsCalc.__init__-3453"><span class="linenos">3453</span></a><span class="sd">        Raises:</span>
</span><span id="ScalingLawsCalc.__init__-3454"><a href="#ScalingLawsCalc.__init__-3454"><span class="linenos">3454</span></a><span class="sd">            FileExistsError: If the output directory for the dataset</span>
</span><span id="ScalingLawsCalc.__init__-3455"><a href="#ScalingLawsCalc.__init__-3455"><span class="linenos">3455</span></a><span class="sd">                already exists.</span>
</span><span id="ScalingLawsCalc.__init__-3456"><a href="#ScalingLawsCalc.__init__-3456"><span class="linenos">3456</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc.__init__-3457"><a href="#ScalingLawsCalc.__init__-3457"><span class="linenos">3457</span></a>
</span><span id="ScalingLawsCalc.__init__-3458"><a href="#ScalingLawsCalc.__init__-3458"><span class="linenos">3458</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="ScalingLawsCalc.__init__-3459"><a href="#ScalingLawsCalc.__init__-3459"><span class="linenos">3459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span> <span class="o">=</span> <span class="n">data_name</span>
</span><span id="ScalingLawsCalc.__init__-3460"><a href="#ScalingLawsCalc.__init__-3460"><span class="linenos">3460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">output_dir</span>
</span><span id="ScalingLawsCalc.__init__-3461"><a href="#ScalingLawsCalc.__init__-3461"><span class="linenos">3461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">data_name</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.__init__-3462"><a href="#ScalingLawsCalc.__init__-3462"><span class="linenos">3462</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span> <span class="o">=</span> <span class="n">FPDF</span><span class="p">()</span>
</span><span id="ScalingLawsCalc.__init__-3463"><a href="#ScalingLawsCalc.__init__-3463"><span class="linenos">3463</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span> <span class="o">=</span> <span class="n">stats_frame</span>
</span><span id="ScalingLawsCalc.__init__-3464"><a href="#ScalingLawsCalc.__init__-3464"><span class="linenos">3464</span></a>
</span><span id="ScalingLawsCalc.__init__-3465"><a href="#ScalingLawsCalc.__init__-3465"><span class="linenos">3465</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ScalingLawsCalc.__init__-3466"><a href="#ScalingLawsCalc.__init__-3466"><span class="linenos">3466</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.__init__-3467"><a href="#ScalingLawsCalc.__init__-3467"><span class="linenos">3467</span></a>        <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
</span><span id="ScalingLawsCalc.__init__-3468"><a href="#ScalingLawsCalc.__init__-3468"><span class="linenos">3468</span></a>            <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span>
</span><span id="ScalingLawsCalc.__init__-3469"><a href="#ScalingLawsCalc.__init__-3469"><span class="linenos">3469</span></a>                <span class="sa">f</span><span class="s2">&quot;The directory </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span><span class="si">}</span><span class="s2"> already exists. &quot;</span>
</span><span id="ScalingLawsCalc.__init__-3470"><a href="#ScalingLawsCalc.__init__-3470"><span class="linenos">3470</span></a>                <span class="sa">f</span><span class="s2">&quot;Please remove it or specify a different name.&quot;</span>
</span><span id="ScalingLawsCalc.__init__-3471"><a href="#ScalingLawsCalc.__init__-3471"><span class="linenos">3471</span></a>            <span class="p">)</span>
</span><span id="ScalingLawsCalc.__init__-3472"><a href="#ScalingLawsCalc.__init__-3472"><span class="linenos">3472</span></a>
</span><span id="ScalingLawsCalc.__init__-3473"><a href="#ScalingLawsCalc.__init__-3473"><span class="linenos">3473</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span><span id="ScalingLawsCalc.__init__-3474"><a href="#ScalingLawsCalc.__init__-3474"><span class="linenos">3474</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">set_auto_page_break</span><span class="p">(</span><span class="n">auto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.__init__-3475"><a href="#ScalingLawsCalc.__init__-3475"><span class="linenos">3475</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.__init__-3476"><a href="#ScalingLawsCalc.__init__-3476"><span class="linenos">3476</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span>
</span><span id="ScalingLawsCalc.__init__-3477"><a href="#ScalingLawsCalc.__init__-3477"><span class="linenos">3477</span></a>            <span class="mi">200</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ln</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
</span><span id="ScalingLawsCalc.__init__-3478"><a href="#ScalingLawsCalc.__init__-3478"><span class="linenos">3478</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc.__init__-3479"><a href="#ScalingLawsCalc.__init__-3479"><span class="linenos">3479</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.__init__-3480"><a href="#ScalingLawsCalc.__init__-3480"><span class="linenos">3480</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initializes the ScalingLawsCalc class.</p>

<p>Args:
    data (TrajectoriesFrame): The trajectory dataset.
    data_name (str): The name of the dataset.
    output_dir (str): Directory to save output files.
    stats_frame (DataSetStats): Object to store statistics
        of the dataset.</p>

<p>Raises:
    FileExistsError: If the output directory for the dataset
        already exists.</p>
</div>


                            </div>
                            <div id="ScalingLawsCalc.data" class="classattr">
                                <div class="attr variable">
            <span class="name">data</span>

        
    </div>
    <a class="headerlink" href="#ScalingLawsCalc.data"></a>
    
    

                            </div>
                            <div id="ScalingLawsCalc.animal_name" class="classattr">
                                <div class="attr variable">
            <span class="name">animal_name</span>

        
    </div>
    <a class="headerlink" href="#ScalingLawsCalc.animal_name"></a>
    
    

                            </div>
                            <div id="ScalingLawsCalc.output_dir" class="classattr">
                                <div class="attr variable">
            <span class="name">output_dir</span>

        
    </div>
    <a class="headerlink" href="#ScalingLawsCalc.output_dir"></a>
    
    

                            </div>
                            <div id="ScalingLawsCalc.output_dir_animal" class="classattr">
                                <div class="attr variable">
            <span class="name">output_dir_animal</span>

        
    </div>
    <a class="headerlink" href="#ScalingLawsCalc.output_dir_animal"></a>
    
    

                            </div>
                            <div id="ScalingLawsCalc.pdf" class="classattr">
                                <div class="attr variable">
            <span class="name">pdf</span>

        
    </div>
    <a class="headerlink" href="#ScalingLawsCalc.pdf"></a>
    
    

                            </div>
                            <div id="ScalingLawsCalc.stats_frame" class="classattr">
                                <div class="attr variable">
            <span class="name">stats_frame</span>

        
    </div>
    <a class="headerlink" href="#ScalingLawsCalc.stats_frame"></a>
    
    

                            </div>
                            <div id="ScalingLawsCalc.process_file" class="classattr">
                                        <input id="ScalingLawsCalc.process_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">process_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ScalingLawsCalc.process_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScalingLawsCalc.process_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalingLawsCalc.process_file-3608"><a href="#ScalingLawsCalc.process_file-3608"><span class="linenos">3608</span></a>    <span class="k">def</span> <span class="nf">process_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ScalingLawsCalc.process_file-3609"><a href="#ScalingLawsCalc.process_file-3609"><span class="linenos">3609</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc.process_file-3610"><a href="#ScalingLawsCalc.process_file-3610"><span class="linenos">3610</span></a><span class="sd">        Main processing function that executes preprocessing,</span>
</span><span id="ScalingLawsCalc.process_file-3611"><a href="#ScalingLawsCalc.process_file-3611"><span class="linenos">3611</span></a><span class="sd">        statistical analysis, and generates a PDF report with various</span>
</span><span id="ScalingLawsCalc.process_file-3612"><a href="#ScalingLawsCalc.process_file-3612"><span class="linenos">3612</span></a><span class="sd">        scaling laws.</span>
</span><span id="ScalingLawsCalc.process_file-3613"><a href="#ScalingLawsCalc.process_file-3613"><span class="linenos">3613</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalingLawsCalc.process_file-3614"><a href="#ScalingLawsCalc.process_file-3614"><span class="linenos">3614</span></a>
</span><span id="ScalingLawsCalc.process_file-3615"><a href="#ScalingLawsCalc.process_file-3615"><span class="linenos">3615</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_data</span><span class="p">({</span><span class="s2">&quot;animal&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span><span class="p">})</span>
</span><span id="ScalingLawsCalc.process_file-3616"><a href="#ScalingLawsCalc.process_file-3616"><span class="linenos">3616</span></a>
</span><span id="ScalingLawsCalc.process_file-3617"><a href="#ScalingLawsCalc.process_file-3617"><span class="linenos">3617</span></a>        <span class="n">filtered_animals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess_data</span><span class="p">()</span>
</span><span id="ScalingLawsCalc.process_file-3618"><a href="#ScalingLawsCalc.process_file-3618"><span class="linenos">3618</span></a>        <span class="n">filtered_animals</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
</span><span id="ScalingLawsCalc.process_file-3619"><a href="#ScalingLawsCalc.process_file-3619"><span class="linenos">3619</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;compressed_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3620"><a href="#ScalingLawsCalc.process_file-3620"><span class="linenos">3620</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3621"><a href="#ScalingLawsCalc.process_file-3621"><span class="linenos">3621</span></a>        <span class="n">filled_data</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span><span class="p">,</span> <span class="n">S_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advenced_preprocessing</span><span class="p">()</span>
</span><span id="ScalingLawsCalc.process_file-3622"><a href="#ScalingLawsCalc.process_file-3622"><span class="linenos">3622</span></a>
</span><span id="ScalingLawsCalc.process_file-3623"><a href="#ScalingLawsCalc.process_file-3623"><span class="linenos">3623</span></a>        <span class="n">min_label_no</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ScalingLawsCalc.process_file-3624"><a href="#ScalingLawsCalc.process_file-3624"><span class="linenos">3624</span></a>            <span class="p">[</span><span class="n">value</span><span class="p">]</span>
</span><span id="ScalingLawsCalc.process_file-3625"><a href="#ScalingLawsCalc.process_file-3625"><span class="linenos">3625</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">Stats</span><span class="p">()</span>
</span><span id="ScalingLawsCalc.process_file-3626"><a href="#ScalingLawsCalc.process_file-3626"><span class="linenos">3626</span></a>            <span class="o">.</span><span class="n">get_min_labels_no_after_filtration</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3627"><a href="#ScalingLawsCalc.process_file-3627"><span class="linenos">3627</span></a>            <span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="ScalingLawsCalc.process_file-3628"><a href="#ScalingLawsCalc.process_file-3628"><span class="linenos">3628</span></a>        <span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ScalingLawsCalc.process_file-3629"><a href="#ScalingLawsCalc.process_file-3629"><span class="linenos">3629</span></a>
</span><span id="ScalingLawsCalc.process_file-3630"><a href="#ScalingLawsCalc.process_file-3630"><span class="linenos">3630</span></a>        <span class="n">min_records</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ScalingLawsCalc.process_file-3631"><a href="#ScalingLawsCalc.process_file-3631"><span class="linenos">3631</span></a>            <span class="p">[</span><span class="n">value</span><span class="p">]</span>
</span><span id="ScalingLawsCalc.process_file-3632"><a href="#ScalingLawsCalc.process_file-3632"><span class="linenos">3632</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">Stats</span><span class="p">()</span>
</span><span id="ScalingLawsCalc.process_file-3633"><a href="#ScalingLawsCalc.process_file-3633"><span class="linenos">3633</span></a>            <span class="o">.</span><span class="n">get_min_records_no_before_filtration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3634"><a href="#ScalingLawsCalc.process_file-3634"><span class="linenos">3634</span></a>            <span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="ScalingLawsCalc.process_file-3635"><a href="#ScalingLawsCalc.process_file-3635"><span class="linenos">3635</span></a>        <span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ScalingLawsCalc.process_file-3636"><a href="#ScalingLawsCalc.process_file-3636"><span class="linenos">3636</span></a>
</span><span id="ScalingLawsCalc.process_file-3637"><a href="#ScalingLawsCalc.process_file-3637"><span class="linenos">3637</span></a>        <span class="n">laws</span> <span class="o">=</span> <span class="n">Laws</span><span class="p">(</span>
</span><span id="ScalingLawsCalc.process_file-3638"><a href="#ScalingLawsCalc.process_file-3638"><span class="linenos">3638</span></a>            <span class="n">pdf_object</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span>
</span><span id="ScalingLawsCalc.process_file-3639"><a href="#ScalingLawsCalc.process_file-3639"><span class="linenos">3639</span></a>            <span class="n">stats_frame</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="p">,</span>
</span><span id="ScalingLawsCalc.process_file-3640"><a href="#ScalingLawsCalc.process_file-3640"><span class="linenos">3640</span></a>            <span class="n">output_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span><span class="p">,</span>
</span><span id="ScalingLawsCalc.process_file-3641"><a href="#ScalingLawsCalc.process_file-3641"><span class="linenos">3641</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3642"><a href="#ScalingLawsCalc.process_file-3642"><span class="linenos">3642</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">visitation_frequency</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">,</span> <span class="n">min_label_no</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3643"><a href="#ScalingLawsCalc.process_file-3643"><span class="linenos">3643</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">distinct_locations_over_time</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">n_data</span><span class="p">,</span> <span class="n">S_data</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3644"><a href="#ScalingLawsCalc.process_file-3644"><span class="linenos">3644</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">msd_curve_split</span><span class="p">(</span><span class="n">filled_data</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3645"><a href="#ScalingLawsCalc.process_file-3645"><span class="linenos">3645</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">rog_over_time</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">,</span> <span class="n">min_records</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3646"><a href="#ScalingLawsCalc.process_file-3646"><span class="linenos">3646</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
</span><span id="ScalingLawsCalc.process_file-3647"><a href="#ScalingLawsCalc.process_file-3647"><span class="linenos">3647</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">waiting_times</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3648"><a href="#ScalingLawsCalc.process_file-3648"><span class="linenos">3648</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">jump_lengths_distribution</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3649"><a href="#ScalingLawsCalc.process_file-3649"><span class="linenos">3649</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">travel_times</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3650"><a href="#ScalingLawsCalc.process_file-3650"><span class="linenos">3650</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">rog</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3651"><a href="#ScalingLawsCalc.process_file-3651"><span class="linenos">3651</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">msd_distribution</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3652"><a href="#ScalingLawsCalc.process_file-3652"><span class="linenos">3652</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">return_time_distribution</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3653"><a href="#ScalingLawsCalc.process_file-3653"><span class="linenos">3653</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">exploration_time</span><span class="p">(</span><span class="n">filtered_animals</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3654"><a href="#ScalingLawsCalc.process_file-3654"><span class="linenos">3654</span></a>        <span class="n">laws</span><span class="o">.</span><span class="n">estimate_pnew</span><span class="p">(</span><span class="n">filled_data</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3655"><a href="#ScalingLawsCalc.process_file-3655"><span class="linenos">3655</span></a>
</span><span id="ScalingLawsCalc.process_file-3656"><a href="#ScalingLawsCalc.process_file-3656"><span class="linenos">3656</span></a>        <span class="n">pdf_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="ScalingLawsCalc.process_file-3657"><a href="#ScalingLawsCalc.process_file-3657"><span class="linenos">3657</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">output_dir_animal</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">animal_name</span><span class="si">}</span><span class="s2">.pdf&quot;</span>
</span><span id="ScalingLawsCalc.process_file-3658"><a href="#ScalingLawsCalc.process_file-3658"><span class="linenos">3658</span></a>        <span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3659"><a href="#ScalingLawsCalc.process_file-3659"><span class="linenos">3659</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">pdf_path</span><span class="p">)</span>
</span><span id="ScalingLawsCalc.process_file-3660"><a href="#ScalingLawsCalc.process_file-3660"><span class="linenos">3660</span></a>
</span><span id="ScalingLawsCalc.process_file-3661"><a href="#ScalingLawsCalc.process_file-3661"><span class="linenos">3661</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stats_frame</span><span class="o">.</span><span class="n">add_record</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Main processing function that executes preprocessing,
statistical analysis, and generates a PDF report with various
scaling laws.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>